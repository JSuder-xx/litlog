var starter=function(r){"use strict";var w=["Failure",-2],T=["Invalid_argument",-3],k=["Division_by_zero",-5],C=["Not_found",-6],s=["Match_failure",-7],M=["Assert_failure",-10];function o(r,e,n){for(var t=new Array(n),a=0,i=e;a<n;)t[a]=r[i],a=a+1|0,i=i+1|0;return t}function lr(r,e){if(e<0||e>=r.length)throw[T,"index out of bounds"];return r[e]}function y(r,e){for(;;){var n=e,t=r,a=t.length,i=0===a?1:a,u=i-n.length|0;if(0==u)return t.apply(null,n);if(0<=u)return function(e,n){return function(r){return y(e,n.concat([r]))}}(t,n);e=o(n,i,0|-u),r=t.apply(null,o(n,0,i))}}function vr(u,o){var r=u.length;if(1===r)return u(o);switch(r){case 1:return u(o);case 2:return function(r){return u(o,r)};case 3:return function(r,e){return u(o,r,e)};case 4:return function(r,e,n){return u(o,r,e,n)};case 5:return function(r,e,n,t){return u(o,r,e,n,t)};case 6:return function(r,e,n,t,a){return u(o,r,e,n,t,a)};case 7:return function(r,e,n,t,a,i){return u(o,r,e,n,t,a,i)};default:return y(u,[o])}}function L(i,u,o){var r=i.length;if(2===r)return i(u,o);switch(r){case 1:return y(i(u),[o]);case 2:return i(u,o);case 3:return function(r){return i(u,o,r)};case 4:return function(r,e){return i(u,o,r,e)};case 5:return function(r,e,n){return i(u,o,r,e,n)};case 6:return function(r,e,n,t){return i(u,o,r,e,n,t)};case 7:return function(r,e,n,t,a){return i(u,o,r,e,n,t,a)};default:return y(i,[u,o])}}function I(a,i,u,o){var r=a.length;if(3===r)return a(i,u,o);switch(r){case 1:return y(a(i),[u,o]);case 2:return y(a(i,u),[o]);case 3:return a(i,u,o);case 4:return function(r){return a(i,u,o,r)};case 5:return function(r,e){return a(i,u,o,r,e)};case 6:return function(r,e,n){return a(i,u,o,r,e,n)};case 7:return function(r,e,n,t){return a(i,u,o,r,e,n,t)};default:return y(a,[i,u,o])}}function rr(r,e){return e.tag=r,e}function a(r,e){return r<e?-1:r===e?0:1}function h(r,e){return r===e?0:r<e?-1:1}w.tag=248,T.tag=248,k.tag=248,C.tag=248,s.tag=248,M.tag=248;var p=function(r,e){for(var n in r)e(n)};function i(r){var e=[r];return e.tag=246,e}function m(r,e){for(;;){var n=e,t=r;if(t===n)return!0;var a=typeof t;if("string"==a||"number"==a||"boolean"==a||"undefined"==a||null===t)return!1;var i=typeof n;if("function"==a||"function"==i)throw[T,"equal: functional value"];if("number"==i||"undefined"==i||null===n)return!1;var u=0|t.tag,o=0|n.tag;if(250!=u)if(250!=o){if(248==u)return t[1]===n[1];if(251==u)throw[T,"equal: abstract value"];if(u!=o)return!1;if(256==u)return t[1]===n[1];var c=0|t.length;if(c!=(0|n.length))return!1;if(!Array.isArray(t)){if(t instanceof Date&&n instanceof Date)return!(n<t||t<n);var s={contents:!0},f=function(e,n){return function(r){e.hasOwnProperty(r)||(n.contents=!1)}}(n,s),l=function(e,n,t){return function(r){e.hasOwnProperty(r)&&m(n[r],e[r])||(t.contents=!1)}}(t,n,s);return p(t,f),s.contents&&p(n,l),s.contents}for(var v=0;;){var d=v;if(d===c)return!0;if(!m(t[d],n[d]))return!1;v=d+1|0}}else e=n[0];else r=t[0]}}function er(r,e){return!m(r,e)}function g(r){if(r<0)throw[T,"String.create"];for(var e=new Array(r),n=0;n<r;++n)e[n]=0;return e}function b(r,e,n,t,a){if(!(a<=0))if(r!==n){var i=r.length-e|0;if(a<=i)for(var u=0;u<a;++u)n[t+u|0]=r[e+u|0];else{for(var o=0;o<i;++o)n[t+o|0]=r[e+o|0];for(var c=i;c<a;++c)n[t+c|0]=0}}else{if(e<t){for(var s=(r.length-t|0)-1|0,f=a-1|0,l=f<s?f:s;0<=l;--l)r[t+l|0]=r[e+l|0];return}if(e<=t)return;for(var v=(r.length-e|0)-1|0,d=a-1|0,h=d<v?d:v,p=0;p<=h;++p)r[t+p|0]=r[e+p|0]}}function f(r){var e=r.length,n="",t=e;if(e<=4096&&e===r.length)return String.fromCharCode.apply(null,r);for(var a=0;0<t;){var i=t<1024?t:1024,u=new Array(i);b(r,a,u,0,i),n+=String.fromCharCode.apply(null,u),t=t-i|0,a=a+i|0}return n}function c(r,e,n,t,a){if(!(a<=0)){var i=r.length-e|0;if(a<=i)for(var u=0;u<a;++u)n[t+u|0]=r.charCodeAt(e+u|0);else{for(var o=0;o<i;++o)n[t+o|0]=r.charCodeAt(e+o|0);for(var c=i;c<a;++c)n[t+c|0]=0}}}function l(r){for(var e=r.length,n=new Array(e),t=0;t<e;++t)n[t]=r.charCodeAt(t);return n}var v=Math.imul||function(r,e){return((r>>16)*(e|=0)<<16)+(65535&r)*e|0};function S(r,e){return[e,r>>>0]}var x=[-2147483648,0],e=[2147483647,4294967295],N=[0,1],A=[0,0],O=[-1,4294967295];function u(r){return 0!=(2147483648&r)}function d(r){return 0==(2147483648&r)}function q(r){var e=1+(-1^r[1])|0;return S(e,(-1^r[0])+(0==e?1:0)|0)}function _(r,e,n){var t=r[1],a=t+e|0,i=u(t)&&(u(e)||d(a))||u(e)&&d(a)?1:0;return S(a,r[0]+n+i|0)}function R(r,e){return _(r,e[1],e[0])}function F(r,e){return r[0]===e[0]&&r[1]===e[1]}function E(r,e,n){var t=1+(-1^e)>>>0;return _(r,t,(-1^n)+(0==t?1:0)|0)}function P(r,e){return E(r,e[1],e[0])}function D(r,e){for(;;){var n,t=e,a=r,i=0,u=0;if(0!==a[0])u=3;else{if(0===a[1])return A;u=3}if(3===u)if(0!==t[0])i=2;else{if(0===t[1])return A;i=2}if(2===i){var o=a[0],c=0;if(-2147483648!==o||0!==a[1]?c=3:n=t[1],3===c){var s=t[0],f=a[1],l=0;if(-2147483648!==s||0!==t[1]?l=4:n=f,4===l){var v=t[1];if(o<0){if(0<=s)return q(D(q(a),t));e=q(t),r=q(a);continue}if(s<0)return q(D(a,q(t)));var d=65535&o,h=f>>>16,p=65535&f,m=65535&s,g=v>>>16,b=65535&v,w=0,y=0,_=0,k=p*b,w=(y=(y=(_=(k>>>16)+h*b)>>>16)+((_=(65535&_)+p*g)>>>16)+d*b)>>>16;return w+=(y=(65535&y)+h*g)>>>16,w+=(y=(65535&y)+p*m)>>>16,S(65535&k|(65535&_)<<16,(y&=65535)|(w=(o>>>16)*b+d*g+h*m+p*(s>>>16)+w&65535)<<16)}}}return 0==(1&n)?A:x}}function $(r,e){var n=e[0],t=r[0];return n<t||!(t<n)&&r[1]>=e[1]}function B(r,e){return!F(r,e)}function U(r,e){return!$(r,e)}function V(r){return 4294967296*r[0]+r[1]}function J(r){return isNaN(r)||!isFinite(r)?A:r<=-0x8000000000000000?x:0x8000000000000000<=r+1?e:r<0?q(J(-r)):S(r%4294967296|0,r/4294967296|0)}function Q(r){if(n=(e=r)[0],0==(t=n>>21)||-1==t&&(0!==e[1]||-2097152!==n))return String(V(r));var e,n,t;if(r[0]<0)return F(r,x)?"-9223372036854775808":"-"+Q(q(r));var a=J(Math.floor(V(r)/10)),i=a[1],u=a[0],o=E(E(r,i<<3,i>>>29|u<<3),i<<1,i>>>31|u<<1),c=o[1],s=o[0];if(0===c&&0===s)return Q(a)+"0";if(s<0){var f=1+(-1^c)>>>0,l=Math.ceil(f/10),v=10*l-f;return Q(E(a,0|l,0))+String(0|v)}var d=c,h=Math.floor(d/10),p=d-10*h;return Q(_(a,0|h,0))+String(0|p)}function W(r,e){for(;;){var n=e,t=r,a=0,i=0;if(0===n[0]&&0===n[1])throw k;if((i=3)===i){var u=t[0];if(-2147483648!==u)if(0!==u)a=2;else{if(0===t[1])return A;a=2}else if(0!==t[1])a=2;else{if(F(n,N)||F(n,O))return t;if(F(n,x))return N;var o=function(r,e){if(0===e)return r;var n=r[1];return 32<=e?S(0,n<<(e-32|0)):S(n<<e,n>>>(32-e|0)|r[0]<<e)}(W(function(r,e){if(0===e)return r;var n=r[0];return e<32?S(n<<(32-e|0)|r[1]>>>e,n>>e):S(n>>(e-32|0),0<=n?0:-1)}(t,1),n),1),c=0;if(0!==o[0])c=4;else{if(0===o[1])return n[0]<0?N:q(N);c=4}if(4===c)return R(o,W(P(t,D(n,o)),n))}}if(2===a&&-2147483648===n[0]&&0===n[1])return A;var s=n[0];if(!(t[0]<0)){if(s<0)return q(W(t,q(n)));for(var f=A,l=t;$(l,n);){for(var v=(y=1,(_=Math.floor(V(l)/V(n)))<y?y:_),d=Math.ceil(Math.log(v)/Math.LN2),h=d<=48?1:Math.pow(2,d-48),p=J(v),m=D(p,n);m[0]<0||(w=l,(b=m)[0]>w[0]||!(b[0]<w[0])&&b[1]>w[1]);)m=D(p=J(v-=h),n);0===(g=p)[0]&&0===g[1]&&(p=N),f=R(f,p),l=P(l,m)}return f}if(0<=s)return q(W(q(t),n));e=q(n),r=q(t)}var g,b,w,y,_}function Z(r,e){var n=W(r,e);return[n,P(r,D(n,e))]}function j(r){return 0|r[1]}function z(r){function e(r){return(r>>>0).toString(16)}var n=r[1],t=r[0];if(0===t&&0===n)return"0";if(0===n)return e(t)+"00000000";if(0===t)return e(n);var a=e(n),i=8-a.length|0;return i<=0?e(t)+a:e(t)+("0".repeat(i)+a)}function H(r){return[2147483647&r[0],r[1]]}function X(n){var r=n.length;if(31<r)throw[T,"format_int: format too long"];for(var e,t={justify:"+",signstyle:"-",filter:" ",alternate:!1,base:2,signedconv:!1,width:0,uppercase:!1,sign:1,prec:-1,conv:"f"},a=0;;){var i=a;if(r<=i)return t;var u=n.charCodeAt(i),o=0;if(69<=u)if(88<=u)if(121<=u)o=1;else switch(u-88|0){case 0:t.base=1,t.uppercase=!0,a=i+1|0;continue;case 13:case 14:case 15:o=5;break;case 12:case 17:o=4;break;case 23:a=i+1|(t.base=0);continue;case 29:t.base=2,a=i+1|0;continue;case 1:case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 16:case 18:case 19:case 20:case 21:case 22:case 24:case 25:case 26:case 27:case 28:case 30:case 31:o=1;break;case 32:a=i+(t.base=1)|0;continue}else{if(!(72<=u)){t.signedconv=!0,t.uppercase=!0,t.conv=String.fromCharCode(65<=(e=u)&&e<=90||192<=e&&e<=214||216<=e&&e<=222?e+32|0:e),a=i+1|0;continue}o=1}else switch(u){case 35:t.alternate=!0,a=i+1|0;continue;case 32:case 43:o=2;break;case 45:t.justify="-",a=i+1|0;continue;case 46:for(var c=i+1|(t.prec=0);function(e){return function(){var r=n.charCodeAt(e)-48|0;return 0<=r&&r<=9}}(c)();)t.prec=(v(t.prec,10)+n.charCodeAt(c)|0)-48|0,c=c+1|0;a=c;continue;case 33:case 34:case 36:case 37:case 38:case 39:case 40:case 41:case 42:case 44:case 47:o=1;break;case 48:t.filter="0",a=i+1|0;continue;case 49:case 50:case 51:case 52:case 53:case 54:case 55:case 56:case 57:o=3;break;default:o=1}switch(o){case 1:a=i+1|0;continue;case 2:t.signstyle=String.fromCharCode(u),a=i+1|0;continue;case 3:t.width=0;for(var s=i;function(e){return function(){var r=n.charCodeAt(e)-48|0;return 0<=r&&r<=9}}(s)();)t.width=(v(t.width,10)+n.charCodeAt(s)|0)-48|0,s=s+1|0;a=s;continue;case 4:t.signedconv=!0,t.base=2,a=i+1|0;continue;case 5:t.signedconv=!0,t.conv=String.fromCharCode(u),a=i+1|0;continue}}}function K(r,e){var n=r.justify,t=r.signstyle,a=r.filter,i=r.alternate,u=r.base,o=r.signedconv,c=r.width,s=r.uppercase,f=r.sign,l=e.length;o&&(f<0||"-"!==t)&&(l=l+1|0),i&&(0===u?l=l+1|0:1===u&&(l=l+2|0));var v="";if("+"===n&&" "===a)for(var d=l;d<c;++d)v+=a;if(o&&(f<0?v+="-":"-"!==t&&(v+=t)),i&&0===u&&(v+="0"),i&&1===u&&(v+="0x"),"+"===n&&"0"===a)for(var h=l;h<c;++h)v+=a;if(v=s?v+e.toUpperCase():v+e,"-"===n)for(var p=l;p<c;++p)v+=" ";return v}function G(r,e){if("%d"===r)return String(e);var n,t=X(r),a=(e<0?t.signedconv?(t.sign=-1,-e):e>>>0:e).toString(function(r){switch(r){case 0:return 8;case 1:return 16;case 2:return 10}}(t.base));return 0<=t.prec&&(t.filter=" ",0<(n=t.prec-a.length|0)&&(a="0".repeat(n)+a)),K(t,a)}function n(r,e){if("%d"===r)return Q(e);var n,t,a,i=X(r),u=i.signedconv&&U(e,A)?(i.sign=-1,q(e)):e;switch(i.base){case 0:n=function(r){var e="",n=S(8,0),t="01234567";if(U(r,A)){var a=Z(H(r),n),i=R(S(0,268435456),a[0]);for(e=t[j(a[1])]+e;B(i,A);)var u=Z(i,n),i=u[0],e=t[j(u[1])]+e}else{var o=Z(r,n),c=o[0];for(e=t[j(o[1])]+e;B(c,A);){var s=Z(c,n),c=s[0];e=t[j(s[1])]+e}}return e}(u);break;case 1:n=z(u);break;case 2:n=function(r){if(!U(r,A))return Q(r);var e=S(10,0),n=Z(H(r),e),t=Z(R(S(8,0),n[1]),e);return Q(R(R(S(-858993460,214748364),n[0]),t[0]))+"0123456789"[j(t[1])]}(u)}return a=0<=i.prec?(i.filter=" ",0<(t=i.prec-n.length|0)?"0".repeat(t)+n:n):n,K(i,a)}var Y=function(r,e,n){if(!isFinite(r))return isNaN(r)?"nan":0<r?"infinity":"-infinity";var t=(0!=r||1/r!=-1/0)&&0<=r?0:1;t&&(r=-r);var a=0;if(0!=r)if(r<1)for(;r<1&&-1022<a;)r*=2,a--;else for(;2<=r;)r/=2,a++;var i,u=a<0?"":"+",o="";if(t)o="-";else switch(n){case 43:o="+";break;case 32:o=" "}0<=e&&e<13&&(i=Math.pow(2,4*e),r=Math.round(r*i)/i);var c,s,f=r.toString(16);return 0<=e&&((c=f.indexOf("."))<0?f+="."+"0".repeat(e):(s=c+1+e,f.length<s?f+="0".repeat(s-f.length):f=f.substr(0,s))),o+"0x"+f+"p"+u+a.toString(10)},t=G,nr=G;function tr(r,e){if(e>=r.length||e<0)throw[T,"index out of bounds"];return r.charCodeAt(e)}var ar={contents:0};function ir(r){var e=[r,(ar.contents=ar.contents+1,ar.contents)];return e.tag=248,e}var ur=[];function or(r){if(void 0===r){var e=[ur,0];return e.tag=256,e}if(null===r||r[0]!==ur)return r;var n=r[1]+1|0,t=[ur,n];return t.tag=256,t}function cr(r){if(null===r||r[0]!==ur)return r;var e=r[1];return 0===e?void 0:[ur,e-1|0]}var sr=ir("Caml_js_exceptions.Error");function fr(r){return function(r){if(void 0!==r){if(248===r.tag)return 1;var e=r[0];return void 0!==e&&248===e.tag}}(r)?r:[sr,r]}function dr(r){if("number"==typeof r)return 0;switch(0|r.tag){case 0:return rr(0,[dr(r[0])]);case 1:return rr(1,[dr(r[0])]);case 2:return rr(2,[dr(r[0])]);case 3:return rr(3,[dr(r[0])]);case 4:return rr(4,[dr(r[0])]);case 5:return rr(5,[dr(r[0])]);case 6:return rr(6,[dr(r[0])]);case 7:return rr(7,[dr(r[0])]);case 8:return rr(8,[r[0],dr(r[1])]);case 9:var e=r[0];return rr(9,[e,e,dr(r[2])]);case 10:return rr(10,[dr(r[0])]);case 11:return rr(11,[dr(r[0])]);case 12:return rr(12,[dr(r[0])]);case 13:return rr(13,[dr(r[0])]);case 14:return rr(14,[dr(r[0])])}}function hr(r,e){if("number"==typeof r)return e;switch(0|r.tag){case 0:return rr(0,[hr(r[0],e)]);case 1:return rr(1,[hr(r[0],e)]);case 2:return rr(2,[hr(r[0],e)]);case 3:return rr(3,[hr(r[0],e)]);case 4:return rr(4,[hr(r[0],e)]);case 5:return rr(5,[hr(r[0],e)]);case 6:return rr(6,[hr(r[0],e)]);case 7:return rr(7,[hr(r[0],e)]);case 8:return rr(8,[r[0],hr(r[1],e)]);case 9:return rr(9,[r[0],r[1],hr(r[2],e)]);case 10:return rr(10,[hr(r[0],e)]);case 11:return rr(11,[hr(r[0],e)]);case 12:return rr(12,[hr(r[0],e)]);case 13:return rr(13,[hr(r[0],e)]);case 14:return rr(14,[hr(r[0],e)])}}ir("Pervasives.Exit");function pr(r){return 0<=r?r:0|-r}function mr(r){return r?"true":"false"}function gr(r){for(var e=0,n=r;;){if(!n)return e;n=n[1],e=e+1|0}}function br(r,e){for(;;){if(!r)return e;e=[r[0],e],r=r[1]}}function wr(r){return br(r,0)}function yr(r){return r?function r(e,n){return e?[e[0],r(e[1],n)]:n}(r[0],yr(r[1])):0}function _r(r,e){return e?[vr(r,e[0]),_r(r,e[1])]:0}function kr(r,e){for(;;){var n=e;if(!n)return;vr(r,n[0]),e=n[1]}}function Sr(r,e,n){for(;;){var t=n;if(!t)return e;n=t[1],e=L(r,e,t[0])}}function xr(r,e){if(r){if(e)return[[r[0],e[0]],xr(r[1],e[1])];throw[T,"List.combine"]}if(!e)return 0;throw[T,"List.combine"]}function Nr(r,e){for(;;){if(0===r)return e;if(!e)throw[M,["list.ml",262,11]];e=e[1],r=r-1|0}}var Ar=yr,Or=function(o){return function(r){for(var e=0,n=r;;){var t=n,a=e;if(!t)return br(a,0);var i=t[1],u=t[0];vr(o,u)?(n=i,e=[u,a]):n=i}}},qr=function(_,r){function k(r,e){if(2!==r){if(3===r&&e){var n=e[1];if(n){var t=n[1];if(t){var a=t[0],i=n[0],u=e[0];return L(_,u,i)<=0?L(_,i,a)<=0?[u,[i,[a,0]]]:L(_,u,a)<=0?[u,[a,[i,0]]]:[a,[u,[i,0]]]:L(_,u,a)<=0?[i,[u,[a,0]]]:L(_,i,a)<=0?[i,[a,[u,0]]]:[a,[i,[u,0]]]}}}}else if(e){var o=e[1];if(o){var c=o[0],s=e[0];return L(_,s,c)<=0?[s,[c,0]]:[c,[s,0]]}}for(var f=r>>1,l=r-f|0,v=Nr(f,e),d=S(f,e),h=S(l,v),p=0;;){var m=p,g=h,b=d;if(!b)return br(g,m);if(!g)return br(b,m);var w=g[0],y=b[0];0<L(_,y,w)?(p=[y,m],d=b[1]):(p=[w,m],h=g[1])}}var S=function(r,e){if(2!==r){if(3===r&&e){var n=e[1];if(n){var t=n[1];if(t){var a=t[0],i=n[0],u=e[0];return 0<L(_,u,i)?0<L(_,i,a)?[u,[i,[a,0]]]:0<L(_,u,a)?[u,[a,[i,0]]]:[a,[u,[i,0]]]:0<L(_,u,a)?[i,[u,[a,0]]]:0<L(_,i,a)?[i,[a,[u,0]]]:[a,[i,[u,0]]]}}}}else if(e){var o=e[1];if(o){var c=o[0],s=e[0];return 0<L(_,s,c)?[s,[c,0]]:[c,[s,0]]}}for(var f=r>>1,l=r-f|0,v=Nr(f,e),d=k(f,e),h=k(l,v),p=0;;){var m=p,g=h,b=d;if(!b)return br(g,m);if(!g)return br(b,m);var w=g[0],y=b[0];L(_,y,w)<=0?(p=[y,m],d=b[1]):(p=[w,m],h=g[1])}},e=gr(r);return e<2?r:k(e,r)};function Rr(r){return 97<=r&&r<=122?r-32|0:r}function Fr(r,e){var n=g(r);return function(r,e,n,t){if(!(n<=0))for(var a=e,i=n+e|0;a<i;++a)r[a]=t}(n,0,r,e),n}var Er=[];function Tr(r,e,n){if(e<0||n<0||e>(r.length-n|0))throw[T,"String.sub / Bytes.sub"];var t=g(n);return b(r,e,t,0,n),t}function Cr(r,e,n){return f(Tr(r,e,n))}function Mr(r,e,n,t,a){if(a<0||e<0||e>(r.length-a|0)||t<0||t>(n.length-a|0))throw[T,"Bytes.blit"];return b(r,e,n,t,a),0}function Lr(r,e,n,t,a){if(a<0||e<0||e>(r.length-a|0)||t<0||t>(n.length-a|0))throw[T,"String.blit / Bytes.blit_string"];return c(r,e,n,t,a)}function Ir(r){var e=r-9|0;return 4<e||e<0?23==e:2!=e}function Pr(r){for(var e,n,t,a=0,i=0,u=r.length;i<u;++i)var o,c=r[i],a=a+(32<=c?58<(o=c-34|0)||o<0?93<=o?4:1:57<o||o<1?2:1:11<=c?13!==c?4:2:8<=c?2:4)|0;if(a===r.length)return n=(e=r).length,t=g(n),b(e,0,t,0,n),t;for(var s=g(a),f=a=0,l=r.length;f<l;++f){var v=r[f],d=0;if(35<=v)92!==v?127<=v?d=1:s[a]=v:d=2;else if(32<=v)34<=v?d=2:s[a]=v;else if(14<=v)d=1;else switch(v){case 8:s[a]=92,s[a=a+1|0]=98;break;case 9:s[a]=92,s[a=a+1|0]=116;break;case 10:s[a]=92,s[a=a+1|0]=110;break;case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:case 11:case 12:d=1;break;case 13:s[a]=92,s[a=a+1|0]=114}switch(d){case 1:s[a]=92,s[a=a+1|0]=48+(v/100|0)|0,s[a=a+1|0]=48+(v/10|0)%10|0,s[a=a+1|0]=48+v%10|0;break;case 2:s[a]=92,s[a=a+1|0]=v}a=a+1|0}return s}function Dr(r){return function(r,e){var n=e.length;if(0===n)return e;for(var t=g(n),a=0;a<n;++a)t[a]=vr(r,e[a]);return t}(Rr,r)}function $r(r,e){return f(Fr(r,e))}function Br(r,e,n){for(;;){if(!n)return r;var t=n[1],a=n[0];if(!t)return a.length+r|0;n=t,r=function(r,e){if(e<=r)return r;throw[T,"String.concat"]}((a.length+e|0)+r|0,r)}}function Ur(r,e){if(!e)return"";var n=r.length;return f(function(r,e,n,t,a){for(;;){var i=e;if(!a)return r;var u=a[1],o=a[0];if(!u)return c(o,0,r,i,o.length),r;c(o,0,r,i,o.length),c(n,0,r,i+o.length|0,t),a=u,e=(i+o.length|0)+t|0}}(g(Br(0,n,e)),0,r,n,e))}function Vr(r){var e=r-9|0;return 4<e||e<0?23==e:2!=e}function Jr(r){return""===r||!Vr(r.charCodeAt(0))&&!Vr(r.charCodeAt(r.length-1|0))?r:f(function(r){for(var e=r.length,n=0;n<e&&Ir(r[n]);)n=n+1|0;for(var t=e-1|0;n<=t&&Ir(r[t]);)t=t-1|0;return n<=t?Tr(r,n,1+(t-n|0)|0):Er}(l(r)))}var Qr=h,Wr=Lr;function Zr(r,e,n,t){var a,i,u=void 0!==e&&e,o=r.style;return void 0!==o.setProperty?o.setProperty(n,t,u?"important":null):(a=n,i=t,void(r.style[a]=i))}function jr(r,e,n){return r.insertBefore(e,n)}function zr(r,e,n,t){return""===e?r.setAttribute(n,t):r.setAttributeNS(e,n,t)}function Hr(r,e){return""===r?document.createElement(e):document.createElementNS(r,e)}var Xr=rr(0,[""]);function Kr(r,e,n,t,a,i){return rr(2,[r,e,n,t,a,i])}function Gr(r,e,n){return rr(3,[r,rr(0,[e,n]),{contents:void 0}])}function Yr(r){for(;;){var e=r;switch(0|e.tag){case 0:return"\x3c!-- "+e[0]+" --\x3e";case 1:return e[0];case 2:var n=e[1],t=e[0];return Ur("",["<",[t,[""===t?"":":",[n,[Ur("",_r(function(r){if("number"==typeof r)return"";switch(0|r.tag){case 0:return Ur("",[" ",[r[0],['="',[r[1],['"',0]]]]]);case 1:return Ur("",[" ",[r[1],['="',[r[2],['"',0]]]]]);case 2:return Ur("",[" data-",[r[0],['="',[r[1],['"',0]]]]]);case 3:return"";case 4:return Ur("",[' style="',[Ur(";",_r(function(r){return Ur("",[r[0],[":",[r[1],[";",0]]]])},r[0])),['"',0]]])}},e[4])),[">",[Ur("",_r(Yr,e[5])),["</",[n,[">",0]]]]]]]]]]);case 3:r=vr(e[1],void 0);continue;case 4:r=e[1];continue}}}function re(r){if(!r.tag)return r[1];var e=r[0];return function(r){return or(e)}}function ee(r,e,n,t){var a,i,u,o,c,s={contents:re(t)},f=(a=r,i=s,function(r){var e=vr(i.contents,r);if(void 0!==e)return vr(a.contents.enqueue,cr(e))});return u=n,o=f,c=!1,e.addEventListener(u,o,c),{handler:f,cb:s}}function ne(r,e,n){if(void 0!==n)return t=r,a=e,i=n.handler,u=!1,void t.removeEventListener(a,i,u);var t,a,i,u}function te(r,e,n,t,a,i,u,o){var c,s,f=u.contents;if(void 0!==f)if(n!==t){u.contents=ne(e,n,u.contents),o.contents=ee(r,e,t,i)}else{if(o.contents=u.contents,c=a,(s=i).tag?c.tag&&m(s[0],c[0]):!c.tag&&s[0]===c[0])return;var l=re(i);f.cb.contents=l}else o.contents=ee(r,e,t,i)}function ae(r,e,n,t,a){!function(n,r){var e,t,a;if("number"!=typeof r)switch(0|r.tag){case 0:return n[r[0]]=void 0;case 1:return e=n,t=r[0],a=r[1],""===t?e.removeAttribute(a):e.removeAttributeNS(t,a);case 2:throw console.log(["TODO:  Remove Data Unhandled",r[0],r[1]]),[w,"TODO:  Remove Data Unhandled"];case 3:var i=r[2];return i.contents=ne(n,r[0],i.contents);case 4:Sr(function(r,e){return Zr(n,void 0,e[0],null)},void 0,r[0])}}(e,t),function(r,n,e){if("number"!=typeof e)switch(0|e.tag){case 0:return n[e[0]]=e[1];case 1:return zr(n,e[0],e[1],e[2]);case 2:throw console.log(["TODO:  Add Data Unhandled",e[0],e[1]]),[w,"TODO:  Add Data Unhandled"];case 3:return e[2].contents=ee(r,n,e[0],e[1]);case 4:Sr(function(r,e){return Zr(n,void 0,e[0],e[1])},void 0,e[0])}}(r,e,a)}function ie(r,u,e,n,t){if("number"==typeof t)throw[w,"This should never be called as all entries through NoProp are gated."];switch(0|t.tag){case 0:return void(u[t[0]]=t[1]);case 1:return zr(u,t[0],t[1],t[2]);case 2:throw console.log(["TODO:  Mutate Data Unhandled",t[0],t[1]]),[w,"TODO:  Mutate Data Unhandled"];case 3:throw[w,"This will never be called because it is gated"];case 4:if("number"==typeof n)throw[w,"Passed a non-Style to a new Style as a Mutations while the old Style is not actually a style!"];if(4===n.tag)return function(r,e,n,t){for(;;){var a=t,i=n,u=e;if(i){if(a){t=a[1],n=i[1],e=I(r,u,i[0],a[0]);continue}throw[T,"List.fold_left2"]}if(a)throw[T,"List.fold_left2"];return u}}(function(r,e,n){var t=n[1],a=n[0],i=e[0];return i===a?e[1]===t?void 0:Zr(u,void 0,a,t):(Zr(u,void 0,i,null),Zr(u,void 0,a,t))},void 0,n[0],t[0]);throw[w,"Passed a non-Style to a new Style as a Mutations while the old Style is not actually a style!"]}}function ue(r,e,n,t){return function(r,e,n,t){for(;;){var a=t,i=n;if(!i)return!a;var u=i[0];if(!a)return!1;if("number"==typeof u){if("number"==typeof a[0]){t=a[1],n=i[1],0;continue}}else switch(0|u.tag){case 0:var o=a[0];if("number"==typeof o||o.tag)break;u[0]===o[0]&&u[1]===o[1]||ie(0,e,0,u,o),t=a[1],n=i[1],0;continue;case 1:var c=a[0];if("number"==typeof c||1!==c.tag)break;u[0]===c[0]&&u[1]===c[1]&&u[2]===c[2]||ie(0,e,0,u,c),t=a[1],n=i[1],0;continue;case 2:var s=a[0];if("number"==typeof s||2!==s.tag)break;u[0]===s[0]&&u[1]===s[1]||ie(0,e,0,u,s),t=a[1],n=i[1],0;continue;case 3:var f=a[0];if("number"==typeof f||3!==f.tag)break;te(r,e,u[0],f[0],u[1],f[1],u[2],f[2]),t=a[1],n=i[1],0;continue;case 4:var l=a[0];if("number"==typeof l||4!==l.tag)break;m(u[0],l[0])||ie(0,e,0,u,l),t=a[1],n=i[1],0;continue}ae(r,e,0,u,a[0]),t=a[1],n=i[1],0}}(r,e,n,t)}function oe(r,e,n,t,a){if(2!==a.tag)throw[w,"Node replacement should never be passed anything but a node itself"];var i=a[4],u=lr(n,t),o=Hr(a[0],a[1]);if(ue(r,o,_r(function(r){return 0},i),i))return fe(r,o,o.childNodes,0,0,a[5]),jr(e,o,u),void e.removeChild(u);throw[s,["vdom.ml",319,30]]}function ce(r,e){for(;;){var n=e,t=r;switch(0|n.tag){case 0:var a=n[0];return document.createComment(a);case 1:var i=n[0];return document.createTextNode(i);case 2:var u=n[4],o=Hr(n[0],n[1]);if(ue(t,o,_r(function(r){return 0},u),u))return fe(t,o,o.childNodes,0,0,n[5]),o;throw[s,["vdom.ml",333,30]];case 3:var c=vr(n[1],void 0);e=n[2].contents=c;continue;case 4:e=n[1],r=vr(n[0],t);continue}}}function se(r,e,n,t,a,i){if(2!==a.tag)throw[w,"Non-node passed to patchVNodesOnElems_MutateNode"];if(2!==i.tag)throw[w,"Non-node passed to patchVNodesOnElems_MutateNode"];if(a[3]!==i[3]||a[1]!==i[1])return oe(r,e,n,t,i),0;var u=lr(n,t),o=u.childNodes;return ue(r,u,a[4],i[4])||(console.log("VDom:  Failed swapping properties because the property list length changed, use `noProp` to swap properties instead, not by altering the list structure.  This is a massive inefficiency until this issue is resolved."),oe(r,e,n,t,i)),fe(r,u,o,0,a[5],i[5])}function fe(r,e,n,t,a,i){for(;;){var u=i,o=a,c=t;if(o){var s=o[0];switch(0|s.tag){case 0:if(u){var f=u[0];if(!f.tag&&s[0]===f[0]){i=u[1],a=o[1],t=c+1|0;continue}}break;case 1:if(u){var l=u[0];if(1===l.tag){var v=l[0];s[0]!==v&&(lr(n,c).nodeValue=v),i=u[1],a=o[1],t=c+1|0;continue}}break;case 2:if(u){var d=u[0];if(2===d.tag){var h=u[1],p=d[2],m=d[1],g=d[0],b=o[1],w=s[2],y=s[1],_=s[0];if(w===p&&""!==w){i=h,a=b,t=c+1|0;continue}if(""===w||""===p){se(r,e,n,c,s,d),i=h,a=b,t=c+1|0;continue}var k=0,S=0;if(b){var x=b[0];if(2===x.tag){var N=b[1],A=x[2],O=x[1],q=x[0],R=0;if(h){var F=h[0];if(2===F.tag){if(q===g&&O===m&&A===p&&_===F[0]&&y===F[1]&&w===F[2]){var E=lr(n,c),T=lr(n,c+1|0);e.removeChild(T),jr(e,T,E),i=h[1],a=N,t=c+2|0;continue}R=4}else R=4}else R=4;if(4===R){if(q===g&&O===m&&A===p){var C=lr(n,c);e.removeChild(C),i=h,a=N,t=c+1|0;continue}S=3}}else S=3}else S=3;if(3===S)if(h){var M=h[0];if(2===M.tag){if(_===M[0]&&y===M[1]&&w===M[2]){var L=lr(n,c);jr(e,ce(r,d),L),i=h,t=c+1|0;continue}k=2}else k=2}else k=2;if(2===k){se(r,e,n,c,s,d),i=h,a=b,t=c+1|0;continue}}}break;case 3:if(u){var I=u[0];if(3===I.tag){var P=u[1],D=I[2],$=I[1],B=I[0],U=o[1],V=s[2],J=s[0];if(J===B){D.contents=V.contents,i=P,a=U,t=c+1|0;continue}var Q=0,W=0;if(U){var Z=U[0];if(3===Z.tag){var j=U[1],z=Z[0],H=0;if(P){var X=P[0];if(3===X.tag){if(z===B&&J===X[0]){var K=lr(n,c),G=lr(n,c+1|0);e.removeChild(G),jr(e,G,K),i=P[1],a=j,t=c+2|0;continue}H=4}else H=4}else H=4;if(4===H){if(z===B){var Y=lr(n,c);e.removeChild(Y);var rr=Z[2].contents;D.contents=rr,i=P,a=j,t=c+1|0;continue}W=3}}else W=3}else W=3;if(3===W)if(P){var er=P[0];if(3===er.tag){if(er[0]===J){var nr=lr(n,c),tr=vr($,void 0);jr(e,ce(r,D.contents=tr),nr),i=P,t=c+1|0;continue}Q=2}else Q=2}else Q=2;if(2===Q){var ar=V.contents,ir=vr($,void 0);i=[D.contents=ir,P],a=[ar,U];continue}}}break;case 4:a=[s[1],o[1]];continue}var ur=o[1];if(u){var or=u[0];if(4===or.tag){fe(vr(or[0],r),e,n,c,[s,0],[or[1],0]),i=u[1],a=ur,t=c+1|0;continue}var cr=lr(n,c);jr(e,ce(r,or),cr),e.removeChild(cr),i=u[1],a=ur,t=c+1|0;continue}var sr=lr(n,c);e.removeChild(sr),i=0,a=ur}else{if(!u)return;var fr=ce(r,u[0]);e.appendChild(fr),i=u[1],t=c+1|(a=0)}}}function le(n,r){if("number"!=typeof r)switch(0|r.tag){case 1:return Sr(function(r,e){return le(n,e)},void 0,r[0]);case 0:case 2:return vr(r[0],n)}}function ve(i,u,r,e){var o=function(r,e){for(;;){var n=e,t=r;if("number"==typeof n)return;switch(0|n.tag){case 0:var a=n[0];return a?kr(function(e){return function(r){return o(e,r)}}(t),a):void 0;case 1:return void(n[2].contents=vr(n[1],t));case 2:var i=vr(n[0],t);e=n[1],r=i;continue}}},c=function(r,e){for(;;){var n=e,t=r;if("number"==typeof n)return;switch(0|n.tag){case 0:var a=n[0];return a?kr(function(e){return function(r){return c(e,r)}}(t),a):void 0;case 1:var i=n[2],u=i.contents;return void 0!==u?vr(u,i.contents=void 0):void 0;case 2:var o=vr(n[0],t);e=n[1],r=o;continue}}};if("number"==typeof r){if("number"==typeof e)return e}else switch(0|r.tag){case 0:if("number"==typeof e||e.tag)break;return function(r,e){for(;;){var n=e;if(r){var t=r[1],a=r[0];if(n){ve(i,u,a,n[0]),e=n[1],r=t;continue}c(i,a),e=0,r=t}else{if(!n)return;o(u,n[0]),e=n[1],r=0}}}(r[0],e[0]),e;case 1:if("number"!=typeof e&&1===e.tag&&r[0]===e[0])return e[2].contents=r[2].contents,e;break;case 2:if("number"==typeof e||2!==e.tag)break;return ve(vr(r[0],i),vr(e[0],u),r[1],e[1]),e}return c(i,r),o(u,e),e}function de(r,e){for(var n=r.length;(r.position+e|0)>n;)n<<=1;var t=g(n);Mr(r.buffer,0,t,0,r.position),r.buffer=t,r.length=n}function he(r,e){var n=e.length,t=r.position+n|0;t>r.length&&de(r,n),Lr(e,0,r.buffer,r.position,n),r.position=t}function pe(r,e){var n,t,a,i=r.bytes.length,u=r.ind+e|0;u<=i||(a=g((t=u)<(n=i<<1)?n:t),Mr(r.bytes,0,a,0,i),r.bytes=a)}function me(r,e){pe(r,1),r.bytes[r.ind]=e,r.ind=r.ind+1|0}function ge(r,e){var n=e.length;pe(r,n),Wr(e,0,r.bytes,r.ind,n),r.ind=r.ind+n|0}function be(r){return Cr(r.bytes,0,r.ind)}function we(r){if("number"==typeof r)return 0;switch(0|r.tag){case 0:return rr(0,[we(r[0])]);case 1:return rr(1,[we(r[0])]);case 2:return rr(2,[we(r[0])]);case 3:return rr(3,[we(r[0])]);case 4:return rr(4,[we(r[0])]);case 5:return rr(5,[we(r[0])]);case 6:return rr(6,[we(r[0])]);case 7:return rr(7,[we(r[0])]);case 8:return rr(8,[r[0],we(r[1])]);case 9:return rr(9,[r[1],r[0],we(r[2])]);case 10:return rr(10,[we(r[0])]);case 11:return rr(11,[we(r[0])]);case 12:return rr(12,[we(r[0])]);case 13:return rr(13,[we(r[0])]);case 14:return rr(14,[we(r[0])])}}function ye(r){if("number"==typeof r)return[function(r){return 0},function(r){return 0},function(r){return 0},function(r){return 0}];switch(0|r.tag){case 0:var e=ye(r[0]),n=e[1],t=e[0];return[function(r){return vr(t,0),0},function(r){return vr(n,0),0},e[2],e[3]];case 1:var a=ye(r[0]),i=a[1],u=a[0];return[function(r){return vr(u,0),0},function(r){return vr(i,0),0},a[2],a[3]];case 2:var o=ye(r[0]),c=o[1],s=o[0];return[function(r){return vr(s,0),0},function(r){return vr(c,0),0},o[2],o[3]];case 3:var f=ye(r[0]),l=f[1],v=f[0];return[function(r){return vr(v,0),0},function(r){return vr(l,0),0},f[2],f[3]];case 4:var d=ye(r[0]),h=d[1],p=d[0];return[function(r){return vr(p,0),0},function(r){return vr(h,0),0},d[2],d[3]];case 5:var m=ye(r[0]),g=m[1],b=m[0];return[function(r){return vr(b,0),0},function(r){return vr(g,0),0},m[2],m[3]];case 6:var w=ye(r[0]),y=w[1],_=w[0];return[function(r){return vr(_,0),0},function(r){return vr(y,0),0},w[2],w[3]];case 7:var k=ye(r[0]),S=k[1],x=k[0];return[function(r){return vr(x,0),0},function(r){return vr(S,0),0},k[2],k[3]];case 8:var N=ye(r[1]),A=N[1],O=N[0];return[function(r){return vr(O,0),0},function(r){return vr(A,0),0},N[2],N[3]];case 9:var q=ye(r[2]),R=q[3],F=q[2],E=q[1],T=q[0],C=ye(_e(we(r[0]),r[1])),M=C[3],L=C[2],I=C[1],P=C[0];return[function(r){return vr(T,0),vr(P,0),0},function(r){return vr(I,0),vr(E,0),0},function(r){return vr(F,0),vr(L,0),0},function(r){return vr(M,0),vr(R,0),0}];case 10:var D=ye(r[0]),$=D[1],B=D[0];return[function(r){return vr(B,0),0},function(r){return vr($,0),0},D[2],D[3]];case 11:var U=ye(r[0]),V=U[1],J=U[0];return[function(r){return vr(J,0),0},function(r){return vr(V,0),0},U[2],U[3]];case 12:var Q=ye(r[0]),W=Q[1],Z=Q[0];return[function(r){return vr(Z,0),0},function(r){return vr(W,0),0},Q[2],Q[3]];case 13:var j=ye(r[0]),z=j[3],H=j[2],X=j[1],K=j[0];return[function(r){return vr(K,0),0},function(r){return vr(X,0),0},function(r){return vr(H,0),0},function(r){return vr(z,0),0}];case 14:var G=ye(r[0]),Y=G[3],rr=G[2],er=G[1],nr=G[0];return[function(r){return vr(nr,0),0},function(r){return vr(er,0),0},function(r){return vr(rr,0),0},function(r){return vr(Y,0),0}]}}function _e(r,e){var n=0;if("number"==typeof r){if("number"==typeof e)return 0;switch(0|e.tag){case 8:n=6;break;case 9:n=7;break;case 10:n=1;break;case 11:n=2;break;case 12:n=3;break;case 13:n=4;break;case 14:n=5;break;default:throw[M,["camlinternalFormat.ml",846,23]]}}else switch(0|r.tag){case 0:if("number"==typeof e)n=8;else switch(0|e.tag){case 0:return rr(0,[_e(r[0],e[0])]);case 8:n=6;break;case 9:n=7;break;case 10:n=1;break;case 11:n=2;break;case 12:n=3;break;case 13:n=4;break;case 14:n=5}break;case 1:if("number"==typeof e)n=8;else switch(0|e.tag){case 1:return rr(1,[_e(r[0],e[0])]);case 8:n=6;break;case 9:n=7;break;case 10:n=1;break;case 11:n=2;break;case 12:n=3;break;case 13:n=4;break;case 14:n=5}break;case 2:if("number"==typeof e)n=8;else switch(0|e.tag){case 2:return rr(2,[_e(r[0],e[0])]);case 8:n=6;break;case 9:n=7;break;case 10:n=1;break;case 11:n=2;break;case 12:n=3;break;case 13:n=4;break;case 14:n=5}break;case 3:if("number"==typeof e)n=8;else switch(0|e.tag){case 3:return rr(3,[_e(r[0],e[0])]);case 8:n=6;break;case 9:n=7;break;case 10:n=1;break;case 11:n=2;break;case 12:n=3;break;case 13:n=4;break;case 14:n=5}break;case 4:if("number"==typeof e)n=8;else switch(0|e.tag){case 4:return rr(4,[_e(r[0],e[0])]);case 8:n=6;break;case 9:n=7;break;case 10:n=1;break;case 11:n=2;break;case 12:n=3;break;case 13:n=4;break;case 14:n=5}break;case 5:if("number"==typeof e)n=8;else switch(0|e.tag){case 5:return rr(5,[_e(r[0],e[0])]);case 8:n=6;break;case 9:n=7;break;case 10:n=1;break;case 11:n=2;break;case 12:n=3;break;case 13:n=4;break;case 14:n=5}break;case 6:if("number"==typeof e)n=8;else switch(0|e.tag){case 6:return rr(6,[_e(r[0],e[0])]);case 8:n=6;break;case 9:n=7;break;case 10:n=1;break;case 11:n=2;break;case 12:n=3;break;case 13:n=4;break;case 14:n=5}break;case 7:if("number"==typeof e)n=8;else switch(0|e.tag){case 7:return rr(7,[_e(r[0],e[0])]);case 8:n=6;break;case 9:n=7;break;case 10:n=1;break;case 11:n=2;break;case 12:n=3;break;case 13:n=4;break;case 14:n=5}break;case 8:if("number"==typeof e)throw[M,["camlinternalFormat.ml",832,26]];switch(0|e.tag){case 8:return rr(8,[_e(r[0],e[0]),_e(r[1],e[1])]);case 10:n=1;break;case 11:n=2;break;case 12:n=3;break;case 13:n=4;break;case 14:n=5;break;default:throw[M,["camlinternalFormat.ml",832,26]]}break;case 9:if("number"==typeof e)throw[M,["camlinternalFormat.ml",842,28]];switch(0|e.tag){case 8:n=6;break;case 9:var t=ye(_e(we(r[1]),e[0]));return vr(t[1],0),vr(t[3],0),rr(9,[r[0],e[1],_e(r[2],e[2])]);case 10:n=1;break;case 11:n=2;break;case 12:n=3;break;case 13:n=4;break;case 14:n=5;break;default:throw[M,["camlinternalFormat.ml",842,28]]}break;case 10:if("number"==typeof e)throw[M,["camlinternalFormat.ml",810,21]];if(10===e.tag)return rr(10,[_e(r[0],e[0])]);throw[M,["camlinternalFormat.ml",810,21]];case 11:if("number"==typeof e)throw[M,["camlinternalFormat.ml",814,21]];switch(0|e.tag){case 10:n=1;break;case 11:return rr(11,[_e(r[0],e[0])]);default:throw[M,["camlinternalFormat.ml",814,21]]}break;case 12:if("number"==typeof e)throw[M,["camlinternalFormat.ml",818,19]];switch(0|e.tag){case 10:n=1;break;case 11:n=2;break;case 12:return rr(12,[_e(r[0],e[0])]);default:throw[M,["camlinternalFormat.ml",818,19]]}break;case 13:if("number"==typeof e)throw[M,["camlinternalFormat.ml",822,22]];switch(0|e.tag){case 10:n=1;break;case 11:n=2;break;case 12:n=3;break;case 13:return rr(13,[_e(r[0],e[0])]);default:throw[M,["camlinternalFormat.ml",822,22]]}break;case 14:if("number"==typeof e)throw[M,["camlinternalFormat.ml",827,30]];switch(0|e.tag){case 10:n=1;break;case 11:n=2;break;case 12:n=3;break;case 13:n=4;break;case 14:return rr(14,[_e(r[0],e[0])]);default:throw[M,["camlinternalFormat.ml",827,30]]}}switch(n){case 1:throw[M,["camlinternalFormat.ml",811,21]];case 2:throw[M,["camlinternalFormat.ml",815,21]];case 3:throw[M,["camlinternalFormat.ml",819,19]];case 4:throw[M,["camlinternalFormat.ml",823,22]];case 5:throw[M,["camlinternalFormat.ml",828,30]];case 6:throw[M,["camlinternalFormat.ml",833,26]];case 7:throw[M,["camlinternalFormat.ml",843,28]];case 8:throw[M,["camlinternalFormat.ml",847,23]]}}var ke=ir("CamlinternalFormat.Type_mismatch");function Se(r,e){if("number"==typeof r)return[0,e];if(!r.tag)return[rr(0,[r[0],r[1]]),e];if("number"==typeof e)throw ke;if(2===e.tag)return[rr(1,[r[0]]),e[0]];throw ke}function xe(r,e,n){var t=Se(r,n);if("number"!=typeof e)return[t[0],[e[0]],t[1]];if(0===e)return[t[0],0,t[1]];var a=t[1];if("number"==typeof a)throw ke;if(2===a.tag)return[t[0],1,a[0]];throw ke}function Ne(r,e){if("number"==typeof r)return[0,e];switch(0|r.tag){case 0:if("number"==typeof e)throw ke;if(e.tag)throw ke;var n=Ne(r[0],e[0]);return[rr(0,[n[0]]),n[1]];case 1:if("number"==typeof e)throw ke;if(e.tag)throw ke;var t=Ne(r[0],e[0]);return[rr(1,[t[0]]),t[1]];case 2:var a=Se(r[0],e),i=a[1];if("number"==typeof i)throw ke;if(1!==i.tag)throw ke;var u=Ne(r[1],i[0]);return[rr(2,[a[0],u[0]]),u[1]];case 3:var o=Se(r[0],e),c=o[1];if("number"==typeof c)throw ke;if(1!==c.tag)throw ke;var s=Ne(r[1],c[0]);return[rr(3,[o[0],s[0]]),s[1]];case 4:var f=xe(r[1],r[2],e),l=f[2];if("number"==typeof l)throw ke;if(2!==l.tag)throw ke;var v=Ne(r[3],l[0]);return[rr(4,[r[0],f[0],f[1],v[0]]),v[1]];case 5:var d=xe(r[1],r[2],e),h=d[2];if("number"==typeof h)throw ke;if(3!==h.tag)throw ke;var p=Ne(r[3],h[0]);return[rr(5,[r[0],d[0],d[1],p[0]]),p[1]];case 6:var m=xe(r[1],r[2],e),g=m[2];if("number"==typeof g)throw ke;if(4!==g.tag)throw ke;var b=Ne(r[3],g[0]);return[rr(6,[r[0],m[0],m[1],b[0]]),b[1]];case 7:var w=xe(r[1],r[2],e),y=w[2];if("number"==typeof y)throw ke;if(5!==y.tag)throw ke;var _=Ne(r[3],y[0]);return[rr(7,[r[0],w[0],w[1],_[0]]),_[1]];case 8:var k=xe(r[1],r[2],e),S=k[2];if("number"==typeof S)throw ke;if(6!==S.tag)throw ke;var x=Ne(r[3],S[0]);return[rr(8,[r[0],k[0],k[1],x[0]]),x[1]];case 9:var N=Se(r[0],e),A=N[1];if("number"==typeof A)throw ke;if(7!==A.tag)throw ke;var O=Ne(r[1],A[0]);return[rr(9,[N[0],O[0]]),O[1]];case 10:var q=Ne(r[0],e);return[rr(10,[q[0]]),q[1]];case 11:var R=Ne(r[1],e);return[rr(11,[r[0],R[0]]),R[1]];case 12:var F=Ne(r[1],e);return[rr(12,[r[0],F[0]]),F[1]];case 13:if("number"==typeof e)throw ke;if(8!==e.tag)throw ke;var E=e[0];if(er([r[1]],[E]))throw ke;var T=Ne(r[2],e[1]);return[rr(13,[r[0],E,T[0]]),T[1]];case 14:if("number"==typeof e)throw ke;if(9!==e.tag)throw ke;var C=e[0];if(er([dr(r[1])],[dr(C)]))throw ke;var M=Ne(r[2],dr(e[2]));return[rr(14,[r[0],C,M[0]]),M[1]];case 15:if("number"==typeof e)throw ke;if(10!==e.tag)throw ke;var L=Ne(r[0],e[0]);return[rr(15,[L[0]]),L[1]];case 16:if("number"==typeof e)throw ke;if(11!==e.tag)throw ke;var I=Ne(r[0],e[0]);return[rr(16,[I[0]]),I[1]];case 17:var P=Ne(r[1],e);return[rr(17,[r[0],P[0]]),P[1]];case 18:var D=r[0],$=r[1];if(D.tag){var B=D[0],U=Ne(B[0],e),V=Ne($,U[1]);return[rr(18,[rr(1,[[U[0],B[1]]]),V[0]]),V[1]]}var J=D[0],Q=Ne(J[0],e),W=Ne($,Q[1]);return[rr(18,[rr(0,[[Q[0],J[1]]]),W[0]]),W[1]];case 19:if("number"==typeof e)throw ke;if(13!==e.tag)throw ke;var Z=Ne(r[0],e[0]);return[rr(19,[Z[0]]),Z[1]];case 20:if("number"==typeof e)throw ke;if(1!==e.tag)throw ke;var j=Ne(r[2],e[0]);return[rr(20,[r[0],r[1],j[0]]),j[1]];case 21:if("number"==typeof e)throw ke;if(2!==e.tag)throw ke;var z=Ne(r[1],e[0]);return[rr(21,[r[0],z[0]]),z[1]];case 23:var H=r[0],X=r[1];if("number"==typeof H){if(2!==H)return Ae(H,X,e);if("number"==typeof e)throw ke;if(14!==e.tag)throw ke;var K=Ne(X,e[0]);return[rr(23,[2,K[0]]),K[1]]}switch(0|H.tag){case 8:return Ae(rr(8,[H[0],H[1]]),X,e);case 9:var G=function r(e,n,t){if("number"==typeof e)return[0,Ne(n,t)];switch(0|e.tag){case 0:if("number"==typeof t)throw ke;if(t.tag)throw ke;var a=r(e[0],n,t[0]);return[rr(0,[a[0]]),a[1]];case 1:if("number"==typeof t)throw ke;if(1!==t.tag)throw ke;var i=r(e[0],n,t[0]);return[rr(1,[i[0]]),i[1]];case 2:if("number"==typeof t)throw ke;if(2!==t.tag)throw ke;var u=r(e[0],n,t[0]);return[rr(2,[u[0]]),u[1]];case 3:if("number"==typeof t)throw ke;if(3!==t.tag)throw ke;var o=r(e[0],n,t[0]);return[rr(3,[o[0]]),o[1]];case 4:if("number"==typeof t)throw ke;if(4!==t.tag)throw ke;var c=r(e[0],n,t[0]);return[rr(4,[c[0]]),c[1]];case 5:if("number"==typeof t)throw ke;if(5!==t.tag)throw ke;var s=r(e[0],n,t[0]);return[rr(5,[s[0]]),s[1]];case 6:if("number"==typeof t)throw ke;if(6!==t.tag)throw ke;var f=r(e[0],n,t[0]);return[rr(6,[f[0]]),f[1]];case 7:if("number"==typeof t)throw ke;if(7!==t.tag)throw ke;var l=r(e[0],n,t[0]);return[rr(7,[l[0]]),l[1]];case 8:if("number"==typeof t)throw ke;if(8!==t.tag)throw ke;var v=t[0];if(er([e[0]],[v]))throw ke;var d=r(e[1],n,t[1]);return[rr(8,[v,d[0]]),d[1]];case 9:if("number"==typeof t)throw ke;if(9!==t.tag)throw ke;var h=t[1],p=t[0];if(er([dr(e[0])],[dr(p)]))throw ke;if(er([dr(e[1])],[dr(h)]))throw ke;var m=ye(_e(we(p),h));vr(m[1],0),vr(m[3],0);var g=r(dr(e[2]),n,t[2]);return[rr(9,[p,h,we(g[0])]),g[1]];case 10:if("number"==typeof t)throw ke;if(10!==t.tag)throw ke;var b=r(e[0],n,t[0]);return[rr(10,[b[0]]),b[1]];case 11:if("number"==typeof t)throw ke;if(11!==t.tag)throw ke;var w=r(e[0],n,t[0]);return[rr(11,[w[0]]),w[1]];case 12:throw ke;case 13:if("number"==typeof t)throw ke;if(13!==t.tag)throw ke;var y=r(e[0],n,t[0]);return[rr(13,[y[0]]),y[1]];case 14:if("number"==typeof t)throw ke;if(14!==t.tag)throw ke;var _=r(e[0],n,t[0]);return[rr(14,[_[0]]),_[1]]}}(H[1],X,e),Y=G[1];return[rr(23,[rr(9,[H[0],G[0]]),Y[0]]),Y[1]];default:return Ae(H,X,e)}case 22:case 24:throw ke}}function Ae(r,e,n){var t=Ne(e,n);return[rr(23,[r,t[0]]),t[1]]}function Oe(r,e){return function(r,e){var n=Ne(r,e);if("number"==typeof n[1])return n[0];throw ke}(r,dr(we(e)))}function qe(r,e,n){var t=n.length,a=pr(e),i=e<0?0:r;if(a<=t)return n;var u=Fr(a,2===i?48:32);switch(i){case 0:Wr(n,0,u,0,t);break;case 1:Wr(n,0,u,a-t|0,t);break;case 2:0<t&&(43===tr(n,0)||45===tr(n,0)||32===tr(n,0))?(u[0]=tr(n,0),Wr(n,1,u,1+(a-t|0)|0,t-1|0)):1<t&&48===tr(n,0)&&(120===tr(n,1)||88===tr(n,1))?(u[1]=tr(n,1),Wr(n,2,u,2+(a-t|0)|0,t-2|0)):Wr(n,0,u,a-t|0,t)}return f(u)}function Re(r,e){var n=pr(r),t=e.length,a=tr(e,0),i=0;if(58<=a)if(71<=a){if(102<a||a<97)return e;i=2}else{if(a<65)return e;i=2}else if(32!==a){if(a<43)return e;switch(a-43|0){case 0:case 2:i=1;break;case 1:case 3:case 4:return e;case 5:if(t<(n+2|0)&&1<t&&(120===tr(e,1)||88===tr(e,1))){var u=Fr(n+2|0,48);return u[1]=tr(e,1),Wr(e,2,u,4+(n-t|0)|0,t-2|0),f(u)}i=2;break;case 6:case 7:case 8:case 9:case 10:case 11:case 12:case 13:case 14:i=2}}else i=1;switch(i){case 1:if((n+1|0)<=t)return e;var o=Fr(n+1|0,48);return o[0]=a,Wr(e,1,o,2+(n-t|0)|0,t-1|0),f(o);case 2:if(n<=t)return e;var c=Fr(n,48);return Wr(e,0,c,n-t|0,t),f(c)}}function Fe(r){var a,e=(a=r,function(r){for(;;){var e=r;if(e>=a.length)return;var n=a.charCodeAt(e);if(n<32)return 1;var t=n-34|0;if(58<t||t<0){if(93<=t)return 1;r=e+1|0}else{if(57<t||t<1)return 1;r=e+1|0}}}(0)?f(Pr(l(a))):a),n=e.length,t=Fr(n+2|0,34);return c(e,0,t,1,n),f(t)}function Ee(r,e){if(15===r)return"%.12g";var n=pr(e),t=function(r){switch(r){case 0:case 1:case 2:return 102;case 3:case 4:case 5:return 101;case 6:case 7:case 8:return 69;case 9:case 10:case 11:return 103;case 12:case 13:case 14:return 71;case 15:return 70;case 16:case 17:case 18:return 104;case 19:case 20:case 21:return 72}}(r),a={ind:0,bytes:g(16)};return me(a,37),function(r,e){switch(e){case 0:case 3:case 6:case 9:case 12:case 15:case 16:case 19:return;case 1:case 4:case 7:case 10:case 13:case 17:case 20:return me(r,43);case 2:case 5:case 8:case 11:case 14:case 18:case 21:me(r,32)}}(a,r),me(a,46),ge(a,String(n)),me(a,t),be(a)}function Te(r,e){return G(function(r){switch(r){case 0:return"%d";case 1:return"%+d";case 2:return"% d";case 3:return"%i";case 4:return"%+i";case 5:return"% i";case 6:return"%x";case 7:return"%#x";case 8:return"%X";case 9:return"%#X";case 10:return"%o";case 11:return"%#o";case 12:return"%u"}}(r),e)}function Ce(r,e){return nr(function(r){switch(r){case 0:return"%ld";case 1:return"%+ld";case 2:return"% ld";case 3:return"%li";case 4:return"%+li";case 5:return"% li";case 6:return"%lx";case 7:return"%#lx";case 8:return"%lX";case 9:return"%#lX";case 10:return"%lo";case 11:return"%#lo";case 12:return"%lu"}}(r),e)}function Me(r,e){return t(function(r){switch(r){case 0:return"%nd";case 1:return"%+nd";case 2:return"% nd";case 3:return"%ni";case 4:return"%+ni";case 5:return"% ni";case 6:return"%nx";case 7:return"%#nx";case 8:return"%nX";case 9:return"%#nX";case 10:return"%no";case 11:return"%#no";case 12:return"%nu"}}(r),e)}function Le(r,e){return n(function(r){switch(r){case 0:return"%Ld";case 1:return"%+Ld";case 2:return"% Ld";case 3:return"%Li";case 4:return"%+Li";case 5:return"% Li";case 6:return"%Lx";case 7:return"%#Lx";case 8:return"%LX";case 9:return"%#LX";case 10:return"%Lo";case 11:return"%#Lo";case 12:return"%Lu"}}(r),e)}function Ie(r,e,n){if(16<=r){var t;if(17<=r)switch(r-17|0){case 2:t=45;break;case 0:case 3:t=43;break;case 1:case 4:t=32}else t=45;var a=Y(n,e,t);return 19<=r?f(Dr(l(a))):a}var i=function(r,e){var n=X(r),t=n.prec<0?6:n.prec,a=e<0?(n.sign=-1,-e):e,i="";if(isNaN(a))i="nan",n.filter=" ";else if(isFinite(a)){switch(n.conv){case"e":var u=(i=a.toExponential(t)).length;"e"===i[u-3|0]&&(i=i.slice(0,u-1|0)+("0"+i.slice(u-1|0)));break;case"f":i=a.toFixed(t);break;case"g":var o=0!==t?t:1,c=(i=a.toExponential(o-1|0)).indexOf("e"),s=0|Number(i.slice(c+1|0));if(s<-4||1e21<=a||a.toFixed().length>o){for(var f=c-1|0;"0"===i[f];)f=f-1|0;"."===i[f]&&(f=f-1|0);var l=(i=i.slice(0,f+1|0)+i.slice(c)).length;"e"===i[l-3|0]&&(i=i.slice(0,l-1|0)+("0"+i.slice(l-1|0)))}else{var v=o;if(s<0)v=v-(1+s|0)|0,i=a.toFixed(v);else for(;(i=a.toFixed(v)).length>(o+1|0);)v=v-1|0;if(0!==v){for(var d=i.length-1|0;"0"===i[d];)d=d-1|0;"."===i[d]&&(d=d-1|0),i=i.slice(0,d+1|0)}}}}else i="inf",n.filter=" ";return K(n,i)}(Ee(r,e),n);if(15!==r)return i;var u,o=i.length,c=(u=n,isFinite(u)?22250738585072014e-324<=Math.abs(u)?0:0!==u?1:2:isNaN(u)?4:3);return 3!=c?4<=c?"nan":function(r){for(;;){var e=r;if(e===o)return!1;var n=tr(i,e)-46|0;if(23<n||n<0){if(55==n)return!0;r=e+1|0}else{if(22<n||n<1)return!0;r=e+1|0}}}(0)?i:i+".":n<0?"neg_infinity":"infinity"}function Pe(r){var e=function(r){var e=0;if(40<=r){if(92===r)return"\\\\";e=127<=r?1:2}else if(32<=r){if(39<=r)return"\\'";e=2}else if(14<=r)e=1;else switch(r){case 8:return"\\b";case 9:return"\\t";case 10:return"\\n";case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:case 11:case 12:e=1;break;case 13:return"\\r"}switch(e){case 1:var n=[0,0,0,0];return n[0]=92,n[1]=48+(r/100|0)|0,n[2]=48+(r/10|0)%10|0,n[3]=48+r%10|0,f(n);case 2:var t=[0];return t[0]=r,f(t)}}(r),n=e.length,t=Fr(n+2|0,39);return c(e,0,t,1,n),f(t)}function De(r){var e={ind:0,bytes:g(16)};return function r(e,n){for(;;){var t=n;if("number"==typeof t)return;switch(0|t.tag){case 0:ge(e,"%c"),n=t[0];continue;case 1:ge(e,"%s"),n=t[0];continue;case 2:ge(e,"%i"),n=t[0];continue;case 3:ge(e,"%li"),n=t[0];continue;case 4:ge(e,"%ni"),n=t[0];continue;case 5:ge(e,"%Li"),n=t[0];continue;case 6:ge(e,"%f"),n=t[0];continue;case 7:ge(e,"%B"),n=t[0];continue;case 8:ge(e,"%{"),r(e,t[0]),ge(e,"%}"),n=t[1];continue;case 9:ge(e,"%("),r(e,t[0]),ge(e,"%)"),n=t[2];continue;case 10:ge(e,"%a"),n=t[0];continue;case 11:ge(e,"%t"),n=t[0];continue;case 12:ge(e,"%?"),n=t[0];continue;case 13:ge(e,"%r"),n=t[0];continue;case 14:ge(e,"%_r"),n=t[0];continue}}}(e,r),be(e)}function $e(r,s,e,n){for(;;){var t=n,a=e,i=r;if("number"==typeof t)return L(i,s,a);switch(0|t.tag){case 0:return function(n,t,a){return function(r){var e=rr(5,[t,r]);return $e(n,s,e,a)}}(i,a,t[0]);case 1:return function(t,a,i){return function(r){var e=Pe(r),n=rr(4,[a,e]);return $e(t,s,n,i)}}(i,a,t[0]);case 2:return Ue(i,s,a,t[1],t[0],function(r){return r});case 3:return Ue(i,s,a,t[1],t[0],Fe);case 4:return Ve(i,s,a,t[3],t[1],t[2],Te,t[0]);case 5:return Ve(i,s,a,t[3],t[1],t[2],Ce,t[0]);case 6:return Ve(i,s,a,t[3],t[1],t[2],Me,t[0]);case 7:return Ve(i,s,a,t[3],t[1],t[2],Le,t[0]);case 8:var u=t[3],o=t[1],c=t[2],f=t[0];if("number"==typeof o)return"number"==typeof c?(0!==c?function(t,a,i,u){return function(r,e){var n=Ie(u,r,e);return $e(t,s,rr(4,[a,n]),i)}}:function(n,t,a,i){return function(r){var e=Ie(i,-6,r);return $e(n,s,rr(4,[t,e]),a)}})(i,a,u,f):function(n,t,a,i,u){return function(r){var e=Ie(i,u,r);return $e(n,s,rr(4,[t,e]),a)}}(i,a,u,f,c[0]);if(o.tag){var l=o[0];return"number"==typeof c?(0!==c?function(a,i,u,o,c){return function(r,e,n){var t=qe(c,r,Ie(o,e,n));return $e(a,s,rr(4,[i,t]),u)}}:function(a,i,u,o,c){return function(r,e){var n=Ie(o,-6,e),t=qe(c,r,n);return $e(a,s,rr(4,[i,t]),u)}})(i,a,u,f,l):function(t,a,i,u,o,c){return function(r,e){var n=qe(o,r,Ie(u,c,e));return $e(t,s,rr(4,[a,n]),i)}}(i,a,u,f,l,c[0])}var v=o[1],d=o[0];return"number"==typeof c?(0!==c?function(t,a,i,u,o,c){return function(r,e){var n=qe(o,c,Ie(u,r,e));return $e(t,s,rr(4,[a,n]),i)}}:function(t,a,i,u,o,c){return function(r){var e=Ie(u,-6,r),n=qe(o,c,e);return $e(t,s,rr(4,[a,n]),i)}})(i,a,u,f,d,v):function(n,t,a,i,u,o,c){return function(r){var e=qe(u,o,Ie(i,c,r));return $e(n,s,rr(4,[t,e]),a)}}(i,a,u,f,d,v,c[0]);case 9:return Ue(i,s,a,t[1],t[0],mr);case 10:n=t[0],e=rr(7,[a]);continue;case 11:n=t[1],e=rr(2,[a,t[0]]);continue;case 12:n=t[1],e=rr(3,[a,t[0]]);continue;case 13:return function(e,n,t,a){return function(r){return $e(e,s,rr(4,[n,a]),t)}}(i,a,t[2],De(t[1]));case 14:var h=t[2];return function(e,n,t,a){return function(r){return $e(e,s,n,function r(e,n){if("number"==typeof e)return n;switch(0|e.tag){case 0:return rr(0,[r(e[0],n)]);case 1:return rr(1,[r(e[0],n)]);case 2:return rr(2,[e[0],r(e[1],n)]);case 3:return rr(3,[e[0],r(e[1],n)]);case 4:return rr(4,[e[0],e[1],e[2],r(e[3],n)]);case 5:return rr(5,[e[0],e[1],e[2],r(e[3],n)]);case 6:return rr(6,[e[0],e[1],e[2],r(e[3],n)]);case 7:return rr(7,[e[0],e[1],e[2],r(e[3],n)]);case 8:return rr(8,[e[0],e[1],e[2],r(e[3],n)]);case 9:return rr(9,[e[0],r(e[1],n)]);case 10:return rr(10,[r(e[0],n)]);case 11:return rr(11,[e[0],r(e[1],n)]);case 12:return rr(12,[e[0],r(e[1],n)]);case 13:return rr(13,[e[0],e[1],r(e[2],n)]);case 14:return rr(14,[e[0],e[1],r(e[2],n)]);case 15:return rr(15,[r(e[0],n)]);case 16:return rr(16,[r(e[0],n)]);case 17:return rr(17,[e[0],r(e[1],n)]);case 18:return rr(18,[e[0],r(e[1],n)]);case 19:return rr(19,[r(e[0],n)]);case 20:return rr(20,[e[0],e[1],r(e[2],n)]);case 21:return rr(21,[e[0],r(e[1],n)]);case 22:return rr(22,[r(e[0],n)]);case 23:return rr(23,[e[0],r(e[1],n)]);case 24:return rr(24,[e[0],e[1],r(e[2],n)])}}(Oe(r[0],t),a))}}(i,a,t[1],h);case 15:return function(r,t,a){return function(e,n){return $e(r,s,rr(6,[t,function(r){return L(e,r,n)}]),a)}}(i,a,t[0]);case 16:return function(e,n,t){return function(r){return $e(e,s,rr(6,[n,r]),t)}}(i,a,t[0]);case 17:n=t[1],e=rr(0,[a,t[0]]);continue;case 18:var p=t[0];if(p.tag){var m=function(n,t,a){return function(r,e){return $e(n,r,rr(1,[t,rr(1,[e])]),a)}}(i,a,t[1]);n=p[0][0],e=0,r=m;continue}var g=function(n,t,a){return function(r,e){return $e(n,r,rr(1,[t,rr(0,[e])]),a)}}(i,a,t[1]);n=p[0][0],e=0,r=g;continue;case 19:throw[M,["camlinternalFormat.ml",1525,4]];case 20:return function(e,n,t){return function(r){return $e(e,s,t,n)}}(i,t[2],rr(8,[a,"Printf: bad conversion %["]));case 21:return function(t,a,i){return function(r){var e=G("%u",r),n=rr(4,[a,e]);return $e(t,s,n,i)}}(i,a,t[1]);case 22:return function(n,t,a){return function(r){var e=rr(5,[t,r]);return $e(n,s,e,a)}}(i,a,t[0]);case 23:return function(r,e,n,t,a){if("number"!=typeof t)return 9===t.tag?function n(t,a,i,r,u){if("number"==typeof r)return Be(t,a,i,u);switch(0|r.tag){case 0:var e=r[0];return function(r){return n(t,a,i,e,u)};case 1:var o=r[0];return function(r){return n(t,a,i,o,u)};case 2:var c=r[0];return function(r){return n(t,a,i,c,u)};case 3:var s=r[0];return function(r){return n(t,a,i,s,u)};case 4:var f=r[0];return function(r){return n(t,a,i,f,u)};case 5:var l=r[0];return function(r){return n(t,a,i,l,u)};case 6:var v=r[0];return function(r){return n(t,a,i,v,u)};case 7:var d=r[0];return function(r){return n(t,a,i,d,u)};case 8:var h=r[1];return function(r){return n(t,a,i,h,u)};case 9:var p=r[2],m=_e(we(r[0]),r[1]);return function(r){return n(t,a,i,hr(m,p),u)};case 10:var g=r[0];return function(r,e){return n(t,a,i,g,u)};case 11:var b=r[0];return function(r){return n(t,a,i,b,u)};case 12:var w=r[0];return function(r){return n(t,a,i,w,u)};case 13:throw[M,["camlinternalFormat.ml",1616,31]];case 14:throw[M,["camlinternalFormat.ml",1617,31]]}}(r,e,n,t[1],a):Be(r,e,n,a);if(2===t)throw[M,["camlinternalFormat.ml",1593,39]];return Be(r,e,n,a)}(i,s,a,t[0],t[1]);case 24:return function e(n,t,a,i,r,u){if(!r)return $e(n,t,rr(4,[a,u]),i);var o=r[0];return function(r){return e(n,t,a,i,o,vr(u,r))}}(i,s,a,t[2],t[0],vr(t[1],void 0))}}}function Be(r,e,n,t){return $e(r,e,rr(8,[n,"Printf: bad conversion %_"]),t)}function Ue(a,i,u,o,r,c){if("number"==typeof r)return function(r){var e=vr(c,r),n=rr(4,[u,e]);return $e(a,i,n,o)};if(r.tag){var s=r[0];return function(r,e){var n=qe(s,r,vr(c,e)),t=rr(4,[u,n]);return $e(a,i,t,o)}}var t=r[1],f=r[0];return function(r){var e=qe(f,t,vr(c,r)),n=rr(4,[u,e]);return $e(a,i,n,o)}}function Ve(a,i,u,o,r,e,c,s){if("number"==typeof r){if("number"==typeof e)return 0!==e?function(r,e){var n=Re(r,L(c,s,e));return $e(a,i,rr(4,[u,n]),o)}:function(r){var e=L(c,s,r);return $e(a,i,rr(4,[u,e]),o)};var n=e[0];return function(r){var e=Re(n,L(c,s,r));return $e(a,i,rr(4,[u,e]),o)}}if(r.tag){var f=r[0];if("number"==typeof e)return 0!==e?function(r,e,n){var t=qe(f,r,Re(e,L(c,s,n)));return $e(a,i,rr(4,[u,t]),o)}:function(r,e){var n=qe(f,r,L(c,s,e));return $e(a,i,rr(4,[u,n]),o)};var t=e[0];return function(r,e){var n=qe(f,r,Re(t,L(c,s,e)));return $e(a,i,rr(4,[u,n]),o)}}var l=r[1],v=r[0];if("number"==typeof e)return 0!==e?function(r,e){var n=qe(v,l,Re(r,L(c,s,e)));return $e(a,i,rr(4,[u,n]),o)}:function(r){var e=qe(v,l,L(c,s,r));return $e(a,i,rr(4,[u,e]),o)};var d=e[0];return function(r){var e=qe(v,l,Re(d,L(c,s,r)));return $e(a,i,rr(4,[u,e]),o)}}function Je(r,e){for(;;){var n=e,t=0;if("number"==typeof n)return;switch(0|n.tag){case 0:var a=function(r){if("number"==typeof r)switch(r){case 0:return"@]";case 1:return"@}";case 2:return"@?";case 3:return"@\n";case 4:return"@.";case 5:return"@@";case 6:return"@%"}else switch(0|r.tag){case 0:case 1:return r[0];case 2:return"@"+f(Fr(1,r[0]))}}(n[1]);return Je(r,n[0]),he(r,a),0;case 1:var i=n[1],u=n[0];if(i.tag){Je(r,u),he(r,"@["),e=i[0];continue}Je(r,u),he(r,"@{"),e=i[0];continue;case 2:case 4:t=1;break;case 3:case 5:t=2;break;case 6:return Je(r,n[0]),he(r,vr(n[1],void 0)),0;case 7:e=n[0];continue;case 8:throw Je(r,n[0]),[T,n[1]]}switch(t){case 1:return Je(r,n[0]),he(r,n[1]),0;case 2:return Je(r,n[0]),o=r,c=n[1],s=void 0,(s=o.position)>=o.length&&de(o,1),o.buffer[s]=c,o.position=s+1|0,0}}var o,c,s}function Qe(o,r){return $e(function(r,e){var n,t,a,i,u={buffer:a=g(t=(n=64)<1?1:n),position:0,length:t,initial_buffer:a};return Je(u,e),vr(o,Cr((i=u).buffer,0,i.position))},void 0,0,r[0])}function We(r){return Qe(function(r){return r},r)}function Ze(r,e){return n=r.location,t=e.location,n.line===t.line?a(t.column,n.column):a(t.line,n.line);var n,t}function je(r){return I(We([rr(11,["At ",rr(2,[0,rr(11,["; Expecting ",rr(2,[0,rr(11,[" but actual ",rr(2,[0,0])])])])])]),"At %s; Expecting %s but actual %s"]),(e=r.location,L(We([rr(11,["Ln ",rr(4,[0,0,0,rr(11,[", Col ",rr(4,[0,0,0,0])])])]),"Ln %d, Col %d"]),e.line,e.column)),r.expecting,r.actual);var e}function ze(r){return r.result}function He(r,e,n){var t=vr(r,n);if(t.tag)return rr(1,[t[0]]);var a=t[0];return L(e,a.result,{location:a.location,input_chars:a.remaining_chars})}function Xe(r,e,n,t){var a=vr(r,t);if(a.tag)return rr(0,[{result:n,location:t.location,remaining_chars:t.input_chars}]);var i=a[0];return L(e,i.result,{location:i.location,input_chars:i.remaining_chars})}function Ke(r,e){return rr(0,[{result:r,location:e.location,remaining_chars:e.input_chars}])}function Ge(r,e,n){var t=vr(e,n);if(!t.tag)return t;var a=t[0];return rr(1,a?[[{expecting:vr(r,Ur(" OR ",_r(function(r){return r.expecting},a))),actual:a[0].actual,location:n.location},0]]:[[{expecting:vr(r,""),actual:"No input",location:n.location},0]])}function Ye(r,e,n){var t=vr(e,n);if(!t.tag)return t;var a=t[0];return rr(1,a?[[{expecting:r,actual:a[0].actual,location:n.location},a[1]]]:[[{expecting:r,actual:"",location:n.location},0]])}function rn(n,e){return function(r){return He(e,function(r){var e=vr(n,r);return function(r){return Ke(e,r)}},r)}}function en(r,e,n){var t=vr(r,n);if(!t.tag)return t;var a=vr(e,n);return a.tag?rr(1,[Ar([t[0],[a[0],0]])]):a}function nn(r){if(!r)return function(r){return rr(1,[0])};var e=r[0],n=nn(r[1]);return function(r){return en(e,n,r)}}function tn(t){function e(r){return He(t,function(n){var e=tn(t);return function(r){return He(e,function(r){var e=[n,r];return function(r){return Ke(e,r)}},r)}},r)}return function(r){return en(e,function(r){return Ke(0,r)},r)}}function an(r,e){return a=e,i=n=r,t=(u=function(e){var n=wr(e);return function(r){return Xe(a,function(r){return function(r){return He(i,function(r){return u([r,e])},r)}},n,r)}})(0),function(r){return He(n,function(n){return function(r){return He(t,function(r){var e=[n,r];return function(r){return Ke(e,r)}},r)}},r)};var n,t,a,i,u}function un(r,e,n){var t=n.input_chars;if(!t)return rr(1,[[{expecting:e,actual:"Ran out of characters",location:n.location},0]]);var a,i,u,o=t[0];return vr(r,o)?rr(0,[{result:o,location:(a=n.location,i=o,u=a.line,10!==i&&13!==i?{column:a.column+1|0,line:u}:{column:1,line:u+1|0}),remaining_chars:t[1]}]):rr(1,[[{expecting:e,actual:vr(We([rr(12,[39,rr(0,[rr(12,[39,0])])]),"'%c'"]),o),location:n.location},0]])}function on(e){var n=vr(We([rr(0,[0]),"%c"]),e);return function(r){return un(function(r){return e===r},n,r)}}function cn(e,n){var t=L(We([rr(11,["A character between ",rr(0,[rr(11,[" and ",rr(0,[0])])])]),"A character between %c and %c"]),e,n);return function(r){return un(function(r){return e<=r&&r<=n},t,r)}}var sn,fn,ln=(sn=[32,[9,[13,[10,0]]]],fn=vr(We([rr(11,["One of: ",rr(2,[0,0])]),"One of: %s"]),Ur(", ",_r(function(r){return $r(1,r)},sn))),function(r){return un(function(r){return function(r,e){for(;;){var n=e;if(!n)return!1;if(m(n[0],r))return!0;e=n[1]}}(r,sn)},fn,r)}),vn=(on(10),on(9),cn(65,90)),dn=cn(97,122),hn=cn(48,57),pn=We([rr(2,[0,0]),"%s"]);function mn(r){return Ge(pn,function(r){return en(dn,vn,r)},r)}nn([cn(97,102),[cn(65,70),[hn,0]]]);var gn=function e(n){function t(r){return He(n,function(r){return e(n)},r)}return function(r){return en(t,function(r){return Ke(void 0,r)},r)}}(ln);cn(48,55);function bn(t){var a=t.length,i=function(r){if(a<=r)return function(r){return Ke(t,r)};var e=i(r+1|0),n=on(tr(t,r));return function(r){return He(n,function(r){return e},r)}};if(a<=0)return function(r){throw[w,r]}("token must be a non-empty string");function e(r){return He(gn,function(r){return n},r)}var n=i(0);return function(r){return Ye(t,e,r)}}function wn(r,e){return vr(r,{location:{column:1,line:1},input_chars:(a=Jr(e),i=a.length,wr(function(r,e){for(;;){var n=e,t=r;if(n===i)return t;e=n+1|0,r=[tr(a,n),t]}}(0,0)))});var a,i}function yn(r,e){var n=wn(r,e);if(n.tag)return rr(1,[n[0]]);var t=n[0],a=t.remaining_chars,i=t.location;return a?rr(1,[[{expecting:"End of input",actual:vr(We([rr(11,["Characters remaining: ",rr(2,[0,0])]),"Characters remaining: %s"]),Ur("",_r(function(r){return $r(1,r)},a))),location:i},0]]):rr(0,[{result:t.result,location:i,remaining_chars:a}])}var _n=He,kn=en,Sn=function(e,n){return function(r){return He(e,function(r){return n},r)}},xn=function(e,n){return function(r){return He(e,function(e){return function(r){return He(n,function(r){return function(r){return Ke(e,r)}},r)}},r)}};function Nn(d){function h(r){return r?r[4]:0}function p(r,e,n,t){var a=h(r),i=h(t);return[r,e,n,t,i<=a?a+1|0:i+1|0]}function t(r,e){return[0,r,e,0,1]}function m(r,e,n,t){var a=r?r[4]:0,i=t?t[4]:0;if((i+2|0)<a){if(r){var u=r[3],o=r[2],c=r[1],s=r[0];if(h(s)>=h(u))return p(s,c,o,p(u,e,n,t));if(u)return p(p(s,c,o,u[0]),u[1],u[2],p(u[3],e,n,t));throw[T,"Map.bal"]}throw[T,"Map.bal"]}if(i<=(a+2|0))return[r,e,n,t,i<=a?a+1|0:i+1|0];if(t){var f=t[3],l=t[2],v=t[1],d=t[0];if(h(f)>=h(d))return p(p(r,e,n,d),v,l,f);if(d)return p(p(r,e,n,d[0]),d[1],d[2],p(d[3],v,l,f));throw[T,"Map.bal"]}throw[T,"Map.bal"]}function a(r){for(;;){if(!r)throw C;var e=r[0];if(!e)return[r[1],r[2]];r=e}}function r(r){for(;;){if(!r)return;var e=r[0];if(!e)return[r[1],r[2]];r=e}}function g(r,e){if(!r)return e;if(!e)return r;var n=a(e);return m(r,n[0],n[1],i(e))}function l(r,e){if(!r)return e;if(!e)return r;var n=a(e);return N(r,n[0],n[1],i(e))}function b(r,e,n,t){return void 0!==n?N(r,e,cr(n),t):l(r,t)}function s(r,e){for(;;){if(!r)return e;e=[r[1],r[2],r[3],e],r=r[0]}}var f=function(r,e,n){if(!n)return[0,r,e,0,1];var t=n[3],a=n[2],i=n[1],u=n[0],o=L(d.compare,r,i);if(0===o)return a===e?n:[u,r,e,t,n[4]];if(o<0){var c=f(r,e,u);return u===c?n:m(c,i,a,t)}var s=f(r,e,t);return t===s?n:m(u,i,a,s)},i=function(r){if(r){var e=r[0];return e?m(i(e),r[1],r[2],r[3]):r[3]}throw[T,"Map.remove_min_elt"]},v=function(r,e){if(!e)return 0;var n=e[3],t=e[2],a=e[1],i=e[0],u=L(d.compare,r,a);if(0===u)return g(i,n);if(u<0){var o=v(r,i);return i===o?e:m(o,a,t,n)}var c=v(r,n);return n===c?e:m(i,a,t,c)},w=function(r,e,n){if(n){var t=n[3],a=n[2],i=n[1],u=n[0],o=L(d.compare,r,i);if(0===o){var c=vr(e,or(a));if(void 0===c)return g(u,t);var s=cr(c);return a===s?n:[u,r,s,t,n[4]]}if(o<0){var f=w(r,e,u);return u===f?n:m(f,i,a,t)}var l=w(r,e,t);return t===l?n:m(u,i,a,l)}var v=vr(e,void 0);return void 0!==v?[0,r,cr(v),0,1]:0},u=function(r,e){for(;;){var n=e;if(!n)return;u(r,n[0]),L(r,n[1],n[2]),e=n[3]}},o=function(r,e){if(!e)return 0;var n=o(r,e[0]),t=vr(r,e[2]),a=o(r,e[3]);return[n,e[1],t,a,e[4]]},c=function(r,e){if(!e)return 0;var n=e[1];return[c(r,e[0]),n,L(r,n,e[2]),c(r,e[3]),e[4]]},y=function(r,e,n){for(;;){var t=e;if(!t)return n;n=I(r,t[1],t[2],y(r,t[0],n)),e=t[3]}},_=function(r,e){for(;;){var n=e;if(!n)return!0;if(!L(r,n[1],n[2]))return!1;if(!_(r,n[0]))return!1;e=n[3]}},k=function(r,e){for(;;){var n=e;if(!n)return!1;if(L(r,n[1],n[2]))return!0;if(k(r,n[0]))return!0;e=n[3]}},S=function(r,e,n){return n?m(S(r,e,n[0]),n[1],n[2],n[3]):t(r,e)},x=function(r,e,n){return n?m(n[0],n[1],n[2],x(r,e,n[3])):t(r,e)},N=function(r,e,n,t){if(!r)return S(e,n,t);if(!t)return x(e,n,r);var a=t[4],i=r[4];return(a+2|0)<i?m(r[0],r[1],r[2],N(r[3],e,n,t)):(i+2|0)<a?m(N(r,e,n,t[0]),t[1],t[2],t[3]):p(r,e,n,t)},A=function(r,e){if(!e)return[0,void 0,0];var n=e[3],t=e[2],a=e[1],i=e[0],u=L(d.compare,r,a);if(0===u)return[i,or(t),n];if(u<0){var o=A(r,i);return[o[0],o[1],N(o[2],a,t,n)]}var c=A(r,n);return[N(i,a,t,c[0]),c[1],c[2]]},O=function(r,e,n){if(e){var t=e[1];if(e[4]>=h(n)){var a=A(t,n);return b(O(r,e[0],a[0]),t,I(r,t,or(e[2]),a[1]),O(r,e[3],a[2]))}}else if(!n)return 0;if(n){var i=n[1],u=A(i,e);return b(O(r,u[0],n[0]),i,I(r,i,u[1],or(n[2])),O(r,u[2],n[3]))}throw[M,["map.ml",393,10]]},q=function(r,e,n){if(!e)return n;if(!n)return e;var t=n[2],a=n[1],i=e[2],u=e[1];if(e[4]>=n[4]){var o=A(u,n),c=o[1],s=q(r,e[0],o[0]),f=q(r,e[3],o[2]);return void 0!==c?b(s,u,I(r,u,i,cr(c)),f):N(s,u,i,f)}var l=A(a,e),v=l[1],d=q(r,l[0],n[0]),h=q(r,l[2],n[3]);return void 0!==v?b(d,a,I(r,a,cr(v),t),h):N(d,a,t,h)},R=function(r,e){if(!e)return 0;var n=e[3],t=e[2],a=e[1],i=e[0],u=R(r,i),o=L(r,a,t),c=R(r,n);return o?i===u&&n===c?e:N(u,a,t,c):l(u,c)},F=function(r,e){if(!e)return[0,0];var n=e[2],t=e[1],a=F(r,e[0]),i=a[1],u=a[0],o=L(r,t,n),c=F(r,e[3]),s=c[1],f=c[0];return o?[N(u,t,n,f),l(i,s)]:[l(u,f),N(i,t,n,s)]},e=function(r){return r?(e(r[0])+1|0)+e(r[3])|0:0},E=function(r,e){for(;;){var n=e;if(!n)return r;e=n[0],r=[[n[1],n[2]],E(r,n[3])]}};return{empty:0,is_empty:function(r){return!r},mem:function(r,e){for(;;){var n=e;if(!n)return!1;var t=L(d.compare,r,n[1]);if(0===t)return!0;e=t<0?n[0]:n[3]}},add:f,update:w,singleton:t,remove:v,merge:O,union:q,compare:function(r,e,n){for(var t=s(e,0),a=s(n,0);;){var i=a,u=t;if(!u)return i?-1:0;if(!i)return 1;var o=L(d.compare,u[0],i[0]);if(0!==o)return o;var c=L(r,u[1],i[1]);if(0!==c)return c;a=s(i[2],i[3]),t=s(u[2],u[3])}},equal:function(r,e,n){for(var t=s(e,0),a=s(n,0);;){var i=a,u=t;if(!u)return!i;if(!i)return!1;if(0!==L(d.compare,u[0],i[0]))return!1;if(!L(r,u[1],i[1]))return!1;a=s(i[2],i[3]),t=s(u[2],u[3])}},iter:u,fold:y,for_all:_,exists:k,filter:R,partition:F,cardinal:e,bindings:function(r){return E(0,r)},min_binding:a,min_binding_opt:r,max_binding:function(r){for(;;){if(!r)throw C;var e=r[3];if(!e)return[r[1],r[2]];r=e}},max_binding_opt:function(r){for(;;){if(!r)return;var e=r[3];if(!e)return[r[1],r[2]];r=e}},choose:a,choose_opt:r,split:A,find:function(r,e){for(;;){var n=e;if(!n)throw C;var t=L(d.compare,r,n[1]);if(0===t)return n[2];e=t<0?n[0]:n[3]}},find_opt:function(r,e){for(;;){var n=e;if(!n)return;var t=L(d.compare,r,n[1]);if(0===t)return or(n[2]);e=t<0?n[0]:n[3]}},find_first:function(r,e){for(;;){var n=e;if(!n)throw C;var t=n[1];if(vr(r,t))for(var a=t,i=n[2],u=n[0];;){var o=u;if(!o)return[a,i];var c=o[1];vr(r,c)?(u=o[0],i=o[2],a=c):u=o[3]}e=n[3]}},find_first_opt:function(r,e){for(;;){var n=e;if(!n)return;var t=n[1];if(vr(r,t))for(var a=t,i=n[2],u=n[0];;){var o=u;if(!o)return[a,i];var c=o[1];vr(r,c)?(u=o[0],i=o[2],a=c):u=o[3]}e=n[3]}},find_last:function(r,e){for(;;){var n=e;if(!n)throw C;var t=n[1];if(vr(r,t))for(var a=t,i=n[2],u=n[3];;){var o=u;if(!o)return[a,i];var c=o[1];vr(r,c)?(u=o[3],i=o[2],a=c):u=o[0]}e=n[0]}},find_last_opt:function(r,e){for(;;){var n=e;if(!n)return;var t=n[1];if(vr(r,t))for(var a=t,i=n[2],u=n[3];;){var o=u;if(!o)return[a,i];var c=o[1];vr(r,c)?(u=o[3],i=o[2],a=c):u=o[0]}e=n[0]}},map:o,mapi:c}}function An(r,e){var n=e.length;if(0===n)return[];for(var t=function(r,e){for(var n=new Array(r),t=0;t<r;++t)n[t]=e;return n}(n,vr(r,e[0])),a=1;a<n;++a)t[a]=vr(r,e[a]);return t}function On(r,e,n){for(var t=n,a=e.length-1|0;0<=a;--a)t=L(r,e[a],t);return t}ir("Array.Bottom");function qn(r,e){if(e in r)return or(r[e])}var Rn=function(r){var e=typeof r;return"string"==e?rr(0,[r]):"number"==e?rr(1,[r]):"boolean"==e?!0===r?1:0:null===r?2:Array.isArray(r)?rr(3,[r]):rr(2,[r])};function Fn(r,e){return e.tag?e:r}function En(r,e){return e.tag?or(e[0]):function(r){if(r.tag)return or(r[0])}(r)}function Tn(r){return r?r[4]:0}function Cn(r,e,n,t){var a=Tn(r),i=Tn(t);return[r,e,n,t,i<=a?a+1|0:i+1|0]}function Mn(r,e){return[0,r,e,0,1]}function Ln(r,e,n,t){var a=r?r[4]:0,i=t?t[4]:0;if((i+2|0)<a){if(r){var u=r[3],o=r[2],c=r[1],s=r[0];if(Tn(s)>=Tn(u))return Cn(s,c,o,Cn(u,e,n,t));if(u)return Cn(Cn(s,c,o,u[0]),u[1],u[2],Cn(u[3],e,n,t));throw[T,"Map.bal"]}throw[T,"Map.bal"]}if(i<=(a+2|0))return[r,e,n,t,i<=a?a+1|0:i+1|0];if(t){var f=t[3],l=t[2],v=t[1],d=t[0];if(Tn(f)>=Tn(d))return Cn(Cn(r,e,n,d),v,l,f);if(d)return Cn(Cn(r,e,n,d[0]),d[1],d[2],Cn(d[3],v,l,f));throw[T,"Map.bal"]}throw[T,"Map.bal"]}function In(r,e,n){if(!n)return[0,r,e,0,1];var t=n[3],a=n[2],i=n[1],u=n[0],o=h(r,i);if(0===o)return a===e?n:[u,r,e,t,n[4]];if(o<0){var c=In(r,e,u);return u===c?n:Ln(c,i,a,t)}var s=In(r,e,t);return t===s?n:Ln(u,i,a,s)}function Pn(r){for(;;){if(!r)throw C;var e=r[0];if(!e)return[r[1],r[2]];r=e}}function Dn(r){for(;;){if(!r)return;var e=r[0];if(!e)return[r[1],r[2]];r=e}}function $n(r){if(r){var e=r[0];return e?Ln($n(e),r[1],r[2],r[3]):r[3]}throw[T,"Map.remove_min_elt"]}function Bn(r,e){if(!r)return e;if(!e)return r;var n=Pn(e);return Ln(r,n[0],n[1],$n(e))}function Un(r,e,n,t){if(!r)return function r(e,n,t){return t?Ln(r(e,n,t[0]),t[1],t[2],t[3]):Mn(e,n)}(e,n,t);if(!t)return function r(e,n,t){return t?Ln(t[0],t[1],t[2],r(e,n,t[3])):Mn(e,n)}(e,n,r);var a=t[4],i=r[4];return(a+2|0)<i?Ln(r[0],r[1],r[2],Un(r[3],e,n,t)):(i+2|0)<a?Ln(Un(r,e,n,t[0]),t[1],t[2],t[3]):Cn(r,e,n,t)}function Vn(r,e){if(!r)return e;if(!e)return r;var n=Pn(e);return Un(r,n[0],n[1],$n(e))}function Jn(r,e,n,t){return void 0!==n?Un(r,e,cr(n),t):Vn(r,t)}function Qn(r,e){if(!e)return[0,void 0,0];var n=e[3],t=e[2],a=e[1],i=e[0],u=h(r,a);if(0===u)return[i,or(t),n];if(u<0){var o=Qn(r,i);return[o[0],o[1],Un(o[2],a,t,n)]}var c=Qn(r,n);return[Un(i,a,t,c[0]),c[1],c[2]]}function Wn(r,e){for(;;){if(!r)return e;e=[r[1],r[2],r[3],e],r=r[0]}}var Zn={empty:0,is_empty:function(r){return!r},mem:function(r,e){for(;;){if(!e)return!1;var n=h(r,e[1]);if(0===n)return!0;e=n<0?e[0]:e[3]}},add:In,update:function r(e,n,t){if(t){var a=t[3],i=t[2],u=t[1],o=t[0],c=h(e,u);if(0===c){var s=vr(n,or(i));if(void 0===s)return Bn(o,a);var f=cr(s);return i===f?t:[o,e,f,a,t[4]]}if(c<0){var l=r(e,n,o);return o===l?t:Ln(l,u,i,a)}var v=r(e,n,a);return a===v?t:Ln(o,u,i,v)}var d=vr(n,void 0);return void 0!==d?[0,e,cr(d),0,1]:0},singleton:Mn,remove:function r(e,n){if(!n)return 0;var t=n[3],a=n[2],i=n[1],u=n[0],o=h(e,i);if(0===o)return Bn(u,t);if(o<0){var c=r(e,u);return u===c?n:Ln(c,i,a,t)}var s=r(e,t);return t===s?n:Ln(u,i,a,s)},merge:function r(e,n,t){if(n){var a=n[1];if(n[4]>=Tn(t)){var i=Qn(a,t);return Jn(r(e,n[0],i[0]),a,I(e,a,or(n[2]),i[1]),r(e,n[3],i[2]))}}else if(!t)return 0;if(t){var u=t[1],o=Qn(u,n);return Jn(r(e,o[0],t[0]),u,I(e,u,o[1],or(t[2])),r(e,o[2],t[3]))}throw[M,["map.ml",393,10]]},union:function r(e,n,t){if(!n)return t;if(!t)return n;var a=t[2],i=t[1],u=n[2],o=n[1];if(n[4]>=t[4]){var c=Qn(o,t),s=c[1],f=r(e,n[0],c[0]),l=r(e,n[3],c[2]);return void 0!==s?Jn(f,o,I(e,o,u,cr(s)),l):Un(f,o,u,l)}var v=Qn(i,n),d=v[1],h=r(e,v[0],t[0]),p=r(e,v[2],t[3]);return void 0!==d?Jn(h,i,I(e,i,cr(d),a),p):Un(h,i,a,p)},compare:function(r,e,n){for(var t=Wn(e,0),a=Wn(n,0);;){var i=a,u=t;if(!u)return i?-1:0;if(!i)return 1;var o=h(u[0],i[0]);if(0!==o)return o;var c=L(r,u[1],i[1]);if(0!==c)return c;a=Wn(i[2],i[3]),t=Wn(u[2],u[3])}},equal:function(r,e,n){for(var t=Wn(e,0),a=Wn(n,0);;){var i=a,u=t;if(!u)return!i;if(!i)return!1;if(0!==h(u[0],i[0]))return!1;if(!L(r,u[1],i[1]))return!1;a=Wn(i[2],i[3]),t=Wn(u[2],u[3])}},iter:function r(e,n){for(;;){var t=n;if(!t)return;r(e,t[0]),L(e,t[1],t[2]),n=t[3]}},fold:function r(e,n,t){for(;;){var a=n;if(!a)return t;t=I(e,a[1],a[2],r(e,a[0],t)),n=a[3]}},for_all:function r(e,n){for(;;){var t=n;if(!t)return!0;if(!L(e,t[1],t[2]))return!1;if(!r(e,t[0]))return!1;n=t[3]}},exists:function r(e,n){for(;;){var t=n;if(!t)return!1;if(L(e,t[1],t[2]))return!0;if(r(e,t[0]))return!0;n=t[3]}},filter:function r(e,n){if(!n)return 0;var t=n[3],a=n[2],i=n[1],u=n[0],o=r(e,u),c=L(e,i,a),s=r(e,t);return c?u===o&&t===s?n:Un(o,i,a,s):Vn(o,s)},partition:function r(e,n){if(!n)return[0,0];var t=n[2],a=n[1],i=r(e,n[0]),u=i[1],o=i[0],c=L(e,a,t),s=r(e,n[3]),f=s[1],l=s[0];return c?[Un(o,a,t,l),Vn(u,f)]:[Vn(o,l),Un(u,a,t,f)]},cardinal:function r(e){return e?(r(e[0])+1|0)+r(e[3])|0:0},bindings:function(r){return function r(e,n){for(;;){var t=n;if(!t)return e;n=t[0],e=[[t[1],t[2]],r(e,t[3])]}}(0,r)},min_binding:Pn,min_binding_opt:Dn,max_binding:function(r){for(;;){if(!r)throw C;var e=r[3];if(!e)return[r[1],r[2]];r=e}},max_binding_opt:function(r){for(;;){if(!r)return;var e=r[3];if(!e)return[r[1],r[2]];r=e}},choose:Pn,choose_opt:Dn,split:Qn,find:function(r,e){for(;;){if(!e)throw C;var n=h(r,e[1]);if(0===n)return e[2];e=n<0?e[0]:e[3]}},find_opt:function(r,e){for(;;){var n=e;if(!n)return;var t=h(r,n[1]);if(0===t)return or(n[2]);e=t<0?n[0]:n[3]}},find_first:function(r,e){for(;;){var n=e;if(!n)throw C;var t=n[1];if(vr(r,t))for(var a=t,i=n[2],u=n[0];;){var o=u;if(!o)return[a,i];var c=o[1];vr(r,c)?(u=o[0],i=o[2],a=c):u=o[3]}e=n[3]}},find_first_opt:function(r,e){for(;;){var n=e;if(!n)return;var t=n[1];if(vr(r,t))for(var a=t,i=n[2],u=n[0];;){var o=u;if(!o)return[a,i];var c=o[1];vr(r,c)?(u=o[0],i=o[2],a=c):u=o[3]}e=n[3]}},find_last:function(r,e){for(;;){var n=e;if(!n)throw C;var t=n[1];if(vr(r,t))for(var a=t,i=n[2],u=n[3];;){var o=u;if(!o)return[a,i];var c=o[1];vr(r,c)?(u=o[3],i=o[2],a=c):u=o[0]}e=n[0]}},find_last_opt:function(r,e){for(;;){var n=e;if(!n)return;var t=n[1];if(vr(r,t))for(var a=t,i=n[2],u=n[3];;){var o=u;if(!o)return[a,i];var c=o[1];vr(r,c)?(u=o[3],i=o[2],a=c):u=o[0]}e=n[0]}},map:function r(e,n){if(!n)return 0;var t=r(e,n[0]),a=vr(e,n[2]),i=r(e,n[3]);return[t,n[1],a,i,n[4]]},mapi:function r(e,n){if(!n)return 0;var t=n[1];return[r(e,n[0]),t,L(e,t,n[2]),r(e,n[3]),n[4]]}},jn=ir("Tea_json.Decoder.ParseFail");function zn(n){return[function(r){var e=Rn(r);return"number"==typeof e&&2<=e?rr(0,[n]):rr(1,["Non-null value"])}]}function Hn(a,r){var i=r[0];return[function(r){var e=Rn(r);if("number"==typeof e)return rr(1,["Non-fieldable value"]);if(2!==e.tag)return rr(1,["Non-fieldable value"]);var n=qn(e[0],a);if(void 0===n)return rr(1,["Field Value is undefined: "+a]);var t=vr(i,cr(n));return t.tag?rr(1,["field `"+a+("` -> "+t[0])]):t}]}function Xn(e){return[function(r){var i=function(r,e){for(;;){var n=e;if(!n)return rr(1,["No one-of's matched"]);var t=n[1];try{var a=vr(n[0][0],r);return a.tag?i(r,t):a}catch(r){e=t;continue}}};return i(r,e)}]}function Kn(n,r){var t=r[0];return[function(r){var e=vr(t,r);return e.tag?rr(1,["map "+e[0]]):rr(0,[vr(n,e[0])])}]}function Gn(t,r){var a=r[0];return[function(r){var e=vr(a,r);if(e.tag)return e;var n=vr(t,e[0]);return vr(n[0],r)}]}function Yn(r,e){try{return vr(r[0],e)}catch(r){var n=fr(r);return n[0]===jn?rr(1,[n[1]]):rr(1,["Unknown JSON parsing error"])}}var rt={ObjectDict:Zn,ParseFail:jn,string:[function(r){var e=Rn(r);return"number"==typeof e||e.tag?rr(1,["Non-string value"]):rr(0,[e[0]])}],$$int:[function(r){var e=Rn(r);if("number"==typeof e)return rr(1,["Non-int value"]);if(1!==e.tag)return rr(1,["Non-int value"]);var n=e[0];return-2147483648<n&&n<2147483647?rr(0,[0|n]):rr(1,["number out of int range"])}],$$float:[function(r){var e=Rn(r);return"number"==typeof e||1!==e.tag?rr(1,["Non-float-value"]):rr(0,[e[0]])}],bool:[function(r){var e=Rn(r);if("number"!=typeof e)return rr(1,["Non-boolean value"]);switch(e){case 0:return rr(0,[!1]);case 1:return rr(0,[!0]);case 2:return rr(1,["Non-boolean value"])}}],$$null:zn,list:function(r){var t=r[0];return[function(r){var e=Rn(r);if("number"==typeof e)return rr(1,["Non-list value"]);if(3!==e.tag)return rr(1,["Non-list value"]);try{return rr(0,[_r(function(r){var e=vr(t,r);if(!e.tag)return e[0];throw[jn,e[0]]},function(r){for(var e=r.length-1|0,n=0;;){if(e<0)return n;n=[r[e],n],e=e-1|0}}(e[0]))])}catch(r){var n=fr(r);if(n[0]===jn)return rr(1,["list -> "+n[1]]);throw n}}]},array:function(r){var t=r[0];return[function(r){var e=Rn(r);if("number"==typeof e)return rr(1,["Non-array value"]);if(3!==e.tag)return rr(1,["Non-array value"]);try{return rr(0,[An(function(r){var e=vr(t,r);if(!e.tag)return e[0];throw[jn,e[0]]},e[0])])}catch(r){var n=fr(r);if(n[0]===jn)return rr(1,["array -> "+n[1]]);throw n}}]},keyValuePairs:function(r){var i=r[0];return[function(r){var e=Rn(r);if("number"==typeof e)return rr(1,["Non-keyValuePair value"]);if(2!==e.tag)return rr(1,["Non-keyValuePair value"]);var a=e[0],n=Object.keys(a);try{return rr(0,[On(function(r,e){var n=qn(a,r);if(void 0===n)throw[jn,"Key is undefined: "+r];var t=vr(i,cr(n));if(!t.tag)return[[r,t[0]],e];throw[jn,t[0]]},n,0)])}catch(r){var t=fr(r);if(t[0]===jn)return rr(1,["Invalid keyValuePair parsing: "+t[1]]);throw t}}]},dict:function(r){var i=r[0];return[function(r){var e=Rn(r);if("number"==typeof e)return rr(1,["Non-dict value"]);if(2!==e.tag)return rr(1,["Non-dict value"]);var a=e[0],n=Object.keys(a);try{return rr(0,[On(function(r,e){var n=qn(a,r);if(void 0===n)throw[jn,"Key is undefined: "+r];var t=vr(i,cr(n));if(!t.tag)return In(r,t[0],e);throw[jn,t[0]]},n,0)])}catch(r){var t=fr(r);if(t[0]===jn)return rr(1,["Invalid dict parsing: "+t[1]]);throw t}}]},field:Hn,at:function(r,e){return function r(e,n,t){return n?L(e,n[0],r(e,n[1],t)):t}(Hn,r,e)},index:function(t,r){var a=r[0];return[function(r){var e=Rn(r);if("number"==typeof e)return rr(1,["Non-array value"]);if(3!==e.tag)return rr(1,["Non-array value"]);var n=e[0];return t<0||t>n.length?rr(1,["Array index out of range: "+String(t)]):vr(a,lr(n,t))}]},maybe:function(r){var n=r[0];return[function(r){var e=vr(n,r);return e.tag?rr(0,[void 0]):rr(0,[or(e[0])])}]},oneOf:Xn,map:Kn,map2:function(a,r,e){var i=e[0],u=r[0];return[function(r){var e=vr(u,r),n=vr(i,r);if(!e.tag&&!n.tag)return rr(0,[L(a,e[0],n[0])]);var t=En(e,n);if(void 0!==t)return rr(1,["map2 -> "+t]);throw[w,"Impossible case"]}]},map3:function(i,r,e,n){var u=n[0],o=e[0],c=r[0];return[function(r){var e=vr(c,r),n=vr(o,r),t=vr(u,r);if(!e.tag&&!n.tag&&!t.tag)return rr(0,[I(i,e[0],n[0],t[0])]);var a=Fn(t,Fn(n,e));if(a.tag)return rr(1,["map3 -> "+a[0]]);throw[w,"Impossible case"]}]},map4:function(u,r,e,n,t){var o=t[0],c=n[0],s=e[0],f=r[0];return[function(r){var e=vr(f,r),n=vr(s,r),t=vr(c,r),a=vr(o,r);if(!(e.tag||n.tag||t.tag||a.tag))return rr(0,[function(t,a,i,u,o){var r=t.length;if(4===r)return t(a,i,u,o);switch(r){case 1:return y(t(a),[i,u,o]);case 2:return y(t(a,i),[u,o]);case 3:return y(t(a,i,u),[o]);case 4:return t(a,i,u,o);case 5:return function(r){return t(a,i,u,o,r)};case 6:return function(r,e){return t(a,i,u,o,r,e)};case 7:return function(r,e,n){return t(a,i,u,o,r,e,n)};default:return y(t,[a,i,u,o])}}(u,e[0],n[0],t[0],a[0])]);var i=Fn(a,Fn(t,Fn(n,e)));if(i.tag)return rr(1,["map4 -> "+i[0]]);throw[w,"Impossible case"]}]},map5:function(o,r,e,n,t,a){var c=a[0],s=t[0],f=n[0],l=e[0],v=r[0];return[function(r){var e=vr(v,r),n=vr(l,r),t=vr(f,r),a=vr(s,r),i=vr(c,r);if(!(e.tag||n.tag||t.tag||a.tag||i.tag))return rr(0,[function(n,t,a,i,u,o){var r=n.length;if(5===r)return n(t,a,i,u,o);switch(r){case 1:return y(n(t),[a,i,u,o]);case 2:return y(n(t,a),[i,u,o]);case 3:return y(n(t,a,i),[u,o]);case 4:return y(n(t,a,i,u),[o]);case 5:return n(t,a,i,u,o);case 6:return function(r){return n(t,a,i,u,o,r)};case 7:return function(r,e){return n(t,a,i,u,o,r,e)};default:return y(n,[t,a,i,u,o])}}(o,e[0],n[0],t[0],a[0],i[0])]);var u=Fn(i,Fn(a,Fn(t,Fn(n,e))));if(u.tag)return rr(1,["map5 -> "+u[0]]);throw[w,"Impossible case"]}]},map6:function(c,r,e,n,t,a,i){var s=i[0],f=a[0],l=t[0],v=n[0],d=e[0],h=r[0];return[function(r){var e=vr(h,r),n=vr(d,r),t=vr(v,r),a=vr(l,r),i=vr(f,r),u=vr(s,r);if(!(e.tag||n.tag||t.tag||a.tag||i.tag||u.tag))return rr(0,[function(e,n,t,a,i,u,o){var r=e.length;if(6===r)return e(n,t,a,i,u,o);switch(r){case 1:return y(e(n),[t,a,i,u,o]);case 2:return y(e(n,t),[a,i,u,o]);case 3:return y(e(n,t,a),[i,u,o]);case 4:return y(e(n,t,a,i),[u,o]);case 5:return y(e(n,t,a,i,u),[o]);case 6:return e(n,t,a,i,u,o);case 7:return function(r){return e(n,t,a,i,u,o,r)};default:return y(e,[n,t,a,i,u,o])}}(c,e[0],n[0],t[0],a[0],i[0],u[0])]);var o=Fn(u,Fn(i,Fn(a,Fn(t,Fn(n,e)))));if(o.tag)return rr(1,["map6 -> "+o[0]]);throw[w,"Impossible case"]}]},map7:function(s,r,e,n,t,a,i,u){var f=u[0],l=i[0],v=a[0],d=t[0],h=n[0],p=e[0],m=r[0];return[function(r){var e=vr(m,r),n=vr(p,r),t=vr(h,r),a=vr(d,r),i=vr(v,r),u=vr(l,r),o=vr(f,r);if(!(e.tag||n.tag||t.tag||a.tag||i.tag||u.tag||o.tag))return rr(0,[function(r,e,n,t,a,i,u,o){var c=r.length;if(7===c)return r(e,n,t,a,i,u,o);switch(c){case 1:return y(r(e),[n,t,a,i,u,o]);case 2:return y(r(e,n),[t,a,i,u,o]);case 3:return y(r(e,n,t),[a,i,u,o]);case 4:return y(r(e,n,t,a),[i,u,o]);case 5:return y(r(e,n,t,a,i),[u,o]);case 6:return y(r(e,n,t,a,i,u),[o]);case 7:return r(e,n,t,a,i,u,o);default:return y(r,[e,n,t,a,i,u,o])}}(s,e[0],n[0],t[0],a[0],i[0],u[0],o[0])]);var c=Fn(o,Fn(u,Fn(i,Fn(a,Fn(t,Fn(n,e))))));if(c.tag)return rr(1,["map7 -> "+c[0]]);throw[w,"Impossible case"]}]},map8:function(f,r,e,n,t,a,i,u,o){var l=o[0],v=u[0],d=i[0],h=a[0],p=t[0],m=n[0],g=e[0],b=r[0];return[function(r){var e=vr(b,r),n=vr(g,r),t=vr(m,r),a=vr(p,r),i=vr(h,r),u=vr(d,r),o=vr(v,r),c=vr(l,r);if(!(e.tag||n.tag||t.tag||a.tag||i.tag||u.tag||o.tag||c.tag))return rr(0,[function(r,e,n,t,a,i,u,o,c){var s=r.length;if(8===s)return r(e,n,t,a,i,u,o,c);switch(s){case 1:return y(r(e),[n,t,a,i,u,o,c]);case 2:return y(r(e,n),[t,a,i,u,o,c]);case 3:return y(r(e,n,t),[a,i,u,o,c]);case 4:return y(r(e,n,t,a),[i,u,o,c]);case 5:return y(r(e,n,t,a,i),[u,o,c]);case 6:return y(r(e,n,t,a,i,u),[o,c]);case 7:return y(r(e,n,t,a,i,u,o),[c]);default:return y(r,[e,n,t,a,i,u,o,c])}}(f,e[0],n[0],t[0],a[0],i[0],u[0],o[0],c[0])]);var s=Fn(c,Fn(o,Fn(u,Fn(i,Fn(a,Fn(t,Fn(n,e)))))));if(s.tag)return rr(1,["map8 -> "+s[0]]);throw[w,"Impossible case"]}]},succeed:function(e){return[function(r){return rr(0,[e])}]},fail:function(e){return[function(r){return rr(1,[e])}]},value:[function(r){return rr(0,[r])}],andThen:Gn,lazy_:function(r){return Gn(r,[function(r){return rr(0,[void 0])}])},nullable:function(r){return Xn([zn(void 0),[Kn(or,r),0]])},decodeValue:Yn,decodeEvent:function(r,e){try{return vr(r[0],e)}catch(r){var n=fr(r);return n[0]===jn?rr(1,[n[1]]):rr(1,["Unknown JSON parsing error"])}},decodeString:function(r,e){try{return Yn(r,JSON.parse(e))}catch(r){return rr(1,["Invalid JSON string"])}}};function et(r){return rr(1,[r])}function nt(r,e,n,t){return Kr("","div",void 0!==r?r:"",void 0!==e?e:"",n,t)}function tt(r,e,n,t){return Kr("","span",void 0!==r?r:"",void 0!==e?e:"",n,t)}function at(r,e,n,t){return Kr("","p",void 0!==r?r:"",void 0!==e?e:"",n,t)}function it(r,e,n,t){return Kr("","h3",void 0!==r?r:"",void 0!==e?e:"",n,t)}function ut(r,e,n,t){return Kr("","button",void 0!==r?r:"",void 0!==e?e:"",n,t)}function ot(r,e,n,t){return Kr("","textarea",void 0!==r?r:"",void 0!==e?e:"",n,t)}function ct(r,e,n,t){return Kr("","label",void 0!==r?r:"",void 0!==e?e:"",n,t)}function st(r,e,n,t){return Kr("","ul",void 0!==r?r:"",void 0!==e?e:"",n,t)}function ft(r,e,n,t){return Kr("","li",void 0!==r?r:"",void 0!==e?e:"",n,t)}function lt(r,e,n,t){return Kr("","option",void 0!==r?r:"",void 0!==e?e:"",n,t)}function vt(r,e,n,t){return Kr("","hr",void 0!==r?r:"",void 0!==e?e:"",n,t)}function dt(r){return rr(0,["className",r])}function ht(r){return rr(0,["className",Ur(" ",_r(function(r){return r[0]},Or(function(r){return r[1]})(r)))])}function pt(r){return rr(0,["placeholder",r])}function mt(r){return rr(0,["value",r])}var gt=Gr;function bt(r,e){var n,t;return t=function(r){return or(vr(e,r))},Gr("input",void 0!==(n=void 0!==r?r:"")?n:"",function(r){var e=r.target;if(void 0!==e){var n=e.value;return void 0!==n?vr(t,n):void 0}})}function wt(r,e){var n,t;return t=function(r){return or(vr(e,r))},Gr("change",void 0!==(n=void 0!==r?r:"")?n:"",function(r){var e=r.target;if(void 0!==e){var n=e.value;return void 0!==n?vr(t,n):void 0}})}function yt(r){return rr(3,["click",rr(1,[r]),{contents:void 0}])}var _t={stopPropagation:!1,preventDefault:!1},kt=(rt.at(["target",["value",0]],rt.string),rt.at(["target",["checked",0]],rt.bool),rt.field("keyCode",rt.$$int));var St={max:function(r){return rr(1,["","max",r])},min:function(r){return rr(1,["","min",r])},step:function(r){return rr(1,["","step",r])},disabled:function(r){return r?rr(1,["","disabled","true"]):0},selected:function(r){return r?rr(1,["","selected","true"]):0},acceptCharset:function(r){return rr(1,["","accept-charset",r])},rel:function(r){return rr(1,["","rel",r])}},xt=Xr,Nt=0,At=246,Ot=250,qt=ir("CamlinternalLazy.Undefined");function Rt(r){throw qt}function Ft(r){var e=0|r.tag;return e===Ot?r[0]:e!==At?r:function(r){var e,n=r[0];r[0]=Rt;try{var t=vr(n,void 0);return r[0]=t,e=Ot,r.tag=e,t}catch(e){throw r[0]=function(r){throw e},e}}(r)}function Et(r,e){return Ar(_r(e,r))}var Tt={take:function(r,e){var n=function(r,e,n){for(;;){var t=e;if(0===n)return[r,t];if(!t)return[r,0];n=n-1|0,e=t[1],r=[t[0],r]}}(0,e,r);return[wr(n[0]),n[1]]},apply:function(r,e){return vr(e,r)},bind:Et,concat_map:function(r,e){return Ar(_r(r,e))},$great$great$eq:Et,next_or_this_item:function(r,e){for(var n=e;;){if(!n)return r;var t=n[1];if(m(r,n[0]))return t?t[0]:r;n=t}},count:function(r,e){for(var n=0,t=e;;){var a=n;if(!t)return a;var i=t[1];vr(r,t[0])?(t=i,n=a+1|0):t=i}},list_from_option:function(r){return void 0!==r?[cr(r),0]:0},first_inconsistent_opt:function(r,e){if(r)for(var n=vr(e,r[0]),t=r[1];;){var a=t,i=n;if(!a)return;var u=vr(e,a[0]);if(!m(u,i))return[i,u];t=a[1],n=u}}};function Ct(r,e,n){return gt(r,e,function(r){return _t.stopPropagation&&r.stopPropagation(),_t.preventDefault&&r.preventDefault(),(e=rt.decodeEvent(n,r)).tag?void 0:or(e[0]);var e})}var Mt={keydown:function(r,e,n){var t=rt.field("ctrlKey",rt.bool),a=rt.map2(function(r,e){return{ctrlKey:e,keyCode:r}},kt,t);return Ct("keydown",r,rt.andThen(function(r){return vr(n,r)?rt.succeed(e):rt.fail("Incorrect keys")},a))}},Lt={on_keyed:Ct,Keydown:Mt};function It(r,e){return e.tag?e:rr(0,[vr(r,e[0])])}function Pt(r){return r.tag?r:r[0]}function Dt(r,e){return Pt(It(e,r))}var $t={map:It,map_error:function(r,e){return e.tag?rr(1,[vr(r,e[0])]):e},flatten:Pt,flat_map:function(r,e){return Pt(It(r,e))},bind:Dt,$great$great$eq:Dt};function Bt(r){return[r,0]}function Ut(e,r){if(!r)return 0;var n=r[1];return[vr(e,r[0]),i(function(r){return Ut(e,Ft(n))})]}function Vt(r,e){if(!r)return Ft(e);var n=r[1];return[r[0],i(function(r){return Vt(Ft(e),n)})]}function Jt(r){if(!r)return 0;var e=r[1];return Vt(r[0],i(function(r){return Jt(Ft(e))}))}function Qt(r,e){return Jt(Ut(e,r))}var Wt={$$return:Bt,unit:Bt,push:function(r,e){return[r,e]},map:Ut,filter:function n(t,r){for(;;){if(!r)return 0;var e=r[1],a=r[0];if(vr(t,a))return[a,i(function(e){return function(r){return n(t,Ft(e))}}(e))];r=Ft(e)}},interleave_delayed:Vt,append_delayed:function e(r,n){if(!r)return Ft(n);var t=r[1];return[r[0],i(function(r){return e(Ft(t),n)})]},flatten:Jt,bind:Qt,$great$great$eq:Qt,from_list:function e(r){if(!r)return 0;var n=r[1];return[r[0],i(function(r){return e(n)})]},from_option:function(r){return void 0!==r?[cr(r),0]:0}};function Zt(r,e){return[L(We([rr(2,[0,rr(4,[0,0,0,0])]),"%s%d"]),r[0],e)]}function jt(r){return vr(We([rr(12,[63,rr(2,[0,0])]),"?%s"]),r[0])}var zt={compare:function(r,e){return h(r[0],e[0])},make:function(r){return[r]},make_numbered:Zt,to_string:jt};function Ht(r,e){return h(r[0],e[0])}function Xt(r,e){return r[0]===e[0]}var Kt={make:function(r){return[r]},compare:Ht,equals:Xt,to_string:function(r){return r[0]}};function Gt(r){if(!r.tag)return jt(r[0]);var e=r[0],n=e.related_terms,t=e.relation_name[0];return n?L(We([rr(2,[0,rr(12,[40,rr(2,[0,rr(12,[41,0])])])]),"%s(%s)"]),t,Ur(", ",_r(Gt,n))):t}function Yt(r){if(!r.tag)return 0;var e=r[0],n=e.related_terms;return[[e.relation_name,gr(n)],Tt.concat_map(Yt,n)]}var ra={make_relation:function(r,e){return rr(1,[{relation_name:[r],related_terms:e}])},make_variable:function(r){return rr(0,[[r]])},to_string:Gt,relation_arities:Yt};function ea(r){switch(0|r.tag){case 0:return Gt(r[0]);case 1:return L(We([rr(12,[60,rr(2,[0,rr(11,[" = ",rr(2,[0,rr(12,[62,0])])])])]),"<%s = %s>"]),Gt(r[0]),Gt(r[1]));case 2:return L(We([rr(12,[60,rr(2,[0,rr(11,[" /= ",rr(2,[0,rr(12,[62,0])])])])]),"<%s /= %s>"]),Gt(r[0]),Gt(r[1]))}}function na(r){switch(0|r.tag){case 0:return Yt(r[0])}return Ar([Yt(r[0]),[Yt(r[1]),0]])}var ta={to_string:ea,relation_arities:na};function aa(r){return Ur(" and ",_r(ea,r))}var ia={empty:0,to_string:aa},ua=Nn(zt),oa=ua.empty;function ca(r,e){return I(ua.add,r[0],r[1],e)}function sa(r,e){var n=L(ua.find_opt,r,e);if(void 0!==n){if(n.tag)return n;var t=sa(n[0],e);return void 0!==t?t:n}}function fa(r,n){function t(r){var e=sa(r,n);return void 0!==e?i(e):rr(0,[["?"]])}var a=function(r,e){if(e.tag)return Sr(a,r,e[0].related_terms);var n=e[0];return ca([n,t(n)],r)},i=function(r){if(!r.tag)return t(r[0]);var e=r[0];return rr(1,[{relation_name:e.relation_name,related_terms:_r(i,e.related_terms)}])};return vr(ua.bindings,Sr(function(r,e){switch(0|e.tag){case 0:return a(r,e[0])}return a(a(r,e[0]),e[1])},oa,r))}function la(r,a,i){var u=function(r){for(;;){var e=r;if(e.tag)return function(r,e){for(;;){var n=e;if(!n)return!1;if(vr(r,n[0]))return!0;e=n[1]}}(u,e[0].related_terms);var n=e[0];if(m(n,a))return!0;var t=sa(n,i);if(void 0===t)return!1;r=t}};return u(r)}var va={FrameMap:ua,empty:oa,extend:ca,lookup:sa,instantiate:function(t){var a=function(r){if(!r.tag){var e=sa(r[0],t);return void 0!==e?a(e):rr(0,[["?"]])}var n=r[0];return rr(1,[{relation_name:n.relation_name,related_terms:_r(a,n.related_terms)}])};return a},variable_bindings_in_query:fa,to_strings:function(r,e){var n=fa(r,e);return n?_r(function(r){return L(We([rr(2,[0,rr(11,[" := ",rr(2,[0,0])])]),"%s := %s"]),jt(r[0]),Gt(r[1]))},n):0},term_depends_on_variable:la};function da(r){var e,n,t=r.antecedents,a=Gt(r.consequent);return n=t?(e=aa(t),L(We([rr(2,[0,rr(11,[" when ",rr(2,[0,0])])]),"%s when %s"]),a,e)):a,vr(We([rr(2,[0,rr(12,[46,0])]),"%s."]),n)}function ha(r){return Ar([yr(_r(na,r.antecedents)),[Yt(r.consequent),0]])}var pa={contents:0};function ma(r){if(!r.tag)return rr(0,[Zt(r[0],pa.contents)]);var e=r[0],n=_r(ma,e.related_terms);return rr(1,[{relation_name:e.relation_name,related_terms:n}])}function ga(r){switch(0|r.tag){case 0:return rr(0,[ma(r[0])]);case 1:return rr(1,[ma(r[0]),ma(r[1])]);case 2:return rr(2,[ma(r[0]),ma(r[1])])}}function ba(r){return pa.contents=pa.contents+1|0,{antecedents:_r(ga,r.antecedents),consequent:ma(r.consequent)}}var wa={to_string:da,relation_arities:ha,rename_rule_variables:ba},ya=Nn({compare:Qr});function _a(r){return r.rule}function ka(r,e){return r.id===e.id}var Sa={all_rules:0,indexed_by_consequent_relation:ya.empty};function xa(r,e){var n,t;return t=e.tag?void 0!==(n=L(ya.find_opt,e[0].relation_name[0],r.indexed_by_consequent_relation))?n:0:r.all_rules,Wt.from_list(wr(t))}function Na(r){return wr(r.all_rules)}var Aa={contents:1};function Oa(r,e){var n={id:(Aa.contents=Aa.contents+1|0,Aa.contents),rule:e},t=e.consequent;return t.tag?{all_rules:[n,r.all_rules],indexed_by_consequent_relation:I(ya.update,t[0].relation_name[0],function(r){return void 0!==r?[n,r]:[n,0]},r.indexed_by_consequent_relation)}:{all_rules:[n,r.all_rules],indexed_by_consequent_relation:r.indexed_by_consequent_relation}}var qa,Ra={VariableName:zt,RelationName:Kt,Term:ra,ComplexTerm:ta,Query:ia,Frame:va,Rule:wa,RuleDatabase:{empty:Sa,rule_from_entry:_a,identifier_of_rule_entry:function(r){return vr(We([rr(4,[0,0,0,0]),"%d"]),r.id)},update_rule_entry:function(r,e){return console.log(vr(We([rr(11,["Update rule entry: ",rr(2,[0,0])]),"Update rule entry: %s"]),da(e))),{id:r.id,rule:e}},is_same:ka,remove_rule:function(r,e){var n=e.id,t=Or(function(r){return r.id!==n}),a=vr(t,r.all_rules),i=e.rule.consequent;return i.tag?{all_rules:a,indexed_by_consequent_relation:I(ya.update,i[0].relation_name[0],function(r){return void 0!==r?vr(t,r):0},r.indexed_by_consequent_relation)}:{all_rules:a,indexed_by_consequent_relation:r.indexed_by_consequent_relation}},add_rule:Oa,update_rule:function(r,e){function n(r){return _r(function(r){return r.id===e.id?e:r},r)}var t=n(r.all_rules);console.log(vr(We([rr(11,["Updating rule in database: ",rr(2,[0,0])]),"Updating rule in database: %s"]),da(e.rule)));var a=e.rule.consequent;return a.tag?{all_rules:t,indexed_by_consequent_relation:I(ya.update,a[0].relation_name[0],function(r){return void 0!==r?n(r):[e,0]},r.indexed_by_consequent_relation)}:{all_rules:t,indexed_by_consequent_relation:r.indexed_by_consequent_relation}},fetch_for_query:xa,all_rules:Na}},Fa={$$Map:qa=Nn({compare:Ht}),make:function(n,r){return Sr(function(r,e){return I(qa.update,vr(n,e),function(r){return void 0!==r?[e,r]:[e,0]},r)},qa.empty,r)},keys:function(r){return _r(function(r){return r[0]},vr(qa.bindings,r))},find_opt:function(r,e){return L(qa.find_opt,r,e)}};function Ea(a,r){return Sr(function(r,e){var n=vr(a,e);if(void 0===n)return r;var t=Tt.first_inconsistent_opt(n,function(r){return r[1]});return void 0!==t?[I(We([rr(11,["Relation '",rr(2,[0,rr(11,["' has inconsistent number of terms applied of ",rr(4,[0,0,0,rr(11,[" and ",rr(4,[0,0,0,0])])])])])]),"Relation '%s' has inconsistent number of terms applied of %d and %d"]),e[0],t[0],t[1]),r]:r},0,r)}function Ta(r){return L(Fa.make,function(r){return r[0]},Tt.concat_map(ha,r))}function Ca(r){return vr(Fa.keys,L(Fa.make,function(r){return r[0]},ha(r)))}function Ma(r,e){var n=Ta([e,_r(_a,r)]);return Ea(function(r){return L(Fa.find_opt,r,n)},Ca(e))}var La={rule_database_snapshot:Na,issues_in_existing_rule:function(r,e){var n=Ta(_r(_a,[e,Or(function(r){return!ka(r,e)})(r)]));return Ea(function(r){return L(Fa.find_opt,r,n)},Ca(_a(e)))},issues_in_new_rule:Ma,issues_in_query:function(r,e){var n=Tt.concat_map(na,e),t=L(Fa.make,function(r){return r[0]},Ar([n,[Tt.concat_map(ha,_r(_a,r)),0]]));return Ea(function(r){return L(Fa.find_opt,r,t)},vr(Fa.keys,L(Fa.make,function(r){return r[0]},n)))}};function Ia(r){function e(r){return kn(mn,t,r)}function n(r){return Ge(a,e,r)}var t=on(95),a=vr(We([rr(2,[0,rr(11,[" requires ",rr(2,[0,0])])]),"%s requires %s"]),r);return function(r){return _n(n,function(e){return rn(function(r){return Ur("",_r(function(r){return $r(1,r)},[e,r]))},tn(nn([mn,[hn,[on(95),[on(45),0]]]])))},r)}}var Pa=Sn(on(63),rn(function(r){return rr(0,[[r]])},Ia("Variable")));function Da(r){return Ye("Variable starting with ?",Pa,r)}var $a=Sn(bn("= "),function(r){return Ke(!0,r)}),Ba=Sn(bn("/= "),function(r){return Ke(!1,r)});function Ua(r){return kn($a,Ba,r)}function Va(r){return an(r,Sn(Sn(gn,bn("and")),gn))}function Ja(r){return kn(Da,Wa,r)}function Qa(r){return _n(Sn(on(60),Ja),function(t){return function(r){return _n(Ua,function(n){var e=xn(Ja,on(62));return function(r){return _n(e,function(r){var e=rr(n?1:2,[t,r]);return function(r){return Ke(e,r)}},r)}},r)}},r)}function Wa(r){return _n(xn(Ia("Relation"),gn),function(r){var e=[r],n=rr(1,[{relation_name:e,related_terms:0}]),t=xn(on(40),gn);return function(r){return Xe(t,function(r){return rn(function(r){return rr(1,[{relation_name:e,related_terms:r}])},xn(xn(Za,gn),on(41)))},n,r)}},r)}function Za(r){return an(xn(Ja,gn),Sn(on(44),gn))(r)}function ja(r){return kn(rn(function(r){return rr(0,[r])},Ja),Qa,r)}function za(r){return Va(ja)(r)}function Ha(r){return xn(function(r){return _n(Ja,function(e){function n(r){return Ke(t,r)}var t={antecedents:0,consequent:e},a=rn(function(r){return{antecedents:r,consequent:e}},Sn(Sn(Sn(gn,bn("when")),gn),za));return function(r){return kn(a,n,r)}},r)},on(46))(r)}var Xa={rule_parser:Ha,query_parser:function(r){return Va(ja)(r)},rule_database_result_from_rule_strings:function(r){return Sr(function(r,e){return $t.flat_map(function(t){return $t.flat_map(function(r){var e=r.result,n=Ma(Na(t),e);return 0<gr(n)?rr(1,[n]):rr(0,[Oa(t,e)])},$t.map_error(function(r){return _r(je,r)},yn(Ha,e)))},r)},rr(0,[Sa]),r)}};function Ka(r){var e=function(r,e){for(var n=0,t=0,a=e;;){var i=a,u=t,o=n;if(!i)return[br(o,0),br(u,0)];var c=i[1],s=i[0];vr(r,s)?(a=c,n=[s,o]):(a=c,t=[s,u])}}(function(r){switch(0|r.tag){case 0:case 1:return!1;case 2:return!0}},r);return Ar([e[1],[e[0],0]])}function Ga(o,r){function c(r,e){for(;;){var n=r;if(!n)return e;e=t(n[0],e),r=n[1]}}var t=function(r,e){switch(0|r.tag){case 0:var a=r[0];return Wt.$great$great$eq(e,function(t){return Wt.$great$great$eq(xa(o,a),function(r){var e=ba(_a(r)),n=s(a,e.consequent,t);return void 0!==n?c(e.antecedents,Wt.$$return({frame:n.frame,rules_applied:[r,n.rules_applied]})):0})});case 1:var n=r[1],t=r[0];return Wt.$great$great$eq(e,function(r){return Wt.from_option(s(t,n,r))});case 2:var i=r[1],u=r[0];return Wt.$great$great$eq(e,function(r){return void 0!==s(u,i,r)?0:Wt.$$return(r)})}},s=function(r,e,n){if(m(r,e))return n;if(!r.tag)return i(r[0],e,n);var t=r[0];if(!e.tag)return i(e[0],r,n);var a=e[0];return Xt(t.relation_name,a.relation_name)?Sr(function(r,e){if(void 0!==r)return s(e[0],e[1],r)},n,xr(t.related_terms,a.related_terms)):void 0},i=function(r,e,n){var t=sa(r,n.frame);if(void 0!==t)return s(t,e,n);if(e.tag)return la(e,r,n.frame)?void 0:{frame:ca([r,e],n.frame),rules_applied:n.rules_applied};var a=sa(e[0],n.frame);return void 0!==a?s(rr(0,[r]),a,n):{frame:ca([r,e],n.frame),rules_applied:n.rules_applied}},e=Ka(r);return function(r){return c(e,r)}}var Ya={query:function(r,e){return Ga(r,e)(Wt.$$return({frame:oa,rules_applied:0}))}};function ri(r){var e=function r(e){if(!e)return rr(0,[0]);var n=e[1],t=e[0];if(!n)return t.tag?t:rr(0,[[t[0],0]]);if(t.tag)return t;var a=r(n);return a.tag?a:rr(0,[[t[0],a[0]]])}(_r(function(r){return yn(Xa.query_parser,r)},_r(function(r){return r[0]},r.queries)));return e.tag?(console.error(e[0]),0):xr(_r(ze,e[0]),_r(function(r){return r[1]},r.queries))}var ei=[{name:"Simple Facts",rule_instructions:["FACTs are unconditionally true statements. As soon as a fact is entered into the database it is known to be true. \n        A Fact can relate other terms together or it can stand on its own. In this chapter we show just simple facts that stand on their own.",["A Fact is represented as an identifier written in any case. Spaces cannot be used inside Fact names but underscores can be.",["Click the <Query> button to explore the queries that can be written against this simple database.",0]]],rules:["OrangesAreSpherical.",["oranges_are_spherical.",["SoccerBallsAreSpherical.",["soccerBalls_ARE_spherical.",0]]]],queries:[["SoccerBallsAreSpherical",["This query just asks whether the fact is found in the database. Execute this query to reveal that this fact is found in the database."]],[["FootballsAreSpherical",["Try this query. Observe that no solution was found because the fact is not in the database."]],0]]},[{name:"Facts as Predicates",rule_instructions:["Facts can also express the truth of a _relationship_ between things. A Fact that expresses a relationship with a single term can be viewed as a declaration of \n            inclusion in a Set (a Predicate). For example, the facts from the previous chapter about spherical items can be more usefully represented as predicates.",0],rules:["Spherical(Oranges).",["Spherical(SoccerBalls).",["Spherical(BasketBalls).",["Spherical(Sun).",0]]]],queries:[["Spherical(Oranges)",["This query just asks if this specific fact is in the database. It is."]],[["Spherical(FootBalls)",["Observe that this query fails to find a solution."]],0]]},[{name:"Querying with Variables",rule_instructions:["The queries in the prior chapters were pretty lame because they could only ask if very _specific_ facts were present in the database.",["To introduce a little abstraction we need variables which act as kind of wildcard placeholders for any value. Variables are written with a ? prefix.",["When a query includes a variable, the solution to the query will display the variable binding which satisfies the query.",0]]],rules:["Spherical(Oranges).",["Spherical(SoccerBalls).",["Spherical(BasketBalls).",["Spherical(Sun).",0]]]],queries:[["Spherical(?sphericalThing)",["When you execute this query you will observe multiple things: 1) the solution now includes the value of the binding and \n            2) there are now multiple solutions which can be requested with Next Solution. Logic programming environments\n            require user to explicitly ask for the Next Solution because logic programming supports INFINITE solution spaces!!!"]],0]},[{name:"Relationships",rule_instructions:["Facts can express relationships between multiple things. This child demonstrates declaration of mother-child relationships.",0],rules:["MotherOf(Sally, Bob).",["MotherOf(Sally, Janice).",["MotherOf(Sally, Debrah).",["MotherOf(Janice, Malcom).",0]]]],queries:[["MotherOf(Sally, ?childOfSally)",["This query will find all children of Sally in the database."]],[["MotherOf(?motherOfBob, Bob)",["This query will find the mother (or mothers) of Bob. NOTE: We have now seen that variables can be put in any place. That is a powerful concept we will explore later."]],[["MotherOf(?mother, ?child)",["In fact, we can use variables for both locations to get all mother-child solutions in the database."]],0]]]},[{name:"Implication (Rules)",rule_instructions:["While Facts are uncondtionally true, a RULE specifies a _conclusion_ whose truth is dependent upon one or more conditions. For example, someone is a parent of someone else if \n        we can prove that they are the mother or father. Parenthood follows from motherhood and fatherhood.",0],rules:["ParentOf(?parent, ?child) when MotherOf(?parent, ?child).",["ParentOf(?parent, ?child) when FatherOf(?parent, ?child).",["MotherOf(Sally, Janice).",["MotherOf(Sally, Debrah).",["MotherOf(Janice, Malcom).",["FatherOf(Roberto, Janice).",0]]]]]],queries:[["ParentOf(Sally, Janice)",["Here we will simply ask the database if it can prove that Sally is the parent of Janice. NOTE: The database does not explicitly declare Sally is the parent of Janice. The logic system deduced the fact from the rules given."]],[["ParentOf(?parent, Janice)",["We can also use variables in the query to find all parents of Janice."]],[["ParentOf(Sally, ?child)",["Or find all the children of Sally."]],0]]]},[{name:"Unification: Part 1",rule_instructions:["In this next example consider the definition of Siblings. Note that the variable ?parent is found in two sub-queries of ParentOf. \n        This means that the Siblings rule can only be proven true when a ParentOf can be proven for the first sibling and for the second and\n        that the parent must be able to be unified (in this case the same). This is an example of unification and it is one of most interesting powers \n        in logic programming because it can accomplish a lot work in a very subtle and succinct way.",0],rules:["ParentOf(?parent, ?child) when MotherOf(?parent, ?child).",["Siblings(?firstSibling, ?secondSibling) when ParentOf(?parent, ?firstSibling) and ParentOf(?parent, ?secondSibling).",["MotherOf(Sally, Janice).",["MotherOf(Sally, Debrah).",["MotherOf(Sally, Malcom).",0]]]]],queries:[["Siblings(Janice, Debrah)",["A yes/no style query that just asks the system to deduce whether Janice and Debrah are siblings."]],[["Siblings(?sibling, Debrah)",["Here we ask about the siblings of Debrah. OBSERVE: Debrah is her own sibling! Weird. We will explain and fix this behavior in the next Chapter."]],0]]},[{name:"Unification: Part 2",rule_instructions:["In the last chapter we saw that our definition of sibling was such that it would report that a person was their own sibling. This was because\n        we defined sibling as ANY other term in the database that has the same parent. We did not explicitly ask not to be informed when both terms were the same.",0],rules:["ParentOf(?parent, ?child) when MotherOf(?parent, ?child).",["Siblings(?firstSibling, ?secondSibling) when ParentOf(?parent, ?firstSibling) and ParentOf(?parent, ?secondSibling) and <?firstSibling /= ?secondSibling>.",["MotherOf(Sally, Janice).",["MotherOf(Sally, Debrah).",["MotherOf(Sally, Malcom).",0]]]]],queries:[["Siblings(?sibling, Debrah)",["Now we should only get other terms that have the same parent but which are not Debrah herself."]],0]},[{name:"Recursion (Genealogy)",rule_instructions:["A rule can depend upon itself recursively! This chapter demonstrates a recursive declaration for proving that something is an ancestor of another.",["As is always the case with recursion, BEWARE to always have a terminating base case. Observe that the recursive specification of AncestorOf has a ParentOf \n        sub-query which is not a reference to AncestorOf. When the ParentOf sub-query in the body of the AncestorOf rule fails the recursion terminates.",0]],rules:["ParentOf(?Mother, ?Child) when MotherOf(?Mother, ?Child).",["AncestorOf(?Ancestor, ?Descendant) when ParentOf(?Ancestor, ?Descendant).",["AncestorOf(?Ancestor, ?Descendant) when ParentOf(?ParentOfDescendant, ?Descendant) and AncestorOf(?Ancestor, ?ParentOfDescendant).",["MotherOf(Erica, Sally).",["MotherOf(Sally, Jane).",["MotherOf(Jane, Maria).",["MotherOf(Maria, Roberta).",0]]]]]]],queries:[["AncestorOf(Erica, Sally)",["Here Erica is just Sally's mother so we don't even need to use recursion"]],[["AncestorOf(Erica, Jane)",["Note that there is ONE application of the recursive rule."]],[["AncestorOf(Erica, Roberta)",["Observe that there are THREE applications of the recursive rule."]],[["AncestorOf(?ancestor, Roberta)",["Demonstrating a variable to ask for ALL ancestors of Roberta."]],[["AncestorOf(Erica, ?descendant)",["Demonstrating a variable to ask for ALL descendants of Erica."]],0]]]]]},[{name:"Linked List: Append",rule_instructions:["So far we have covered use cases that probably seem relatively natural to a database system. We are now going to\n          explore patterns that approximate general purpose programming but using an entirely declarative information based approach.",["We begin with appending two linked lists together. In this example, the N relation defines a linked-list node (abbreviated to N for reasons that become quickly apparent.)",["A node in a linked list has a value and a pointer to the next item in the list. The last node in the list typically has a null pointer in most imperative programming languages.",["Here we represent the terminating value as Empty. So an empty list is just Empty.",["A list of a single item would be N(FirstItem, Empty).",["A list of two items N(FirstItem, N(SecondItem, Empty))",["...and so on. Obviously this is a tedious way to write lists but it is still pretty amazing to consider it is possible to define list behavior with two rules.",["The AMAZING property is that this append operation can be queried from any direction just like every other query we have seen. In other languages the \n          append operation takes two INPUTs and yields an OUTPUT. In a logic programming language there are NO inputs or outputs in the specification of rules and facts. The author\n          of the query determines what is given and what is requested.",0]]]]]]]],rules:["Append(Empty, ?List, ?List).",["Append(N(?Head, ?Tail), ?RightList, N(?Head, ?Result)) when Append(?Tail, ?RightList, ?Result).",0]],queries:[["Append(N(a, N(b, N(c, Empty))), N(one, N(two, N(three, Empty))), ?Result)",["Appends a list of [a, b, c] and a list of [one, two, three]."]],[["Append(N(a, N(b, Empty)), ?right, N(a, N(b, N(c, N(d, Empty)))))",["AMAZING!!! We are asking what list would we have to add to [a, b] to get [a, b, c, d]."]],[["Append(?left, ?right, N(a, N(b, N(c, N(d, Empty)))))",["This is even crazier. We are now asking for all combinations of input that might produce the output."]],0]]]},[{name:"Linked List: Remove",rule_instructions:["This chapter illustrates how one might implement removal of all instances of an element from a list.",["The technique involves complex pattern matching, unification, recursion, and not-unifies.",["It is entirely OK if this seems hard. This example is included only to demonstrate the extent to which the declarative paradigm \n          can be stretched to implement ",0]]],rules:["Remove(?Item, Empty, Empty).",["Remove(?Item, N(?Item, ?Tail), ?RecursiveTail) when Remove(?Item, ?Tail, ?RecursiveTail).",["Remove(?Item, N(?Head, ?Tail), N(?Head, ?RecursiveTail)) when <?Item /= ?Head> and Remove(?Item, ?Tail, ?RecursiveTail).",0]]],queries:[["Remove(a, Empty, ?result)",[""]],[["Remove(a, N(a, Empty), ?result)",[""]],[["Remove(a, N(b, Empty), ?result)",[""]],[["Remove(b, N(a, N(b, N(a, Empty))), ?result)",[""]],[["Remove(cherry, N(apple, N(banana, N(cherry, N(date, N(elderberry, Empty))))), ?result)",[""]],[["Remove(x, N(x, N(o, N(x, N(o, N(x, Empty))))), ?result)",[""]],[["Remove(?whatWouldIRemove, N(x, N(o, N(x, N(o, N(x, Empty))))), N(o, N(o, Empty)))",[""]],0]]]]]]]},[{name:"Numbers: Summation",rule_instructions:["Peano numbers",0],rules:["SumOf(Zero, ?Number, ?Number).",["SumOf(Succ(?InnerLeft), ?Right, Succ(?SumOfRightAndInnerLeft)) when SumOf(?InnerLeft, ?Right, ?SumOfRightAndInnerLeft).",0]],queries:[["SumOf(Zero, Zero, ?sum)",["0 + 0"]],[["SumOf(Zero, Succ(Succ(Zero)), ?sum)",["0 + 2"]],[["SumOf(Succ(Zero), Succ(Succ(Zero)), ?sum)",["1 + 2"]],[["SumOf(Succ(Succ(Zero)), Succ(Succ(Zero)), ?sum)",["2 + 2"]],[["SumOf(Succ(Succ(Succ(Zero))), Succ(Succ(Zero)), ?sum)",["3 + 2"]],0]]]]]},[{name:"Numbers: Pretty Summation",rule_instructions:["Using aliasing to clean up summation.",0],rules:["SumOf(Zero, ?Number, ?Number).",["SumOf(Succ(?InnerLeft), ?Right, Succ(?SumOfRightAndInnerLeft)) when SumOf(?InnerLeft, ?Right, ?SumOfRightAndInnerLeft).",["PrettySum(?leftAlias, ?rightAlias, ?prettySum) when Alias(?leftAlias, ?leftStructure) and Alias(?rightAlias, ?rightStructure) and SumOf(?leftStructure, ?rightStructure, ?sumStructure) and Alias(?prettySum, ?sumStructure).",["Alias(Zero, Zero).",["Alias(One, Succ(Zero)).",["Alias(Two, Succ(Succ(Zero))).",["Alias(Three, Succ(?twoStructure)) when Alias(Two, ?twoStructure).",["Alias(Four, Succ(?threeStructure)) when Alias(Three, ?threeStructure).",["Alias(Five, Succ(?fourStructure)) when Alias(Four, ?fourStructure).",["Alias(Six, Succ(?fiveStructure)) when Alias(Five, ?fiveStructure).",["Alias(Seven, Succ(?sixStructure)) when Alias(Six, ?sixStructure).",["Alias(Eight, Succ(?sevenStructure)) when Alias(Seven, ?sevenStructure).",["Alias(Nine, Succ(?eightStructure)) when Alias(Eight, ?eightStructure).",0]]]]]]]]]]]]],queries:[["PrettySum(Two, Three, ?prettySum)",[""]],[["PrettySum(Three, Five, ?prettySum)",[""]],[["PrettySum(One, Seven, ?prettySum)",[""]],[["PrettySum(Four, Five, ?prettySum)",[""]],0]]]]},0]]]]]]]]]]]];var ni=["LitLog, short for Literate Logic programming, is a subset of Prolog with a simpler syntax and an on-line editor. \n    The goal of LitLog is to offer a path to quickly learning the basics of declarative logic programming in three lunch breaks or less.",["When Logic Programming fits the problem space, it beats other programming paradigms by orders of magnitude so it is a helpful tool to\n    have in your mental toolbox (even if an applicable problem may only arise once in a decade). It is also just neat and that alone is worth a few lunch periods.",["The act of declarative logic programming is building a knowledge database that can be queried. It is the query powers that are surprising and interesting.",["Rules & Facts are the two forms of knowledge representation. Get started by choosing the first chapter.",0]]]];function ti(r,e){return{text:vr(r,e),compilation_result:rr(0,[e])}}function ai(r,e,n){var t,a,i,u,o,c=yn(e,r);return{text:r,compilation_result:c.tag?(t=qr(Ze,c[0]))?(a=t[0],i=Or(function(r){return Ze(r,a)<=0})(t[1]),rr(1,[_r(je,[a,i])])):rr(1,[0]):(o=vr(n,u=c[0].result))?rr(1,[o]):rr(0,[u])}}function ii(r){var e=r.solution_stream;return e?{initiating_query:r.initiating_query,solution_stream:Ft(e[1]),displayed_solutions:[e[0],r.displayed_solutions]}:r}var ui={CompiledTextEditing:{empty:function(r){return{text:"",compilation_result:rr(1,[0])}},edit:ti,make:ai},ExecutingQueryInfo:{next_solution:ii},init:function(r){return{rule_database:Ra.RuleDatabase.empty,available_chapters:ei,chapter_opt:void 0,interaction_mode:0}}};var oi={viewRules:0,initiateAddRule:1,initiateEditRule:function(r){return rr(0,[r])},initiateEditQuery:function(r){return rr(1,[r])},chooseChapter:function(r){return rr(2,[r])},nextChapter:2,updateText:function(r){return rr(3,[r])},addRule:function(r){return rr(4,[r])},editRuleEntry:function(r){return rr(5,[r])},deleteRule:function(r){return rr(6,[r])},executeQuery:function(r){return rr(7,[r])},nextFrame:3};function ci(){"remove"in Element.prototype||(Element.prototype.remove=function(){this.parentNode&&this.parentNode.removeChild(this)}),function(){for(var i=0,r=["ms","moz","webkit","o"],e=0;e<r.length&&!window.requestAnimationFrame;++e)window.requestAnimationFrame=window[r[e]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[r[e]+"CancelAnimationFrame"]||window[r[e]+"CancelRequestAnimationFrame"];window.requestAnimationFrame||(window.requestAnimationFrame=function(r,e){var n=(new Date).getTime(),t=Math.max(0,16-(n-i)),a=window.setTimeout(function(){r(n+t)},t);return i=n+t,a}),window.cancelAnimationFrame||(window.cancelAnimationFrame=function(r){clearTimeout(r)})}()}function si(u,l,t,v,d,r){if(void 0===r)return function(a){function i(r){var e=vr(t,r);n.contents=ve(a,a,n.contents,e)}var n={contents:0};return{startup:function(r){le(a,d),i(v)},render_string:function(r){return Yr(vr(l,r))},handleMsg:function(r,e){var n=L(u,r,e),t=n[0];return le(a,n[1]),i(t),t},shutdown:function(r){le(a,r),n.contents=ve(a,a,n.contents,0)}}};var h=cr(r);return function(o){function a(r){var e,n,t,a,i,u;void 0!==f.contents&&(e=[vr(l,s.contents),0],t=o,a=h,i=c.contents,u=e,fe(t,a,a.childNodes,0,i,u),n=u,c.contents=n,f.contents=void 0)}function e(r){for(;0<h.childNodes.length;){var e=h.firstChild;null!==e&&h.removeChild(e)}}function i(r){var e=vr(t,r);n.contents=ve(o,o,n.contents,e)}var c={contents:0},s={contents:v},f={contents:void 0},n={contents:0};return{startup:function(r){e(),le(o,d),i(s.contents),f.contents=-1,a()},render_string:function(r){return Yr(vr(l,r))},handleMsg:function(r,e){var n=L(u,r,e),t=n[0];return s.contents=t,le(o,n[1]),void 0===f.contents&&(f.contents=-1,a()),i(t),t},shutdown:function(r){f.contents=void 0,le(o,r),n.contents=ve(o,o,n.contents,0),c.contents=0,e()}}}}function fi(r,e,n){ci();var t,a,i,u,o,c,s,f,l,v=vr(r.init,n),d=v[0],h=null==e?void 0:or(e),p=si(r.update,r.view,r.subscriptions,d,v[1],h);return t=d,a=p,i=r.shutdown,u={contents:t},c=vr(a,o={contents:{enqueue:function(r){console.log("INVALID enqueue CALL!")}}}),s={contents:void 0},l={enqueue:f=function(r){var e=s.contents;if(void 0===e){s.contents=0;var n=L(c.handleMsg,u.contents,r);u.contents=n;var t=s.contents;if(void 0!==t)return t?(s.contents=void 0,kr(f,wr(t))):void(s.contents=void 0);throw[w,"INVALID message queue state, should never be None during message processing!"]}s.contents=[r,e]}},o.contents=l,vr(c.startup,void 0),{pushMsg:f,shutdown:function(r){o.contents={enqueue:function(r){console.log("INVALID message enqueued when shut down")}};var e=vr(i,u.contents);vr(c.shutdown,e)},getHtmlString:function(r){return vr(c.render_string,u.contents)}}}function li(r){return{href:r.href,protocol:r.protocol,host:r.host,hostname:r.hostname,port:r.port,pathname:r.pathname,search:r.search,hash:r.hash,username:r.username,password:r.password,origin:r.origin}}var vi={contents:void 0};function di(i){var e;return e=function(e){vi.contents=function(r){return vr(e.enqueue,vr(i,r))};function a(r){var e;void 0!==(e=vi.contents)&&vr(e,li(document.location))}var r,n,t;return n=a,t=!(r="popstate"),window.addEventListener(r,n,t),function(r){return n=a,t=!(e="popstate"),window.removeEventListener(e,n,t);var e,n,t}},rr(1,["navigation",function(r){return vr(e,r.contents)},{contents:void 0}])}var hi="button-bar",pi="delete";function mi(r,e,n){var t=void 0===r||r;return ut(void 0,void 0,[yt(n),[St.disabled(!t),0]],[et(e),0])}function gi(r){return nt(void 0,void 0,[dt(hi),0],r)}var bi="#48a9dc",wi="\n\n        ."+String(hi)+(" {\n            padding-top: 5px; \n            padding-bottom: 5px;\n        }\n\n        button {\n            background-color: white;\n            color: #555;\n            box-shadow: 0 0 0 1px "+String(bi)+(";\n            border: none;\n            border-radius: 4px;\n            padding: 6px;\n            margin-right: 8px;\n            font-size: 14px;\n        }\n\n        button."+String(pi)+(" {\n            background-color: #f00;\n            box-shadow: 0 0 2px 2px rgba(127,0,0,.5);\n            font-weight: bold;\n            color: #fff;\n            padding-left: 8px;\n            padding-right: 8px;\n            border-radius: 4px;\n            display: inline-block;\n        }\n\n        button:active {\n            background-color: "+String(bi)+(";\n            color: white;\n        }\n\n        button:disabled {\n            background-color: #ddd;\n            color: #90adbd;\n        }\n\n        a, a:active, a:visited {\n            display: inline-block;\n            color: "+String(bi)+("\n        }\n\n        a, a:active, a:visited {\n            display: inline-block;\n            color: "+String(bi))))))+"\n        }\n    ",yi="panels",_i="panel",ki="panel-header",Si="panel-body";function xi(r,e){return nt(void 0,void 0,[dt(_i),0],[nt(void 0,void 0,[dt(ki),0],[et(r),0]),[nt(void 0,void 0,[dt(Si),0],e),0]])}var Ni="\n        div."+String(yi)+(" {\n            height: 98%;\n        }\n\n        div."+String(ki)+(" {\n            background-color: #248;\n            color: white;\n            font-weight: bold;\n            padding: 4px;\n        }   \n\n        div."+String(_i)+(" {\n            overflow-y: auto;\n            background-color: white;\n            margin-top: 5px;\n        }     \n        \n\n        @media screen and (max-width: 1023px) {\n            div."+String(_i)+(" {\n                float: left;\n                width: 99%;\n                margin-top: 10px;\n                border: solid 1px #aaa;\n            }\n        }\n\n        @media screen and (min-width: 1024px) {\n            div."+String(_i)+(" {\n                float: left;\n                margin-left: 5px;\n                margin-right: 5px;\n                width: 48%;\n                height: 98%;\n                border: solid 1px #aaa;\n            }\n        }\n\n        div."+String(Si))))))+" {\n            padding: 6px;\n        }\n    ",Ai="section";function Oi(r,e){return nt(void 0,void 0,[dt(Ai),0],[it(void 0,void 0,0,[et(r),0]),[vt(void 0,void 0,0,0),[nt(void 0,void 0,0,e),0]]])}var qi="variable",Ri="fact",Fi="relation",Ei="punctuation",Ti="query-comment",Ci="rule-application-count",Mi="rule-application-count-visible",Li="relation",Ii="rule-item",Pi="rule-used",Di="rule-display",$i="\n        ."+String(qi)+(" {\n            color: #ff0; \n            display: inline-block;\n        }\n\n        ."+String(Li)+(" {\n            display: inline-block;\n        }\n\n        ."+String(Ri)+(" {\n            color: #0f0;\n            display: inline-block;\n        }\n        \n        ."+String(Ti)+(" {\n            color: #ccc;\n            padding: 4px;\n            margin-bottom: 8px;\n        }\n\n        ."+String(Fi)+(" {\n            color: #6af;\n            font-weight: bold;\n            display: inline-block;\n        }\n\n        ."+String(Ei)+(" {\n            color: white;\n            font-weight: bold;\n        }\n\n        ."+String(Di)+(" {\n            background-color: black;\n            font-family: Consolas, monospace;\n            padding: 4px;\n        }\n\n        ."+String(Ii)+(" {\n            color: black;\n            background-color: black;\n\n            display: flex;\n            align-items: center;            \n\n            border-radius: 6px;\n            padding: 6px;\n            box-shadow: 0 0.5em 1em -0.125em rgba(10,10,10,.1), 0 0 0 1px rgba(10,10,10,.02);\n\n            margin-bottom: 12px;\n            font-size: 14px;\n        }\n\n        ."+String(Ii)+("."+String(Pi)+(" {\n            box-shadow: 0 0 2px 4px #f44;\n        }\n\n        ."+String(Ci)+(" {\n            display: inline-block;\n            visibility: hidden;\n            padding-left: 6px;\n            padding-right: 6px;\n            padding-top: 2px;\n            padding-bottom: 2px;\n            border-radius: 9px;\n            border: solid 1px #884;\n            color: black;\n            background-color: #ff8;\n            font-weight: bold;\n            font-size: 16px;\n        }\n\n        ."+String(Ci)+("."+String(Mi)))))))))))))+" {\n            visibility: visible;\n        }\n\n        ul {\n            list-style: none;\n            margin-block-start: 0;\n            margin-block-end: 0;\n        }\n    ";function Bi(r){return tt(void 0,void 0,[dt(Ei),0],[et(r),0])}function Ui(r){if(!r.tag)return tt(void 0,void 0,[dt(qi),0],[et(vr(We([rr(12,[63,rr(2,[0,0])]),"?%s"]),r[0][0])),0]);var e=r[0],n=e.related_terms,t=e.relation_name[0];return n?tt(void 0,void 0,[dt(Li),0],[tt(void 0,void 0,[dt(Fi),0],[et(t),0]),[Bi("("),[Ui(n[0]),[tt(void 0,void 0,0,_r(function(r){return tt(void 0,void 0,0,[Bi(", "),[Ui(r),0]])},n[1])),[Bi(")"),0]]]]]):tt(void 0,void 0,[dt(Ri),0],[et(t),0])}function Vi(r){switch(0|r.tag){case 0:return Ui(r[0]);case 1:return tt(void 0,void 0,0,[Ui(r[0]),[Bi("="),[Ui(r[1]),0]]]);case 2:return tt(void 0,void 0,0,[Ui(r[0]),[Bi("/="),[Ui(r[1]),0]]])}}function Ji(r){function e(r,e){return ft(void 0,void 0,0,[Bi(r),[Vi(e),0]])}var n,t,a,i=r.antecedents;return a=i?(n=i[0],st(void 0,void 0,0,(t=wr(i[1]))?Ar([[e("when ",n),0],[_r(function(r){return e("and ",r)},wr(t[1])),[[ft(void 0,void 0,0,[Bi("and "),[Vi(t[0]),[Bi("."),0]]]),0],0]]]):[ft(void 0,void 0,0,[Bi(" when "),[Vi(n),[Bi("."),0]]]),0])):Bi("."),nt(void 0,void 0,[dt(Di),0],[Ui(r.consequent),[a,0]])}function Qi(r,e){return nt(void 0,void 0,[dt(Di),0],[0!==e.length?nt(void 0,void 0,[dt(Ti),0],[et(e),0]):xt,[st(void 0,void 0,0,_r(function(r){return ft(void 0,void 0,0,[Vi(r),0])},r)),0]])}function Wi(r){var e,n,t,a,i=vr(Ra.RuleDatabase.rule_from_entry,r);return nt(void 0,void 0,[ht([[Ii,!0],[[Pi,!1],0]]),0],[ut(void 0,void 0,[yt(oi.deleteRule(r)),[dt(pi),0]],[et("X"),0]),[(n=e=void 0,t=[yt(oi.initiateEditRule(r)),0],a=[Ji(i),0],Kr("","a",void 0!==e?e:"",void 0!==n?n:"",t,a)),0]])}var Zi="language-editing",ji="errors-container",zi="editing-container",Hi="\n        input {\n            margin-left: 6px;\n        }          \n        \n        ."+String(Zi)+(" {\n            width: 96%;\n            font-family: Consolas, monospace;\n            background-color: black;\n            color: white;\n        }\n\n        ."+String(ji)+(" ul {\n            padding-left: 20px;\n            list-style: square;\n        }\n\n        ."+String(zi)+(" {\n            margin-bottom: 16px;\n        }\n\n        ."+String(ji))))+" li {\n            color: #800;\n            font-size: 14px;\n        }\n    ";function Xi(r,e,n,t,a,i){var u,o=r.compilation_result;if(o.tag)return nt(void 0,void 0,[dt(zi),0],[ct(void 0,void 0,0,[et(e),0]),[ot(void 0,void 0,[bt(void 0,oi.updateText),[dt(Zi),[pt(i),[mt(r.text),[Nt,0]]]]],0),[xt,[gi([(u=o[0])?nt(void 0,void 0,[dt(ji),0],[st(void 0,void 0,0,_r(function(r){return ft(void 0,void 0,0,[et(r),0])},u)),0]):xt,[mi(void 0,"Cancel",a),0]]),0]]]]);var c=vr(t,o[0]);return nt(void 0,void 0,[dt(zi),0],[ct(void 0,void 0,0,[et(e),0]),[ot(void 0,void 0,[bt(void 0,oi.updateText),[dt(Zi),[pt(i),[mt(r.text),[I(Lt.Keydown.keydown,r.text,c,function(r){return 13===r.keyCode&&r.ctrlKey}),0]]]]],0),[nt(void 0,void 0,0,[et(vr(We([rr(11,["(ctrl+enter to ",rr(2,[0,rr(12,[41,0])])]),"(ctrl+enter to %s)"]),n)),0]),[gi([mi(void 0,n,c),[mi(void 0,"Cancel",a),0]]),0]]]])}function Ki(n){function r(a){return nt(void 0,void 0,0,_r(function(r){return e=a,n=r,t=Tt.count(function(r){return L(Ra.RuleDatabase.is_same,r,n)},e),nt(void 0,void 0,[ht([[Ii,!0],[[Pi,0<t],0]]),0],[tt(void 0,void 0,[ht([[Ci,!0],[[Mi,0<t],0]]),0],[et(vr(We([rr(4,[0,0,0,0]),"%d"]),t)),0]),[Ji(vr(Ra.RuleDatabase.rule_from_entry,n)),0]]);var e,n,t},u))}var e,t,a,i,u=vr(Ra.RuleDatabase.all_rules,n.rule_database),o=n.interaction_mode;if("number"==typeof o)s=nt(void 0,"viewing_rules",0,[gi([ct(void 0,void 0,0,[et("Chapter:"),0]),[(a=[wt(t=e=void 0,function(e){return oi.chooseChapter(function(r,e){for(;;){var n=e;if(!n)return;var t=n[0];if(vr(r,t))return or(t);e=n[1]}}(function(r){return r.name===e},n.available_chapters))}),0],i=[lt(void 0,void 0,[St.selected(void 0===n.chapter_opt),0],[et("(select chapter)"),0]),_r(function(r){return lt(void 0,void 0,[St.selected(m(n.chapter_opt,r)),0],[et(r.name),0])},n.available_chapters)],Kr("","select",void 0!==e?e:"",void 0!==t?t:"",a,i)),[mi(void 0,"Add Rule / Fact",1),[u?mi(void 0,"Query",rr(1,[0])):xt,0]]]]),[vt(void 0,void 0,0,0),[nt(void 0,"editable_rules",0,[at(void 0,void 0,0,[et(u?"Click the rule text of any rule to edit/update that rule. Clicking X removes the rule from the database WITHOUT a prompt.":"Click <Add Rule/Fact> to start adding rules to the database."),0]),[nt(void 0,void 0,0,_r(Wi,u)),0]]),0]]]);else switch(0|o.tag){case 0:s=nt(void 0,"adding_rule",0,[Xi(o[0],"New Rule","Add Rule",oi.addRule,0,"New rule..."),[vt(void 0,void 0,0,0),[r(0),0]]]);break;case 1:var c=o[0],s=nt(void 0,"editing_rule",0,[Xi(o[1],"Editing Rule","Update Rule",function(r){return oi.editRuleEntry(L(Ra.RuleDatabase.update_rule_entry,c,r))},0,"Edit rule..."),[vt(void 0,void 0,0,0),[r([c,0]),0]]]);break;case 2:s=r(0);break;case 3:var f=o[0].solution_stream;s=r(f?f[0].rules_applied:0)}return xi("Rules and Facts",[s,0])}var Gi="solution-frame",Yi="no-solution",ru="example-query";function eu(r){function e(r){return Oi("Query",[Qi(o,""),0])}function n(r){var e=L(Ra.Frame.to_strings,o,r.frame);return nt(void 0,void 0,[dt(Gi),0],e?[it(void 0,void 0,0,[et("Satisfied With Variable Substitution(s)"),0]),[st(void 0,void 0,0,_r(function(r){return ft(void 0,void 0,0,[et(r),0])},e)),0]]:[it(void 0,void 0,0,[et("Satisfied Without Variable Sustitution"),0]),[st(void 0,void 0,0,0),0]])}var t,a,i=r.displayed_solutions,u=r.solution_stream,o=r.initiating_query;return a=i?(t=gr(i),Oi(vr(We([rr(11,["Prior Solutions (",rr(4,[0,0,0,rr(12,[41,0])])]),"Prior Solutions (%d)"]),t),[ct(void 0,void 0,0,[et("OBSERVE: Some solutions may appear more than once because there can be multiple paths to reach the same solution. LitLog does not remove duplicate solutions from the display in order to illustrate the paths / search process."),0]),_r(n,i)])):xt,nt(void 0,"executing_query",0,[u?nt(void 0,"solutions_remaining",0,[gi([mi(void 0,"Next Solution",3),[mi(void 0,"New Query",rr(1,[o])),[mi(void 0,"Cancel",0),0]]]),[e(),[Oi("Current Solution",[ct(void 0,void 0,0,[et("OBSERVE: All rules and facts applied in the discovery of the current solution are highlighted in the Rules and Facts panel with a count of the number of times the Rule/Fact was applied in the discovery of the solution."),0]),[n(u[0]),0]]),0]]]):nt(void 0,"end_of_stream",0,[gi([mi(void 0,"New Query",rr(1,[o])),[mi(void 0,"Manage Rules",0),[mi(void 0,"Next Chapter",2),0]]]),[e(),[Oi("All Solutions Found",[ct(void 0,void 0,0,[et("All of the solutions to the query have been found. Click New Query to keep experimenting in this chapter or <Next Chapter> to move on."),0]),0]),[i?xt:nt(void 0,void 0,[dt(Yi),0],[et("No Solution"),0]),0]]]]),[a,0]])}function nu(r){return nt(void 0,"instructions",0,_r(function(r){return at(void 0,void 0,0,[et(r),0])},r))}function tu(r){function e(r,e){return xi(r,[e,0])}var n,t,a,i=r.chapter_opt,u=void 0!==i?i.rule_instructions:ni,o=r.interaction_mode;if("number"==typeof o)return e("Instructions",nu(u));switch(0|o.tag){case 2:return e("Query",(n=o[0],t=r.chapter_opt,a=void 0!==t?ri(t):0,nt(void 0,"editing_query",0,[Xi(n,"Query","Execute Query",oi.executeQuery,0,"New query..."),[a?nt(void 0,void 0,0,[ct(void 0,void 0,0,[et("Example Queries. Click a query below to populate the query entry box with that query."),0]),[nt(void 0,void 0,0,_r(function(r){var e=r[0];return nt(void 0,void 0,[dt(ru),[yt(oi.updateText(vr(Ra.Query.to_string,e))),0]],[Qi(e,r[1][0]),0])},a)),0]]):xt,0]])));case 3:return e("Query",eu(o[0]));default:return e("Instructions",nu(u))}}var au=Ur(" ",["\n        html {\n            height: 100%\n        }\n\n        select {\n            font-size: 16px;\n            color: #444;\n            margin-left: 4px;\n            margin-right: 16px;\n        }\n\n        body {\n            height: 100%;\n            background-color: #eee;\n            display: flex;\n            flex-direction: column;\n            font-family: sans-serif;\n            padding: 0;\n            margin: 0;\n        }\n\n        p {\n            font-size: 14px;\n        }\n\n        h3 {\n            margin-bottom: 3px;\n        }\n    ",[wi,[Ni,["\n\n    ",[$i,[Hi,["",[" \n\n    div."+String(ru)+(" {\n        border-radius: 3px;\n        padding: 5px;\n        margin-bottom: 6px;\n        background-color: #444;\n    }\n\n    div."+String(Yi)+(" {\n        margin: 4px;\n        padding: 6px;\n        border-radius: 3px;\n        border-color: #aaa;\n        border-width: 1px;\n        border-style: solid;\n        background-color: #fcc;\n    }\n\n    div."+String(Gi)+(" {\n        margin: 4px;\n        padding: 4px;\n        border-radius: 3px;\n        border-color: #aaa;\n        border-width: 1px;\n        border-style: solid;\n        background-color: #cfc;\n    }\n\n    div."+String(Gi))))+" > h3 {\n        font-size: 16px;\n        font-weight: bold;\n        margin: 4px;\n    }\n    \n    ",0]]]]]]]]);var iu,uu,ou,cu=(iu=function(r){return oi.viewRules},ou={init:function(r){return L(uu.init,r,li(document.location))},update:(uu={init:function(r,e){return[ui.init(void 0),0]},update:function(r,e){function n(r,e){var n=Xa.rule_database_result_from_rule_strings(e.rules);return n.tag?(console.error(n[0]),r):n[0]}var t,a=r.interaction_mode,i=r.rule_database;if("number"==typeof e)switch(e){case 0:c={rule_database:r.rule_database,available_chapters:r.available_chapters,chapter_opt:r.chapter_opt,interaction_mode:0};break;case 1:c={rule_database:r.rule_database,available_chapters:r.available_chapters,chapter_opt:r.chapter_opt,interaction_mode:rr(0,[{text:"",compilation_result:rr(1,[0])}])};break;case 2:var u=r.chapter_opt,o=void 0!==u?(t=u,Tt.next_or_this_item(t,ei)):function(r){if(r)return r[0];throw[w,"hd"]}(ei),c={rule_database:n(i,o),available_chapters:r.available_chapters,chapter_opt:o,interaction_mode:0};break;case 3:c="number"==typeof a||3!==a.tag?r:{rule_database:r.rule_database,available_chapters:r.available_chapters,chapter_opt:r.chapter_opt,interaction_mode:rr(3,[ii(a[0])])}}else switch(0|e.tag){case 0:var s=e[0],f=vr(Ra.RuleDatabase.rule_from_entry,s);c={rule_database:r.rule_database,available_chapters:r.available_chapters,chapter_opt:r.chapter_opt,interaction_mode:rr(1,[s,ti(Ra.Rule.to_string,f)])};break;case 1:c={rule_database:r.rule_database,available_chapters:r.available_chapters,chapter_opt:r.chapter_opt,interaction_mode:rr(2,[ti(Ra.Query.to_string,e[0])])};break;case 2:var l=e[0];c={rule_database:void 0!==l?n(i,l):Ra.RuleDatabase.empty,available_chapters:r.available_chapters,chapter_opt:l,interaction_mode:0};break;case 3:var v=e[0],d=La.rule_database_snapshot(i);if("number"==typeof a)c=r;else switch(0|a.tag){case 0:c={rule_database:r.rule_database,available_chapters:r.available_chapters,chapter_opt:r.chapter_opt,interaction_mode:rr(0,[ai(v,Xa.rule_parser,function(r){return La.issues_in_new_rule(d,r)})])};break;case 1:var h=a[0];c={rule_database:r.rule_database,available_chapters:r.available_chapters,chapter_opt:r.chapter_opt,interaction_mode:rr(1,[h,ai(v,Xa.rule_parser,function(r){return La.issues_in_existing_rule(d,L(Ra.RuleDatabase.update_rule_entry,h,r))})])};break;case 2:c={rule_database:r.rule_database,available_chapters:r.available_chapters,chapter_opt:r.chapter_opt,interaction_mode:rr(2,[ai(v,Xa.query_parser,function(r){return La.issues_in_query(d,r)})])};break;case 3:c=r}break;case 4:c={rule_database:L(Ra.RuleDatabase.add_rule,i,e[0]),available_chapters:r.available_chapters,chapter_opt:r.chapter_opt,interaction_mode:rr(0,[{text:"",compilation_result:rr(1,[0])}])};break;case 5:c={rule_database:L(Ra.RuleDatabase.update_rule,i,e[0]),available_chapters:r.available_chapters,chapter_opt:r.chapter_opt,interaction_mode:0};break;case 6:c={rule_database:L(Ra.RuleDatabase.remove_rule,i,e[0]),available_chapters:r.available_chapters,chapter_opt:r.chapter_opt,interaction_mode:r.interaction_mode};break;case 7:var p=e[0],m=Ya.query(i,p);c={rule_database:r.rule_database,available_chapters:r.available_chapters,chapter_opt:r.chapter_opt,interaction_mode:rr(3,[{initiating_query:p,solution_stream:m,displayed_solutions:0}])}}return[c,0]},view:function(r){return e=[Ki(r),[tu(r),0]],nt(void 0,void 0,[dt(yi),0],e);var e},subscriptions:function(r){return 0},shutdown:function(r){return 0}}).update,view:uu.view,subscriptions:function(r){return rr(0,[[di(iu),[vr(uu.subscriptions,r),0]]])},shutdown:uu.shutdown},function(r,e){return fi(ou,r,e)});return r.main=function(r,e){var n=document.createElement("style");return document.head.appendChild(n),n.innerHTML=au,L(cu,r,void 0)},r}({});
