var starter=function(r){"use strict";var n=["Failure",-2],e=["Invalid_argument",-3],t=["Division_by_zero",-5],a=["Not_found",-6],u=["Match_failure",-7],i=["Assert_failure",-10];function o(r,n,e){for(var t=new Array(e),a=0,u=n;a<e;)t[a]=r[u],a=a+1|0,u=u+1|0;return t}function c(r,n){if(n<0||n>=r.length)throw[e,"index out of bounds"];return r[n]}function f(r,n){for(;;){var e=n,t=r,a=t.length,u=0===a?1:a,i=u-e.length|0;if(0===i)return t.apply(null,e);if(i>=0)return function(r,n){return function(e){return f(r,n.concat([e]))}}(t,e);n=o(e,u,0|-i),r=t.apply(null,o(e,0,u))}}function s(r,n){var e=r.length;if(1===e)return r(n);switch(e){case 1:return r(n);case 2:return function(e){return r(n,e)};case 3:return function(e,t){return r(n,e,t)};case 4:return function(e,t,a){return r(n,e,t,a)};case 5:return function(e,t,a,u){return r(n,e,t,a,u)};case 6:return function(e,t,a,u,i){return r(n,e,t,a,u,i)};case 7:return function(e,t,a,u,i,o){return r(n,e,t,a,u,i,o)};default:return f(r,[n])}}function v(r,n,e){var t=r.length;if(2===t)return r(n,e);switch(t){case 1:return f(r(n),[e]);case 2:return r(n,e);case 3:return function(t){return r(n,e,t)};case 4:return function(t,a){return r(n,e,t,a)};case 5:return function(t,a,u){return r(n,e,t,a,u)};case 6:return function(t,a,u,i){return r(n,e,t,a,u,i)};case 7:return function(t,a,u,i,o){return r(n,e,t,a,u,i,o)};default:return f(r,[n,e])}}function l(r,n,e,t){var a=r.length;if(3===a)return r(n,e,t);switch(a){case 1:return f(r(n),[e,t]);case 2:return f(r(n,e),[t]);case 3:return r(n,e,t);case 4:return function(a){return r(n,e,t,a)};case 5:return function(a,u){return r(n,e,t,a,u)};case 6:return function(a,u,i){return r(n,e,t,a,u,i)};case 7:return function(a,u,i,o){return r(n,e,t,a,u,i,o)};default:return f(r,[n,e,t])}}function d(r,n,e,t,a){var u=r.length;if(4===u)return r(n,e,t,a);switch(u){case 1:return f(r(n),[e,t,a]);case 2:return f(r(n,e),[t,a]);case 3:return f(r(n,e,t),[a]);case 4:return r(n,e,t,a);case 5:return function(u){return r(n,e,t,a,u)};case 6:return function(u,i){return r(n,e,t,a,u,i)};case 7:return function(u,i,o){return r(n,e,t,a,u,i,o)};default:return f(r,[n,e,t,a])}}function h(r,n,e,t,a,u){var i=r.length;if(5===i)return r(n,e,t,a,u);switch(i){case 1:return f(r(n),[e,t,a,u]);case 2:return f(r(n,e),[t,a,u]);case 3:return f(r(n,e,t),[a,u]);case 4:return f(r(n,e,t,a),[u]);case 5:return r(n,e,t,a,u);case 6:return function(i){return r(n,e,t,a,u,i)};case 7:return function(i,o){return r(n,e,t,a,u,i,o)};default:return f(r,[n,e,t,a,u])}}function m(r,n,e,t,a,u,i){var o=r.length;if(6===o)return r(n,e,t,a,u,i);switch(o){case 1:return f(r(n),[e,t,a,u,i]);case 2:return f(r(n,e),[t,a,u,i]);case 3:return f(r(n,e,t),[a,u,i]);case 4:return f(r(n,e,t,a),[u,i]);case 5:return f(r(n,e,t,a,u),[i]);case 6:return r(n,e,t,a,u,i);case 7:return function(o){return r(n,e,t,a,u,i,o)};default:return f(r,[n,e,t,a,u,i])}}function g(r,n,e,t,a,u,i,o){var c=r.length;if(7===c)return r(n,e,t,a,u,i,o);switch(c){case 1:return f(r(n),[e,t,a,u,i,o]);case 2:return f(r(n,e),[t,a,u,i,o]);case 3:return f(r(n,e,t),[a,u,i,o]);case 4:return f(r(n,e,t,a),[u,i,o]);case 5:return f(r(n,e,t,a,u),[i,o]);case 6:return f(r(n,e,t,a,u,i),[o]);case 7:return r(n,e,t,a,u,i,o);default:return f(r,[n,e,t,a,u,i,o])}}function p(r,n,e,t,a,u,i,o,c){var s=r.length;if(8===s)return r(n,e,t,a,u,i,o,c);switch(s){case 1:return f(r(n),[e,t,a,u,i,o,c]);case 2:return f(r(n,e),[t,a,u,i,o,c]);case 3:return f(r(n,e,t),[a,u,i,o,c]);case 4:return f(r(n,e,t,a),[u,i,o,c]);case 5:return f(r(n,e,t,a,u),[i,o,c]);case 6:return f(r(n,e,t,a,u,i),[o,c]);case 7:return f(r(n,e,t,a,u,i,o),[c]);default:return f(r,[n,e,t,a,u,i,o,c])}}function b(r,n){return n.tag=r,n}function w(r,n){return r<n?-1:r===n?0:1}function _(r,n){return r===n?0:r<n?-1:1}n.tag=248,e.tag=248,t.tag=248,a.tag=248,u.tag=248,i.tag=248;var y=function(r,n){for(var e in r)n(e)};function k(r){var n=[r];return n.tag=246,n}function x(r,n){for(;;){var t=n,a=r;if(a===t)return!0;var u=typeof a;if("string"===u||"number"===u||"boolean"===u||"undefined"===u||null===a)return!1;var i=typeof t;if("function"===u||"function"===i)throw[e,"equal: functional value"];if("number"===i||"undefined"===i||null===t)return!1;var o=0|a.tag,c=0|t.tag;if(250!==o)if(250!==c){if(248===o)return a[1]===t[1];if(251===o)throw[e,"equal: abstract value"];if(o!==c)return!1;if(256===o)return a[1]===t[1];var f=0|a.length;if(f!==(0|t.length))return!1;if(!Array.isArray(a)){if(a instanceof Date&&t instanceof Date)return!(a>t||a<t);var s={contents:!0},v=function(r,n){return function(e){r.hasOwnProperty(e)||(n.contents=!1)}}(t,s),l=function(r,n,e){return function(t){r.hasOwnProperty(t)&&x(n[t],r[t])||(e.contents=!1)}}(a,t,s);return y(a,v),s.contents&&y(t,l),s.contents}for(var d=0;;){var h=d;if(h===f)return!0;if(!x(a[h],t[h]))return!1;d=h+1|0}}else n=t[0];else r=a[0]}}function q(r,n){return!x(r,n)}function F(r){if(r<0)throw[e,"String.create"];for(var n=new Array(r),t=0;t<r;++t)n[t]=0;return n}function S(r,n,e,t,a){if(!(a<=0))if(r!==e){var u=r.length-n|0;if(a<=u)for(var i=0;i<a;++i)e[t+i|0]=r[n+i|0];else{for(var o=0;o<u;++o)e[t+o|0]=r[n+o|0];for(var c=u;c<a;++c)e[t+c|0]=0}}else{if(n<t){for(var f=(r.length-t|0)-1|0,s=a-1|0,v=f>s?s:f;v>=0;--v)r[t+v|0]=r[n+v|0];return}if(n<=t)return;for(var l=(r.length-n|0)-1|0,d=a-1|0,h=l>d?d:l,m=0;m<=h;++m)r[t+m|0]=r[n+m|0]}}function N(r){var n=r.length,e="",t=n;if(n<=4096&&n===r.length)return String.fromCharCode.apply(null,r);for(var a=0;t>0;){var u=t<1024?t:1024,i=new Array(u);S(r,a,i,0,u),e+=String.fromCharCode.apply(null,i),t=t-u|0,a=a+u|0}return e}function C(r,n,e,t,a){if(!(a<=0)){var u=r.length-n|0;if(a<=u)for(var i=0;i<a;++i)e[t+i|0]=r.charCodeAt(n+i|0);else{for(var o=0;o<u;++o)e[t+o|0]=r.charCodeAt(n+o|0);for(var c=u;c<a;++c)e[t+c|0]=0}}}function A(r){for(var n=r.length,e=new Array(n),t=0;t<n;++t)e[t]=r.charCodeAt(t);return e}var M=Math.imul||function(r,n){return((r>>16)*(n|=0)<<16)+(65535&r)*n|0};function R(r,n){return[n,r>>>0]}var L=[-2147483648,0],O=[2147483647,4294967295],D=[0,1],T=[0,0],$=[-1,4294967295];function E(r){return 0!=(2147483648&r)}function P(r){return 0==(2147483648&r)}function I(r){var n=1+(-1^r[1])|0;return R(n,(-1^r[0])+(0===n?1:0)|0)}function V(r,n,e){var t=r[1],a=t+n|0,u=E(t)&&(E(n)||P(a))||E(n)&&P(a)?1:0;return R(a,r[0]+e+u|0)}function B(r,n){return V(r,n[1],n[0])}function U(r,n){return r[0]===n[0]&&r[1]===n[1]}function Q(r,n,e){var t=1+(-1^n)>>>0;return V(r,t,(-1^e)+(0===t?1:0)|0)}function j(r,n){return Q(r,n[1],n[0])}function z(r,n){if(0===n)return r;var e=r[1];return n>=32?R(0,e<<(n-32|0)):R(e<<n,e>>>(32-n|0)|r[0]<<n)}function X(r,n){if(0===n)return r;var e=r[0];return n<32?R(e<<(32-n|0)|r[1]>>>n,e>>n):R(e>>(n-32|0),e>=0?0:-1)}function K(r,n){for(;;){var e,t=n,a=r,u=0,i=0;if(0!==a[0])i=3;else{if(0===a[1])return T;i=3}if(3===i)if(0!==t[0])u=2;else{if(0===t[1])return T;u=2}if(2===u){var o=a[0],c=0;if(-2147483648!==o||0!==a[1]?c=3:e=t[1],3===c){var f=t[0],s=a[1],v=0;if(-2147483648!==f||0!==t[1]?v=4:e=s,4===v){var l=t[1];if(o<0){if(f>=0)return I(K(I(a),t));n=I(t),r=I(a);continue}if(f<0)return I(K(a,I(t)));var d=65535&o,h=s>>>16,m=65535&s,g=65535&f,p=l>>>16,b=65535&l,w=0,_=0,y=0,k=m*b;return w=(_=(_=(y=(k>>>16)+h*b)>>>16)+((y=(65535&y)+m*p)>>>16)+d*b)>>>16,w+=(_=(65535&_)+h*p)>>>16,w+=(_=(65535&_)+m*g)>>>16,R(65535&k|(65535&y)<<16,(_&=65535)|(w=w+((o>>>16)*b+d*p+h*g+m*(f>>>16))&65535)<<16)}}}return 0==(1&e)?T:L}}function G(r,n){var e=n[0],t=r[0];return t>e||!(t<e)&&r[1]>=n[1]}function J(r,n){return!U(r,n)}function H(r,n){return!G(r,n)}function W(r,n){return r[0]>n[0]||!(r[0]<n[0])&&r[1]>n[1]}function Y(r){return 4294967296*r[0]+r[1]}function Z(r){return isNaN(r)||!isFinite(r)?T:r<=-0x8000000000000000?L:r+1>=0x8000000000000000?O:r<0?I(Z(-r)):R(r%4294967296|0,r/4294967296|0)}function rr(r){if(function(r){var n=r[0],e=n>>21;return 0===e||-1===e&&!(0===r[1]&&-2097152===n)}(r))return String(Y(r));if(r[0]<0)return U(r,L)?"-9223372036854775808":"-"+rr(I(r));var n=Z(Math.floor(Y(r)/10)),e=n[1],t=n[0],a=Q(Q(r,e<<3,e>>>29|t<<3),e<<1,e>>>31|t<<1),u=a[1],i=a[0];if(0===u&&0===i)return rr(n)+"0";if(i<0){var o=1+(-1^u)>>>0,c=Math.ceil(o/10),f=10*c-o;return rr(Q(n,0|c,0))+String(0|f)}var s=u,v=Math.floor(s/10),l=s-10*v;return rr(V(n,0|v,0))+String(0|l)}function nr(r,n){var e=function r(n,e){for(;;){var a=e,u=n,i=0;if(0===a[0]&&0===a[1])throw t;if(3===3){var o=u[0];if(-2147483648!==o)if(0!==o)i=2;else{if(0===u[1])return T;i=2}else if(0!==u[1])i=2;else{if(U(a,D)||U(a,$))return u;if(U(a,L))return D;var c=z(r(X(u,1),a),1),f=0;if(0!==c[0])f=4;else{if(0===c[1])return a[0]<0?D:I(D);f=4}if(4===f)return B(c,r(j(u,K(a,c)),a))}}if(2===i&&-2147483648===a[0]&&0===a[1])return T;var s=a[0];if(!(u[0]<0)){if(s<0)return I(r(u,I(a)));for(var v=T,l=u;G(l,a);){for(var d=(w=1,_=Math.floor(Y(l)/Y(a)),w>_?w:_),h=Math.ceil(Math.log(d)/Math.LN2),m=h<=48?1:Math.pow(2,h-48),g=Z(d),p=K(g,a);p[0]<0||W(p,l);)p=K(g=Z(d-=m),a);0===(b=g)[0]&&0===b[1]&&(g=D),v=B(v,g),l=j(l,p)}return v}if(s>=0)return I(r(I(u),a));e=I(a),n=I(u)}var b,w,_}(r,n);return[e,j(r,K(e,n))]}function er(r){return 0|r[1]}function tr(r){return[2147483647&r[0],r[1]]}function ar(r){return r>=65&&r<=90||r>=192&&r<=214||r>=216&&r<=222?r+32|0:r}function ur(r){var n=r.length;if(n>31)throw[e,"format_int: format too long"];for(var t={justify:"+",signstyle:"-",filter:" ",alternate:!1,base:2,signedconv:!1,width:0,uppercase:!1,sign:1,prec:-1,conv:"f"},a=0;;){var u=a;if(u>=n)return t;var i=r.charCodeAt(u),o=0;if(i>=69)if(i>=88)if(i>=121)o=1;else switch(i-88|0){case 0:t.base=1,t.uppercase=!0,a=u+1|0;continue;case 13:case 14:case 15:o=5;break;case 12:case 17:o=4;break;case 23:t.base=0,a=u+1|0;continue;case 29:t.base=2,a=u+1|0;continue;case 1:case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 16:case 18:case 19:case 20:case 21:case 22:case 24:case 25:case 26:case 27:case 28:case 30:case 31:o=1;break;case 32:t.base=1,a=u+1|0;continue}else{if(!(i>=72)){t.signedconv=!0,t.uppercase=!0,t.conv=String.fromCharCode(ar(i)),a=u+1|0;continue}o=1}else switch(i){case 35:t.alternate=!0,a=u+1|0;continue;case 32:case 43:o=2;break;case 45:t.justify="-",a=u+1|0;continue;case 46:t.prec=0;for(var c=u+1|0;function(n){return function(){var e=r.charCodeAt(n)-48|0;return e>=0&&e<=9}}(c)();)t.prec=(M(t.prec,10)+r.charCodeAt(c)|0)-48|0,c=c+1|0;a=c;continue;case 33:case 34:case 36:case 37:case 38:case 39:case 40:case 41:case 42:case 44:case 47:o=1;break;case 48:t.filter="0",a=u+1|0;continue;case 49:case 50:case 51:case 52:case 53:case 54:case 55:case 56:case 57:o=3;break;default:o=1}switch(o){case 1:a=u+1|0;continue;case 2:t.signstyle=String.fromCharCode(i),a=u+1|0;continue;case 3:t.width=0;for(var f=u;function(n){return function(){var e=r.charCodeAt(n)-48|0;return e>=0&&e<=9}}(f)();)t.width=(M(t.width,10)+r.charCodeAt(f)|0)-48|0,f=f+1|0;a=f;continue;case 4:t.signedconv=!0,t.base=2,a=u+1|0;continue;case 5:t.signedconv=!0,t.conv=String.fromCharCode(i),a=u+1|0;continue}}}function ir(r,n){var e=r.justify,t=r.signstyle,a=r.filter,u=r.alternate,i=r.base,o=r.signedconv,c=r.width,f=r.uppercase,s=r.sign,v=n.length;o&&(s<0||"-"!==t)&&(v=v+1|0),u&&(0===i?v=v+1|0:1===i&&(v=v+2|0));var l="";if("+"===e&&" "===a)for(var d=v;d<c;++d)l+=a;if(o&&(s<0?l+="-":"-"!==t&&(l+=t)),u&&0===i&&(l+="0"),u&&1===i&&(l+="0x"),"+"===e&&"0"===a)for(var h=v;h<c;++h)l+=a;if(l=f?l+n.toUpperCase():l+n,"-"===e)for(var m=v;m<c;++m)l+=" ";return l}function or(r,n){if("%d"===r)return String(n);var e=ur(r),t=(n<0?e.signedconv?(e.sign=-1,-n):n>>>0:n).toString(function(r){switch(r){case 0:return 8;case 1:return 16;case 2:return 10}}(e.base));if(e.prec>=0){e.filter=" ";var a=e.prec-t.length|0;a>0&&(t="0".repeat(a)+t)}return ir(e,t)}function cr(r,n){if("%d"===r)return rr(n);var e,t,a=ur(r),u=a.signedconv&&H(n,T)?(a.sign=-1,I(n)):n;switch(a.base){case 0:e=function(r){var n="",e=R(8,0),t="01234567";if(H(r,T)){var a=nr(tr(r),e),u=B(R(0,268435456),a[0]),i=a[1];for(n=t[er(i)]+n;J(u,T);){var o=nr(u,e);u=o[0],n=t[er(i=o[1])]+n}}else{var c=nr(r,e),f=c[0],s=c[1];for(n=t[er(s)]+n;J(f,T);){var v=nr(f,e);f=v[0],n=t[er(s=v[1])]+n}}return n}(u);break;case 1:e=function(r){var n=r[1],e=r[0],t=function(r){return(r>>>0).toString(16)};if(0===e&&0===n)return"0";if(0===n)return t(e)+"00000000";if(0===e)return t(n);var a=t(n),u=8-a.length|0;return u<=0?t(e)+a:t(e)+("0".repeat(u)+a)}(u);break;case 2:e=function(r){if(!H(r,T))return rr(r);var n=R(10,0),e=nr(tr(r),n),t=nr(B(R(8,0),e[1]),n);return rr(B(B(R(-858993460,214748364),e[0]),t[0]))+"0123456789"[er(t[1])]}(u)}if(a.prec>=0){a.filter=" ";var i=a.prec-e.length|0;t=i>0?"0".repeat(i)+e:e}else t=e;return ir(a,t)}var fr=or,sr=or;function vr(r,n){if(n>=r.length||n<0)throw[e,"index out of bounds"];return r.charCodeAt(n)}var lr={contents:0};function dr(r){var n=[r,(lr.contents=lr.contents+1,lr.contents)];return n.tag=248,n}var hr=[];function mr(r){if(void 0===r){var n=[hr,0];return n.tag=256,n}if(null===r||r[0]!==hr)return r;var e=r[1]+1|0,t=[hr,e];return t.tag=256,t}function gr(r){if(null===r||r[0]!==hr)return r;var n=r[1];return 0===n?void 0:[hr,n-1|0]}var pr=dr("Caml_js_exceptions.Error");function br(r){return function(r){if(void 0===r)return!1;if(248===r.tag)return!0;var n=r[0];return void 0!==n&&248===n.tag}(r)?r:[pr,r]}function wr(r){if("number"==typeof r)return 0;switch(0|r.tag){case 0:return b(0,[wr(r[0])]);case 1:return b(1,[wr(r[0])]);case 2:return b(2,[wr(r[0])]);case 3:return b(3,[wr(r[0])]);case 4:return b(4,[wr(r[0])]);case 5:return b(5,[wr(r[0])]);case 6:return b(6,[wr(r[0])]);case 7:return b(7,[wr(r[0])]);case 8:return b(8,[r[0],wr(r[1])]);case 9:var n=r[0];return b(9,[n,n,wr(r[2])]);case 10:return b(10,[wr(r[0])]);case 11:return b(11,[wr(r[0])]);case 12:return b(12,[wr(r[0])]);case 13:return b(13,[wr(r[0])]);case 14:return b(14,[wr(r[0])])}}function _r(r,n){if("number"==typeof r)return n;switch(0|r.tag){case 0:return b(0,[_r(r[0],n)]);case 1:return b(1,[_r(r[0],n)]);case 2:return b(2,[r[0],_r(r[1],n)]);case 3:return b(3,[r[0],_r(r[1],n)]);case 4:return b(4,[r[0],r[1],r[2],_r(r[3],n)]);case 5:return b(5,[r[0],r[1],r[2],_r(r[3],n)]);case 6:return b(6,[r[0],r[1],r[2],_r(r[3],n)]);case 7:return b(7,[r[0],r[1],r[2],_r(r[3],n)]);case 8:return b(8,[r[0],r[1],r[2],_r(r[3],n)]);case 9:return b(9,[r[0],_r(r[1],n)]);case 10:return b(10,[_r(r[0],n)]);case 11:return b(11,[r[0],_r(r[1],n)]);case 12:return b(12,[r[0],_r(r[1],n)]);case 13:return b(13,[r[0],r[1],_r(r[2],n)]);case 14:return b(14,[r[0],r[1],_r(r[2],n)]);case 15:return b(15,[_r(r[0],n)]);case 16:return b(16,[_r(r[0],n)]);case 17:return b(17,[r[0],_r(r[1],n)]);case 18:return b(18,[r[0],_r(r[1],n)]);case 19:return b(19,[_r(r[0],n)]);case 20:return b(20,[r[0],r[1],_r(r[2],n)]);case 21:return b(21,[r[0],_r(r[1],n)]);case 22:return b(22,[_r(r[0],n)]);case 23:return b(23,[r[0],_r(r[1],n)]);case 24:return b(24,[r[0],r[1],_r(r[2],n)])}}dr("Pervasives.Exit");function yr(r){return r>=0?r:0|-r}function kr(r){return r?"true":"false"}function xr(r){for(var n=0,e=r;;){var t=n;if(!e)return t;e=e[1],n=t+1|0}}function qr(r,n){for(;;){var e=n,t=r;if(!t)return e;n=[t[0],e],r=t[1]}}function Fr(r){return qr(r,0)}function Sr(r){return r?function r(n,e){return n?[n[0],r(n[1],e)]:e}(r[0],Sr(r[1])):0}function Nr(r,n){return n?[s(r,n[0]),Nr(r,n[1])]:0}function Cr(r,n){for(;;){var e=n;if(!e)return;s(r,e[0]),n=e[1]}}function Ar(r,n,e){for(;;){var t=e,a=n;if(!t)return a;e=t[1],n=v(r,a,t[0])}}function Mr(r,n){for(;;){var e=n;if(!e)return!1;if(s(r,e[0]))return!0;n=e[1]}}function Rr(r,n){for(;;){var e=r;if(0===e)return n;if(!n)throw[i,["list.ml",262,11]];n=n[1],r=e-1|0}}var Lr=Sr,Or=function(r){return function(n){for(var e=0,t=n;;){var a=t,u=e;if(!a)return qr(u,0);var i=a[1],o=a[0];s(r,o)?(t=i,e=[o,u]):t=i}}},Dr=function(r,n){var e=function(n,e){if(2!==n){if(3===n&&e){var a=e[1];if(a){var u=a[1];if(u){var i=u[0],o=a[0],c=e[0];return v(r,c,o)<=0?v(r,o,i)<=0?[c,[o,[i,0]]]:v(r,c,i)<=0?[c,[i,[o,0]]]:[i,[c,[o,0]]]:v(r,c,i)<=0?[o,[c,[i,0]]]:v(r,o,i)<=0?[o,[i,[c,0]]]:[i,[o,[c,0]]]}}}}else if(e){var f=e[1];if(f){var s=f[0],l=e[0];return v(r,l,s)<=0?[l,[s,0]]:[s,[l,0]]}}for(var d=n>>1,h=n-d|0,m=Rr(d,e),g=t(d,e),p=t(h,m),b=0;;){var w=b,_=p,y=g;if(!y)return qr(_,w);if(!_)return qr(y,w);var k=_[0],x=y[0];v(r,x,k)>0?(b=[x,w],g=y[1]):(b=[k,w],p=_[1])}},t=function(n,t){if(2!==n){if(3===n&&t){var a=t[1];if(a){var u=a[1];if(u){var i=u[0],o=a[0],c=t[0];return v(r,c,o)>0?v(r,o,i)>0?[c,[o,[i,0]]]:v(r,c,i)>0?[c,[i,[o,0]]]:[i,[c,[o,0]]]:v(r,c,i)>0?[o,[c,[i,0]]]:v(r,o,i)>0?[o,[i,[c,0]]]:[i,[o,[c,0]]]}}}}else if(t){var f=t[1];if(f){var s=f[0],l=t[0];return v(r,l,s)>0?[l,[s,0]]:[s,[l,0]]}}for(var d=n>>1,h=n-d|0,m=Rr(d,t),g=e(d,t),p=e(h,m),b=0;;){var w=b,_=p,y=g;if(!y)return qr(_,w);if(!_)return qr(y,w);var k=_[0],x=y[0];v(r,x,k)<=0?(b=[x,w],g=y[1]):(b=[k,w],p=_[1])}},a=xr(n);return a<2?n:e(a,n)};function Tr(r){return r>=97&&r<=122?r-32|0:r}function $r(r,n){var e=F(r);return function(r,n,e,t){if(!(e<=0))for(var a=n,u=e+n|0;a<u;++a)r[a]=t}(e,0,r,n),e}var Er=[];function Pr(r,n,t){if(n<0||t<0||n>(r.length-t|0))throw[e,"String.sub / Bytes.sub"];var a=F(t);return S(r,n,a,0,t),a}function Ir(r,n,e){return N(Pr(r,n,e))}function Vr(r,n,t,a,u){if(u<0||n<0||n>(r.length-u|0)||a<0||a>(t.length-u|0))throw[e,"Bytes.blit"];return S(r,n,t,a,u)}function Br(r,n,t,a,u){if(u<0||n<0||n>(r.length-u|0)||a<0||a>(t.length-u|0))throw[e,"String.blit / Bytes.blit_string"];return C(r,n,t,a,u)}function Ur(r){var n=r-9|0;return n>4||n<0?23===n:2!==n}function Qr(r){for(var n=0,e=0,t=r.length;e<t;++e){var a,u=r[e];if(u>=32){var i=u-34|0;a=i>58||i<0?i>=93?4:1:i>57||i<1?2:1}else a=u>=11?13!==u?4:2:u>=8?2:4;n=n+a|0}if(n===r.length)return function(r){var n=r.length,e=F(n);return S(r,0,e,0,n),e}(r);var o=F(n);n=0;for(var c=0,f=r.length;c<f;++c){var s=r[c],v=0;if(s>=35)92!==s?s>=127?v=1:o[n]=s:v=2;else if(s>=32)s>=34?v=2:o[n]=s;else if(s>=14)v=1;else switch(s){case 8:o[n]=92,o[n=n+1|0]=98;break;case 9:o[n]=92,o[n=n+1|0]=116;break;case 10:o[n]=92,o[n=n+1|0]=110;break;case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:case 11:case 12:v=1;break;case 13:o[n]=92,o[n=n+1|0]=114}switch(v){case 1:o[n]=92,o[n=n+1|0]=48+(s/100|0)|0,o[n=n+1|0]=48+(s/10|0)%10|0,o[n=n+1|0]=48+s%10|0;break;case 2:o[n]=92,o[n=n+1|0]=s}n=n+1|0}return o}function jr(r){return function(r,n){var e=n.length;if(0===e)return n;for(var t=F(e),a=0;a<e;++a)t[a]=s(r,n[a]);return t}(Tr,r)}function zr(r,n){return N($r(r,n))}function Xr(r,n){if(r>=n)return r;throw[e,"String.concat"]}function Kr(r,n){if(!n)return"";var e=r.length;return N(function(r,n,e,t,a){for(;;){var u=a,i=n;if(!u)return r;var o=u[1],c=u[0];if(!o)return C(c,0,r,i,c.length),r;C(c,0,r,i,c.length),C(e,0,r,i+c.length|0,t),a=o,n=(i+c.length|0)+t|0}}(F(function(r,n,e){for(;;){var t=e,a=r;if(!t)return a;var u=t[1],i=t[0];if(!u)return i.length+a|0;e=u,r=Xr((i.length+n|0)+a|0,a)}}(0,e,n)),0,r,e,n))}function Gr(r){var n=r-9|0;return n>4||n<0?23===n:2!==n}function Jr(r){return""===r||!Gr(r.charCodeAt(0))&&!Gr(r.charCodeAt(r.length-1|0))?r:N(function(r){for(var n=r.length,e=0;e<n&&Ur(r[e]);)e=e+1|0;for(var t=n-1|0;t>=e&&Ur(r[t]);)t=t-1|0;return t>=e?Pr(r,e,1+(t-e|0)|0):Er}(A(r)))}var Hr=_,Wr=Br;function Yr(r,n,e,t){var a=void 0!==n&&n,u=r.style;return void 0!==u.setProperty?u.setProperty(e,t,a?"important":null):function(r,n,e){r.style[n]=e}(r,e,t)}function Zr(r,n,e){return r.insertBefore(n,e)}function rn(r,n,e,t){return""===n?r.setAttribute(e,t):r.setAttributeNS(n,e,t)}function nn(r,n){return""===r?document.createElement(n):document.createElementNS(r,n)}var en=b(0,[""]);function tn(r,n,e,t,a,u){return b(2,[r,n,e,t,a,u])}function an(r,n,e){return b(3,[r,b(0,[n,e]),{contents:void 0}])}function un(r){for(;;){var n=r;switch(0|n.tag){case 0:return"\x3c!-- "+n[0]+" --\x3e";case 1:return n[0];case 2:var e=n[1],t=n[0];return Kr("",["<",[t,[""===t?"":":",[e,[Kr("",Nr((function(r){if("number"==typeof r)return"";switch(0|r.tag){case 0:return Kr("",[" ",[r[0],['="',[r[1],['"',0]]]]]);case 1:return Kr("",[" ",[r[1],['="',[r[2],['"',0]]]]]);case 2:return Kr("",[" data-",[r[0],['="',[r[1],['"',0]]]]]);case 3:return"";case 4:return Kr("",[' style="',[Kr(";",Nr((function(r){return Kr("",[r[0],[":",[r[1],[";",0]]]])}),r[0])),['"',0]]])}}),n[4])),[">",[Kr("",Nr(un,n[5])),["</",[e,[">",0]]]]]]]]]]);case 3:r=s(n[1],void 0);continue;case 4:r=n[1];continue}}}function on(r){if(!r.tag)return r[1];var n=r[0];return function(r){return mr(n)}}function cn(r,n,e,t){var a,u,i,o={contents:on(t)},c=function(r,n){return function(e){var t=s(n.contents,e);if(void 0!==t)return s(r.contents.enqueue,gr(t))}}(r,o);return a=e,u=c,i=!1,n.addEventListener(a,u,i),{handler:c,cb:o}}function fn(r,n,e){if(void 0!==e)return t=r,a=n,u=e.handler,i=!1,void t.removeEventListener(a,u,i);var t,a,u,i}function sn(r,n,e,t,a,u,i,o){var c=i.contents;if(void 0!==c)if(e!==t)i.contents=fn(n,e,i.contents),o.contents=cn(r,n,t,u);else{if(o.contents=i.contents,function(r,n){return n.tag?!(!r.tag||!x(n[0],r[0])):!r.tag&&n[0]===r[0]}(a,u))return;var f=on(u);c.cb.contents=f}else o.contents=cn(r,n,t,u)}function vn(r,e,t,a,u){!function(r,e,t,a){var u,i,o;if("number"!=typeof a)switch(0|a.tag){case 0:return void(e[a[0]]=void 0);case 1:return u=e,i=a[0],o=a[1],""===i?u.removeAttribute(o):u.removeAttributeNS(i,o);case 2:throw console.log(["TODO:  Remove Data Unhandled",a[0],a[1]]),[n,"TODO:  Remove Data Unhandled"];case 3:var c=a[2];return void(c.contents=fn(e,a[0],c.contents));case 4:Ar((function(r,n){return Yr(e,void 0,n[0],null)}),void 0,a[0])}}(0,e,0,a),function(r,e,t,a){if("number"!=typeof a)switch(0|a.tag){case 0:return void(e[a[0]]=a[1]);case 1:return rn(e,a[0],a[1],a[2]);case 2:throw console.log(["TODO:  Add Data Unhandled",a[0],a[1]]),[n,"TODO:  Add Data Unhandled"];case 3:return void(a[2].contents=cn(r,e,a[0],a[1]));case 4:Ar((function(r,n){return Yr(e,void 0,n[0],n[1])}),void 0,a[0])}}(r,e,0,u)}function ln(r,t,a,u,i){if("number"==typeof i)throw[n,"This should never be called as all entries through NoProp are gated."];switch(0|i.tag){case 0:return void(t[i[0]]=i[1]);case 1:return rn(t,i[0],i[1],i[2]);case 2:throw console.log(["TODO:  Mutate Data Unhandled",i[0],i[1]]),[n,"TODO:  Mutate Data Unhandled"];case 3:throw[n,"This will never be called because it is gated"];case 4:if("number"==typeof u)throw[n,"Passed a non-Style to a new Style as a Mutations while the old Style is not actually a style!"];if(4===u.tag)return function(r,n,t,a){for(;;){var u=a,i=t,o=n;if(i){if(u){a=u[1],t=i[1],n=l(r,o,i[0],u[0]);continue}throw[e,"List.fold_left2"]}if(u)throw[e,"List.fold_left2"];return o}}((function(r,n,e){var a=e[1],u=e[0],i=n[0];return i===u?n[1]===a?void 0:Yr(t,void 0,u,a):(Yr(t,void 0,i,null),Yr(t,void 0,u,a))}),void 0,u[0],i[0]);throw[n,"Passed a non-Style to a new Style as a Mutations while the old Style is not actually a style!"]}}function dn(r,n,e,t){return function(r,n,e,t,a){for(;;){var u=a,i=t,o=e;if(!i)return!u;var c=i[0];if(!u)return!1;if("number"==typeof c){if("number"==typeof u[0]){a=u[1],t=i[1],e=o+1|0;continue}}else switch(0|c.tag){case 0:var f=u[0];if("number"!=typeof f&&!f.tag){c[0]===f[0]&&c[1]===f[1]||ln(0,n,0,c,f),a=u[1],t=i[1],e=o+1|0;continue}break;case 1:var s=u[0];if("number"!=typeof s&&1===s.tag){c[0]===s[0]&&c[1]===s[1]&&c[2]===s[2]||ln(0,n,0,c,s),a=u[1],t=i[1],e=o+1|0;continue}break;case 2:var v=u[0];if("number"!=typeof v&&2===v.tag){c[0]===v[0]&&c[1]===v[1]||ln(0,n,0,c,v),a=u[1],t=i[1],e=o+1|0;continue}break;case 3:var l=u[0];if("number"!=typeof l&&3===l.tag){sn(r,n,c[0],l[0],c[1],l[1],c[2],l[2]),a=u[1],t=i[1],e=o+1|0;continue}break;case 4:var d=u[0];if("number"!=typeof d&&4===d.tag){x(c[0],d[0])||ln(0,n,0,c,d),a=u[1],t=i[1],e=o+1|0;continue}}vn(r,n,0,c,u[0]),a=u[1],t=i[1],e=o+1|0}}(r,n,0,e,t)}function hn(r,e,t,a,i){if(2===i.tag){var o=i[4],f=c(t,a),s=nn(i[0],i[1]);if(dn(r,s,Nr((function(r){return 0}),o),o))return pn(r,s,s.childNodes,0,0,i[5]),Zr(e,s,f),void e.removeChild(f);throw[u,["vdom.ml",319,30]]}throw[n,"Node replacement should never be passed anything but a node itself"]}function mn(r,n){for(;;){var e=n,t=r;switch(0|e.tag){case 0:var a=e[0];return document.createComment(a);case 1:var i=e[0];return document.createTextNode(i);case 2:var o=e[4],c=nn(e[0],e[1]);if(dn(t,c,Nr((function(r){return 0}),o),o))return pn(t,c,c.childNodes,0,0,e[5]),c;throw[u,["vdom.ml",333,30]];case 3:var f=s(e[1],void 0);e[2].contents=f,n=f;continue;case 4:n=e[1],r=s(e[0],t);continue}}}function gn(r,e,t,a,u,i){if(2===u.tag){if(2===i.tag){if(u[3]!==i[3]||u[1]!==i[1])return hn(r,e,t,a,i);var o=c(t,a),f=o.childNodes;return dn(r,o,u[4],i[4])||(console.log("VDom:  Failed swapping properties because the property list length changed, use `noProp` to swap properties instead, not by altering the list structure.  This is a massive inefficiency until this issue is resolved."),hn(r,e,t,a,i)),pn(r,o,f,0,u[5],i[5])}throw[n,"Non-node passed to patchVNodesOnElems_MutateNode"]}throw[n,"Non-node passed to patchVNodesOnElems_MutateNode"]}function pn(r,n,e,t,a,u){for(;;){var i=u,o=a,f=t;if(o){var v=o[0];switch(0|v.tag){case 0:if(i){var l=i[0];if(!l.tag&&v[0]===l[0]){u=i[1],a=o[1],t=f+1|0;continue}}break;case 1:if(i){var d=i[0];if(1===d.tag){var h=d[0];if(v[0]!==h)c(e,f).nodeValue=h;u=i[1],a=o[1],t=f+1|0;continue}}break;case 2:if(i){var m=i[0];if(2===m.tag){var g=i[1],p=m[2],b=m[1],w=m[0],_=o[1],y=v[2],k=v[1],x=v[0];if(y===p&&""!==y){u=g,a=_,t=f+1|0;continue}if(""===y||""===p){gn(r,n,e,f,v,m),u=g,a=_,t=f+1|0;continue}var q=0,F=0;if(_){var S=_[0];if(2===S.tag){var N=_[1],C=S[2],A=S[1],M=S[0],R=0;if(g){var L=g[0];if(2===L.tag){if(M===w&&A===b&&C===p&&x===L[0]&&k===L[1]&&y===L[2]){var O=c(e,f),D=c(e,f+1|0);n.removeChild(D),Zr(n,D,O),u=g[1],a=N,t=f+2|0;continue}R=4}else R=4}else R=4;if(4===R){if(M===w&&A===b&&C===p){var T=c(e,f);n.removeChild(T),u=g,a=N,t=f+1|0;continue}F=3}}else F=3}else F=3;if(3===F)if(g){var $=g[0];if(2===$.tag){if(x===$[0]&&k===$[1]&&y===$[2]){var E=c(e,f);Zr(n,mn(r,m),E),u=g,t=f+1|0;continue}q=2}else q=2}else q=2;if(2===q){gn(r,n,e,f,v,m),u=g,a=_,t=f+1|0;continue}}}break;case 3:if(i){var P=i[0];if(3===P.tag){var I=i[1],V=P[2],B=P[1],U=P[0],Q=o[1],j=v[2],z=v[0];if(z===U){V.contents=j.contents,u=I,a=Q,t=f+1|0;continue}var X=0,K=0;if(Q){var G=Q[0];if(3===G.tag){var J=Q[1],H=G[0],W=0;if(I){var Y=I[0];if(3===Y.tag){if(H===U&&z===Y[0]){var Z=c(e,f),rr=c(e,f+1|0);n.removeChild(rr),Zr(n,rr,Z),u=I[1],a=J,t=f+2|0;continue}W=4}else W=4}else W=4;if(4===W){if(H===U){var nr=c(e,f);n.removeChild(nr);var er=G[2].contents;V.contents=er,u=I,a=J,t=f+1|0;continue}K=3}}else K=3}else K=3;if(3===K)if(I){var tr=I[0];if(3===tr.tag){if(tr[0]===z){var ar=c(e,f),ur=s(B,void 0);V.contents=ur,Zr(n,mn(r,ur),ar),u=I,t=f+1|0;continue}X=2}else X=2}else X=2;if(2===X){var ir=j.contents,or=s(B,void 0);V.contents=or,u=[or,I],a=[ir,Q];continue}}}break;case 4:a=[v[1],o[1]];continue}var cr=o[1];if(i){var fr=i[0];if(4===fr.tag){pn(s(fr[0],r),n,e,f,[v,0],[fr[1],0]),u=i[1],a=cr,t=f+1|0;continue}var sr=c(e,f);Zr(n,mn(r,fr),sr),n.removeChild(sr),u=i[1],a=cr,t=f+1|0;continue}var vr=c(e,f);n.removeChild(vr),u=0,a=cr}else{if(!i)return;var lr=mn(r,i[0]);n.appendChild(lr),u=i[1],a=0,t=f+1|0}}}function bn(r,n){if("number"!=typeof n)switch(0|n.tag){case 1:return Ar((function(n,e){return bn(r,e)}),void 0,n[0]);case 0:case 2:return s(n[0],r)}}function wn(r,n,e,t){var a=function(r,n){for(;;){var e=n,t=r;if("number"==typeof e)return;switch(0|e.tag){case 0:var u=e[0];return u?Cr(function(r){return function(n){return a(r,n)}}(t),u):void 0;case 1:return void(e[2].contents=s(e[1],t));case 2:var i=s(e[0],t);n=e[1],r=i;continue}}},u=function(r,n){for(;;){var e=n,t=r;if("number"==typeof e)return;switch(0|e.tag){case 0:var a=e[0];return a?Cr(function(r){return function(n){return u(r,n)}}(t),a):void 0;case 1:var i=e[2],o=i.contents;return void 0!==o?(i.contents=void 0,s(o,void 0)):void 0;case 2:var c=s(e[0],t);n=e[1],r=c;continue}}};if("number"==typeof e){if("number"==typeof t)return t}else switch(0|e.tag){case 0:if("number"!=typeof t&&!t.tag){return function(e,t){for(;;){var i=t,o=e;if(o){var c=o[1],f=o[0];if(i){wn(r,n,f,i[0]),t=i[1],e=c;continue}u(r,f),t=0,e=c}else{if(!i)return;a(n,i[0]),t=i[1],e=0}}}(e[0],t[0]),t}break;case 1:if("number"!=typeof t&&1===t.tag&&e[0]===t[0])return t[2].contents=e[2].contents,t;break;case 2:if("number"!=typeof t&&2===t.tag)return wn(s(e[0],r),s(t[0],n),e[1],t[1]),t}return u(r,e),a(n,t),t}function _n(r,n){for(var e=r.length;(r.position+n|0)>e;)e<<=1;var t=F(e);Vr(r.buffer,0,t,0,r.position),r.buffer=t,r.length=e}function yn(r,n){var e=r.position;e>=r.length&&_n(r,1),r.buffer[e]=n,r.position=e+1|0}function kn(r,n){var e=n.length,t=r.position+e|0;t>r.length&&_n(r,e),Br(n,0,r.buffer,r.position,e),r.position=t}function xn(r,n){var e=r.bytes.length,t=r.ind+n|0;if(!(t<=e)){var a,u,i=F((a=e<<1)>(u=t)?a:u);Vr(r.bytes,0,i,0,e),r.bytes=i}}function qn(r,n){xn(r,1),r.bytes[r.ind]=n,r.ind=r.ind+1|0}function Fn(r,n){var e=n.length;xn(r,e),Wr(n,0,r.bytes,r.ind,e),r.ind=r.ind+e|0}function Sn(r){return Ir(r.bytes,0,r.ind)}function Nn(r){if("number"==typeof r)switch(r){case 0:return"@]";case 1:return"@}";case 2:return"@?";case 3:return"@\n";case 4:return"@.";case 5:return"@@";case 6:return"@%"}else switch(0|r.tag){case 0:case 1:return r[0];case 2:return"@"+N($r(1,r[0]))}}function Cn(r){if("number"==typeof r)return 0;switch(0|r.tag){case 0:return b(0,[Cn(r[0])]);case 1:return b(1,[Cn(r[0])]);case 2:return b(2,[Cn(r[0])]);case 3:return b(3,[Cn(r[0])]);case 4:return b(4,[Cn(r[0])]);case 5:return b(5,[Cn(r[0])]);case 6:return b(6,[Cn(r[0])]);case 7:return b(7,[Cn(r[0])]);case 8:return b(8,[r[0],Cn(r[1])]);case 9:return b(9,[r[1],r[0],Cn(r[2])]);case 10:return b(10,[Cn(r[0])]);case 11:return b(11,[Cn(r[0])]);case 12:return b(12,[Cn(r[0])]);case 13:return b(13,[Cn(r[0])]);case 14:return b(14,[Cn(r[0])])}}function An(r){if("number"==typeof r)return[function(r){return 0},function(r){return 0},function(r){return 0},function(r){return 0}];switch(0|r.tag){case 0:var n=An(r[0]),e=n[1],t=n[0];return[function(r){return s(t,0),0},function(r){return s(e,0),0},n[2],n[3]];case 1:var a=An(r[0]),u=a[1],i=a[0];return[function(r){return s(i,0),0},function(r){return s(u,0),0},a[2],a[3]];case 2:var o=An(r[0]),c=o[1],f=o[0];return[function(r){return s(f,0),0},function(r){return s(c,0),0},o[2],o[3]];case 3:var v=An(r[0]),l=v[1],d=v[0];return[function(r){return s(d,0),0},function(r){return s(l,0),0},v[2],v[3]];case 4:var h=An(r[0]),m=h[1],g=h[0];return[function(r){return s(g,0),0},function(r){return s(m,0),0},h[2],h[3]];case 5:var p=An(r[0]),b=p[1],w=p[0];return[function(r){return s(w,0),0},function(r){return s(b,0),0},p[2],p[3]];case 6:var _=An(r[0]),y=_[1],k=_[0];return[function(r){return s(k,0),0},function(r){return s(y,0),0},_[2],_[3]];case 7:var x=An(r[0]),q=x[1],F=x[0];return[function(r){return s(F,0),0},function(r){return s(q,0),0},x[2],x[3]];case 8:var S=An(r[1]),N=S[1],C=S[0];return[function(r){return s(C,0),0},function(r){return s(N,0),0},S[2],S[3]];case 9:var A=An(r[2]),M=A[3],R=A[2],L=A[1],O=A[0],D=An(Mn(Cn(r[0]),r[1])),T=D[3],$=D[2],E=D[1],P=D[0];return[function(r){return s(O,0),s(P,0),0},function(r){return s(E,0),s(L,0),0},function(r){return s(R,0),s($,0),0},function(r){return s(T,0),s(M,0),0}];case 10:var I=An(r[0]),V=I[1],B=I[0];return[function(r){return s(B,0),0},function(r){return s(V,0),0},I[2],I[3]];case 11:var U=An(r[0]),Q=U[1],j=U[0];return[function(r){return s(j,0),0},function(r){return s(Q,0),0},U[2],U[3]];case 12:var z=An(r[0]),X=z[1],K=z[0];return[function(r){return s(K,0),0},function(r){return s(X,0),0},z[2],z[3]];case 13:var G=An(r[0]),J=G[3],H=G[2],W=G[1],Y=G[0];return[function(r){return s(Y,0),0},function(r){return s(W,0),0},function(r){return s(H,0),0},function(r){return s(J,0),0}];case 14:var Z=An(r[0]),rr=Z[3],nr=Z[2],er=Z[1],tr=Z[0];return[function(r){return s(tr,0),0},function(r){return s(er,0),0},function(r){return s(nr,0),0},function(r){return s(rr,0),0}]}}function Mn(r,n){var e=0;if("number"==typeof r){if("number"==typeof n)return 0;switch(0|n.tag){case 8:e=6;break;case 9:e=7;break;case 10:e=1;break;case 11:e=2;break;case 12:e=3;break;case 13:e=4;break;case 14:e=5;break;default:throw[i,["camlinternalFormat.ml",846,23]]}}else switch(0|r.tag){case 0:if("number"==typeof n)e=8;else switch(0|n.tag){case 0:return b(0,[Mn(r[0],n[0])]);case 8:e=6;break;case 9:e=7;break;case 10:e=1;break;case 11:e=2;break;case 12:e=3;break;case 13:e=4;break;case 14:e=5}break;case 1:if("number"==typeof n)e=8;else switch(0|n.tag){case 1:return b(1,[Mn(r[0],n[0])]);case 8:e=6;break;case 9:e=7;break;case 10:e=1;break;case 11:e=2;break;case 12:e=3;break;case 13:e=4;break;case 14:e=5}break;case 2:if("number"==typeof n)e=8;else switch(0|n.tag){case 2:return b(2,[Mn(r[0],n[0])]);case 8:e=6;break;case 9:e=7;break;case 10:e=1;break;case 11:e=2;break;case 12:e=3;break;case 13:e=4;break;case 14:e=5}break;case 3:if("number"==typeof n)e=8;else switch(0|n.tag){case 3:return b(3,[Mn(r[0],n[0])]);case 8:e=6;break;case 9:e=7;break;case 10:e=1;break;case 11:e=2;break;case 12:e=3;break;case 13:e=4;break;case 14:e=5}break;case 4:if("number"==typeof n)e=8;else switch(0|n.tag){case 4:return b(4,[Mn(r[0],n[0])]);case 8:e=6;break;case 9:e=7;break;case 10:e=1;break;case 11:e=2;break;case 12:e=3;break;case 13:e=4;break;case 14:e=5}break;case 5:if("number"==typeof n)e=8;else switch(0|n.tag){case 5:return b(5,[Mn(r[0],n[0])]);case 8:e=6;break;case 9:e=7;break;case 10:e=1;break;case 11:e=2;break;case 12:e=3;break;case 13:e=4;break;case 14:e=5}break;case 6:if("number"==typeof n)e=8;else switch(0|n.tag){case 6:return b(6,[Mn(r[0],n[0])]);case 8:e=6;break;case 9:e=7;break;case 10:e=1;break;case 11:e=2;break;case 12:e=3;break;case 13:e=4;break;case 14:e=5}break;case 7:if("number"==typeof n)e=8;else switch(0|n.tag){case 7:return b(7,[Mn(r[0],n[0])]);case 8:e=6;break;case 9:e=7;break;case 10:e=1;break;case 11:e=2;break;case 12:e=3;break;case 13:e=4;break;case 14:e=5}break;case 8:if("number"==typeof n)throw[i,["camlinternalFormat.ml",832,26]];switch(0|n.tag){case 8:return b(8,[Mn(r[0],n[0]),Mn(r[1],n[1])]);case 10:e=1;break;case 11:e=2;break;case 12:e=3;break;case 13:e=4;break;case 14:e=5;break;default:throw[i,["camlinternalFormat.ml",832,26]]}break;case 9:if("number"==typeof n)throw[i,["camlinternalFormat.ml",842,28]];switch(0|n.tag){case 8:e=6;break;case 9:var t=An(Mn(Cn(r[1]),n[0]));return s(t[1],0),s(t[3],0),b(9,[r[0],n[1],Mn(r[2],n[2])]);case 10:e=1;break;case 11:e=2;break;case 12:e=3;break;case 13:e=4;break;case 14:e=5;break;default:throw[i,["camlinternalFormat.ml",842,28]]}break;case 10:if("number"==typeof n)throw[i,["camlinternalFormat.ml",810,21]];if(10===n.tag)return b(10,[Mn(r[0],n[0])]);throw[i,["camlinternalFormat.ml",810,21]];case 11:if("number"==typeof n)throw[i,["camlinternalFormat.ml",814,21]];switch(0|n.tag){case 10:e=1;break;case 11:return b(11,[Mn(r[0],n[0])]);default:throw[i,["camlinternalFormat.ml",814,21]]}break;case 12:if("number"==typeof n)throw[i,["camlinternalFormat.ml",818,19]];switch(0|n.tag){case 10:e=1;break;case 11:e=2;break;case 12:return b(12,[Mn(r[0],n[0])]);default:throw[i,["camlinternalFormat.ml",818,19]]}break;case 13:if("number"==typeof n)throw[i,["camlinternalFormat.ml",822,22]];switch(0|n.tag){case 10:e=1;break;case 11:e=2;break;case 12:e=3;break;case 13:return b(13,[Mn(r[0],n[0])]);default:throw[i,["camlinternalFormat.ml",822,22]]}break;case 14:if("number"==typeof n)throw[i,["camlinternalFormat.ml",827,30]];switch(0|n.tag){case 10:e=1;break;case 11:e=2;break;case 12:e=3;break;case 13:e=4;break;case 14:return b(14,[Mn(r[0],n[0])]);default:throw[i,["camlinternalFormat.ml",827,30]]}}switch(e){case 1:throw[i,["camlinternalFormat.ml",811,21]];case 2:throw[i,["camlinternalFormat.ml",815,21]];case 3:throw[i,["camlinternalFormat.ml",819,19]];case 4:throw[i,["camlinternalFormat.ml",823,22]];case 5:throw[i,["camlinternalFormat.ml",828,30]];case 6:throw[i,["camlinternalFormat.ml",833,26]];case 7:throw[i,["camlinternalFormat.ml",843,28]];case 8:throw[i,["camlinternalFormat.ml",847,23]]}}var Rn=dr("CamlinternalFormat.Type_mismatch");function Ln(r,n){if("number"==typeof r)return[0,n];if(!r.tag)return[b(0,[r[0],r[1]]),n];if("number"==typeof n)throw Rn;if(2===n.tag)return[b(1,[r[0]]),n[0]];throw Rn}function On(r,n,e){var t=Ln(r,e);if("number"!=typeof n)return[t[0],[n[0]],t[1]];if(0===n)return[t[0],0,t[1]];var a=t[1];if("number"==typeof a)throw Rn;if(2===a.tag)return[t[0],1,a[0]];throw Rn}function Dn(r,n){if("number"==typeof r)return[0,n];switch(0|r.tag){case 0:if("number"==typeof n)throw Rn;if(n.tag)throw Rn;var e=Dn(r[0],n[0]);return[b(0,[e[0]]),e[1]];case 1:if("number"==typeof n)throw Rn;if(n.tag)throw Rn;var t=Dn(r[0],n[0]);return[b(1,[t[0]]),t[1]];case 2:var a=Ln(r[0],n),u=a[1];if("number"==typeof u)throw Rn;if(1===u.tag){var i=Dn(r[1],u[0]);return[b(2,[a[0],i[0]]),i[1]]}throw Rn;case 3:var o=Ln(r[0],n),c=o[1];if("number"==typeof c)throw Rn;if(1===c.tag){var f=Dn(r[1],c[0]);return[b(3,[o[0],f[0]]),f[1]]}throw Rn;case 4:var v=On(r[1],r[2],n),l=v[2];if("number"==typeof l)throw Rn;if(2===l.tag){var d=Dn(r[3],l[0]);return[b(4,[r[0],v[0],v[1],d[0]]),d[1]]}throw Rn;case 5:var h=On(r[1],r[2],n),m=h[2];if("number"==typeof m)throw Rn;if(3===m.tag){var g=Dn(r[3],m[0]);return[b(5,[r[0],h[0],h[1],g[0]]),g[1]]}throw Rn;case 6:var p=On(r[1],r[2],n),w=p[2];if("number"==typeof w)throw Rn;if(4===w.tag){var _=Dn(r[3],w[0]);return[b(6,[r[0],p[0],p[1],_[0]]),_[1]]}throw Rn;case 7:var y=On(r[1],r[2],n),k=y[2];if("number"==typeof k)throw Rn;if(5===k.tag){var x=Dn(r[3],k[0]);return[b(7,[r[0],y[0],y[1],x[0]]),x[1]]}throw Rn;case 8:var F=On(r[1],r[2],n),S=F[2];if("number"==typeof S)throw Rn;if(6===S.tag){var N=Dn(r[3],S[0]);return[b(8,[r[0],F[0],F[1],N[0]]),N[1]]}throw Rn;case 9:var C=Ln(r[0],n),A=C[1];if("number"==typeof A)throw Rn;if(7===A.tag){var M=Dn(r[1],A[0]);return[b(9,[C[0],M[0]]),M[1]]}throw Rn;case 10:var R=Dn(r[0],n);return[b(10,[R[0]]),R[1]];case 11:var L=Dn(r[1],n);return[b(11,[r[0],L[0]]),L[1]];case 12:var O=Dn(r[1],n);return[b(12,[r[0],O[0]]),O[1]];case 13:if("number"==typeof n)throw Rn;if(8===n.tag){var D=n[0];if(q([r[1]],[D]))throw Rn;var T=Dn(r[2],n[1]);return[b(13,[r[0],D,T[0]]),T[1]]}throw Rn;case 14:if("number"==typeof n)throw Rn;if(9===n.tag){var $=n[0];if(q([wr(r[1])],[wr($)]))throw Rn;var E=Dn(r[2],wr(n[2]));return[b(14,[r[0],$,E[0]]),E[1]]}throw Rn;case 15:if("number"==typeof n)throw Rn;if(10===n.tag){var P=Dn(r[0],n[0]);return[b(15,[P[0]]),P[1]]}throw Rn;case 16:if("number"==typeof n)throw Rn;if(11===n.tag){var I=Dn(r[0],n[0]);return[b(16,[I[0]]),I[1]]}throw Rn;case 17:var V=Dn(r[1],n);return[b(17,[r[0],V[0]]),V[1]];case 18:var B=r[0],U=r[1];if(B.tag){var Q=B[0],j=Dn(Q[0],n),z=Dn(U,j[1]);return[b(18,[b(1,[[j[0],Q[1]]]),z[0]]),z[1]]}var X=B[0],K=Dn(X[0],n),G=Dn(U,K[1]);return[b(18,[b(0,[[K[0],X[1]]]),G[0]]),G[1]];case 19:if("number"==typeof n)throw Rn;if(13===n.tag){var J=Dn(r[0],n[0]);return[b(19,[J[0]]),J[1]]}throw Rn;case 20:if("number"==typeof n)throw Rn;if(1===n.tag){var H=Dn(r[2],n[0]);return[b(20,[r[0],r[1],H[0]]),H[1]]}throw Rn;case 21:if("number"==typeof n)throw Rn;if(2===n.tag){var W=Dn(r[1],n[0]);return[b(21,[r[0],W[0]]),W[1]]}throw Rn;case 23:var Y=r[0],Z=r[1];if("number"==typeof Y){if(2!==Y)return Tn(Y,Z,n);if("number"==typeof n)throw Rn;if(14===n.tag){var rr=Dn(Z,n[0]);return[b(23,[2,rr[0]]),rr[1]]}throw Rn}switch(0|Y.tag){case 8:return Tn(b(8,[Y[0],Y[1]]),Z,n);case 9:var nr=function r(n,e,t){if("number"==typeof n)return[0,Dn(e,t)];switch(0|n.tag){case 0:if("number"==typeof t)throw Rn;if(t.tag)throw Rn;var a=r(n[0],e,t[0]);return[b(0,[a[0]]),a[1]];case 1:if("number"==typeof t)throw Rn;if(1===t.tag){var u=r(n[0],e,t[0]);return[b(1,[u[0]]),u[1]]}throw Rn;case 2:if("number"==typeof t)throw Rn;if(2===t.tag){var i=r(n[0],e,t[0]);return[b(2,[i[0]]),i[1]]}throw Rn;case 3:if("number"==typeof t)throw Rn;if(3===t.tag){var o=r(n[0],e,t[0]);return[b(3,[o[0]]),o[1]]}throw Rn;case 4:if("number"==typeof t)throw Rn;if(4===t.tag){var c=r(n[0],e,t[0]);return[b(4,[c[0]]),c[1]]}throw Rn;case 5:if("number"==typeof t)throw Rn;if(5===t.tag){var f=r(n[0],e,t[0]);return[b(5,[f[0]]),f[1]]}throw Rn;case 6:if("number"==typeof t)throw Rn;if(6===t.tag){var v=r(n[0],e,t[0]);return[b(6,[v[0]]),v[1]]}throw Rn;case 7:if("number"==typeof t)throw Rn;if(7===t.tag){var l=r(n[0],e,t[0]);return[b(7,[l[0]]),l[1]]}throw Rn;case 8:if("number"==typeof t)throw Rn;if(8===t.tag){var d=t[0];if(q([n[0]],[d]))throw Rn;var h=r(n[1],e,t[1]);return[b(8,[d,h[0]]),h[1]]}throw Rn;case 9:if("number"==typeof t)throw Rn;if(9===t.tag){var m=t[1],g=t[0];if(q([wr(n[0])],[wr(g)]))throw Rn;if(q([wr(n[1])],[wr(m)]))throw Rn;var p=An(Mn(Cn(g),m));s(p[1],0),s(p[3],0);var w=r(wr(n[2]),e,t[2]);return[b(9,[g,m,Cn(w[0])]),w[1]]}throw Rn;case 10:if("number"==typeof t)throw Rn;if(10===t.tag){var _=r(n[0],e,t[0]);return[b(10,[_[0]]),_[1]]}throw Rn;case 11:if("number"==typeof t)throw Rn;if(11===t.tag){var y=r(n[0],e,t[0]);return[b(11,[y[0]]),y[1]]}throw Rn;case 12:throw Rn;case 13:if("number"==typeof t)throw Rn;if(13===t.tag){var k=r(n[0],e,t[0]);return[b(13,[k[0]]),k[1]]}throw Rn;case 14:if("number"==typeof t)throw Rn;if(14===t.tag){var x=r(n[0],e,t[0]);return[b(14,[x[0]]),x[1]]}throw Rn}}(Y[1],Z,n),er=nr[1];return[b(23,[b(9,[Y[0],nr[0]]),er[0]]),er[1]];default:return Tn(Y,Z,n)}case 22:case 24:throw Rn}}function Tn(r,n,e){var t=Dn(n,e);return[b(23,[r,t[0]]),t[1]]}function $n(r,n){return function(r,n){var e=Dn(r,n);if("number"==typeof e[1])return e[0];throw Rn}(r,wr(Cn(n)))}function En(r,n,e){var t=e.length,a=yr(n),u=n<0?0:r;if(a<=t)return e;var i=$r(a,2===u?48:32);switch(u){case 0:Wr(e,0,i,0,t);break;case 1:Wr(e,0,i,a-t|0,t);break;case 2:t>0&&(43===vr(e,0)||45===vr(e,0)||32===vr(e,0))?(i[0]=vr(e,0),Wr(e,1,i,1+(a-t|0)|0,t-1|0)):t>1&&48===vr(e,0)&&(120===vr(e,1)||88===vr(e,1))?(i[1]=vr(e,1),Wr(e,2,i,2+(a-t|0)|0,t-2|0)):Wr(e,0,i,a-t|0,t)}return N(i)}function Pn(r,n){var e=yr(r),t=n.length,a=vr(n,0),u=0;if(a>=58)if(a>=71){if(a>102||a<97)return n;u=2}else{if(a<65)return n;u=2}else if(32!==a){if(a<43)return n;switch(a-43|0){case 0:case 2:u=1;break;case 1:case 3:case 4:return n;case 5:if((e+2|0)>t&&t>1&&(120===vr(n,1)||88===vr(n,1))){var i=$r(e+2|0,48);return i[1]=vr(n,1),Wr(n,2,i,4+(e-t|0)|0,t-2|0),N(i)}u=2;break;case 6:case 7:case 8:case 9:case 10:case 11:case 12:case 13:case 14:u=2}}else u=1;switch(u){case 1:if((e+1|0)<=t)return n;var o=$r(e+1|0,48);return o[0]=a,Wr(n,1,o,2+(e-t|0)|0,t-1|0),N(o);case 2:if(e<=t)return n;var c=$r(e,48);return Wr(n,0,c,e-t|0,t),N(c)}}function In(r){var n,e=(n=r,function(r){for(;;){var e=r;if(e>=n.length)return!1;var t=n.charCodeAt(e);if(t<32)return!0;var a=t-34|0;if(a>58||a<0){if(a>=93)return!0;r=e+1|0}else{if(a>57||a<1)return!0;r=e+1|0}}}(0)?N(Qr(A(n))):n),t=e.length,a=$r(t+2|0,34);return C(e,0,a,1,t),N(a)}function Vn(r,n){if(15===r)return"%.12g";var e=yr(n),t=function(r){switch(r){case 0:case 1:case 2:return 102;case 3:case 4:case 5:return 101;case 6:case 7:case 8:return 69;case 9:case 10:case 11:return 103;case 12:case 13:case 14:return 71;case 15:return 70;case 16:case 17:case 18:return 104;case 19:case 20:case 21:return 72}}(r),a={ind:0,bytes:F(16)};return qn(a,37),function(r,n){switch(n){case 0:case 3:case 6:case 9:case 12:case 15:case 16:case 19:return;case 1:case 4:case 7:case 10:case 13:case 17:case 20:return qn(r,43);case 2:case 5:case 8:case 11:case 14:case 18:case 21:qn(r,32)}}(a,r),qn(a,46),Fn(a,String(e)),qn(a,t),Sn(a)}function Bn(r,n){return or(function(r){switch(r){case 0:return"%d";case 1:return"%+d";case 2:return"% d";case 3:return"%i";case 4:return"%+i";case 5:return"% i";case 6:return"%x";case 7:return"%#x";case 8:return"%X";case 9:return"%#X";case 10:return"%o";case 11:return"%#o";case 12:return"%u"}}(r),n)}function Un(r,n){return sr(function(r){switch(r){case 0:return"%ld";case 1:return"%+ld";case 2:return"% ld";case 3:return"%li";case 4:return"%+li";case 5:return"% li";case 6:return"%lx";case 7:return"%#lx";case 8:return"%lX";case 9:return"%#lX";case 10:return"%lo";case 11:return"%#lo";case 12:return"%lu"}}(r),n)}function Qn(r,n){return fr(function(r){switch(r){case 0:return"%nd";case 1:return"%+nd";case 2:return"% nd";case 3:return"%ni";case 4:return"%+ni";case 5:return"% ni";case 6:return"%nx";case 7:return"%#nx";case 8:return"%nX";case 9:return"%#nX";case 10:return"%no";case 11:return"%#no";case 12:return"%nu"}}(r),n)}function jn(r,n){return cr(function(r){switch(r){case 0:return"%Ld";case 1:return"%+Ld";case 2:return"% Ld";case 3:return"%Li";case 4:return"%+Li";case 5:return"% Li";case 6:return"%Lx";case 7:return"%#Lx";case 8:return"%LX";case 9:return"%#LX";case 10:return"%Lo";case 11:return"%#Lo";case 12:return"%Lu"}}(r),n)}function zn(r,n,e){if(r>=16){var t;if(r>=17)switch(r-17|0){case 2:t=45;break;case 0:case 3:t=43;break;case 1:case 4:t=32}else t=45;var a=function(r,n,e){if(!isFinite(r))return isNaN(r)?"nan":r>0?"infinity":"-infinity";var t=0==r&&1/r==-1/0?1:r>=0?0:1;t&&(r=-r);var a=0;if(0==r);else if(r<1)for(;r<1&&a>-1022;)r*=2,a--;else for(;r>=2;)r/=2,a++;var u=a<0?"":"+",i="";if(t)i="-";else switch(e){case 43:i="+";break;case 32:i=" "}if(n>=0&&n<13){var o=Math.pow(2,4*n);r=Math.round(r*o)/o}var c=r.toString(16);if(n>=0){var f=c.indexOf(".");if(f<0)c+="."+"0".repeat(n);else{var s=f+1+n;c.length<s?c+="0".repeat(s-c.length):c=c.substr(0,s)}}return i+"0x"+c+"p"+u+a.toString(10)}(e,n,t);return r>=19?N(jr(A(a))):a}var u=function(r,n){var e=ur(r),t=e.prec<0?6:e.prec,a=n<0?(e.sign=-1,-n):n,u="";if(isNaN(a))u="nan",e.filter=" ";else if(isFinite(a)){switch(e.conv){case"e":var i=(u=a.toExponential(t)).length;"e"===u[i-3|0]&&(u=u.slice(0,i-1|0)+"0"+u.slice(i-1|0));break;case"f":u=a.toFixed(t);break;case"g":var o=0!==t?t:1,c=(u=a.toExponential(o-1|0)).indexOf("e"),f=0|Number(u.slice(c+1|0));if(f<-4||a>=1e21||a.toFixed().length>o){for(var s=c-1|0;"0"===u[s];)s=s-1|0;"."===u[s]&&(s=s-1|0);var v=(u=u.slice(0,s+1|0)+u.slice(c)).length;"e"===u[v-3|0]&&(u=u.slice(0,v-1|0)+"0"+u.slice(v-1|0))}else{var l=o;if(f<0)l=l-(f+1|0)|0,u=a.toFixed(l);else for(;(u=a.toFixed(l)).length>(o+1|0);)l=l-1|0;if(0!==l){for(var d=u.length-1|0;"0"===u[d];)d=d-1|0;"."===u[d]&&(d=d-1|0),u=u.slice(0,d+1|0)}}}}else u="inf",e.filter=" ";return ir(e,u)}(Vn(r,n),e);if(15!==r)return u;var i=u.length,o=function(r){return isFinite(r)?Math.abs(r)>=22250738585072014e-324?0:0!==r?1:2:isNaN(r)?4:3}(e);return 3!==o?o>=4?"nan":function(r){for(;;){var n=r;if(n===i)return!1;var e=vr(u,n)-46|0;if(e>23||e<0){if(55===e)return!0;r=n+1|0}else{if(e>22||e<1)return!0;r=n+1|0}}}(0)?u:u+".":e<0?"neg_infinity":"infinity"}function Xn(r){var n=function(r){var n=0;if(r>=40){if(92===r)return"\\\\";n=r>=127?1:2}else if(r>=32){if(r>=39)return"\\'";n=2}else if(r>=14)n=1;else switch(r){case 8:return"\\b";case 9:return"\\t";case 10:return"\\n";case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:case 11:case 12:n=1;break;case 13:return"\\r"}switch(n){case 1:var e=[0,0,0,0];return e[0]=92,e[1]=48+(r/100|0)|0,e[2]=48+(r/10|0)%10|0,e[3]=48+r%10|0,N(e);case 2:var t=[0];return t[0]=r,N(t)}}(r),e=n.length,t=$r(e+2|0,39);return C(n,0,t,1,e),N(t)}function Kn(r){var n={ind:0,bytes:F(16)};return function r(n,e){for(;;){var t=e;if("number"==typeof t)return;switch(0|t.tag){case 0:Fn(n,"%c"),e=t[0];continue;case 1:Fn(n,"%s"),e=t[0];continue;case 2:Fn(n,"%i"),e=t[0];continue;case 3:Fn(n,"%li"),e=t[0];continue;case 4:Fn(n,"%ni"),e=t[0];continue;case 5:Fn(n,"%Li"),e=t[0];continue;case 6:Fn(n,"%f"),e=t[0];continue;case 7:Fn(n,"%B"),e=t[0];continue;case 8:Fn(n,"%{"),r(n,t[0]),Fn(n,"%}"),e=t[1];continue;case 9:Fn(n,"%("),r(n,t[0]),Fn(n,"%)"),e=t[2];continue;case 10:Fn(n,"%a"),e=t[0];continue;case 11:Fn(n,"%t"),e=t[0];continue;case 12:Fn(n,"%?"),e=t[0];continue;case 13:Fn(n,"%r"),e=t[0];continue;case 14:Fn(n,"%_r"),e=t[0];continue}}}(n,r),Sn(n)}function Gn(r,n,e,t){for(;;){var a=t,u=e,o=r;if("number"==typeof a)return v(o,n,u);switch(0|a.tag){case 0:return function(r,e,t){return function(a){var u=b(5,[e,a]);return Gn(r,n,u,t)}}(o,u,a[0]);case 1:return function(r,e,t){return function(a){var u=Xn(a),i=b(4,[e,u]);return Gn(r,n,i,t)}}(o,u,a[0]);case 2:return Wn(o,n,u,a[1],a[0],(function(r){return r}));case 3:return Wn(o,n,u,a[1],a[0],In);case 4:return Yn(o,n,u,a[3],a[1],a[2],Bn,a[0]);case 5:return Yn(o,n,u,a[3],a[1],a[2],Un,a[0]);case 6:return Yn(o,n,u,a[3],a[1],a[2],Qn,a[0]);case 7:return Yn(o,n,u,a[3],a[1],a[2],jn,a[0]);case 8:var c=a[3],f=a[1],l=a[2],d=a[0];if("number"==typeof f)return"number"==typeof l?0!==l?function(r,e,t,a){return function(u,i){var o=zn(a,u,i);return Gn(r,n,b(4,[e,o]),t)}}(o,u,c,d):function(r,e,t,a){return function(u){var i=zn(a,-6,u);return Gn(r,n,b(4,[e,i]),t)}}(o,u,c,d):function(r,e,t,a,u){return function(i){var o=zn(a,u,i);return Gn(r,n,b(4,[e,o]),t)}}(o,u,c,d,l[0]);if(f.tag){var h=f[0];return"number"==typeof l?0!==l?function(r,e,t,a,u){return function(i,o,c){var f=En(u,i,zn(a,o,c));return Gn(r,n,b(4,[e,f]),t)}}(o,u,c,d,h):function(r,e,t,a,u){return function(i,o){var c=zn(a,-6,o),f=En(u,i,c);return Gn(r,n,b(4,[e,f]),t)}}(o,u,c,d,h):function(r,e,t,a,u,i){return function(o,c){var f=En(u,o,zn(a,i,c));return Gn(r,n,b(4,[e,f]),t)}}(o,u,c,d,h,l[0])}var m=f[1],g=f[0];return"number"==typeof l?0!==l?function(r,e,t,a,u,i){return function(o,c){var f=En(u,i,zn(a,o,c));return Gn(r,n,b(4,[e,f]),t)}}(o,u,c,d,g,m):function(r,e,t,a,u,i){return function(o){var c=zn(a,-6,o),f=En(u,i,c);return Gn(r,n,b(4,[e,f]),t)}}(o,u,c,d,g,m):function(r,e,t,a,u,i,o){return function(c){var f=En(u,i,zn(a,o,c));return Gn(r,n,b(4,[e,f]),t)}}(o,u,c,d,g,m,l[0]);case 9:return Wn(o,n,u,a[1],a[0],kr);case 10:t=a[0],e=b(7,[u]);continue;case 11:t=a[1],e=b(2,[u,a[0]]);continue;case 12:t=a[1],e=b(3,[u,a[0]]);continue;case 13:return function(r,e,t,a){return function(u){return Gn(r,n,b(4,[e,a]),t)}}(o,u,a[2],Kn(a[1]));case 14:var p=a[2];return function(r,e,t,a){return function(u){return Gn(r,n,e,_r($n(u[0],t),a))}}(o,u,a[1],p);case 15:return function(r,e,t){return function(a,u){return Gn(r,n,b(6,[e,function(r){return v(a,r,u)}]),t)}}(o,u,a[0]);case 16:return function(r,e,t){return function(a){return Gn(r,n,b(6,[e,a]),t)}}(o,u,a[0]);case 17:t=a[1],e=b(0,[u,a[0]]);continue;case 18:var w=a[0];if(w.tag){var _=function(r,n,e){return function(t,a){return Gn(r,t,b(1,[n,b(1,[a])]),e)}}(o,u,a[1]);t=w[0][0],e=0,r=_;continue}var y=function(r,n,e){return function(t,a){return Gn(r,t,b(1,[n,b(0,[a])]),e)}}(o,u,a[1]);t=w[0][0],e=0,r=y;continue;case 19:throw[i,["camlinternalFormat.ml",1525,4]];case 20:return function(r,e,t){return function(a){return Gn(r,n,t,e)}}(o,a[2],b(8,[u,"Printf: bad conversion %["]));case 21:return function(r,e,t){return function(a){var u=or("%u",a),i=b(4,[e,u]);return Gn(r,n,i,t)}}(o,u,a[1]);case 22:return function(r,e,t){return function(a){var u=b(5,[e,a]);return Gn(r,n,u,t)}}(o,u,a[0]);case 23:return Jn(o,n,u,a[0],a[1]);case 24:return Zn(o,n,u,a[2],a[0],s(a[1],void 0))}}}function Jn(r,n,e,t,a){if("number"!=typeof t)return 9===t.tag?function r(n,e,t,a,u){if("number"==typeof a)return Hn(n,e,t,u);switch(0|a.tag){case 0:var o=a[0];return function(a){return r(n,e,t,o,u)};case 1:var c=a[0];return function(a){return r(n,e,t,c,u)};case 2:var f=a[0];return function(a){return r(n,e,t,f,u)};case 3:var s=a[0];return function(a){return r(n,e,t,s,u)};case 4:var v=a[0];return function(a){return r(n,e,t,v,u)};case 5:var l=a[0];return function(a){return r(n,e,t,l,u)};case 6:var d=a[0];return function(a){return r(n,e,t,d,u)};case 7:var h=a[0];return function(a){return r(n,e,t,h,u)};case 8:var m=a[1];return function(a){return r(n,e,t,m,u)};case 9:var g=a[2],p=Mn(Cn(a[0]),a[1]);return function(a){return r(n,e,t,function r(n,e){if("number"==typeof n)return e;switch(0|n.tag){case 0:return b(0,[r(n[0],e)]);case 1:return b(1,[r(n[0],e)]);case 2:return b(2,[r(n[0],e)]);case 3:return b(3,[r(n[0],e)]);case 4:return b(4,[r(n[0],e)]);case 5:return b(5,[r(n[0],e)]);case 6:return b(6,[r(n[0],e)]);case 7:return b(7,[r(n[0],e)]);case 8:return b(8,[n[0],r(n[1],e)]);case 9:return b(9,[n[0],n[1],r(n[2],e)]);case 10:return b(10,[r(n[0],e)]);case 11:return b(11,[r(n[0],e)]);case 12:return b(12,[r(n[0],e)]);case 13:return b(13,[r(n[0],e)]);case 14:return b(14,[r(n[0],e)])}}(p,g),u)};case 10:var w=a[0];return function(a,i){return r(n,e,t,w,u)};case 11:var _=a[0];return function(a){return r(n,e,t,_,u)};case 12:var y=a[0];return function(a){return r(n,e,t,y,u)};case 13:throw[i,["camlinternalFormat.ml",1616,31]];case 14:throw[i,["camlinternalFormat.ml",1617,31]]}}(r,n,e,t[1],a):Hn(r,n,e,a);if(2!==t)return Hn(r,n,e,a);throw[i,["camlinternalFormat.ml",1593,39]]}function Hn(r,n,e,t){return Gn(r,n,b(8,[e,"Printf: bad conversion %_"]),t)}function Wn(r,n,e,t,a,u){if("number"==typeof a)return function(a){var i=s(u,a),o=b(4,[e,i]);return Gn(r,n,o,t)};if(a.tag){var i=a[0];return function(a,o){var c=En(i,a,s(u,o)),f=b(4,[e,c]);return Gn(r,n,f,t)}}var o=a[1],c=a[0];return function(a){var i=En(c,o,s(u,a)),f=b(4,[e,i]);return Gn(r,n,f,t)}}function Yn(r,n,e,t,a,u,i,o){if("number"==typeof a){if("number"==typeof u)return 0!==u?function(a,u){var c=Pn(a,v(i,o,u));return Gn(r,n,b(4,[e,c]),t)}:function(a){var u=v(i,o,a);return Gn(r,n,b(4,[e,u]),t)};var c=u[0];return function(a){var u=Pn(c,v(i,o,a));return Gn(r,n,b(4,[e,u]),t)}}if(a.tag){var f=a[0];if("number"==typeof u)return 0!==u?function(a,u,c){var s=En(f,a,Pn(u,v(i,o,c)));return Gn(r,n,b(4,[e,s]),t)}:function(a,u){var c=En(f,a,v(i,o,u));return Gn(r,n,b(4,[e,c]),t)};var s=u[0];return function(a,u){var c=En(f,a,Pn(s,v(i,o,u)));return Gn(r,n,b(4,[e,c]),t)}}var l=a[1],d=a[0];if("number"==typeof u)return 0!==u?function(a,u){var c=En(d,l,Pn(a,v(i,o,u)));return Gn(r,n,b(4,[e,c]),t)}:function(a){var u=En(d,l,v(i,o,a));return Gn(r,n,b(4,[e,u]),t)};var h=u[0];return function(a){var u=En(d,l,Pn(h,v(i,o,a)));return Gn(r,n,b(4,[e,u]),t)}}function Zn(r,n,e,t,a,u){if(!a)return Gn(r,n,b(4,[e,u]),t);var i=a[0];return function(a){return Zn(r,n,e,t,i,s(u,a))}}function re(r,n){return Gn((function(n,t){var a,u,i,o,c={buffer:i=F(u=(a=64)<1?1:a),position:0,length:u,initial_buffer:i};return function r(n,t){for(;;){var a=t,u=0;if("number"==typeof a)return;switch(0|a.tag){case 0:var i=Nn(a[1]);return r(n,a[0]),kn(n,i);case 1:var o=a[1],c=a[0];if(o.tag){r(n,c),kn(n,"@["),t=o[0];continue}r(n,c),kn(n,"@{"),t=o[0];continue;case 2:case 4:u=1;break;case 3:case 5:u=2;break;case 6:return r(n,a[0]),kn(n,s(a[1],void 0));case 7:t=a[0];continue;case 8:throw r(n,a[0]),[e,a[1]]}switch(u){case 1:return r(n,a[0]),kn(n,a[1]);case 2:return r(n,a[0]),yn(n,a[1])}}}(c,t),s(r,Ir((o=c).buffer,0,o.position))}),void 0,0,n[0])}function ne(r){return re((function(r){return r}),r)}function ee(r){var n=r.length;return Fr(function(e,t){for(;;){var a=t,u=e;if(a===n)return u;t=a+1|0,e=[vr(r,a),u]}}(0,0))}function te(r,n){return function(r,n){return r.line===n.line?w(n.column,r.column):w(n.line,r.line)}(r.location,n.location)}function ae(r){return l(ne([b(11,["At ",b(2,[0,b(11,["; Expecting ",b(2,[0,b(11,[" but actual ",b(2,[0,0])])])])])]),"At %s; Expecting %s but actual %s"]),function(r){return v(ne([b(11,["Ln ",b(4,[0,0,0,b(11,[", Col ",b(4,[0,0,0,0])])])]),"Ln %d, Col %d"]),r.line,r.column)}(r.location),r.expecting,r.actual)}function ue(r,n,e){var t=s(r,e);if(t.tag)return b(1,[t[0]]);var a=t[0];return v(n,a.result,{location:a.location,input_chars:a.remaining_chars})}function ie(r,n,e,t){var a=s(r,t);if(a.tag)return b(0,[{result:e,location:t.location,remaining_chars:t.input_chars}]);var u=a[0];return v(n,u.result,{location:u.location,input_chars:u.remaining_chars})}function oe(r,n){return b(0,[{result:r,location:n.location,remaining_chars:n.input_chars}])}function ce(r,n,e){var t=s(n,e);if(!t.tag)return t;var a=t[0];return b(1,a?[[{expecting:s(r,Kr(" OR ",Nr((function(r){return r.expecting}),a))),actual:a[0].actual,location:e.location},0]]:[[{expecting:s(r,""),actual:"No input",location:e.location},0]])}function fe(r,n,e){var t=s(n,e);if(!t.tag)return t;var a=t[0];return b(1,a?[[{expecting:r,actual:a[0].actual,location:e.location},a[1]]]:[[{expecting:r,actual:"",location:e.location},0]])}function se(r,n){return function(e){return ue(n,(function(n){var e=s(r,n);return function(r){return oe(e,r)}}),e)}}function ve(r,n,e){var t=s(r,e);if(!t.tag)return t;var a=s(n,e);return a.tag?b(1,[Lr([t[0],[a[0],0]])]):a}function le(r){if(!r)return function(r){return b(1,[0])};var n=r[0],e=le(r[1]);return function(r){return ve(n,e,r)}}function de(r,n){return e=r,t=function(r,n){var e=function(t){return function(a){return ie(r,(function(r){return function(r){return ue(n,(function(r){return e([r,t])}),r)}}),t,a)}};return e(0)}(n,r),function(r){return ue(e,(function(r){return function(n){return ue(t,(function(n){var e=[r,n];return function(r){return oe(e,r)}}),n)}}),r)};var e,t}function he(r,n,e){var t=e.input_chars;if(!t)return b(1,[[{expecting:n,actual:"Ran out of characters",location:e.location},0]]);var a,u,i,o=t[0];return s(r,o)?b(0,[{result:o,location:(a=e.location,u=o,i=a.line,10!==u&&13!==u?{column:a.column+1|0,line:i}:{column:1,line:i+1|0}),remaining_chars:t[1]}]):b(1,[[{expecting:n,actual:s(ne([b(12,[39,b(0,[b(12,[39,0])])]),"'%c'"]),o),location:e.location},0]])}function me(r){var n=s(ne([b(0,[0]),"%c"]),r);return function(e){return he((function(n){return r===n}),n,e)}}function ge(r,n){var e=v(ne([b(11,["A character between ",b(0,[b(11,[" and ",b(0,[0])])])]),"A character between %c and %c"]),r,n);return function(t){return he((function(e){return e>=r&&e<=n}),e,t)}}var pe=function(r){var n=s(ne([b(11,["One of: ",b(2,[0,0])]),"One of: %s"]),Kr(", ",Nr((function(r){return zr(1,r)}),r)));return function(e){return he((function(n){return function(r,n){for(;;){var e=n;if(!e)return!1;if(x(e[0],r))return!0;n=e[1]}}(n,r)}),n,e)}}([32,[9,[13,[10,0]]]]),be=(me(10),me(9),ge(65,90)),we=ge(97,122),_e=ge(48,57),ye=ne([b(2,[0,0]),"%s"]);function ke(r){return ce(ye,(function(r){return ve(we,be,r)}),r)}le([ge(97,102),[ge(65,70),[_e,0]]]);var xe=function r(n){var e=function(e){return ue(n,(function(e){return r(n)}),e)};return function(r){return ve(e,(function(r){return oe(void 0,r)}),r)}}(pe);ge(48,55);function qe(r){var e=r.length,t=function(n){if(n>=e)return function(n){return oe(r,n)};var a=t(n+1|0),u=me(vr(r,n));return function(r){return ue(u,(function(r){return a}),r)}};if(e<=0)return function(r){throw[n,r]}("token must be a non-empty string");var a=t(0),u=function(r){return ue(xe,(function(r){return a}),r)};return function(n){return fe(r,u,n)}}function Fe(r,n){var e=function(r,n){return s(r,{location:{column:1,line:1},input_chars:ee(Jr(n))})}(r,n);if(e.tag)return b(1,[e[0]]);var t=e[0],a=t.remaining_chars,u=t.location;return a?b(1,[[{expecting:"End of input",actual:s(ne([b(11,["Characters remaining: ",b(2,[0,0])]),"Characters remaining: %s"]),Kr("",Nr((function(r){return zr(1,r)}),a))),location:u},0]]):b(0,[{result:t.result,location:u,remaining_chars:a}])}var Se=ue,Ne=ve,Ce=function(r,n){return function(e){return ue(r,(function(r){return n}),e)}},Ae=function(r,n){return function(e){return ue(r,(function(r){return function(e){return ue(n,(function(n){return function(n){return oe(r,n)}}),e)}}),e)}};function Me(r){var n=function(r){return r?r[4]:0},t=function(r,e,t,a){var u=n(r),i=n(a);return[r,e,t,a,u>=i?u+1|0:i+1|0]},u=function(r,n){return[0,r,n,0,1]},o=function(r,a,u,i){var o=r?r[4]:0,c=i?i[4]:0;if(o>(c+2|0)){if(r){var f=r[3],s=r[2],v=r[1],l=r[0];if(n(l)>=n(f))return t(l,v,s,t(f,a,u,i));if(f)return t(t(l,v,s,f[0]),f[1],f[2],t(f[3],a,u,i));throw[e,"Map.bal"]}throw[e,"Map.bal"]}if(c<=(o+2|0))return[r,a,u,i,o>=c?o+1|0:c+1|0];if(i){var d=i[3],h=i[2],m=i[1],g=i[0];if(n(d)>=n(g))return t(t(r,a,u,g),m,h,d);if(g)return t(t(r,a,u,g[0]),g[1],g[2],t(g[3],m,h,d));throw[e,"Map.bal"]}throw[e,"Map.bal"]},c=function(n,e,t){if(!t)return[0,n,e,0,1];var a=t[3],u=t[2],i=t[1],f=t[0],s=v(r.compare,n,i);if(0===s)return u===e?t:[f,n,e,a,t[4]];if(s<0){var l=c(n,e,f);return f===l?t:o(l,i,u,a)}var d=c(n,e,a);return a===d?t:o(f,i,u,d)},f=function(r){for(;;){var n=r;if(!n)throw a;var e=n[0];if(!e)return[n[1],n[2]];r=e}},d=function(r){for(;;){var n=r;if(!n)return;var e=n[0];if(!e)return[n[1],n[2]];r=e}},h=function(r){if(r){var n=r[0];return n?o(h(n),r[1],r[2],r[3]):r[3]}throw[e,"Map.remove_min_elt"]},m=function(r,n){if(!r)return n;if(!n)return r;var e=f(n);return o(r,e[0],e[1],h(n))},g=function(n,e){if(!e)return 0;var t=e[3],a=e[2],u=e[1],i=e[0],c=v(r.compare,n,u);if(0===c)return m(i,t);if(c<0){var f=g(n,i);return i===f?e:o(f,u,a,t)}var s=g(n,t);return t===s?e:o(i,u,a,s)},p=function(n,e,t){if(t){var a=t[3],u=t[2],i=t[1],c=t[0],f=v(r.compare,n,i);if(0===f){var l=s(e,mr(u));if(void 0===l)return m(c,a);var d=gr(l);return u===d?t:[c,n,d,a,t[4]]}if(f<0){var h=p(n,e,c);return c===h?t:o(h,i,u,a)}var g=p(n,e,a);return a===g?t:o(c,i,u,g)}var b=s(e,void 0);return void 0!==b?[0,n,gr(b),0,1]:0},b=function(r,n){for(;;){var e=n;if(!e)return;b(r,e[0]),v(r,e[1],e[2]),n=e[3]}},w=function(r,n){if(!n)return 0;var e=w(r,n[0]),t=s(r,n[2]),a=w(r,n[3]);return[e,n[1],t,a,n[4]]},_=function(r,n){if(!n)return 0;var e=n[1];return[_(r,n[0]),e,v(r,e,n[2]),_(r,n[3]),n[4]]},y=function(r,n,e){for(;;){var t=e,a=n;if(!a)return t;e=l(r,a[1],a[2],y(r,a[0],t)),n=a[3]}},k=function(r,n){for(;;){var e=n;if(!e)return!0;if(!v(r,e[1],e[2]))return!1;if(!k(r,e[0]))return!1;n=e[3]}},x=function(r,n){for(;;){var e=n;if(!e)return!1;if(v(r,e[1],e[2]))return!0;if(x(r,e[0]))return!0;n=e[3]}},q=function(r,n,e){return e?o(q(r,n,e[0]),e[1],e[2],e[3]):u(r,n)},F=function(r,n,e){return e?o(e[0],e[1],e[2],F(r,n,e[3])):u(r,n)},S=function(r,n,e,a){if(!r)return q(n,e,a);if(!a)return F(n,e,r);var u=a[4],i=r[4];return i>(u+2|0)?o(r[0],r[1],r[2],S(r[3],n,e,a)):u>(i+2|0)?o(S(r,n,e,a[0]),a[1],a[2],a[3]):t(r,n,e,a)},N=function(r,n){if(!r)return n;if(!n)return r;var e=f(n);return S(r,e[0],e[1],h(n))},C=function(r,n,e,t){return void 0!==e?S(r,n,gr(e),t):N(r,t)},A=function(n,e){if(!e)return[0,void 0,0];var t=e[3],a=e[2],u=e[1],i=e[0],o=v(r.compare,n,u);if(0===o)return[i,mr(a),t];if(o<0){var c=A(n,i);return[c[0],c[1],S(c[2],u,a,t)]}var f=A(n,t);return[S(i,u,a,f[0]),f[1],f[2]]},M=function(r,e,t){if(e){var a=e[1];if(e[4]>=n(t)){var u=A(a,t);return C(M(r,e[0],u[0]),a,l(r,a,mr(e[2]),u[1]),M(r,e[3],u[2]))}}else if(!t)return 0;if(t){var o=t[1],c=A(o,e);return C(M(r,c[0],t[0]),o,l(r,o,c[1],mr(t[2])),M(r,c[2],t[3]))}throw[i,["map.ml",393,10]]},R=function(r,n,e){if(!n)return e;if(!e)return n;var t=e[2],a=e[1],u=n[2],i=n[1];if(n[4]>=e[4]){var o=A(i,e),c=o[1],f=R(r,n[0],o[0]),s=R(r,n[3],o[2]);return void 0!==c?C(f,i,l(r,i,u,gr(c)),s):S(f,i,u,s)}var v=A(a,n),d=v[1],h=R(r,v[0],e[0]),m=R(r,v[2],e[3]);return void 0!==d?C(h,a,l(r,a,gr(d),t),m):S(h,a,t,m)},L=function(r,n){if(!n)return 0;var e=n[3],t=n[2],a=n[1],u=n[0],i=L(r,u),o=v(r,a,t),c=L(r,e);return o?u===i&&e===c?n:S(i,a,t,c):N(i,c)},O=function(r,n){if(!n)return[0,0];var e=n[2],t=n[1],a=O(r,n[0]),u=a[1],i=a[0],o=v(r,t,e),c=O(r,n[3]),f=c[1],s=c[0];return o?[S(i,t,e,s),N(u,f)]:[N(i,s),S(u,t,e,f)]},D=function(r,n){for(;;){var e=n,t=r;if(!t)return e;n=[t[1],t[2],t[3],e],r=t[0]}},T=function(r){return r?(T(r[0])+1|0)+T(r[3])|0:0},$=function(r,n){for(;;){var e=n,t=r;if(!e)return t;n=e[0],r=[[e[1],e[2]],$(t,e[3])]}};return{empty:0,is_empty:function(r){return!r},mem:function(n,e){for(;;){var t=e;if(!t)return!1;var a=v(r.compare,n,t[1]);if(0===a)return!0;e=a<0?t[0]:t[3]}},add:c,update:p,singleton:u,remove:g,merge:M,union:R,compare:function(n,e,t){for(var a=D(e,0),u=D(t,0);;){var i=u,o=a;if(!o)return i?-1:0;if(!i)return 1;var c=v(r.compare,o[0],i[0]);if(0!==c)return c;var f=v(n,o[1],i[1]);if(0!==f)return f;u=D(i[2],i[3]),a=D(o[2],o[3])}},equal:function(n,e,t){for(var a=D(e,0),u=D(t,0);;){var i=u,o=a;if(!o)return!i;if(!i)return!1;if(0!==v(r.compare,o[0],i[0]))return!1;if(!v(n,o[1],i[1]))return!1;u=D(i[2],i[3]),a=D(o[2],o[3])}},iter:b,fold:y,for_all:k,exists:x,filter:L,partition:O,cardinal:T,bindings:function(r){return $(0,r)},min_binding:f,min_binding_opt:d,max_binding:function(r){for(;;){var n=r;if(!n)throw a;var e=n[3];if(!e)return[n[1],n[2]];r=e}},max_binding_opt:function(r){for(;;){var n=r;if(!n)return;var e=n[3];if(!e)return[n[1],n[2]];r=e}},choose:f,choose_opt:d,split:A,find:function(n,e){for(;;){var t=e;if(!t)throw a;var u=v(r.compare,n,t[1]);if(0===u)return t[2];e=u<0?t[0]:t[3]}},find_opt:function(n,e){for(;;){var t=e;if(!t)return;var a=v(r.compare,n,t[1]);if(0===a)return mr(t[2]);e=a<0?t[0]:t[3]}},find_first:function(r,n){for(;;){var e=n;if(!e)throw a;var t=e[1];if(s(r,t))for(var u=t,i=e[2],o=e[0];;){var c=o;if(!c)return[u,i];var f=c[1];s(r,f)?(o=c[0],i=c[2],u=f):o=c[3]}n=e[3]}},find_first_opt:function(r,n){for(;;){var e=n;if(!e)return;var t=e[1];if(s(r,t))for(var a=t,u=e[2],i=e[0];;){var o=i;if(!o)return[a,u];var c=o[1];s(r,c)?(i=o[0],u=o[2],a=c):i=o[3]}n=e[3]}},find_last:function(r,n){for(;;){var e=n;if(!e)throw a;var t=e[1];if(s(r,t))for(var u=t,i=e[2],o=e[3];;){var c=o;if(!c)return[u,i];var f=c[1];s(r,f)?(o=c[3],i=c[2],u=f):o=c[0]}n=e[0]}},find_last_opt:function(r,n){for(;;){var e=n;if(!e)return;var t=e[1];if(s(r,t))for(var a=t,u=e[2],i=e[3];;){var o=i;if(!o)return[a,u];var c=o[1];s(r,c)?(i=o[3],u=o[2],a=c):i=o[0]}n=e[0]}},map:w,mapi:_}}function Re(r,n){var e=n.length;if(0===e)return[];for(var t=function(r,n){for(var e=new Array(r),t=0;t<r;++t)e[t]=n;return e}(e,s(r,n[0])),a=1;a<e;++a)t[a]=s(r,n[a]);return t}function Le(r){for(var n=r.length-1|0,e=0;;){var t=e,a=n;if(a<0)return t;e=[r[a],t],n=a-1|0}}function Oe(r,n,e){for(var t=e,a=n.length-1|0;a>=0;--a)t=v(r,n[a],t);return t}dr("Array.Bottom");function De(r,n){if(n in r)return mr(r[n])}var Te=function(r){var n=typeof r;return"string"===n?b(0,[r]):"number"===n?b(1,[r]):"boolean"===n?!0===r?1:0:null===r?2:Array.isArray(r)?b(3,[r]):b(2,[r])};function $e(r,n){return n.tag?n:r}function Ee(r,n){return n.tag?mr(n[0]):function(r){if(r.tag)return mr(r[0])}(r)}function Pe(r){return r?r[4]:0}function Ie(r,n,e,t){var a=Pe(r),u=Pe(t);return[r,n,e,t,a>=u?a+1|0:u+1|0]}function Ve(r,n){return[0,r,n,0,1]}function Be(r,n,t,a){var u=r?r[4]:0,i=a?a[4]:0;if(u>(i+2|0)){if(r){var o=r[3],c=r[2],f=r[1],s=r[0];if(Pe(s)>=Pe(o))return Ie(s,f,c,Ie(o,n,t,a));if(o)return Ie(Ie(s,f,c,o[0]),o[1],o[2],Ie(o[3],n,t,a));throw[e,"Map.bal"]}throw[e,"Map.bal"]}if(i<=(u+2|0))return[r,n,t,a,u>=i?u+1|0:i+1|0];if(a){var v=a[3],l=a[2],d=a[1],h=a[0];if(Pe(v)>=Pe(h))return Ie(Ie(r,n,t,h),d,l,v);if(h)return Ie(Ie(r,n,t,h[0]),h[1],h[2],Ie(h[3],d,l,v));throw[e,"Map.bal"]}throw[e,"Map.bal"]}function Ue(r,n,e){if(!e)return[0,r,n,0,1];var t=e[3],a=e[2],u=e[1],i=e[0],o=_(r,u);if(0===o)return a===n?e:[i,r,n,t,e[4]];if(o<0){var c=Ue(r,n,i);return i===c?e:Be(c,u,a,t)}var f=Ue(r,n,t);return t===f?e:Be(i,u,a,f)}function Qe(r){for(;;){var n=r;if(!n)throw a;var e=n[0];if(!e)return[n[1],n[2]];r=e}}function je(r){for(;;){var n=r;if(!n)return;var e=n[0];if(!e)return[n[1],n[2]];r=e}}function ze(r){if(r){var n=r[0];return n?Be(ze(n),r[1],r[2],r[3]):r[3]}throw[e,"Map.remove_min_elt"]}function Xe(r,n){if(!r)return n;if(!n)return r;var e=Qe(n);return Be(r,e[0],e[1],ze(n))}function Ke(r,n,e,t){if(!r)return function r(n,e,t){return t?Be(r(n,e,t[0]),t[1],t[2],t[3]):Ve(n,e)}(n,e,t);if(!t)return function r(n,e,t){return t?Be(t[0],t[1],t[2],r(n,e,t[3])):Ve(n,e)}(n,e,r);var a=t[4],u=r[4];return u>(a+2|0)?Be(r[0],r[1],r[2],Ke(r[3],n,e,t)):a>(u+2|0)?Be(Ke(r,n,e,t[0]),t[1],t[2],t[3]):Ie(r,n,e,t)}function Ge(r,n){if(!r)return n;if(!n)return r;var e=Qe(n);return Ke(r,e[0],e[1],ze(n))}function Je(r,n,e,t){return void 0!==e?Ke(r,n,gr(e),t):Ge(r,t)}function He(r,n){if(!n)return[0,void 0,0];var e=n[3],t=n[2],a=n[1],u=n[0],i=_(r,a);if(0===i)return[u,mr(t),e];if(i<0){var o=He(r,u);return[o[0],o[1],Ke(o[2],a,t,e)]}var c=He(r,e);return[Ke(u,a,t,c[0]),c[1],c[2]]}function We(r,n){for(;;){var e=n,t=r;if(!t)return e;n=[t[1],t[2],t[3],e],r=t[0]}}var Ye={empty:0,is_empty:function(r){return!r},mem:function(r,n){for(;;){var e=n;if(!e)return!1;var t=_(r,e[1]);if(0===t)return!0;n=t<0?e[0]:e[3]}},add:Ue,update:function r(n,e,t){if(t){var a=t[3],u=t[2],i=t[1],o=t[0],c=_(n,i);if(0===c){var f=s(e,mr(u));if(void 0===f)return Xe(o,a);var v=gr(f);return u===v?t:[o,n,v,a,t[4]]}if(c<0){var l=r(n,e,o);return o===l?t:Be(l,i,u,a)}var d=r(n,e,a);return a===d?t:Be(o,i,u,d)}var h=s(e,void 0);return void 0!==h?[0,n,gr(h),0,1]:0},singleton:Ve,remove:function r(n,e){if(!e)return 0;var t=e[3],a=e[2],u=e[1],i=e[0],o=_(n,u);if(0===o)return Xe(i,t);if(o<0){var c=r(n,i);return i===c?e:Be(c,u,a,t)}var f=r(n,t);return t===f?e:Be(i,u,a,f)},merge:function r(n,e,t){if(e){var a=e[1];if(e[4]>=Pe(t)){var u=He(a,t);return Je(r(n,e[0],u[0]),a,l(n,a,mr(e[2]),u[1]),r(n,e[3],u[2]))}}else if(!t)return 0;if(t){var o=t[1],c=He(o,e);return Je(r(n,c[0],t[0]),o,l(n,o,c[1],mr(t[2])),r(n,c[2],t[3]))}throw[i,["map.ml",393,10]]},union:function r(n,e,t){if(!e)return t;if(!t)return e;var a=t[2],u=t[1],i=e[2],o=e[1];if(e[4]>=t[4]){var c=He(o,t),f=c[1],s=r(n,e[0],c[0]),v=r(n,e[3],c[2]);return void 0!==f?Je(s,o,l(n,o,i,gr(f)),v):Ke(s,o,i,v)}var d=He(u,e),h=d[1],m=r(n,d[0],t[0]),g=r(n,d[2],t[3]);return void 0!==h?Je(m,u,l(n,u,gr(h),a),g):Ke(m,u,a,g)},compare:function(r,n,e){for(var t=We(n,0),a=We(e,0);;){var u=a,i=t;if(!i)return u?-1:0;if(!u)return 1;var o=_(i[0],u[0]);if(0!==o)return o;var c=v(r,i[1],u[1]);if(0!==c)return c;a=We(u[2],u[3]),t=We(i[2],i[3])}},equal:function(r,n,e){for(var t=We(n,0),a=We(e,0);;){var u=a,i=t;if(!i)return!u;if(!u)return!1;if(0!==_(i[0],u[0]))return!1;if(!v(r,i[1],u[1]))return!1;a=We(u[2],u[3]),t=We(i[2],i[3])}},iter:function r(n,e){for(;;){var t=e;if(!t)return;r(n,t[0]),v(n,t[1],t[2]),e=t[3]}},fold:function r(n,e,t){for(;;){var a=t,u=e;if(!u)return a;t=l(n,u[1],u[2],r(n,u[0],a)),e=u[3]}},for_all:function r(n,e){for(;;){var t=e;if(!t)return!0;if(!v(n,t[1],t[2]))return!1;if(!r(n,t[0]))return!1;e=t[3]}},exists:function r(n,e){for(;;){var t=e;if(!t)return!1;if(v(n,t[1],t[2]))return!0;if(r(n,t[0]))return!0;e=t[3]}},filter:function r(n,e){if(!e)return 0;var t=e[3],a=e[2],u=e[1],i=e[0],o=r(n,i),c=v(n,u,a),f=r(n,t);return c?i===o&&t===f?e:Ke(o,u,a,f):Ge(o,f)},partition:function r(n,e){if(!e)return[0,0];var t=e[2],a=e[1],u=r(n,e[0]),i=u[1],o=u[0],c=v(n,a,t),f=r(n,e[3]),s=f[1],l=f[0];return c?[Ke(o,a,t,l),Ge(i,s)]:[Ge(o,l),Ke(i,a,t,s)]},cardinal:function r(n){return n?(r(n[0])+1|0)+r(n[3])|0:0},bindings:function(r){return function r(n,e){for(;;){var t=e,a=n;if(!t)return a;e=t[0],n=[[t[1],t[2]],r(a,t[3])]}}(0,r)},min_binding:Qe,min_binding_opt:je,max_binding:function(r){for(;;){var n=r;if(!n)throw a;var e=n[3];if(!e)return[n[1],n[2]];r=e}},max_binding_opt:function(r){for(;;){var n=r;if(!n)return;var e=n[3];if(!e)return[n[1],n[2]];r=e}},choose:Qe,choose_opt:je,split:He,find:function(r,n){for(;;){var e=n;if(!e)throw a;var t=_(r,e[1]);if(0===t)return e[2];n=t<0?e[0]:e[3]}},find_opt:function(r,n){for(;;){var e=n;if(!e)return;var t=_(r,e[1]);if(0===t)return mr(e[2]);n=t<0?e[0]:e[3]}},find_first:function(r,n){for(;;){var e=n;if(!e)throw a;var t=e[1];if(s(r,t))for(var u=t,i=e[2],o=e[0];;){var c=o;if(!c)return[u,i];var f=c[1];s(r,f)?(o=c[0],i=c[2],u=f):o=c[3]}n=e[3]}},find_first_opt:function(r,n){for(;;){var e=n;if(!e)return;var t=e[1];if(s(r,t))for(var a=t,u=e[2],i=e[0];;){var o=i;if(!o)return[a,u];var c=o[1];s(r,c)?(i=o[0],u=o[2],a=c):i=o[3]}n=e[3]}},find_last:function(r,n){for(;;){var e=n;if(!e)throw a;var t=e[1];if(s(r,t))for(var u=t,i=e[2],o=e[3];;){var c=o;if(!c)return[u,i];var f=c[1];s(r,f)?(o=c[3],i=c[2],u=f):o=c[0]}n=e[0]}},find_last_opt:function(r,n){for(;;){var e=n;if(!e)return;var t=e[1];if(s(r,t))for(var a=t,u=e[2],i=e[3];;){var o=i;if(!o)return[a,u];var c=o[1];s(r,c)?(i=o[3],u=o[2],a=c):i=o[0]}n=e[0]}},map:function r(n,e){if(!e)return 0;var t=r(n,e[0]),a=s(n,e[2]),u=r(n,e[3]);return[t,e[1],a,u,e[4]]},mapi:function r(n,e){if(!e)return 0;var t=e[1];return[r(n,e[0]),t,v(n,t,e[2]),r(n,e[3]),e[4]]}},Ze=dr("Tea_json.Decoder.ParseFail");function rt(r){return[function(n){var e=Te(n);return"number"==typeof e&&e>=2?b(0,[r]):b(1,["Non-null value"])}]}function nt(r,n){var e=n[0];return[function(n){var t=Te(n);if("number"==typeof t)return b(1,["Non-fieldable value"]);if(2!==t.tag)return b(1,["Non-fieldable value"]);var a=De(t[0],r);if(void 0===a)return b(1,["Field Value is undefined: "+r]);var u=s(e,gr(a));return u.tag?b(1,["field `"+r+"` -> "+u[0]]):u}]}function et(r){return[function(n){var e=function(r,n){for(;;){var t=n;if(!t)return b(1,["No one-of's matched"]);var a=t[1];try{var u=s(t[0][0],r);return u.tag?e(r,a):u}catch(r){n=a;continue}}};return e(n,r)}]}function tt(r,n){var e=n[0];return[function(n){var t=s(e,n);return t.tag?b(1,["map "+t[0]]):b(0,[s(r,t[0])])}]}function at(r,n){var e=n[0];return[function(n){var t=s(e,n);if(t.tag)return t;var a=s(r,t[0]);return s(a[0],n)}]}function ut(r,n){try{return s(r[0],n)}catch(r){var e=br(r);return e[0]===Ze?b(1,[e[1]]):b(1,["Unknown JSON parsing error"])}}var it={ObjectDict:Ye,ParseFail:Ze,string:[function(r){var n=Te(r);return"number"==typeof n||n.tag?b(1,["Non-string value"]):b(0,[n[0]])}],$$int:[function(r){var n=Te(r);if("number"==typeof n)return b(1,["Non-int value"]);if(1!==n.tag)return b(1,["Non-int value"]);var e=n[0];return e>-2147483648&&e<2147483647?b(0,[0|e]):b(1,["number out of int range"])}],$$float:[function(r){var n=Te(r);return"number"==typeof n||1!==n.tag?b(1,["Non-float-value"]):b(0,[n[0]])}],bool:[function(r){var n=Te(r);if("number"!=typeof n)return b(1,["Non-boolean value"]);switch(n){case 0:return b(0,[!1]);case 1:return b(0,[!0]);case 2:return b(1,["Non-boolean value"])}}],$$null:rt,list:function(r){var n=r[0];return[function(r){var e=Te(r);if("number"==typeof e)return b(1,["Non-list value"]);if(3!==e.tag)return b(1,["Non-list value"]);try{return b(0,[Nr((function(r){var e=s(n,r);if(!e.tag)return e[0];throw[Ze,e[0]]}),Le(e[0]))])}catch(r){var t=br(r);if(t[0]===Ze)return b(1,["list -> "+t[1]]);throw t}}]},array:function(r){var n=r[0];return[function(r){var e=Te(r);if("number"==typeof e)return b(1,["Non-array value"]);if(3!==e.tag)return b(1,["Non-array value"]);try{return b(0,[Re((function(r){var e=s(n,r);if(!e.tag)return e[0];throw[Ze,e[0]]}),e[0])])}catch(r){var t=br(r);if(t[0]===Ze)return b(1,["array -> "+t[1]]);throw t}}]},keyValuePairs:function(r){var n=r[0];return[function(r){var e=Te(r);if("number"==typeof e)return b(1,["Non-keyValuePair value"]);if(2!==e.tag)return b(1,["Non-keyValuePair value"]);var t=e[0],a=Object.keys(t);try{return b(0,[Oe((function(r,e){var a=De(t,r);if(void 0!==a){var u=s(n,gr(a));if(!u.tag)return[[r,u[0]],e];throw[Ze,u[0]]}throw[Ze,"Key is undefined: "+r]}),a,0)])}catch(r){var u=br(r);if(u[0]===Ze)return b(1,["Invalid keyValuePair parsing: "+u[1]]);throw u}}]},dict:function(r){var n=r[0];return[function(r){var e=Te(r);if("number"==typeof e)return b(1,["Non-dict value"]);if(2!==e.tag)return b(1,["Non-dict value"]);var t=e[0],a=Object.keys(t);try{return b(0,[Oe((function(r,e){var a=De(t,r);if(void 0!==a){var u=s(n,gr(a));if(!u.tag)return Ue(r,u[0],e);throw[Ze,u[0]]}throw[Ze,"Key is undefined: "+r]}),a,0)])}catch(r){var u=br(r);if(u[0]===Ze)return b(1,["Invalid dict parsing: "+u[1]]);throw u}}]},field:nt,at:function(r,n){return function r(n,e,t){return e?v(n,e[0],r(n,e[1],t)):t}(nt,r,n)},index:function(r,n){var e=n[0];return[function(n){var t=Te(n);if("number"==typeof t)return b(1,["Non-array value"]);if(3!==t.tag)return b(1,["Non-array value"]);var a=t[0];return r<0||r>a.length?b(1,["Array index out of range: "+String(r)]):s(e,c(a,r))}]},maybe:function(r){var n=r[0];return[function(r){var e=s(n,r);return e.tag?b(0,[void 0]):b(0,[mr(e[0])])}]},oneOf:et,map:tt,map2:function(r,e,t){var a=t[0],u=e[0];return[function(e){var t=s(u,e),i=s(a,e);if(!t.tag&&!i.tag)return b(0,[v(r,t[0],i[0])]);var o=Ee(t,i);if(void 0!==o)return b(1,["map2 -> "+o]);throw[n,"Impossible case"]}]},map3:function(r,e,t,a){var u=a[0],i=t[0],o=e[0];return[function(e){var t=s(o,e),a=s(i,e),c=s(u,e);if(!t.tag&&!a.tag&&!c.tag)return b(0,[l(r,t[0],a[0],c[0])]);var f=$e(c,$e(a,t));if(f.tag)return b(1,["map3 -> "+f[0]]);throw[n,"Impossible case"]}]},map4:function(r,e,t,a,u){var i=u[0],o=a[0],c=t[0],f=e[0];return[function(e){var t=s(f,e),a=s(c,e),u=s(o,e),v=s(i,e);if(!(t.tag||a.tag||u.tag||v.tag))return b(0,[d(r,t[0],a[0],u[0],v[0])]);var l=$e(v,$e(u,$e(a,t)));if(l.tag)return b(1,["map4 -> "+l[0]]);throw[n,"Impossible case"]}]},map5:function(r,e,t,a,u,i){var o=i[0],c=u[0],f=a[0],v=t[0],l=e[0];return[function(e){var t=s(l,e),a=s(v,e),u=s(f,e),i=s(c,e),d=s(o,e);if(!(t.tag||a.tag||u.tag||i.tag||d.tag))return b(0,[h(r,t[0],a[0],u[0],i[0],d[0])]);var m=$e(d,$e(i,$e(u,$e(a,t))));if(m.tag)return b(1,["map5 -> "+m[0]]);throw[n,"Impossible case"]}]},map6:function(r,e,t,a,u,i,o){var c=o[0],f=i[0],v=u[0],l=a[0],d=t[0],h=e[0];return[function(e){var t=s(h,e),a=s(d,e),u=s(l,e),i=s(v,e),o=s(f,e),g=s(c,e);if(!(t.tag||a.tag||u.tag||i.tag||o.tag||g.tag))return b(0,[m(r,t[0],a[0],u[0],i[0],o[0],g[0])]);var p=$e(g,$e(o,$e(i,$e(u,$e(a,t)))));if(p.tag)return b(1,["map6 -> "+p[0]]);throw[n,"Impossible case"]}]},map7:function(r,e,t,a,u,i,o,c){var f=c[0],v=o[0],l=i[0],d=u[0],h=a[0],m=t[0],p=e[0];return[function(e){var t=s(p,e),a=s(m,e),u=s(h,e),i=s(d,e),o=s(l,e),c=s(v,e),w=s(f,e);if(!(t.tag||a.tag||u.tag||i.tag||o.tag||c.tag||w.tag))return b(0,[g(r,t[0],a[0],u[0],i[0],o[0],c[0],w[0])]);var _=$e(w,$e(c,$e(o,$e(i,$e(u,$e(a,t))))));if(_.tag)return b(1,["map7 -> "+_[0]]);throw[n,"Impossible case"]}]},map8:function(r,e,t,a,u,i,o,c,f){var v=f[0],l=c[0],d=o[0],h=i[0],m=u[0],g=a[0],w=t[0],_=e[0];return[function(e){var t=s(_,e),a=s(w,e),u=s(g,e),i=s(m,e),o=s(h,e),c=s(d,e),f=s(l,e),y=s(v,e);if(!(t.tag||a.tag||u.tag||i.tag||o.tag||c.tag||f.tag||y.tag))return b(0,[p(r,t[0],a[0],u[0],i[0],o[0],c[0],f[0],y[0])]);var k=$e(y,$e(f,$e(c,$e(o,$e(i,$e(u,$e(a,t)))))));if(k.tag)return b(1,["map8 -> "+k[0]]);throw[n,"Impossible case"]}]},succeed:function(r){return[function(n){return b(0,[r])}]},fail:function(r){return[function(n){return b(1,[r])}]},value:[function(r){return b(0,[r])}],andThen:at,lazy_:function(r){return at(r,[function(r){return b(0,[void 0])}])},nullable:function(r){return et([rt(void 0),[tt((function(r){return mr(r)}),r),0]])},decodeValue:ut,decodeEvent:function(r,n){try{return s(r[0],n)}catch(r){var e=br(r);return e[0]===Ze?b(1,[e[1]]):b(1,["Unknown JSON parsing error"])}},decodeString:function(r,n){try{return ut(r,JSON.parse(n))}catch(r){return b(1,["Invalid JSON string"])}}};function ot(r){return b(1,[r])}function ct(r,n,e,t){return tn("","div",void 0!==r?r:"",void 0!==n?n:"",e,t)}function ft(r,n,e,t){return tn("","span",void 0!==r?r:"",void 0!==n?n:"",e,t)}function st(r,n,e,t){return tn("","h3",void 0!==r?r:"",void 0!==n?n:"",e,t)}function vt(r,n,e,t){return tn("","ul",void 0!==r?r:"",void 0!==n?n:"",e,t)}function lt(r,n,e,t){return tn("","li",void 0!==r?r:"",void 0!==n?n:"",e,t)}function dt(r,n,e,t){return tn("","hr",void 0!==r?r:"",void 0!==n?n:"",e,t)}function ht(r){return b(0,["className",r])}function mt(r){return b(0,["className",Kr(" ",Nr((function(r){return r[0]}),Or((function(r){return r[1]}))(r)))])}function gt(r){return b(0,["value",r])}function pt(r,n){return function(r,n){return an("input",void 0!==r?r:"",(function(r){var e=r.target;if(void 0!==e){var t=e.value;return void 0!==t?s(n,t):void 0}}))}(void 0!==r?r:"",(function(r){return mr(s(n,r))}))}function bt(r){return function(r,n){return b(3,[r,b(1,[n]),{contents:void 0}])}("click",r)}var wt={stopPropagation:!1,preventDefault:!1};function _t(r,n,e){return an(r,"",(function(r){return n.stopPropagation&&r.stopPropagation(),n.preventDefault&&r.preventDefault(),(t=it.decodeEvent(e,r)).tag?void 0:mr(t[0]);var t}))}it.at(["target",["value",0]],it.string),it.at(["target",["checked",0]],it.bool);var yt=it.field("keyCode",it.$$int);var kt={max:function(r){return b(1,["","max",r])},min:function(r){return b(1,["","min",r])},step:function(r){return b(1,["","step",r])},disabled:function(r){return r?b(1,["","disabled","true"]):0},selected:function(r){return r?b(1,["","selected","true"]):0},acceptCharset:function(r){return b(1,["","accept-charset",r])},rel:function(r){return b(1,["","rel",r])}},xt=en,qt=dr("CamlinternalLazy.Undefined");function Ft(r){throw qt}function St(r){var n=0|r.tag;return 250===n?r[0]:246!==n?r:function(r){var n,e=r[0];r[0]=Ft;try{var t=s(e,void 0);return r[0]=t,n=250,r.tag=n,t}catch(n){throw r[0]=function(r){throw n},n}}(r)}function Nt(r,n){return Lr(Nr(n,r))}var Ct={take:function(r,n){var e=function(r,n,e){for(;;){var t=n,a=r;if(0===e)return[a,t];if(!t)return[a,0];e=e-1|0,n=t[1],r=[t[0],a]}}(0,n,r);return[Fr(e[0]),e[1]]},apply:function(r,n){return s(n,r)},bind:Nt,concat_map:function(r,n){return Lr(Nr(r,n))},$great$great$eq:Nt,list_from_option:function(r){return void 0!==r?[gr(r),0]:0},first_inconsistent_opt:function(r,n){if(r)for(var e=s(n,r[0]),t=r[1];;){var a=t,u=e;if(!a)return;var i=s(n,a[0]);if(!x(i,u))return[u,i];t=a[1],e=i}}};var At={keydown:function(r){var n,e,t=it.field("ctrlKey",it.bool),a=it.map2((function(r,n){return{ctrlKey:n,keyCode:r}}),yt,t);return n="keydown",e=it.andThen(r,a),_t(n,wt,e)}};function Mt(r){return[r,0]}function Rt(r,n){if(!n)return 0;var e=n[1];return[s(r,n[0]),k((function(n){return Rt(r,St(e))}))]}function Lt(r,n){if(!r)return St(n);var e=r[1];return[r[0],k((function(r){return Lt(St(n),e)}))]}function Ot(r){if(!r)return 0;var n=r[1];return Lt(r[0],k((function(r){return Ot(St(n))})))}function Dt(r,n){return Ot(Rt(n,r))}var Tt={$$return:Mt,unit:Mt,push:function(r,n){return[r,n]},map:Rt,filter:function r(n,e){for(;;){var t=e;if(!t)return 0;var a=t[1],u=t[0];if(s(n,u))return[u,k(function(e){return function(t){return r(n,St(e))}}(a))];e=St(a)}},interleave_delayed:Lt,append_delayed:function r(n,e){if(!n)return St(e);var t=n[1];return[n[0],k((function(n){return r(St(t),e)}))]},flatten:Ot,bind:Dt,$great$great$eq:Dt,from_list:function r(n){if(!n)return 0;var e=n[1];return[n[0],k((function(n){return r(e)}))]},from_option:function(r){return void 0!==r?[gr(r),0]:0}};function $t(r,n){return[v(ne([b(2,[0,b(4,[0,0,0,0])]),"%s%d"]),r[0],n)]}function Et(r){return s(ne([b(12,[63,b(2,[0,0])]),"?%s"]),r[0])}var Pt={compare:function(r,n){return _(r[0],n[0])},make:function(r){return[r]},make_numbered:$t,to_string:Et};function It(r,n){return _(r[0],n[0])}function Vt(r,n){return r[0]===n[0]}var Bt={make:function(r){return[r]},compare:It,equals:Vt,to_string:function(r){return r[0]}};function Ut(r){if(!r.tag)return Et(r[0]);var n=r[0],e=n.related_terms,t=n.relation_name[0];return e?v(ne([b(2,[0,b(12,[40,b(2,[0,b(12,[41,0])])])]),"%s(%s)"]),t,Kr(", ",Nr(Ut,e))):t}function Qt(r){if(!r.tag)return 0;var n=r[0],e=n.related_terms;return[[n.relation_name,xr(e)],Ct.concat_map(Qt,e)]}var jt={make_relation:function(r,n){return b(1,[{relation_name:[r],related_terms:n}])},make_variable:function(r){return b(0,[[r]])},to_string:Ut,relation_arities:Qt};function zt(r){switch(0|r.tag){case 0:return Ut(r[0]);case 1:return v(ne([b(12,[60,b(2,[0,b(11,[" = ",b(2,[0,b(12,[62,0])])])])]),"<%s = %s>"]),Ut(r[0]),Ut(r[1]));case 2:return v(ne([b(12,[60,b(2,[0,b(11,[" /= ",b(2,[0,b(12,[62,0])])])])]),"<%s /= %s>"]),Ut(r[0]),Ut(r[1]))}}function Xt(r){switch(0|r.tag){case 0:return Qt(r[0])}return Lr([Qt(r[0]),[Qt(r[1]),0]])}var Kt={to_string:zt,relation_arities:Xt},Gt=Me(Pt),Jt=Gt.empty;function Ht(r,n){return l(Gt.add,r[0],r[1],n)}function Wt(r,n){var e=v(Gt.find_opt,r,n);if(void 0!==e){if(e.tag)return e;var t=Wt(e[0],n);return void 0!==t?t:e}}function Yt(r,n){var e=function(r){var e=Wt(r,n);return void 0!==e?a(e):b(0,[["?"]])},t=function(r,n){if(n.tag)return Ar(t,r,n[0].related_terms);var a=n[0];return Ht([a,e(a)],r)},a=function(r){if(!r.tag)return e(r[0]);var n=r[0];return b(1,[{relation_name:n.relation_name,related_terms:Nr(a,n.related_terms)}])};return s(Gt.bindings,Ar((function(r,n){switch(0|n.tag){case 0:return t(r,n[0])}return t(t(r,n[0]),n[1])}),Jt,r))}function Zt(r,n,e){var t=function(r){for(;;){var a=r;if(a.tag)return Mr(t,a[0].related_terms);var u=a[0];if(x(u,n))return!0;var i=Wt(u,e);if(void 0===i)return!1;r=i}};return t(r)}var ra={FrameMap:Gt,empty:Jt,extend:Ht,lookup:Wt,instantiate:function(r){var n=function(e){if(!e.tag){var t=Wt(e[0],r);return void 0!==t?n(t):b(0,[["?"]])}var a=e[0];return b(1,[{relation_name:a.relation_name,related_terms:Nr(n,a.related_terms)}])};return n},variable_bindings_in_query:Yt,to_strings:function(r,n){var e=Yt(r,n);return e?Nr((function(r){return v(ne([b(2,[0,b(11,[" := ",b(2,[0,0])])]),"%s := %s"]),Et(r[0]),Ut(r[1]))}),e):0},term_depends_on_variable:Zt};function na(r){return Lr([Sr(Nr(Xt,r.antecedents)),[Qt(r.consequent),0]])}var ea={contents:0};function ta(r){switch(0|r.tag){case 0:return b(0,[aa(r[0])]);case 1:return b(1,[aa(r[0]),aa(r[1])]);case 2:return b(2,[aa(r[0]),aa(r[1])])}}function aa(r){if(!r.tag)return b(0,[$t(r[0],ea.contents)]);var n=r[0],e=Nr(aa,n.related_terms);return b(1,[{relation_name:n.relation_name,related_terms:e}])}function ua(r){return ea.contents=ea.contents+1|0,{antecedents:Nr(ta,r.antecedents),consequent:aa(r.consequent)}}var ia={to_string:function(r){var n=r.antecedents,e=Ut(r.consequent);if(!n)return e;var t=Kr(" and ",Nr(zt,n));return v(ne([b(2,[0,b(11,[" when ",b(2,[0,0])])]),"%s when %s"]),e,t)},relation_arities:na,rename_rule_variables:ua},oa=Me({compare:Hr});function ca(r){return r.rule}function fa(r,n){return r.id===n.id}var sa=oa.empty;function va(r,n){var e;if(n.tag){var t=v(oa.find_opt,n[0].relation_name[0],r.indexed_by_consequent_relation);e=void 0!==t?t:0}else e=r.all_rules;return Tt.from_list(Fr(e))}function la(r){return r.all_rules}var da={contents:1};var ha={VariableName:Pt,RelationName:Bt,Term:jt,ComplexTerm:Kt,Frame:ra,Rule:ia,RuleDatabase:{empty:{all_rules:0,indexed_by_consequent_relation:sa},rule_from_entry:ca,update_rule_entry:function(r,n){return{id:r.id,rule:n}},is_same:fa,remove_rule:function(r,n){var e=n.id,t=Or((function(r){return r.id!==e})),a=s(t,r.all_rules),u=n.rule.consequent;return u.tag?{all_rules:a,indexed_by_consequent_relation:l(oa.update,u[0].relation_name[0],(function(r){return void 0!==r?s(t,r):0}),r.indexed_by_consequent_relation)}:{all_rules:a,indexed_by_consequent_relation:r.indexed_by_consequent_relation}},add_rule:function(r,n){var e={id:(da.contents=da.contents+1|0,da.contents),rule:n},t=n.consequent;return t.tag?{all_rules:[e,r.all_rules],indexed_by_consequent_relation:l(oa.update,t[0].relation_name[0],(function(r){return void 0!==r?[e,r]:[e,0]}),r.indexed_by_consequent_relation)}:{all_rules:[e,r.all_rules],indexed_by_consequent_relation:r.indexed_by_consequent_relation}},update_rule:function(r,n){var e=function(r){return Nr((function(r){return r.id===n.id?n:r}),r)},t=e(r.all_rules),a=n.rule.consequent;return a.tag?{all_rules:t,indexed_by_consequent_relation:l(oa.update,a[0].relation_name[0],(function(r){return void 0!==r?e(r):[n,0]}),r.indexed_by_consequent_relation)}:{all_rules:t,indexed_by_consequent_relation:r.indexed_by_consequent_relation}},fetch_for_query:va,all_rules:la}};function ma(r){var n=me(95),e=function(r){return Ne(ke,n,r)},t=s(ne([b(2,[0,b(11,[" requires ",b(2,[0,0])])]),"%s requires %s"]),r),a=function(r){return ce(t,e,r)};return function(r){return Se(a,(function(r){return se((function(n){return Kr("",Nr((function(r){return zr(1,r)}),[r,n]))}),function r(n){var e=function(e){return ue(n,(function(e){var t=r(n);return function(r){return ue(t,(function(r){var n=[e,r];return function(r){return oe(n,r)}}),r)}}),e)};return function(r){return ve(e,(function(r){return oe(0,r)}),r)}}(le([ke,[_e,[me(95),[me(45),0]]]])))}),r)}}var ga=Ce(me(63),se((function(r){return b(0,[[r]])}),ma("Variable")));function pa(r){return fe("Variable starting with ?",ga,r)}var ba=Ce(qe("= "),(function(r){return oe(!0,r)})),wa=Ce(qe("/= "),(function(r){return oe(!1,r)}));function _a(r){return Ne(ba,wa,r)}function ya(r){return de(r,Ce(Ce(xe,qe("and")),xe))}function ka(r){return Ne(se((function(r){return b(0,[r])}),qa),xa,r)}function xa(r){return Se(Ce(me(60),qa),(function(r){return function(n){return Se(_a,(function(n){var e=Ae(qa,me(62));return function(t){return Se(e,(function(e){var t=b(n?1:2,[r,e]);return function(r){return oe(t,r)}}),t)}}),n)}}),r)}function qa(r){return Ne(pa,Sa,r)}function Fa(r){return de(Ae(qa,xe),Ce(me(44),xe))(r)}function Sa(r){return Se(Ae(ma("Relation"),xe),(function(r){var n=[r],e=b(1,[{relation_name:n,related_terms:0}]),t=Ae(me(40),xe);return function(r){return ie(t,(function(r){return se((function(r){return b(1,[{relation_name:n,related_terms:r}])}),Ae(Ae(Fa,xe),me(41)))}),e,r)}}),r)}function Na(r){return ya(ka)(r)}var Ca,Aa=function(r){return Ae((function(r){return Se(qa,(function(r){var n={antecedents:0,consequent:r},e=function(r){return oe(n,r)},t=se((function(n){return{antecedents:n,consequent:r}}),Ce(Ce(Ce(xe,qe("when")),xe),Na));return function(r){return Ne(t,e,r)}}),r)}),me(46))(r)},Ma=function(r){return ya(ka)(r)},Ra={$$Map:Ca=Me({compare:It}),make:function(r,n){return Ar((function(n,e){return l(Ca.update,s(r,e),(function(r){return void 0!==r?[e,r]:[e,0]}),n)}),Ca.empty,n)},keys:function(r){return Nr((function(r){return r[0]}),s(Ca.bindings,r))},find_opt:function(r,n){return v(Ca.find_opt,r,n)}};function La(r,n){return Ar((function(n,e){var t=s(r,e);if(void 0===t)return n;var a=Ct.first_inconsistent_opt(t,(function(r){return r[1]}));return void 0!==a?[l(ne([b(11,["Relation '",b(2,[0,b(11,["' has inconsistent number of terms applied of ",b(4,[0,0,0,b(11,[" and ",b(4,[0,0,0,0])])])])])]),"Relation '%s' has inconsistent number of terms applied of %d and %d"]),e[0],a[0],a[1]),n]:n}),0,n)}function Oa(r){return v(Ra.make,(function(r){return r[0]}),Ct.concat_map(na,r))}function Da(r){return s(Ra.keys,v(Ra.make,(function(r){return r[0]}),na(r)))}var Ta={rule_database_snapshot:la,issues_in_existing_rule:function(r,n){var e=Oa(Nr(ca,[n,Or((function(r){return!fa(r,n)}))(r)]));return La((function(r){return v(Ra.find_opt,r,e)}),Da(ca(n)))},issues_in_new_rule:function(r,n){var e=Oa([n,Nr(ca,r)]);return La((function(r){return v(Ra.find_opt,r,e)}),Da(n))},issues_in_query:function(r,n){var e=Ct.concat_map(Xt,n),t=v(Ra.make,(function(r){return r[0]}),Lr([e,[Ct.concat_map(na,Nr(ca,r)),0]]));return La((function(r){return v(Ra.find_opt,r,t)}),s(Ra.keys,v(Ra.make,(function(r){return r[0]}),e)))}};function $a(r){var n=function(r,n){for(var e=0,t=0,a=n;;){var u=a,i=t,o=e;if(!u)return[qr(o,0),qr(i,0)];var c=u[1],f=u[0];s(r,f)?(a=c,e=[f,o]):(a=c,t=[f,i])}}((function(r){switch(0|r.tag){case 0:case 1:return!1;case 2:return!0}}),r);return Lr([n[1],[n[0],0]])}function Ea(r,n){var t=function(r,n){for(;;){var e=n,t=r;if(!t)return e;n=a(t[0],e),r=t[1]}},a=function(n,e){switch(0|n.tag){case 0:var a=n[0];return Tt.$great$great$eq(e,(function(n){return Tt.$great$great$eq(va(r,a),(function(r){var e=ua(ca(r)),i=u(a,e.consequent,n);return void 0!==i?t(e.antecedents,Tt.$$return({frame:i.frame,rules_applied:[r,i.rules_applied]})):0}))}));case 1:var i=n[1],o=n[0];return Tt.$great$great$eq(e,(function(r){return Tt.from_option(u(o,i,r))}));case 2:var c=n[1],f=n[0];return Tt.$great$great$eq(e,(function(r){return void 0!==u(f,c,r)?0:Tt.$$return(r)}))}},u=function(r,n,t){if(x(r,n))return t;if(!r.tag)return i(r[0],n,t);var a=r[0];if(!n.tag)return i(n[0],r,t);var o=n[0];return Vt(a.relation_name,o.relation_name)?Ar((function(r,n){if(void 0!==r)return u(n[0],n[1],r)}),t,function r(n,t){if(n){if(t)return[[n[0],t[0]],r(n[1],t[1])];throw[e,"List.combine"]}if(!t)return 0;throw[e,"List.combine"]}(a.related_terms,o.related_terms)):void 0},i=function(r,n,e){var t=Wt(r,e.frame);if(void 0!==t)return u(t,n,e);if(n.tag)return Zt(n,r,e.frame)?void 0:{frame:Ht([r,n],e.frame),rules_applied:e.rules_applied};var a=Wt(n[0],e.frame);return void 0!==a?u(b(0,[r]),a,e):{frame:Ht([r,n],e.frame),rules_applied:e.rules_applied}},o=$a(n);return function(r){return t(o,r)}}var Pa={query:function(r,n){return Ea(r,n)(Tt.$$return({frame:Jt,rules_applied:0}))}};function Ia(r,n){return{text:s(r,n),compilation_result:b(0,[n])}}function Va(r,n,e){var t,a=Fe(n,r);if(a.tag){var u=Dr(te,a[0]);if(u){var i=u[0],o=Or((function(r){return te(r,i)<=0}))(u[1]);t=b(1,[Nr(ae,[i,o])])}else t=b(1,[0])}else{var c=a[0].result,f=s(e,c);t=f?b(1,[f]):b(0,[c])}return{text:r,compilation_result:t}}function Ba(r){var n=r.solution_stream;return n?{initiating_query:r.initiating_query,solution_stream:St(n[1]),displayed_solutions:[n[0],r.displayed_solutions]}:r}var Ua={CompiledTextEditing:{empty:function(r){return{text:"",compilation_result:b(1,[0])}},edit:Ia,make:Va},ExecutingQueryInfo:{next_solution:Ba},init:function(r){return{rule_database:ha.RuleDatabase.empty,interaction_mode:0}}};var Qa={viewRules:0,initiateAddRule:1,initiateEditRule:function(r){return b(0,[r])},initiateEditQuery:2,updateText:function(r){return b(1,[r])},addRule:function(r){return b(2,[r])},editRuleEntry:function(r){return b(3,[r])},deleteRule:function(r){return b(4,[r])},executeQuery:function(r){return b(5,[r])},nextFrame:3};function ja(r){"remove"in Element.prototype||(Element.prototype.remove=function(){this.parentNode&&this.parentNode.removeChild(this)}),function(){for(var r=0,n=["ms","moz","webkit","o"],e=0;e<n.length&&!window.requestAnimationFrame;++e)window.requestAnimationFrame=window[n[e]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[n[e]+"CancelAnimationFrame"]||window[n[e]+"CancelRequestAnimationFrame"];window.requestAnimationFrame||(window.requestAnimationFrame=function(n,e){var t=(new Date).getTime(),a=Math.max(0,16-(t-r)),u=window.setTimeout((function(){n(t+a)}),a);return r=t+a,u}),window.cancelAnimationFrame||(window.cancelAnimationFrame=function(r){clearTimeout(r)})}()}function za(r,n,e,t,a,u){if(void 0===u)return function(u){var i={contents:0},o=function(r){var n=s(e,r);i.contents=wn(u,u,i.contents,n)};return{startup:function(r){bn(u,a),o(t)},render_string:function(r){return un(s(n,r))},handleMsg:function(n,e){var t=v(r,n,e),a=t[0];return bn(u,t[1]),o(a),a},shutdown:function(r){bn(u,r),i.contents=wn(u,u,i.contents,0)}}};var i=gr(u);return function(u){var o={contents:0},c={contents:t},f={contents:void 0},l=function(r){if(void 0!==f.contents){var e=[s(n,c.contents),0],t=function(r,n,e,t){return pn(r,n,n.childNodes,0,e,t),t}(u,i,o.contents,e);o.contents=t,f.contents=void 0}},d=function(r){for(;i.childNodes.length>0;){var n=i.firstChild;null!==n&&i.removeChild(n)}},h={contents:0},m=function(r){var n=s(e,r);h.contents=wn(u,u,h.contents,n)};return{startup:function(r){d(),bn(u,a),m(c.contents),f.contents=-1,l()},render_string:function(r){return un(s(n,r))},handleMsg:function(n,e){var t=v(r,n,e),a=t[0];return c.contents=a,bn(u,t[1]),void 0!==f.contents||(f.contents=-1,l()),m(a),a},shutdown:function(r){f.contents=void 0,bn(u,r),h.contents=wn(u,u,h.contents,0),o.contents=0,d()}}}}function Xa(r,e,t){ja();var a=s(r.init,t),u=a[0],i=null==e?void 0:mr(e);return function(r,e,t){var a={contents:r},u={contents:{enqueue:function(r){console.log("INVALID enqueue CALL!")}}},i=s(e,u),o={contents:void 0},c=function(r){var e=o.contents;if(void 0===e){o.contents=0;var t=v(i.handleMsg,a.contents,r);a.contents=t;var u=o.contents;if(void 0!==u)return u?(o.contents=void 0,Cr(c,Fr(u))):void(o.contents=void 0);throw[n,"INVALID message queue state, should never be None during message processing!"]}o.contents=[r,e]},f={enqueue:c};return u.contents=f,s(i.startup,void 0),{pushMsg:c,shutdown:function(r){u.contents={enqueue:function(r){console.log("INVALID message enqueued when shut down")}};var n=s(t,a.contents);s(i.shutdown,n)},getHtmlString:function(r){return s(i.render_string,a.contents)}}}(u,za(r.update,r.view,r.subscriptions,u,a[1],i),r.shutdown)}function Ka(r){return{href:r.href,protocol:r.protocol,host:r.host,hostname:r.hostname,port:r.port,pathname:r.pathname,search:r.search,hash:r.hash,username:r.username,password:r.password,origin:r.origin}}var Ga={contents:void 0};function Ja(r){return function(r,n){return b(1,[r,function(r){return s(n,r.contents)},{contents:void 0}])}("navigation",(function(n){Ga.contents=function(e){return s(n.enqueue,s(r,e))};var e,t,a,u=function(r){var n;void 0!==(n=Ga.contents)&&s(n,Ka(document.location))};return e="popstate",t=u,a=!1,window.addEventListener(e,t,a),function(r){return function(r,n,e){return window.removeEventListener(r,n,e)}("popstate",u,!1)}}))}function Ha(r,n,e){var t,a,u,i,o=void 0===r||r;return t=void 0,a=void 0,u=[bt(e),[kt.disabled(!o),0]],i=[ot(n),0],tn("","button",void 0!==t?t:"",void 0!==a?a:"",u,i)}function Wa(r){return ct(void 0,void 0,[ht("button-bar"),0],r)}var Ya="\n\n        ."+String("button-bar")+" {\n            padding-top: 5px; \n            padding-bottom: 5px;\n        }\n\n        button {\n            background-color: white;\n            color: #555;\n            box-shadow: 0 0 0 1px "+String("#48a9dc")+";\n            border: none;\n            border-radius: 4px;\n            padding: 6px;\n            margin-right: 8px;\n            font-size: 14px;\n        }\n\n        button:active {\n            background-color: "+String("#48a9dc")+";\n            color: white;\n        }\n\n        button:disabled {\n            background-color: #ddd;\n            color: #90adbd;\n        }\n\n        a, a:active, a:visited {\n            display: inline-block;\n            color: "+String("#48a9dc")+"\n        }\n\n        a, a:active, a:visited {\n            display: inline-block;\n            color: "+String("#48a9dc")+"\n        }\n    ";function Za(r,n){return ct(void 0,void 0,[ht("panel"),0],[ct(void 0,void 0,[ht("panel-header"),0],[ot(r),0]),[ct(void 0,void 0,[ht("panel-body"),0],n),0]])}var ru="\n        div."+String("panels")+" {\n            height: 98%;\n        }\n\n        div."+String("panel-header")+" {\n            background-color: #248;\n            color: white;\n            font-weight: bold;\n            padding: 4px;\n        }   \n\n        div."+String("panel")+" {\n            overflow-y: auto;\n            background-color: white;\n            margin-top: 5px;\n        }     \n        \n\n        @media screen and (max-width: 1023px) {\n            div."+String("panel")+" {\n                float: left;\n                width: 99%;\n                margin-top: 10px;\n                border: solid 1px #aaa;\n            }\n        }\n\n        @media screen and (min-width: 1024px) {\n            div."+String("panel")+" {\n                float: left;\n                margin-left: 5px;\n                margin-right: 5px;\n                width: 48%;\n                height: 98%;\n                border: solid 1px #aaa;\n            }\n        }\n\n        div."+String("panel-body")+" {\n            padding: 6px;\n        }\n    ",nu="\n        ."+String("variable")+" {\n            color: #ff0; \n        }\n\n        ."+String("fact")+" {\n            color: #0f0;\n        }\n        \n        ."+String("relation")+" {\n            color: #6af;\n            font-weight: bold;\n        }\n\n        ."+String("punctuation")+" {\n            color: white;\n            font-weight: bold;\n        }\n\n        ."+String("rule-display")+" {\n            background-color: black;\n            font-family: Consolas, monospace;\n            padding: 4px;\n        }\n\n        ."+String("rule-item")+" {\n            color: black;\n            background-color: white;\n\n            border-radius: 6px;\n            padding: 6px;\n            box-shadow: 0 0.5em 1em -0.125em rgba(10,10,10,.1), 0 0 0 1px rgba(10,10,10,.02);\n\n            margin-bottom: 12px;\n        }\n\n        ."+String("rule-item")+"."+String("rule-used")+" {\n            border: solid 2px #44f;\n            background-color: yellow;            \n        }\n\n        ul {\n            list-style: none;\n            margin-block-start: 0;\n            margin-block-end: 0;\n        }\n    ";function eu(r){return ft(void 0,void 0,[ht("punctuation"),0],[ot(r),0])}function tu(r){if(!r.tag)return ft(void 0,void 0,[ht("variable"),0],[ot(s(ne([b(12,[63,b(2,[0,0])]),"?%s"]),r[0][0])),0]);var n=r[0],e=n.related_terms,t=n.relation_name[0];return e?ft(void 0,void 0,0,[ft(void 0,void 0,[ht("relation"),0],[ot(t),0]),[eu("("),[tu(e[0]),[ft(void 0,void 0,0,Nr((function(r){return ft(void 0,void 0,0,[eu(", "),[tu(r),0]])}),e[1])),[eu(")"),0]]]]]):ft(void 0,void 0,[ht("fact"),0],[ot(t),0])}function au(r){switch(0|r.tag){case 0:return tu(r[0]);case 1:return ft(void 0,void 0,0,[tu(r[0]),[eu("="),[tu(r[1]),0]]]);case 2:return ft(void 0,void 0,0,[tu(r[0]),[eu("/="),[tu(r[1]),0]]])}}function uu(r){var n,e=r.antecedents,t=function(r,n){return lt(void 0,void 0,0,[eu(r),[au(n),0]])};if(e){var a=e[0],u=Fr(e[1]);n=u?vt(void 0,void 0,0,Lr([[t("when ",a),0],[Nr((function(r){return t("and ",r)}),Fr(u[1])),[[lt(void 0,void 0,0,[eu("and "),[au(u[0]),[eu("."),0]]]),0],0]]])):ft(void 0,void 0,0,[eu(" when "),[au(a),[eu("."),0]]])}else n=eu(".");return ct(void 0,void 0,[ht("rule-display"),0],[tu(r.consequent),[n,0]])}function iu(r){return ct(void 0,void 0,[mt([["rule-item",!0],0]),0],[Wa([Ha(void 0,"Edit",Qa.initiateEditRule(r)),[Ha(void 0,"Delete",Qa.deleteRule(r)),0]]),[uu(s(ha.RuleDatabase.rule_from_entry,r)),0]])}function ou(r,n,e,t,a){var u,i,o=r.compilation_result;if(o.tag)u=0;else{var c=o[0];u=s(At.keydown,(function(r){return 13===r.keyCode&&r.ctrlKey?it.succeed(s(e,c)):it.fail("Expecting Ctrl-Enter")}))}i=r.compilation_result.tag?xt:ct(void 0,void 0,0,[ot(s(ne([b(11,["(ctrl+enter to ",b(2,[0,b(12,[41,0])])]),"(ctrl+enter to %s)"]),n)),0]);var f,v,l,d,h,m,g,p=r.compilation_result;return f=p.tag?(v=p[0])?ct(void 0,void 0,[ht("errors-container"),0],[vt(void 0,void 0,0,Nr((function(r){return lt(void 0,void 0,0,[ot(r),0])}),v)),0]):xt:Ha(void 0,n,s(e,p[0])),ct(void 0,void 0,0,[(l=void 0,d=void 0,h=[pt(void 0,Qa.updateText),[ht("language-editing"),[(g=a,b(0,["placeholder",g])),[gt(r.text),[u,0]]]]],m=0,tn("","textarea",void 0!==l?l:"",void 0!==d?d:"",h,m)),[i,[Wa([f,[Ha(void 0,"Cancel",t),0]]),0]]])}function cu(r){var n,e=s(ha.RuleDatabase.all_rules,r.rule_database),t=function(r){return ct(void 0,void 0,0,Nr((function(n){return function(r,n){return ct(void 0,void 0,[mt([["rule-item",!0],[["rule-used",Mr((function(r){return v(ha.RuleDatabase.is_same,r,n)}),r)],0]]),0],[uu(s(ha.RuleDatabase.rule_from_entry,n)),0])}(r,n)}),e))},a=r.interaction_mode;if("number"==typeof a)n=ct(void 0,void 0,0,[Wa([Ha(void 0,"Add Rule / Fact",1),[Ha(void 0,"Query",2),0]]),[dt(void 0,void 0,0,0),[ct(void 0,void 0,0,Nr(iu,e)),0]]]);else switch(0|a.tag){case 0:n=ct(void 0,void 0,0,[ou(a[0],"Add Rule",Qa.addRule,0,"New rule..."),[dt(void 0,void 0,0,0),[t(0),0]]]);break;case 1:var u=a[0];n=ct(void 0,void 0,0,[ou(a[1],"Update Rule",(function(r){return Qa.editRuleEntry(v(ha.RuleDatabase.update_rule_entry,u,r))}),0,"Edit rule..."),[dt(void 0,void 0,0,0),[t(0),0]]]);break;case 2:n=t(0);break;case 3:var i=a[0].solution_stream;n=t(i?i[0].rules_applied:0)}return Za("Rules and Facts",[n,0])}function fu(r){var n,e,t,a,u=function(r){return Za("Query",[r,0])},i=function(r){return n=void 0,e=void 0,t=0,a=[ot(r),0],tn("","p",void 0!==n?n:"",void 0!==e?e:"",t,a);var n,e,t,a},o=r.interaction_mode;if("number"!=typeof o)switch(0|o.tag){case 2:return u(function(r){return ct(void 0,void 0,0,[ou(r,"Execute Query",Qa.executeQuery,0,"New query..."),0])}(o[0]));case 3:return u((n=o[0],e=n.solution_stream,t=n.initiating_query,a=function(r){var n=v(ha.Frame.to_strings,t,r.frame);return n?ct(void 0,void 0,0,[st(void 0,void 0,0,[ot("Satisfied:"),0]),[vt(void 0,void 0,0,Nr((function(r){return lt(void 0,void 0,0,[ot(r),0])}),n)),0]]):st(void 0,void 0,0,[ot("Satisfied"),0])},ct(void 0,void 0,0,[ct(void 0,void 0,0,Nr(a,n.displayed_solutions)),[e?ct(void 0,void 0,0,[a(e[0]),[Ha(void 0,"Next Frame",3),[Ha(void 0,"New Query",2),[Ha(void 0,"Cancel",0),0]]]]):Ha(void 0,"Another Query",2),0]])))}var c=function(r,n){return v(ha.Term.make_relation,r,n)},f=function(r,n){return{antecedents:Nr((function(r){return b(0,[r])}),n),consequent:r}},s=c("OrangesAreSpherical",0),l=c("oranges_are_spherical",0),d=c("Spherical",[c("Oranges",0),0]),h=c("Spherical",[c("SoccerBalls",0),0]),m=c("Spherical",[c("BasketBalls",0),0]),g=c("MotherOf",[c("Sally",0),[c("Bob",0),0]]),p=c("SumOf",[c("Two",0),[c("Two",0),[c("Four",0),0]]]);return Za("Instructions",[i("LitLog, short for Literate Logic programming, is a subset of Prolog with a simpler syntax and an on-line editor. \n                The goal of LitLog is offer a path to quickly learning the basics of declarative logic programming in three lunch breaks or less."),[i("When Logic Programming fits the problem space, it beats other programming paradigms by orders of magnitude so it is a helpful tool to\n                have in your mental toolbox (even if an applicable problem may only arise once in a decade). It is also just neat and that alone is worth a few lunch periods."),[i("The act of declarative logic programming is building a knowledge database that can be queried. It is the query powers that are surprising and interesting."),[i("Rules & Facts are the two forms of knowledge representation."),[i("FACTs are unconditionally true statements. As soon as a fact is entered into the database it is known to be true. \n                A Fact can relate other terms together or it can stand on its own. An example of a Fact that stands on its own without any relationships might be"),[uu({antecedents:0,consequent:s}),[i("A Fact is represented as an identifier written in any case. Spaces cannot be used inside Fact names but underscores can be. The above fact could have also been written"),[uu({antecedents:0,consequent:l}),[i("Facts can also express the truth of a _relationship_ between things. A Fact that expresses a relationship with a single term can be viewed as a declaration of \n                inclusion in a Set (a Predicate). For example, the Fact above could be represented, more usefully, as"),[uu({antecedents:0,consequent:d}),[i("The form above now expresses that Oranges are in the set of spherical things. The knowledge database could list other spherical things"),[uu({antecedents:0,consequent:h}),[uu({antecedents:0,consequent:m}),[i("Facts can express relationships between multiple things. For example, a fact which expresses a Mother-Child relationship between Sally and Bob"),[uu({antecedents:0,consequent:g}),[i("Another example might be a relation named 'SumOf' that expresses that two and two relate to four "),[uu({antecedents:0,consequent:p}),[i("While Facts are uncondtionally true, a RULE specifies a _conclusion_ whose truth is dependent upon one or more conditions. For example, we might instruct the logic database that \n                Sally being the Mother of Bob also means that Sally is a Parent of Bob."),[uu(f(c("ParentOf",[c("Sally",0),[c("Bob",0),0]]),[c("MotherOf",[c("Sally",0),[c("Bob",0),0]]),0])),[i("Observe that the rule above is unfortunately specific. It is not a general statement about all mothers and sons but rather a specific statement about two specific individuals.\n                In order to get the power of generalization (abstraction) we need to introduce variables."),[i("Variables are written with a ? prefix. To make a general statement about all mothers also being parents we would write"),[uu(f(c("ParentOf",[b(0,[["Mother"]]),[b(0,[["Child"]]),0]]),[c("MotherOf",[b(0,[["Mother"]]),[b(0,[["Child"]]),0]]),0])),[i("Rules can state multiple conditions that must be true for the rule to be true. To encode the transitive property of the GreaterThan relationship we might write"),[uu(f(c("GreaterThan",[b(0,[["A"]]),[b(0,[["C"]]),0]]),[c("GreaterThan",[b(0,[["A"]]),[b(0,[["B"]]),0]]),[c("GreaterThan",[b(0,[["B"]]),[b(0,[["C"]]),0]]),0]])),[i("Facts, Rules, and Variables are nearly the extent of how knowledge is represented in LitLog. Now we turn to the truly fun part QUERIES!!!\n                "),0]]]]]]]]]]]]]]]]]]]]]]]]])}var su=Kr(" ",["\n        html {\n            height: 100%\n        }\n\n        body {\n            height: 100%;\n            background-color: #eee;\n            display: flex;\n            flex-direction: column;\n            font-family: sans-serif;\n            padding: 0;\n            margin: 0;\n        }\n\n        p {\n            font-size: 14px;\n        }\n    ",[Ya,[ru,[nu,["\n        input {\n            margin-left: 6px;\n        }          \n        \n        ."+String("language-editing")+" {\n            width: 96%;\n            font-family: Consolas, monospace;\n            background-color: black;\n            color: white;\n        }\n\n        ."+String("errors-container")+" ul {\n            padding-left: 20px;\n            list-style: square;\n        }\n\n        ."+String("errors-container")+" li {\n            color: #800;\n            font-size: 14px;\n        }\n    ",["",["",0]]]]]]]);var vu=function(r,n){var e={init:function(r){return v(n.init,r,Ka(document.location))},update:n.update,view:n.view,subscriptions:function(e){return b(0,[[Ja(r),[s(n.subscriptions,e),0]]])},shutdown:n.shutdown};return function(r,n){return Xa(e,r,n)}}((function(r){return Qa.viewRules}),{init:function(r,n){return[Ua.init(void 0),0]},update:function(r,n){var e,t=r.interaction_mode,a=r.rule_database;if("number"==typeof n)switch(n){case 0:e={rule_database:a,interaction_mode:0};break;case 1:e={rule_database:a,interaction_mode:b(0,[{text:"",compilation_result:b(1,[0])}])};break;case 2:e={rule_database:a,interaction_mode:b(2,[{text:"",compilation_result:b(1,[0])}])};break;case 3:e="number"==typeof t||3!==t.tag?{rule_database:a,interaction_mode:t}:{rule_database:a,interaction_mode:b(3,[Ba(t[0])])}}else switch(0|n.tag){case 0:var u=n[0],i=s(ha.RuleDatabase.rule_from_entry,u);e={rule_database:a,interaction_mode:b(1,[u,Ia(ha.Rule.to_string,i)])};break;case 1:var o=n[0],c=Ta.rule_database_snapshot(a);if("number"==typeof t)e={rule_database:a,interaction_mode:t};else switch(0|t.tag){case 0:e={rule_database:a,interaction_mode:b(0,[Va(o,Aa,(function(r){return Ta.issues_in_new_rule(c,r)}))])};break;case 1:var f=t[0];e={rule_database:a,interaction_mode:b(1,[f,Va(o,Aa,(function(r){return Ta.issues_in_existing_rule(c,v(ha.RuleDatabase.update_rule_entry,f,r))}))])};break;case 2:e={rule_database:a,interaction_mode:b(2,[Va(o,Ma,(function(r){return Ta.issues_in_query(c,r)}))])};break;case 3:e={rule_database:a,interaction_mode:t}}break;case 2:e={rule_database:v(ha.RuleDatabase.add_rule,a,n[0]),interaction_mode:b(0,[{text:"",compilation_result:b(1,[0])}])};break;case 3:e={rule_database:v(ha.RuleDatabase.update_rule,a,n[0]),interaction_mode:0};break;case 4:e={rule_database:v(ha.RuleDatabase.remove_rule,a,n[0]),interaction_mode:t};break;case 5:var l=n[0];e={rule_database:a,interaction_mode:b(3,[{initiating_query:l,solution_stream:Pa.query(a,l),displayed_solutions:0}])}}return[e,0]},view:function(r){return n=[cu(r),[fu(r),0]],ct(void 0,void 0,[ht("panels"),0],n);var n},subscriptions:function(r){return 0},shutdown:function(r){return 0}});return r.main=function(r,n){var e=document.createElement("style");return document.head.appendChild(e),e.innerHTML=su,v(vu,r,void 0)},r}({});
