var starter=function(r){"use strict";var n=["Failure",-2],e=["Invalid_argument",-3],t=["Division_by_zero",-5],a=["Not_found",-6],u=["Match_failure",-7],i=["Assert_failure",-10];function o(r,n,e){for(var t=new Array(e),a=0,u=n;a<e;)t[a]=r[u],a=a+1|0,u=u+1|0;return t}function c(r,n){if(n<0||n>=r.length)throw[e,"index out of bounds"];return r[n]}function f(r,n){for(;;){var e=n,t=r,a=t.length,u=0===a?1:a,i=u-e.length|0;if(0===i)return t.apply(null,e);if(i>=0)return function(r,n){return function(e){return f(r,n.concat([e]))}}(t,e);n=o(e,u,0|-i),r=t.apply(null,o(e,0,u))}}function s(r,n){var e=r.length;if(1===e)return r(n);switch(e){case 1:return r(n);case 2:return function(e){return r(n,e)};case 3:return function(e,t){return r(n,e,t)};case 4:return function(e,t,a){return r(n,e,t,a)};case 5:return function(e,t,a,u){return r(n,e,t,a,u)};case 6:return function(e,t,a,u,i){return r(n,e,t,a,u,i)};case 7:return function(e,t,a,u,i,o){return r(n,e,t,a,u,i,o)};default:return f(r,[n])}}function v(r,n,e){var t=r.length;if(2===t)return r(n,e);switch(t){case 1:return f(r(n),[e]);case 2:return r(n,e);case 3:return function(t){return r(n,e,t)};case 4:return function(t,a){return r(n,e,t,a)};case 5:return function(t,a,u){return r(n,e,t,a,u)};case 6:return function(t,a,u,i){return r(n,e,t,a,u,i)};case 7:return function(t,a,u,i,o){return r(n,e,t,a,u,i,o)};default:return f(r,[n,e])}}function l(r,n,e,t){var a=r.length;if(3===a)return r(n,e,t);switch(a){case 1:return f(r(n),[e,t]);case 2:return f(r(n,e),[t]);case 3:return r(n,e,t);case 4:return function(a){return r(n,e,t,a)};case 5:return function(a,u){return r(n,e,t,a,u)};case 6:return function(a,u,i){return r(n,e,t,a,u,i)};case 7:return function(a,u,i,o){return r(n,e,t,a,u,i,o)};default:return f(r,[n,e,t])}}function d(r,n,e,t,a){var u=r.length;if(4===u)return r(n,e,t,a);switch(u){case 1:return f(r(n),[e,t,a]);case 2:return f(r(n,e),[t,a]);case 3:return f(r(n,e,t),[a]);case 4:return r(n,e,t,a);case 5:return function(u){return r(n,e,t,a,u)};case 6:return function(u,i){return r(n,e,t,a,u,i)};case 7:return function(u,i,o){return r(n,e,t,a,u,i,o)};default:return f(r,[n,e,t,a])}}function m(r,n,e,t,a,u){var i=r.length;if(5===i)return r(n,e,t,a,u);switch(i){case 1:return f(r(n),[e,t,a,u]);case 2:return f(r(n,e),[t,a,u]);case 3:return f(r(n,e,t),[a,u]);case 4:return f(r(n,e,t,a),[u]);case 5:return r(n,e,t,a,u);case 6:return function(i){return r(n,e,t,a,u,i)};case 7:return function(i,o){return r(n,e,t,a,u,i,o)};default:return f(r,[n,e,t,a,u])}}function h(r,n,e,t,a,u,i){var o=r.length;if(6===o)return r(n,e,t,a,u,i);switch(o){case 1:return f(r(n),[e,t,a,u,i]);case 2:return f(r(n,e),[t,a,u,i]);case 3:return f(r(n,e,t),[a,u,i]);case 4:return f(r(n,e,t,a),[u,i]);case 5:return f(r(n,e,t,a,u),[i]);case 6:return r(n,e,t,a,u,i);case 7:return function(o){return r(n,e,t,a,u,i,o)};default:return f(r,[n,e,t,a,u,i])}}function g(r,n,e,t,a,u,i,o){var c=r.length;if(7===c)return r(n,e,t,a,u,i,o);switch(c){case 1:return f(r(n),[e,t,a,u,i,o]);case 2:return f(r(n,e),[t,a,u,i,o]);case 3:return f(r(n,e,t),[a,u,i,o]);case 4:return f(r(n,e,t,a),[u,i,o]);case 5:return f(r(n,e,t,a,u),[i,o]);case 6:return f(r(n,e,t,a,u,i),[o]);case 7:return r(n,e,t,a,u,i,o);default:return f(r,[n,e,t,a,u,i,o])}}function p(r,n,e,t,a,u,i,o,c){var s=r.length;if(8===s)return r(n,e,t,a,u,i,o,c);switch(s){case 1:return f(r(n),[e,t,a,u,i,o,c]);case 2:return f(r(n,e),[t,a,u,i,o,c]);case 3:return f(r(n,e,t),[a,u,i,o,c]);case 4:return f(r(n,e,t,a),[u,i,o,c]);case 5:return f(r(n,e,t,a,u),[i,o,c]);case 6:return f(r(n,e,t,a,u,i),[o,c]);case 7:return f(r(n,e,t,a,u,i,o),[c]);default:return f(r,[n,e,t,a,u,i,o,c])}}function b(r,n){return n.tag=r,n}function w(r,n){return r<n?-1:r===n?0:1}function _(r,n){return r===n?0:r<n?-1:1}n.tag=248,e.tag=248,t.tag=248,a.tag=248,u.tag=248,i.tag=248;var y=function(r,n){for(var e in r)n(e)};function k(r){var n=[r];return n.tag=246,n}function x(r,n){for(;;){var t=n,a=r;if(a===t)return!0;var u=typeof a;if("string"===u||"number"===u||"boolean"===u||"undefined"===u||null===a)return!1;var i=typeof t;if("function"===u||"function"===i)throw[e,"equal: functional value"];if("number"===i||"undefined"===i||null===t)return!1;var o=0|a.tag,c=0|t.tag;if(250!==o)if(250!==c){if(248===o)return a[1]===t[1];if(251===o)throw[e,"equal: abstract value"];if(o!==c)return!1;if(256===o)return a[1]===t[1];var f=0|a.length;if(f!==(0|t.length))return!1;if(!Array.isArray(a)){if(a instanceof Date&&t instanceof Date)return!(a>t||a<t);var s={contents:!0},v=function(r,n){return function(e){r.hasOwnProperty(e)||(n.contents=!1)}}(t,s),l=function(r,n,e){return function(t){r.hasOwnProperty(t)&&x(n[t],r[t])||(e.contents=!1)}}(a,t,s);return y(a,v),s.contents&&y(t,l),s.contents}for(var d=0;;){var m=d;if(m===f)return!0;if(!x(a[m],t[m]))return!1;d=m+1|0}}else n=t[0];else r=a[0]}}function N(r,n){return!x(r,n)}function q(r){if(r<0)throw[e,"String.create"];for(var n=new Array(r),t=0;t<r;++t)n[t]=0;return n}function C(r,n,e,t,a){if(!(a<=0))if(r!==e){var u=r.length-n|0;if(a<=u)for(var i=0;i<a;++i)e[t+i|0]=r[n+i|0];else{for(var o=0;o<u;++o)e[t+o|0]=r[n+o|0];for(var c=u;c<a;++c)e[t+c|0]=0}}else{if(n<t){for(var f=(r.length-t|0)-1|0,s=a-1|0,v=f>s?s:f;v>=0;--v)r[t+v|0]=r[n+v|0];return}if(n<=t)return;for(var l=(r.length-n|0)-1|0,d=a-1|0,m=l>d?d:l,h=0;h<=m;++h)r[t+h|0]=r[n+h|0]}}function F(r){var n=r.length,e="",t=n;if(n<=4096&&n===r.length)return String.fromCharCode.apply(null,r);for(var a=0;t>0;){var u=t<1024?t:1024,i=new Array(u);C(r,a,i,0,u),e+=String.fromCharCode.apply(null,i),t=t-u|0,a=a+u|0}return e}function S(r,n,e,t,a){if(!(a<=0)){var u=r.length-n|0;if(a<=u)for(var i=0;i<a;++i)e[t+i|0]=r.charCodeAt(n+i|0);else{for(var o=0;o<u;++o)e[t+o|0]=r.charCodeAt(n+o|0);for(var c=u;c<a;++c)e[t+c|0]=0}}}function A(r){for(var n=r.length,e=new Array(n),t=0;t<n;++t)e[t]=r.charCodeAt(t);return e}var R=Math.imul||function(r,n){return((r>>16)*(n|=0)<<16)+(65535&r)*n|0};function D(r,n){return[n,r>>>0]}var M=[-2147483648,0],$=[2147483647,4294967295],E=[0,1],L=[0,0],O=[-1,4294967295];function T(r){return 0!=(2147483648&r)}function P(r){return 0==(2147483648&r)}function I(r){var n=1+(-1^r[1])|0;return D(n,(-1^r[0])+(0===n?1:0)|0)}function V(r,n,e){var t=r[1],a=t+n|0,u=T(t)&&(T(n)||P(a))||T(n)&&P(a)?1:0;return D(a,r[0]+e+u|0)}function U(r,n){return V(r,n[1],n[0])}function Q(r,n){return r[0]===n[0]&&r[1]===n[1]}function j(r,n,e){var t=1+(-1^n)>>>0;return V(r,t,(-1^e)+(0===t?1:0)|0)}function X(r,n){return j(r,n[1],n[0])}function z(r,n){if(0===n)return r;var e=r[1];return n>=32?D(0,e<<(n-32|0)):D(e<<n,e>>>(32-n|0)|r[0]<<n)}function B(r,n){if(0===n)return r;var e=r[0];return n<32?D(e<<(32-n|0)|r[1]>>>n,e>>n):D(e>>(n-32|0),e>=0?0:-1)}function K(r,n){for(;;){var e,t=n,a=r,u=0,i=0;if(0!==a[0])i=3;else{if(0===a[1])return L;i=3}if(3===i)if(0!==t[0])u=2;else{if(0===t[1])return L;u=2}if(2===u){var o=a[0],c=0;if(-2147483648!==o||0!==a[1]?c=3:e=t[1],3===c){var f=t[0],s=a[1],v=0;if(-2147483648!==f||0!==t[1]?v=4:e=s,4===v){var l=t[1];if(o<0){if(f>=0)return I(K(I(a),t));n=I(t),r=I(a);continue}if(f<0)return I(K(a,I(t)));var d=65535&o,m=s>>>16,h=65535&s,g=65535&f,p=l>>>16,b=65535&l,w=0,_=0,y=0,k=h*b;return w=(_=(_=(y=(k>>>16)+m*b)>>>16)+((y=(65535&y)+h*p)>>>16)+d*b)>>>16,w+=(_=(65535&_)+m*p)>>>16,w+=(_=(65535&_)+h*g)>>>16,D(65535&k|(65535&y)<<16,(_&=65535)|(w=w+((o>>>16)*b+d*p+m*g+h*(f>>>16))&65535)<<16)}}}return 0==(1&e)?L:M}}function J(r,n){var e=n[0],t=r[0];return t>e||!(t<e)&&r[1]>=n[1]}function H(r,n){return!Q(r,n)}function G(r,n){return!J(r,n)}function W(r,n){return r[0]>n[0]||!(r[0]<n[0])&&r[1]>n[1]}function Y(r){return 4294967296*r[0]+r[1]}function Z(r){return isNaN(r)||!isFinite(r)?L:r<=-0x8000000000000000?M:r+1>=0x8000000000000000?$:r<0?I(Z(-r)):D(r%4294967296|0,r/4294967296|0)}function rr(r){if(function(r){var n=r[0],e=n>>21;return 0===e||-1===e&&!(0===r[1]&&-2097152===n)}(r))return String(Y(r));if(r[0]<0)return Q(r,M)?"-9223372036854775808":"-"+rr(I(r));var n=Z(Math.floor(Y(r)/10)),e=n[1],t=n[0],a=j(j(r,e<<3,e>>>29|t<<3),e<<1,e>>>31|t<<1),u=a[1],i=a[0];if(0===u&&0===i)return rr(n)+"0";if(i<0){var o=1+(-1^u)>>>0,c=Math.ceil(o/10),f=10*c-o;return rr(j(n,0|c,0))+String(0|f)}var s=u,v=Math.floor(s/10),l=s-10*v;return rr(V(n,0|v,0))+String(0|l)}function nr(r,n){var e=function r(n,e){for(;;){var a=e,u=n,i=0;if(0===a[0]&&0===a[1])throw t;if(3===3){var o=u[0];if(-2147483648!==o)if(0!==o)i=2;else{if(0===u[1])return L;i=2}else if(0!==u[1])i=2;else{if(Q(a,E)||Q(a,O))return u;if(Q(a,M))return E;var c=z(r(B(u,1),a),1),f=0;if(0!==c[0])f=4;else{if(0===c[1])return a[0]<0?E:I(E);f=4}if(4===f)return U(c,r(X(u,K(a,c)),a))}}if(2===i&&-2147483648===a[0]&&0===a[1])return L;var s=a[0];if(!(u[0]<0)){if(s<0)return I(r(u,I(a)));for(var v=L,l=u;J(l,a);){for(var d=(w=1,_=Math.floor(Y(l)/Y(a)),w>_?w:_),m=Math.ceil(Math.log(d)/Math.LN2),h=m<=48?1:Math.pow(2,m-48),g=Z(d),p=K(g,a);p[0]<0||W(p,l);)p=K(g=Z(d-=h),a);0===(b=g)[0]&&0===b[1]&&(g=E),v=U(v,g),l=X(l,p)}return v}if(s>=0)return I(r(I(u),a));e=I(a),n=I(u)}var b,w,_}(r,n);return[e,X(r,K(e,n))]}function er(r){return 0|r[1]}function tr(r){return[2147483647&r[0],r[1]]}function ar(r){return r>=65&&r<=90||r>=192&&r<=214||r>=216&&r<=222?r+32|0:r}function ur(r){var n=r.length;if(n>31)throw[e,"format_int: format too long"];for(var t={justify:"+",signstyle:"-",filter:" ",alternate:!1,base:2,signedconv:!1,width:0,uppercase:!1,sign:1,prec:-1,conv:"f"},a=0;;){var u=a;if(u>=n)return t;var i=r.charCodeAt(u),o=0;if(i>=69)if(i>=88)if(i>=121)o=1;else switch(i-88|0){case 0:t.base=1,t.uppercase=!0,a=u+1|0;continue;case 13:case 14:case 15:o=5;break;case 12:case 17:o=4;break;case 23:t.base=0,a=u+1|0;continue;case 29:t.base=2,a=u+1|0;continue;case 1:case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 16:case 18:case 19:case 20:case 21:case 22:case 24:case 25:case 26:case 27:case 28:case 30:case 31:o=1;break;case 32:t.base=1,a=u+1|0;continue}else{if(!(i>=72)){t.signedconv=!0,t.uppercase=!0,t.conv=String.fromCharCode(ar(i)),a=u+1|0;continue}o=1}else switch(i){case 35:t.alternate=!0,a=u+1|0;continue;case 32:case 43:o=2;break;case 45:t.justify="-",a=u+1|0;continue;case 46:t.prec=0;for(var c=u+1|0;function(n){return function(){var e=r.charCodeAt(n)-48|0;return e>=0&&e<=9}}(c)();)t.prec=(R(t.prec,10)+r.charCodeAt(c)|0)-48|0,c=c+1|0;a=c;continue;case 33:case 34:case 36:case 37:case 38:case 39:case 40:case 41:case 42:case 44:case 47:o=1;break;case 48:t.filter="0",a=u+1|0;continue;case 49:case 50:case 51:case 52:case 53:case 54:case 55:case 56:case 57:o=3;break;default:o=1}switch(o){case 1:a=u+1|0;continue;case 2:t.signstyle=String.fromCharCode(i),a=u+1|0;continue;case 3:t.width=0;for(var f=u;function(n){return function(){var e=r.charCodeAt(n)-48|0;return e>=0&&e<=9}}(f)();)t.width=(R(t.width,10)+r.charCodeAt(f)|0)-48|0,f=f+1|0;a=f;continue;case 4:t.signedconv=!0,t.base=2,a=u+1|0;continue;case 5:t.signedconv=!0,t.conv=String.fromCharCode(i),a=u+1|0;continue}}}function ir(r,n){var e=r.justify,t=r.signstyle,a=r.filter,u=r.alternate,i=r.base,o=r.signedconv,c=r.width,f=r.uppercase,s=r.sign,v=n.length;o&&(s<0||"-"!==t)&&(v=v+1|0),u&&(0===i?v=v+1|0:1===i&&(v=v+2|0));var l="";if("+"===e&&" "===a)for(var d=v;d<c;++d)l+=a;if(o&&(s<0?l+="-":"-"!==t&&(l+=t)),u&&0===i&&(l+="0"),u&&1===i&&(l+="0x"),"+"===e&&"0"===a)for(var m=v;m<c;++m)l+=a;if(l=f?l+n.toUpperCase():l+n,"-"===e)for(var h=v;h<c;++h)l+=" ";return l}function or(r,n){if("%d"===r)return String(n);var e=ur(r),t=(n<0?e.signedconv?(e.sign=-1,-n):n>>>0:n).toString(function(r){switch(r){case 0:return 8;case 1:return 16;case 2:return 10}}(e.base));if(e.prec>=0){e.filter=" ";var a=e.prec-t.length|0;a>0&&(t="0".repeat(a)+t)}return ir(e,t)}function cr(r,n){if("%d"===r)return rr(n);var e,t,a=ur(r),u=a.signedconv&&G(n,L)?(a.sign=-1,I(n)):n;switch(a.base){case 0:e=function(r){var n="",e=D(8,0),t="01234567";if(G(r,L)){var a=nr(tr(r),e),u=U(D(0,268435456),a[0]),i=a[1];for(n=t[er(i)]+n;H(u,L);){var o=nr(u,e);u=o[0],n=t[er(i=o[1])]+n}}else{var c=nr(r,e),f=c[0],s=c[1];for(n=t[er(s)]+n;H(f,L);){var v=nr(f,e);f=v[0],n=t[er(s=v[1])]+n}}return n}(u);break;case 1:e=function(r){var n=r[1],e=r[0],t=function(r){return(r>>>0).toString(16)};if(0===e&&0===n)return"0";if(0===n)return t(e)+"00000000";if(0===e)return t(n);var a=t(n),u=8-a.length|0;return u<=0?t(e)+a:t(e)+("0".repeat(u)+a)}(u);break;case 2:e=function(r){if(!G(r,L))return rr(r);var n=D(10,0),e=nr(tr(r),n),t=nr(U(D(8,0),e[1]),n);return rr(U(U(D(-858993460,214748364),e[0]),t[0]))+"0123456789"[er(t[1])]}(u)}if(a.prec>=0){a.filter=" ";var i=a.prec-e.length|0;t=i>0?"0".repeat(i)+e:e}else t=e;return ir(a,t)}var fr=or,sr=or;function vr(r,n){if(n>=r.length||n<0)throw[e,"index out of bounds"];return r.charCodeAt(n)}var lr={contents:0};function dr(r){var n=[r,(lr.contents=lr.contents+1,lr.contents)];return n.tag=248,n}var mr=[];function hr(r){if(void 0===r){var n=[mr,0];return n.tag=256,n}if(null===r||r[0]!==mr)return r;var e=r[1]+1|0,t=[mr,e];return t.tag=256,t}function gr(r){if(null===r||r[0]!==mr)return r;var n=r[1];return 0===n?void 0:[mr,n-1|0]}var pr=dr("Caml_js_exceptions.Error");function br(r){return function(r){if(void 0===r)return!1;if(248===r.tag)return!0;var n=r[0];return void 0!==n&&248===n.tag}(r)?r:[pr,r]}function wr(r){if("number"==typeof r)return 0;switch(0|r.tag){case 0:return b(0,[wr(r[0])]);case 1:return b(1,[wr(r[0])]);case 2:return b(2,[wr(r[0])]);case 3:return b(3,[wr(r[0])]);case 4:return b(4,[wr(r[0])]);case 5:return b(5,[wr(r[0])]);case 6:return b(6,[wr(r[0])]);case 7:return b(7,[wr(r[0])]);case 8:return b(8,[r[0],wr(r[1])]);case 9:var n=r[0];return b(9,[n,n,wr(r[2])]);case 10:return b(10,[wr(r[0])]);case 11:return b(11,[wr(r[0])]);case 12:return b(12,[wr(r[0])]);case 13:return b(13,[wr(r[0])]);case 14:return b(14,[wr(r[0])])}}function _r(r,n){if("number"==typeof r)return n;switch(0|r.tag){case 0:return b(0,[_r(r[0],n)]);case 1:return b(1,[_r(r[0],n)]);case 2:return b(2,[r[0],_r(r[1],n)]);case 3:return b(3,[r[0],_r(r[1],n)]);case 4:return b(4,[r[0],r[1],r[2],_r(r[3],n)]);case 5:return b(5,[r[0],r[1],r[2],_r(r[3],n)]);case 6:return b(6,[r[0],r[1],r[2],_r(r[3],n)]);case 7:return b(7,[r[0],r[1],r[2],_r(r[3],n)]);case 8:return b(8,[r[0],r[1],r[2],_r(r[3],n)]);case 9:return b(9,[r[0],_r(r[1],n)]);case 10:return b(10,[_r(r[0],n)]);case 11:return b(11,[r[0],_r(r[1],n)]);case 12:return b(12,[r[0],_r(r[1],n)]);case 13:return b(13,[r[0],r[1],_r(r[2],n)]);case 14:return b(14,[r[0],r[1],_r(r[2],n)]);case 15:return b(15,[_r(r[0],n)]);case 16:return b(16,[_r(r[0],n)]);case 17:return b(17,[r[0],_r(r[1],n)]);case 18:return b(18,[r[0],_r(r[1],n)]);case 19:return b(19,[_r(r[0],n)]);case 20:return b(20,[r[0],r[1],_r(r[2],n)]);case 21:return b(21,[r[0],_r(r[1],n)]);case 22:return b(22,[_r(r[0],n)]);case 23:return b(23,[r[0],_r(r[1],n)]);case 24:return b(24,[r[0],r[1],_r(r[2],n)])}}dr("Pervasives.Exit");function yr(r){return r>=0?r:0|-r}function kr(r){return r?"true":"false"}function xr(r){for(var n=0,e=r;;){var t=n;if(!e)return t;e=e[1],n=t+1|0}}function Nr(r,n){for(;;){var e=n,t=r;if(!t)return e;n=[t[0],e],r=t[1]}}function qr(r){return Nr(r,0)}function Cr(r){return r?function r(n,e){return n?[n[0],r(n[1],e)]:e}(r[0],Cr(r[1])):0}function Fr(r,n){return n?[s(r,n[0]),Fr(r,n[1])]:0}function Sr(r,n){for(;;){var e=n;if(!e)return;s(r,e[0]),n=e[1]}}function Ar(r,n,e){for(;;){var t=e,a=n;if(!t)return a;e=t[1],n=v(r,a,t[0])}}function Rr(r,n){for(;;){var e=n;if(!e)return!1;if(s(r,e[0]))return!0;n=e[1]}}function Dr(r,n){for(;;){var e=r;if(0===e)return n;if(!n)throw[i,["list.ml",262,11]];n=n[1],r=e-1|0}}var Mr=Cr,$r=function(r){return function(n){for(var e=0,t=n;;){var a=t,u=e;if(!a)return Nr(u,0);var i=a[1],o=a[0];s(r,o)?(t=i,e=[o,u]):t=i}}},Er=function(r,n){var e=function(n,e){if(2!==n){if(3===n&&e){var a=e[1];if(a){var u=a[1];if(u){var i=u[0],o=a[0],c=e[0];return v(r,c,o)<=0?v(r,o,i)<=0?[c,[o,[i,0]]]:v(r,c,i)<=0?[c,[i,[o,0]]]:[i,[c,[o,0]]]:v(r,c,i)<=0?[o,[c,[i,0]]]:v(r,o,i)<=0?[o,[i,[c,0]]]:[i,[o,[c,0]]]}}}}else if(e){var f=e[1];if(f){var s=f[0],l=e[0];return v(r,l,s)<=0?[l,[s,0]]:[s,[l,0]]}}for(var d=n>>1,m=n-d|0,h=Dr(d,e),g=t(d,e),p=t(m,h),b=0;;){var w=b,_=p,y=g;if(!y)return Nr(_,w);if(!_)return Nr(y,w);var k=_[0],x=y[0];v(r,x,k)>0?(b=[x,w],g=y[1]):(b=[k,w],p=_[1])}},t=function(n,t){if(2!==n){if(3===n&&t){var a=t[1];if(a){var u=a[1];if(u){var i=u[0],o=a[0],c=t[0];return v(r,c,o)>0?v(r,o,i)>0?[c,[o,[i,0]]]:v(r,c,i)>0?[c,[i,[o,0]]]:[i,[c,[o,0]]]:v(r,c,i)>0?[o,[c,[i,0]]]:v(r,o,i)>0?[o,[i,[c,0]]]:[i,[o,[c,0]]]}}}}else if(t){var f=t[1];if(f){var s=f[0],l=t[0];return v(r,l,s)>0?[l,[s,0]]:[s,[l,0]]}}for(var d=n>>1,m=n-d|0,h=Dr(d,t),g=e(d,t),p=e(m,h),b=0;;){var w=b,_=p,y=g;if(!y)return Nr(_,w);if(!_)return Nr(y,w);var k=_[0],x=y[0];v(r,x,k)<=0?(b=[x,w],g=y[1]):(b=[k,w],p=_[1])}},a=xr(n);return a<2?n:e(a,n)};function Lr(r){return r>=97&&r<=122?r-32|0:r}function Or(r,n){var e=q(r);return function(r,n,e,t){if(!(e<=0))for(var a=n,u=e+n|0;a<u;++a)r[a]=t}(e,0,r,n),e}var Tr=[];function Pr(r,n,t){if(n<0||t<0||n>(r.length-t|0))throw[e,"String.sub / Bytes.sub"];var a=q(t);return C(r,n,a,0,t),a}function Ir(r,n,e){return F(Pr(r,n,e))}function Vr(r,n,t,a,u){if(u<0||n<0||n>(r.length-u|0)||a<0||a>(t.length-u|0))throw[e,"Bytes.blit"];return C(r,n,t,a,u)}function Ur(r,n,t,a,u){if(u<0||n<0||n>(r.length-u|0)||a<0||a>(t.length-u|0))throw[e,"String.blit / Bytes.blit_string"];return S(r,n,t,a,u)}function Qr(r){var n=r-9|0;return n>4||n<0?23===n:2!==n}function jr(r){for(var n=0,e=0,t=r.length;e<t;++e){var a,u=r[e];if(u>=32){var i=u-34|0;a=i>58||i<0?i>=93?4:1:i>57||i<1?2:1}else a=u>=11?13!==u?4:2:u>=8?2:4;n=n+a|0}if(n===r.length)return function(r){var n=r.length,e=q(n);return C(r,0,e,0,n),e}(r);var o=q(n);n=0;for(var c=0,f=r.length;c<f;++c){var s=r[c],v=0;if(s>=35)92!==s?s>=127?v=1:o[n]=s:v=2;else if(s>=32)s>=34?v=2:o[n]=s;else if(s>=14)v=1;else switch(s){case 8:o[n]=92,o[n=n+1|0]=98;break;case 9:o[n]=92,o[n=n+1|0]=116;break;case 10:o[n]=92,o[n=n+1|0]=110;break;case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:case 11:case 12:v=1;break;case 13:o[n]=92,o[n=n+1|0]=114}switch(v){case 1:o[n]=92,o[n=n+1|0]=48+(s/100|0)|0,o[n=n+1|0]=48+(s/10|0)%10|0,o[n=n+1|0]=48+s%10|0;break;case 2:o[n]=92,o[n=n+1|0]=s}n=n+1|0}return o}function Xr(r){return function(r,n){var e=n.length;if(0===e)return n;for(var t=q(e),a=0;a<e;++a)t[a]=s(r,n[a]);return t}(Lr,r)}function zr(r,n){return F(Or(r,n))}function Br(r,n){if(r>=n)return r;throw[e,"String.concat"]}function Kr(r,n){if(!n)return"";var e=r.length;return F(function(r,n,e,t,a){for(;;){var u=a,i=n;if(!u)return r;var o=u[1],c=u[0];if(!o)return S(c,0,r,i,c.length),r;S(c,0,r,i,c.length),S(e,0,r,i+c.length|0,t),a=o,n=(i+c.length|0)+t|0}}(q(function(r,n,e){for(;;){var t=e,a=r;if(!t)return a;var u=t[1],i=t[0];if(!u)return i.length+a|0;e=u,r=Br((i.length+n|0)+a|0,a)}}(0,e,n)),0,r,e,n))}function Jr(r){var n=r-9|0;return n>4||n<0?23===n:2!==n}function Hr(r){return""===r||!Jr(r.charCodeAt(0))&&!Jr(r.charCodeAt(r.length-1|0))?r:F(function(r){for(var n=r.length,e=0;e<n&&Qr(r[e]);)e=e+1|0;for(var t=n-1|0;t>=e&&Qr(r[t]);)t=t-1|0;return t>=e?Pr(r,e,1+(t-e|0)|0):Tr}(A(r)))}var Gr=_,Wr=Ur;function Yr(r,n,e,t){var a=void 0!==n&&n,u=r.style;return void 0!==u.setProperty?u.setProperty(e,t,a?"important":null):function(r,n,e){r.style[n]=e}(r,e,t)}function Zr(r,n,e){return r.insertBefore(n,e)}function rn(r,n,e,t){return""===n?r.setAttribute(e,t):r.setAttributeNS(n,e,t)}function nn(r,n){return""===r?document.createElement(n):document.createElementNS(r,n)}var en=b(0,[""]);function tn(r,n,e,t,a,u){return b(2,[r,n,e,t,a,u])}function an(r,n,e){return b(3,[r,b(0,[n,e]),{contents:void 0}])}function un(r){for(;;){var n=r;switch(0|n.tag){case 0:return"\x3c!-- "+n[0]+" --\x3e";case 1:return n[0];case 2:var e=n[1],t=n[0];return Kr("",["<",[t,[""===t?"":":",[e,[Kr("",Fr((function(r){if("number"==typeof r)return"";switch(0|r.tag){case 0:return Kr("",[" ",[r[0],['="',[r[1],['"',0]]]]]);case 1:return Kr("",[" ",[r[1],['="',[r[2],['"',0]]]]]);case 2:return Kr("",[" data-",[r[0],['="',[r[1],['"',0]]]]]);case 3:return"";case 4:return Kr("",[' style="',[Kr(";",Fr((function(r){return Kr("",[r[0],[":",[r[1],[";",0]]]])}),r[0])),['"',0]]])}}),n[4])),[">",[Kr("",Fr(un,n[5])),["</",[e,[">",0]]]]]]]]]]);case 3:r=s(n[1],void 0);continue;case 4:r=n[1];continue}}}function on(r){if(!r.tag)return r[1];var n=r[0];return function(r){return hr(n)}}function cn(r,n,e,t){var a,u,i,o={contents:on(t)},c=function(r,n){return function(e){var t=s(n.contents,e);if(void 0!==t)return s(r.contents.enqueue,gr(t))}}(r,o);return a=e,u=c,i=!1,n.addEventListener(a,u,i),{handler:c,cb:o}}function fn(r,n,e){if(void 0!==e)return t=r,a=n,u=e.handler,i=!1,void t.removeEventListener(a,u,i);var t,a,u,i}function sn(r,n,e,t,a,u,i,o){var c=i.contents;if(void 0!==c)if(e!==t)i.contents=fn(n,e,i.contents),o.contents=cn(r,n,t,u);else{if(o.contents=i.contents,function(r,n){return n.tag?!(!r.tag||!x(n[0],r[0])):!r.tag&&n[0]===r[0]}(a,u))return;var f=on(u);c.cb.contents=f}else o.contents=cn(r,n,t,u)}function vn(r,e,t,a,u){!function(r,e,t,a){var u,i,o;if("number"!=typeof a)switch(0|a.tag){case 0:return void(e[a[0]]=void 0);case 1:return u=e,i=a[0],o=a[1],""===i?u.removeAttribute(o):u.removeAttributeNS(i,o);case 2:throw console.log(["TODO:  Remove Data Unhandled",a[0],a[1]]),[n,"TODO:  Remove Data Unhandled"];case 3:var c=a[2];return void(c.contents=fn(e,a[0],c.contents));case 4:Ar((function(r,n){return Yr(e,void 0,n[0],null)}),void 0,a[0])}}(0,e,0,a),function(r,e,t,a){if("number"!=typeof a)switch(0|a.tag){case 0:return void(e[a[0]]=a[1]);case 1:return rn(e,a[0],a[1],a[2]);case 2:throw console.log(["TODO:  Add Data Unhandled",a[0],a[1]]),[n,"TODO:  Add Data Unhandled"];case 3:return void(a[2].contents=cn(r,e,a[0],a[1]));case 4:Ar((function(r,n){return Yr(e,void 0,n[0],n[1])}),void 0,a[0])}}(r,e,0,u)}function ln(r,t,a,u,i){if("number"==typeof i)throw[n,"This should never be called as all entries through NoProp are gated."];switch(0|i.tag){case 0:return void(t[i[0]]=i[1]);case 1:return rn(t,i[0],i[1],i[2]);case 2:throw console.log(["TODO:  Mutate Data Unhandled",i[0],i[1]]),[n,"TODO:  Mutate Data Unhandled"];case 3:throw[n,"This will never be called because it is gated"];case 4:if("number"==typeof u)throw[n,"Passed a non-Style to a new Style as a Mutations while the old Style is not actually a style!"];if(4===u.tag)return function(r,n,t,a){for(;;){var u=a,i=t,o=n;if(i){if(u){a=u[1],t=i[1],n=l(r,o,i[0],u[0]);continue}throw[e,"List.fold_left2"]}if(u)throw[e,"List.fold_left2"];return o}}((function(r,n,e){var a=e[1],u=e[0],i=n[0];return i===u?n[1]===a?void 0:Yr(t,void 0,u,a):(Yr(t,void 0,i,null),Yr(t,void 0,u,a))}),void 0,u[0],i[0]);throw[n,"Passed a non-Style to a new Style as a Mutations while the old Style is not actually a style!"]}}function dn(r,n,e,t){return function(r,n,e,t,a){for(;;){var u=a,i=t,o=e;if(!i)return!u;var c=i[0];if(!u)return!1;if("number"==typeof c){if("number"==typeof u[0]){a=u[1],t=i[1],e=o+1|0;continue}}else switch(0|c.tag){case 0:var f=u[0];if("number"!=typeof f&&!f.tag){c[0]===f[0]&&c[1]===f[1]||ln(0,n,0,c,f),a=u[1],t=i[1],e=o+1|0;continue}break;case 1:var s=u[0];if("number"!=typeof s&&1===s.tag){c[0]===s[0]&&c[1]===s[1]&&c[2]===s[2]||ln(0,n,0,c,s),a=u[1],t=i[1],e=o+1|0;continue}break;case 2:var v=u[0];if("number"!=typeof v&&2===v.tag){c[0]===v[0]&&c[1]===v[1]||ln(0,n,0,c,v),a=u[1],t=i[1],e=o+1|0;continue}break;case 3:var l=u[0];if("number"!=typeof l&&3===l.tag){sn(r,n,c[0],l[0],c[1],l[1],c[2],l[2]),a=u[1],t=i[1],e=o+1|0;continue}break;case 4:var d=u[0];if("number"!=typeof d&&4===d.tag){x(c[0],d[0])||ln(0,n,0,c,d),a=u[1],t=i[1],e=o+1|0;continue}}vn(r,n,0,c,u[0]),a=u[1],t=i[1],e=o+1|0}}(r,n,0,e,t)}function mn(r,e,t,a,i){if(2===i.tag){var o=i[4],f=c(t,a),s=nn(i[0],i[1]);if(dn(r,s,Fr((function(r){return 0}),o),o))return pn(r,s,s.childNodes,0,0,i[5]),Zr(e,s,f),void e.removeChild(f);throw[u,["vdom.ml",319,30]]}throw[n,"Node replacement should never be passed anything but a node itself"]}function hn(r,n){for(;;){var e=n,t=r;switch(0|e.tag){case 0:var a=e[0];return document.createComment(a);case 1:var i=e[0];return document.createTextNode(i);case 2:var o=e[4],c=nn(e[0],e[1]);if(dn(t,c,Fr((function(r){return 0}),o),o))return pn(t,c,c.childNodes,0,0,e[5]),c;throw[u,["vdom.ml",333,30]];case 3:var f=s(e[1],void 0);e[2].contents=f,n=f;continue;case 4:n=e[1],r=s(e[0],t);continue}}}function gn(r,e,t,a,u,i){if(2===u.tag){if(2===i.tag){if(u[3]!==i[3]||u[1]!==i[1])return mn(r,e,t,a,i);var o=c(t,a),f=o.childNodes;return dn(r,o,u[4],i[4])||(console.log("VDom:  Failed swapping properties because the property list length changed, use `noProp` to swap properties instead, not by altering the list structure.  This is a massive inefficiency until this issue is resolved."),mn(r,e,t,a,i)),pn(r,o,f,0,u[5],i[5])}throw[n,"Non-node passed to patchVNodesOnElems_MutateNode"]}throw[n,"Non-node passed to patchVNodesOnElems_MutateNode"]}function pn(r,n,e,t,a,u){for(;;){var i=u,o=a,f=t;if(o){var v=o[0];switch(0|v.tag){case 0:if(i){var l=i[0];if(!l.tag&&v[0]===l[0]){u=i[1],a=o[1],t=f+1|0;continue}}break;case 1:if(i){var d=i[0];if(1===d.tag){var m=d[0];if(v[0]!==m)c(e,f).nodeValue=m;u=i[1],a=o[1],t=f+1|0;continue}}break;case 2:if(i){var h=i[0];if(2===h.tag){var g=i[1],p=h[2],b=h[1],w=h[0],_=o[1],y=v[2],k=v[1],x=v[0];if(y===p&&""!==y){u=g,a=_,t=f+1|0;continue}if(""===y||""===p){gn(r,n,e,f,v,h),u=g,a=_,t=f+1|0;continue}var N=0,q=0;if(_){var C=_[0];if(2===C.tag){var F=_[1],S=C[2],A=C[1],R=C[0],D=0;if(g){var M=g[0];if(2===M.tag){if(R===w&&A===b&&S===p&&x===M[0]&&k===M[1]&&y===M[2]){var $=c(e,f),E=c(e,f+1|0);n.removeChild(E),Zr(n,E,$),u=g[1],a=F,t=f+2|0;continue}D=4}else D=4}else D=4;if(4===D){if(R===w&&A===b&&S===p){var L=c(e,f);n.removeChild(L),u=g,a=F,t=f+1|0;continue}q=3}}else q=3}else q=3;if(3===q)if(g){var O=g[0];if(2===O.tag){if(x===O[0]&&k===O[1]&&y===O[2]){var T=c(e,f);Zr(n,hn(r,h),T),u=g,t=f+1|0;continue}N=2}else N=2}else N=2;if(2===N){gn(r,n,e,f,v,h),u=g,a=_,t=f+1|0;continue}}}break;case 3:if(i){var P=i[0];if(3===P.tag){var I=i[1],V=P[2],U=P[1],Q=P[0],j=o[1],X=v[2],z=v[0];if(z===Q){V.contents=X.contents,u=I,a=j,t=f+1|0;continue}var B=0,K=0;if(j){var J=j[0];if(3===J.tag){var H=j[1],G=J[0],W=0;if(I){var Y=I[0];if(3===Y.tag){if(G===Q&&z===Y[0]){var Z=c(e,f),rr=c(e,f+1|0);n.removeChild(rr),Zr(n,rr,Z),u=I[1],a=H,t=f+2|0;continue}W=4}else W=4}else W=4;if(4===W){if(G===Q){var nr=c(e,f);n.removeChild(nr);var er=J[2].contents;V.contents=er,u=I,a=H,t=f+1|0;continue}K=3}}else K=3}else K=3;if(3===K)if(I){var tr=I[0];if(3===tr.tag){if(tr[0]===z){var ar=c(e,f),ur=s(U,void 0);V.contents=ur,Zr(n,hn(r,ur),ar),u=I,t=f+1|0;continue}B=2}else B=2}else B=2;if(2===B){var ir=X.contents,or=s(U,void 0);V.contents=or,u=[or,I],a=[ir,j];continue}}}break;case 4:a=[v[1],o[1]];continue}var cr=o[1];if(i){var fr=i[0];if(4===fr.tag){pn(s(fr[0],r),n,e,f,[v,0],[fr[1],0]),u=i[1],a=cr,t=f+1|0;continue}var sr=c(e,f);Zr(n,hn(r,fr),sr),n.removeChild(sr),u=i[1],a=cr,t=f+1|0;continue}var vr=c(e,f);n.removeChild(vr),u=0,a=cr}else{if(!i)return;var lr=hn(r,i[0]);n.appendChild(lr),u=i[1],a=0,t=f+1|0}}}function bn(r,n){if("number"!=typeof n)switch(0|n.tag){case 1:return Ar((function(n,e){return bn(r,e)}),void 0,n[0]);case 0:case 2:return s(n[0],r)}}function wn(r,n,e,t){var a=function(r,n){for(;;){var e=n,t=r;if("number"==typeof e)return;switch(0|e.tag){case 0:var u=e[0];return u?Sr(function(r){return function(n){return a(r,n)}}(t),u):void 0;case 1:return void(e[2].contents=s(e[1],t));case 2:var i=s(e[0],t);n=e[1],r=i;continue}}},u=function(r,n){for(;;){var e=n,t=r;if("number"==typeof e)return;switch(0|e.tag){case 0:var a=e[0];return a?Sr(function(r){return function(n){return u(r,n)}}(t),a):void 0;case 1:var i=e[2],o=i.contents;return void 0!==o?(i.contents=void 0,s(o,void 0)):void 0;case 2:var c=s(e[0],t);n=e[1],r=c;continue}}};if("number"==typeof e){if("number"==typeof t)return t}else switch(0|e.tag){case 0:if("number"!=typeof t&&!t.tag){return function(e,t){for(;;){var i=t,o=e;if(o){var c=o[1],f=o[0];if(i){wn(r,n,f,i[0]),t=i[1],e=c;continue}u(r,f),t=0,e=c}else{if(!i)return;a(n,i[0]),t=i[1],e=0}}}(e[0],t[0]),t}break;case 1:if("number"!=typeof t&&1===t.tag&&e[0]===t[0])return t[2].contents=e[2].contents,t;break;case 2:if("number"!=typeof t&&2===t.tag)return wn(s(e[0],r),s(t[0],n),e[1],t[1]),t}return u(r,e),a(n,t),t}function _n(r,n){for(var e=r.length;(r.position+n|0)>e;)e<<=1;var t=q(e);Vr(r.buffer,0,t,0,r.position),r.buffer=t,r.length=e}function yn(r,n){var e=r.position;e>=r.length&&_n(r,1),r.buffer[e]=n,r.position=e+1|0}function kn(r,n){var e=n.length,t=r.position+e|0;t>r.length&&_n(r,e),Ur(n,0,r.buffer,r.position,e),r.position=t}function xn(r,n){var e=r.bytes.length,t=r.ind+n|0;if(!(t<=e)){var a,u,i=q((a=e<<1)>(u=t)?a:u);Vr(r.bytes,0,i,0,e),r.bytes=i}}function Nn(r,n){xn(r,1),r.bytes[r.ind]=n,r.ind=r.ind+1|0}function qn(r,n){var e=n.length;xn(r,e),Wr(n,0,r.bytes,r.ind,e),r.ind=r.ind+e|0}function Cn(r){return Ir(r.bytes,0,r.ind)}function Fn(r){if("number"==typeof r)switch(r){case 0:return"@]";case 1:return"@}";case 2:return"@?";case 3:return"@\n";case 4:return"@.";case 5:return"@@";case 6:return"@%"}else switch(0|r.tag){case 0:case 1:return r[0];case 2:return"@"+F(Or(1,r[0]))}}function Sn(r){if("number"==typeof r)return 0;switch(0|r.tag){case 0:return b(0,[Sn(r[0])]);case 1:return b(1,[Sn(r[0])]);case 2:return b(2,[Sn(r[0])]);case 3:return b(3,[Sn(r[0])]);case 4:return b(4,[Sn(r[0])]);case 5:return b(5,[Sn(r[0])]);case 6:return b(6,[Sn(r[0])]);case 7:return b(7,[Sn(r[0])]);case 8:return b(8,[r[0],Sn(r[1])]);case 9:return b(9,[r[1],r[0],Sn(r[2])]);case 10:return b(10,[Sn(r[0])]);case 11:return b(11,[Sn(r[0])]);case 12:return b(12,[Sn(r[0])]);case 13:return b(13,[Sn(r[0])]);case 14:return b(14,[Sn(r[0])])}}function An(r){if("number"==typeof r)return[function(r){return 0},function(r){return 0},function(r){return 0},function(r){return 0}];switch(0|r.tag){case 0:var n=An(r[0]),e=n[1],t=n[0];return[function(r){return s(t,0),0},function(r){return s(e,0),0},n[2],n[3]];case 1:var a=An(r[0]),u=a[1],i=a[0];return[function(r){return s(i,0),0},function(r){return s(u,0),0},a[2],a[3]];case 2:var o=An(r[0]),c=o[1],f=o[0];return[function(r){return s(f,0),0},function(r){return s(c,0),0},o[2],o[3]];case 3:var v=An(r[0]),l=v[1],d=v[0];return[function(r){return s(d,0),0},function(r){return s(l,0),0},v[2],v[3]];case 4:var m=An(r[0]),h=m[1],g=m[0];return[function(r){return s(g,0),0},function(r){return s(h,0),0},m[2],m[3]];case 5:var p=An(r[0]),b=p[1],w=p[0];return[function(r){return s(w,0),0},function(r){return s(b,0),0},p[2],p[3]];case 6:var _=An(r[0]),y=_[1],k=_[0];return[function(r){return s(k,0),0},function(r){return s(y,0),0},_[2],_[3]];case 7:var x=An(r[0]),N=x[1],q=x[0];return[function(r){return s(q,0),0},function(r){return s(N,0),0},x[2],x[3]];case 8:var C=An(r[1]),F=C[1],S=C[0];return[function(r){return s(S,0),0},function(r){return s(F,0),0},C[2],C[3]];case 9:var A=An(r[2]),R=A[3],D=A[2],M=A[1],$=A[0],E=An(Rn(Sn(r[0]),r[1])),L=E[3],O=E[2],T=E[1],P=E[0];return[function(r){return s($,0),s(P,0),0},function(r){return s(T,0),s(M,0),0},function(r){return s(D,0),s(O,0),0},function(r){return s(L,0),s(R,0),0}];case 10:var I=An(r[0]),V=I[1],U=I[0];return[function(r){return s(U,0),0},function(r){return s(V,0),0},I[2],I[3]];case 11:var Q=An(r[0]),j=Q[1],X=Q[0];return[function(r){return s(X,0),0},function(r){return s(j,0),0},Q[2],Q[3]];case 12:var z=An(r[0]),B=z[1],K=z[0];return[function(r){return s(K,0),0},function(r){return s(B,0),0},z[2],z[3]];case 13:var J=An(r[0]),H=J[3],G=J[2],W=J[1],Y=J[0];return[function(r){return s(Y,0),0},function(r){return s(W,0),0},function(r){return s(G,0),0},function(r){return s(H,0),0}];case 14:var Z=An(r[0]),rr=Z[3],nr=Z[2],er=Z[1],tr=Z[0];return[function(r){return s(tr,0),0},function(r){return s(er,0),0},function(r){return s(nr,0),0},function(r){return s(rr,0),0}]}}function Rn(r,n){var e=0;if("number"==typeof r){if("number"==typeof n)return 0;switch(0|n.tag){case 8:e=6;break;case 9:e=7;break;case 10:e=1;break;case 11:e=2;break;case 12:e=3;break;case 13:e=4;break;case 14:e=5;break;default:throw[i,["camlinternalFormat.ml",846,23]]}}else switch(0|r.tag){case 0:if("number"==typeof n)e=8;else switch(0|n.tag){case 0:return b(0,[Rn(r[0],n[0])]);case 8:e=6;break;case 9:e=7;break;case 10:e=1;break;case 11:e=2;break;case 12:e=3;break;case 13:e=4;break;case 14:e=5}break;case 1:if("number"==typeof n)e=8;else switch(0|n.tag){case 1:return b(1,[Rn(r[0],n[0])]);case 8:e=6;break;case 9:e=7;break;case 10:e=1;break;case 11:e=2;break;case 12:e=3;break;case 13:e=4;break;case 14:e=5}break;case 2:if("number"==typeof n)e=8;else switch(0|n.tag){case 2:return b(2,[Rn(r[0],n[0])]);case 8:e=6;break;case 9:e=7;break;case 10:e=1;break;case 11:e=2;break;case 12:e=3;break;case 13:e=4;break;case 14:e=5}break;case 3:if("number"==typeof n)e=8;else switch(0|n.tag){case 3:return b(3,[Rn(r[0],n[0])]);case 8:e=6;break;case 9:e=7;break;case 10:e=1;break;case 11:e=2;break;case 12:e=3;break;case 13:e=4;break;case 14:e=5}break;case 4:if("number"==typeof n)e=8;else switch(0|n.tag){case 4:return b(4,[Rn(r[0],n[0])]);case 8:e=6;break;case 9:e=7;break;case 10:e=1;break;case 11:e=2;break;case 12:e=3;break;case 13:e=4;break;case 14:e=5}break;case 5:if("number"==typeof n)e=8;else switch(0|n.tag){case 5:return b(5,[Rn(r[0],n[0])]);case 8:e=6;break;case 9:e=7;break;case 10:e=1;break;case 11:e=2;break;case 12:e=3;break;case 13:e=4;break;case 14:e=5}break;case 6:if("number"==typeof n)e=8;else switch(0|n.tag){case 6:return b(6,[Rn(r[0],n[0])]);case 8:e=6;break;case 9:e=7;break;case 10:e=1;break;case 11:e=2;break;case 12:e=3;break;case 13:e=4;break;case 14:e=5}break;case 7:if("number"==typeof n)e=8;else switch(0|n.tag){case 7:return b(7,[Rn(r[0],n[0])]);case 8:e=6;break;case 9:e=7;break;case 10:e=1;break;case 11:e=2;break;case 12:e=3;break;case 13:e=4;break;case 14:e=5}break;case 8:if("number"==typeof n)throw[i,["camlinternalFormat.ml",832,26]];switch(0|n.tag){case 8:return b(8,[Rn(r[0],n[0]),Rn(r[1],n[1])]);case 10:e=1;break;case 11:e=2;break;case 12:e=3;break;case 13:e=4;break;case 14:e=5;break;default:throw[i,["camlinternalFormat.ml",832,26]]}break;case 9:if("number"==typeof n)throw[i,["camlinternalFormat.ml",842,28]];switch(0|n.tag){case 8:e=6;break;case 9:var t=An(Rn(Sn(r[1]),n[0]));return s(t[1],0),s(t[3],0),b(9,[r[0],n[1],Rn(r[2],n[2])]);case 10:e=1;break;case 11:e=2;break;case 12:e=3;break;case 13:e=4;break;case 14:e=5;break;default:throw[i,["camlinternalFormat.ml",842,28]]}break;case 10:if("number"==typeof n)throw[i,["camlinternalFormat.ml",810,21]];if(10===n.tag)return b(10,[Rn(r[0],n[0])]);throw[i,["camlinternalFormat.ml",810,21]];case 11:if("number"==typeof n)throw[i,["camlinternalFormat.ml",814,21]];switch(0|n.tag){case 10:e=1;break;case 11:return b(11,[Rn(r[0],n[0])]);default:throw[i,["camlinternalFormat.ml",814,21]]}break;case 12:if("number"==typeof n)throw[i,["camlinternalFormat.ml",818,19]];switch(0|n.tag){case 10:e=1;break;case 11:e=2;break;case 12:return b(12,[Rn(r[0],n[0])]);default:throw[i,["camlinternalFormat.ml",818,19]]}break;case 13:if("number"==typeof n)throw[i,["camlinternalFormat.ml",822,22]];switch(0|n.tag){case 10:e=1;break;case 11:e=2;break;case 12:e=3;break;case 13:return b(13,[Rn(r[0],n[0])]);default:throw[i,["camlinternalFormat.ml",822,22]]}break;case 14:if("number"==typeof n)throw[i,["camlinternalFormat.ml",827,30]];switch(0|n.tag){case 10:e=1;break;case 11:e=2;break;case 12:e=3;break;case 13:e=4;break;case 14:return b(14,[Rn(r[0],n[0])]);default:throw[i,["camlinternalFormat.ml",827,30]]}}switch(e){case 1:throw[i,["camlinternalFormat.ml",811,21]];case 2:throw[i,["camlinternalFormat.ml",815,21]];case 3:throw[i,["camlinternalFormat.ml",819,19]];case 4:throw[i,["camlinternalFormat.ml",823,22]];case 5:throw[i,["camlinternalFormat.ml",828,30]];case 6:throw[i,["camlinternalFormat.ml",833,26]];case 7:throw[i,["camlinternalFormat.ml",843,28]];case 8:throw[i,["camlinternalFormat.ml",847,23]]}}var Dn=dr("CamlinternalFormat.Type_mismatch");function Mn(r,n){if("number"==typeof r)return[0,n];if(!r.tag)return[b(0,[r[0],r[1]]),n];if("number"==typeof n)throw Dn;if(2===n.tag)return[b(1,[r[0]]),n[0]];throw Dn}function $n(r,n,e){var t=Mn(r,e);if("number"!=typeof n)return[t[0],[n[0]],t[1]];if(0===n)return[t[0],0,t[1]];var a=t[1];if("number"==typeof a)throw Dn;if(2===a.tag)return[t[0],1,a[0]];throw Dn}function En(r,n){if("number"==typeof r)return[0,n];switch(0|r.tag){case 0:if("number"==typeof n)throw Dn;if(n.tag)throw Dn;var e=En(r[0],n[0]);return[b(0,[e[0]]),e[1]];case 1:if("number"==typeof n)throw Dn;if(n.tag)throw Dn;var t=En(r[0],n[0]);return[b(1,[t[0]]),t[1]];case 2:var a=Mn(r[0],n),u=a[1];if("number"==typeof u)throw Dn;if(1===u.tag){var i=En(r[1],u[0]);return[b(2,[a[0],i[0]]),i[1]]}throw Dn;case 3:var o=Mn(r[0],n),c=o[1];if("number"==typeof c)throw Dn;if(1===c.tag){var f=En(r[1],c[0]);return[b(3,[o[0],f[0]]),f[1]]}throw Dn;case 4:var v=$n(r[1],r[2],n),l=v[2];if("number"==typeof l)throw Dn;if(2===l.tag){var d=En(r[3],l[0]);return[b(4,[r[0],v[0],v[1],d[0]]),d[1]]}throw Dn;case 5:var m=$n(r[1],r[2],n),h=m[2];if("number"==typeof h)throw Dn;if(3===h.tag){var g=En(r[3],h[0]);return[b(5,[r[0],m[0],m[1],g[0]]),g[1]]}throw Dn;case 6:var p=$n(r[1],r[2],n),w=p[2];if("number"==typeof w)throw Dn;if(4===w.tag){var _=En(r[3],w[0]);return[b(6,[r[0],p[0],p[1],_[0]]),_[1]]}throw Dn;case 7:var y=$n(r[1],r[2],n),k=y[2];if("number"==typeof k)throw Dn;if(5===k.tag){var x=En(r[3],k[0]);return[b(7,[r[0],y[0],y[1],x[0]]),x[1]]}throw Dn;case 8:var q=$n(r[1],r[2],n),C=q[2];if("number"==typeof C)throw Dn;if(6===C.tag){var F=En(r[3],C[0]);return[b(8,[r[0],q[0],q[1],F[0]]),F[1]]}throw Dn;case 9:var S=Mn(r[0],n),A=S[1];if("number"==typeof A)throw Dn;if(7===A.tag){var R=En(r[1],A[0]);return[b(9,[S[0],R[0]]),R[1]]}throw Dn;case 10:var D=En(r[0],n);return[b(10,[D[0]]),D[1]];case 11:var M=En(r[1],n);return[b(11,[r[0],M[0]]),M[1]];case 12:var $=En(r[1],n);return[b(12,[r[0],$[0]]),$[1]];case 13:if("number"==typeof n)throw Dn;if(8===n.tag){var E=n[0];if(N([r[1]],[E]))throw Dn;var L=En(r[2],n[1]);return[b(13,[r[0],E,L[0]]),L[1]]}throw Dn;case 14:if("number"==typeof n)throw Dn;if(9===n.tag){var O=n[0];if(N([wr(r[1])],[wr(O)]))throw Dn;var T=En(r[2],wr(n[2]));return[b(14,[r[0],O,T[0]]),T[1]]}throw Dn;case 15:if("number"==typeof n)throw Dn;if(10===n.tag){var P=En(r[0],n[0]);return[b(15,[P[0]]),P[1]]}throw Dn;case 16:if("number"==typeof n)throw Dn;if(11===n.tag){var I=En(r[0],n[0]);return[b(16,[I[0]]),I[1]]}throw Dn;case 17:var V=En(r[1],n);return[b(17,[r[0],V[0]]),V[1]];case 18:var U=r[0],Q=r[1];if(U.tag){var j=U[0],X=En(j[0],n),z=En(Q,X[1]);return[b(18,[b(1,[[X[0],j[1]]]),z[0]]),z[1]]}var B=U[0],K=En(B[0],n),J=En(Q,K[1]);return[b(18,[b(0,[[K[0],B[1]]]),J[0]]),J[1]];case 19:if("number"==typeof n)throw Dn;if(13===n.tag){var H=En(r[0],n[0]);return[b(19,[H[0]]),H[1]]}throw Dn;case 20:if("number"==typeof n)throw Dn;if(1===n.tag){var G=En(r[2],n[0]);return[b(20,[r[0],r[1],G[0]]),G[1]]}throw Dn;case 21:if("number"==typeof n)throw Dn;if(2===n.tag){var W=En(r[1],n[0]);return[b(21,[r[0],W[0]]),W[1]]}throw Dn;case 23:var Y=r[0],Z=r[1];if("number"==typeof Y){if(2!==Y)return Ln(Y,Z,n);if("number"==typeof n)throw Dn;if(14===n.tag){var rr=En(Z,n[0]);return[b(23,[2,rr[0]]),rr[1]]}throw Dn}switch(0|Y.tag){case 8:return Ln(b(8,[Y[0],Y[1]]),Z,n);case 9:var nr=function r(n,e,t){if("number"==typeof n)return[0,En(e,t)];switch(0|n.tag){case 0:if("number"==typeof t)throw Dn;if(t.tag)throw Dn;var a=r(n[0],e,t[0]);return[b(0,[a[0]]),a[1]];case 1:if("number"==typeof t)throw Dn;if(1===t.tag){var u=r(n[0],e,t[0]);return[b(1,[u[0]]),u[1]]}throw Dn;case 2:if("number"==typeof t)throw Dn;if(2===t.tag){var i=r(n[0],e,t[0]);return[b(2,[i[0]]),i[1]]}throw Dn;case 3:if("number"==typeof t)throw Dn;if(3===t.tag){var o=r(n[0],e,t[0]);return[b(3,[o[0]]),o[1]]}throw Dn;case 4:if("number"==typeof t)throw Dn;if(4===t.tag){var c=r(n[0],e,t[0]);return[b(4,[c[0]]),c[1]]}throw Dn;case 5:if("number"==typeof t)throw Dn;if(5===t.tag){var f=r(n[0],e,t[0]);return[b(5,[f[0]]),f[1]]}throw Dn;case 6:if("number"==typeof t)throw Dn;if(6===t.tag){var v=r(n[0],e,t[0]);return[b(6,[v[0]]),v[1]]}throw Dn;case 7:if("number"==typeof t)throw Dn;if(7===t.tag){var l=r(n[0],e,t[0]);return[b(7,[l[0]]),l[1]]}throw Dn;case 8:if("number"==typeof t)throw Dn;if(8===t.tag){var d=t[0];if(N([n[0]],[d]))throw Dn;var m=r(n[1],e,t[1]);return[b(8,[d,m[0]]),m[1]]}throw Dn;case 9:if("number"==typeof t)throw Dn;if(9===t.tag){var h=t[1],g=t[0];if(N([wr(n[0])],[wr(g)]))throw Dn;if(N([wr(n[1])],[wr(h)]))throw Dn;var p=An(Rn(Sn(g),h));s(p[1],0),s(p[3],0);var w=r(wr(n[2]),e,t[2]);return[b(9,[g,h,Sn(w[0])]),w[1]]}throw Dn;case 10:if("number"==typeof t)throw Dn;if(10===t.tag){var _=r(n[0],e,t[0]);return[b(10,[_[0]]),_[1]]}throw Dn;case 11:if("number"==typeof t)throw Dn;if(11===t.tag){var y=r(n[0],e,t[0]);return[b(11,[y[0]]),y[1]]}throw Dn;case 12:throw Dn;case 13:if("number"==typeof t)throw Dn;if(13===t.tag){var k=r(n[0],e,t[0]);return[b(13,[k[0]]),k[1]]}throw Dn;case 14:if("number"==typeof t)throw Dn;if(14===t.tag){var x=r(n[0],e,t[0]);return[b(14,[x[0]]),x[1]]}throw Dn}}(Y[1],Z,n),er=nr[1];return[b(23,[b(9,[Y[0],nr[0]]),er[0]]),er[1]];default:return Ln(Y,Z,n)}case 22:case 24:throw Dn}}function Ln(r,n,e){var t=En(n,e);return[b(23,[r,t[0]]),t[1]]}function On(r,n){return function(r,n){var e=En(r,n);if("number"==typeof e[1])return e[0];throw Dn}(r,wr(Sn(n)))}function Tn(r,n,e){var t=e.length,a=yr(n),u=n<0?0:r;if(a<=t)return e;var i=Or(a,2===u?48:32);switch(u){case 0:Wr(e,0,i,0,t);break;case 1:Wr(e,0,i,a-t|0,t);break;case 2:t>0&&(43===vr(e,0)||45===vr(e,0)||32===vr(e,0))?(i[0]=vr(e,0),Wr(e,1,i,1+(a-t|0)|0,t-1|0)):t>1&&48===vr(e,0)&&(120===vr(e,1)||88===vr(e,1))?(i[1]=vr(e,1),Wr(e,2,i,2+(a-t|0)|0,t-2|0)):Wr(e,0,i,a-t|0,t)}return F(i)}function Pn(r,n){var e=yr(r),t=n.length,a=vr(n,0),u=0;if(a>=58)if(a>=71){if(a>102||a<97)return n;u=2}else{if(a<65)return n;u=2}else if(32!==a){if(a<43)return n;switch(a-43|0){case 0:case 2:u=1;break;case 1:case 3:case 4:return n;case 5:if((e+2|0)>t&&t>1&&(120===vr(n,1)||88===vr(n,1))){var i=Or(e+2|0,48);return i[1]=vr(n,1),Wr(n,2,i,4+(e-t|0)|0,t-2|0),F(i)}u=2;break;case 6:case 7:case 8:case 9:case 10:case 11:case 12:case 13:case 14:u=2}}else u=1;switch(u){case 1:if((e+1|0)<=t)return n;var o=Or(e+1|0,48);return o[0]=a,Wr(n,1,o,2+(e-t|0)|0,t-1|0),F(o);case 2:if(e<=t)return n;var c=Or(e,48);return Wr(n,0,c,e-t|0,t),F(c)}}function In(r){var n,e=(n=r,function(r){for(;;){var e=r;if(e>=n.length)return!1;var t=n.charCodeAt(e);if(t<32)return!0;var a=t-34|0;if(a>58||a<0){if(a>=93)return!0;r=e+1|0}else{if(a>57||a<1)return!0;r=e+1|0}}}(0)?F(jr(A(n))):n),t=e.length,a=Or(t+2|0,34);return S(e,0,a,1,t),F(a)}function Vn(r,n){if(15===r)return"%.12g";var e=yr(n),t=function(r){switch(r){case 0:case 1:case 2:return 102;case 3:case 4:case 5:return 101;case 6:case 7:case 8:return 69;case 9:case 10:case 11:return 103;case 12:case 13:case 14:return 71;case 15:return 70;case 16:case 17:case 18:return 104;case 19:case 20:case 21:return 72}}(r),a={ind:0,bytes:q(16)};return Nn(a,37),function(r,n){switch(n){case 0:case 3:case 6:case 9:case 12:case 15:case 16:case 19:return;case 1:case 4:case 7:case 10:case 13:case 17:case 20:return Nn(r,43);case 2:case 5:case 8:case 11:case 14:case 18:case 21:Nn(r,32)}}(a,r),Nn(a,46),qn(a,String(e)),Nn(a,t),Cn(a)}function Un(r,n){return or(function(r){switch(r){case 0:return"%d";case 1:return"%+d";case 2:return"% d";case 3:return"%i";case 4:return"%+i";case 5:return"% i";case 6:return"%x";case 7:return"%#x";case 8:return"%X";case 9:return"%#X";case 10:return"%o";case 11:return"%#o";case 12:return"%u"}}(r),n)}function Qn(r,n){return sr(function(r){switch(r){case 0:return"%ld";case 1:return"%+ld";case 2:return"% ld";case 3:return"%li";case 4:return"%+li";case 5:return"% li";case 6:return"%lx";case 7:return"%#lx";case 8:return"%lX";case 9:return"%#lX";case 10:return"%lo";case 11:return"%#lo";case 12:return"%lu"}}(r),n)}function jn(r,n){return fr(function(r){switch(r){case 0:return"%nd";case 1:return"%+nd";case 2:return"% nd";case 3:return"%ni";case 4:return"%+ni";case 5:return"% ni";case 6:return"%nx";case 7:return"%#nx";case 8:return"%nX";case 9:return"%#nX";case 10:return"%no";case 11:return"%#no";case 12:return"%nu"}}(r),n)}function Xn(r,n){return cr(function(r){switch(r){case 0:return"%Ld";case 1:return"%+Ld";case 2:return"% Ld";case 3:return"%Li";case 4:return"%+Li";case 5:return"% Li";case 6:return"%Lx";case 7:return"%#Lx";case 8:return"%LX";case 9:return"%#LX";case 10:return"%Lo";case 11:return"%#Lo";case 12:return"%Lu"}}(r),n)}function zn(r,n,e){if(r>=16){var t;if(r>=17)switch(r-17|0){case 2:t=45;break;case 0:case 3:t=43;break;case 1:case 4:t=32}else t=45;var a=function(r,n,e){if(!isFinite(r))return isNaN(r)?"nan":r>0?"infinity":"-infinity";var t=0==r&&1/r==-1/0?1:r>=0?0:1;t&&(r=-r);var a=0;if(0==r);else if(r<1)for(;r<1&&a>-1022;)r*=2,a--;else for(;r>=2;)r/=2,a++;var u=a<0?"":"+",i="";if(t)i="-";else switch(e){case 43:i="+";break;case 32:i=" "}if(n>=0&&n<13){var o=Math.pow(2,4*n);r=Math.round(r*o)/o}var c=r.toString(16);if(n>=0){var f=c.indexOf(".");if(f<0)c+="."+"0".repeat(n);else{var s=f+1+n;c.length<s?c+="0".repeat(s-c.length):c=c.substr(0,s)}}return i+"0x"+c+"p"+u+a.toString(10)}(e,n,t);return r>=19?F(Xr(A(a))):a}var u=function(r,n){var e=ur(r),t=e.prec<0?6:e.prec,a=n<0?(e.sign=-1,-n):n,u="";if(isNaN(a))u="nan",e.filter=" ";else if(isFinite(a)){switch(e.conv){case"e":var i=(u=a.toExponential(t)).length;"e"===u[i-3|0]&&(u=u.slice(0,i-1|0)+"0"+u.slice(i-1|0));break;case"f":u=a.toFixed(t);break;case"g":var o=0!==t?t:1,c=(u=a.toExponential(o-1|0)).indexOf("e"),f=0|Number(u.slice(c+1|0));if(f<-4||a>=1e21||a.toFixed().length>o){for(var s=c-1|0;"0"===u[s];)s=s-1|0;"."===u[s]&&(s=s-1|0);var v=(u=u.slice(0,s+1|0)+u.slice(c)).length;"e"===u[v-3|0]&&(u=u.slice(0,v-1|0)+"0"+u.slice(v-1|0))}else{var l=o;if(f<0)l=l-(f+1|0)|0,u=a.toFixed(l);else for(;(u=a.toFixed(l)).length>(o+1|0);)l=l-1|0;if(0!==l){for(var d=u.length-1|0;"0"===u[d];)d=d-1|0;"."===u[d]&&(d=d-1|0),u=u.slice(0,d+1|0)}}}}else u="inf",e.filter=" ";return ir(e,u)}(Vn(r,n),e);if(15!==r)return u;var i=u.length,o=function(r){return isFinite(r)?Math.abs(r)>=22250738585072014e-324?0:0!==r?1:2:isNaN(r)?4:3}(e);return 3!==o?o>=4?"nan":function(r){for(;;){var n=r;if(n===i)return!1;var e=vr(u,n)-46|0;if(e>23||e<0){if(55===e)return!0;r=n+1|0}else{if(e>22||e<1)return!0;r=n+1|0}}}(0)?u:u+".":e<0?"neg_infinity":"infinity"}function Bn(r){var n=function(r){var n=0;if(r>=40){if(92===r)return"\\\\";n=r>=127?1:2}else if(r>=32){if(r>=39)return"\\'";n=2}else if(r>=14)n=1;else switch(r){case 8:return"\\b";case 9:return"\\t";case 10:return"\\n";case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:case 11:case 12:n=1;break;case 13:return"\\r"}switch(n){case 1:var e=[0,0,0,0];return e[0]=92,e[1]=48+(r/100|0)|0,e[2]=48+(r/10|0)%10|0,e[3]=48+r%10|0,F(e);case 2:var t=[0];return t[0]=r,F(t)}}(r),e=n.length,t=Or(e+2|0,39);return S(n,0,t,1,e),F(t)}function Kn(r){var n={ind:0,bytes:q(16)};return function r(n,e){for(;;){var t=e;if("number"==typeof t)return;switch(0|t.tag){case 0:qn(n,"%c"),e=t[0];continue;case 1:qn(n,"%s"),e=t[0];continue;case 2:qn(n,"%i"),e=t[0];continue;case 3:qn(n,"%li"),e=t[0];continue;case 4:qn(n,"%ni"),e=t[0];continue;case 5:qn(n,"%Li"),e=t[0];continue;case 6:qn(n,"%f"),e=t[0];continue;case 7:qn(n,"%B"),e=t[0];continue;case 8:qn(n,"%{"),r(n,t[0]),qn(n,"%}"),e=t[1];continue;case 9:qn(n,"%("),r(n,t[0]),qn(n,"%)"),e=t[2];continue;case 10:qn(n,"%a"),e=t[0];continue;case 11:qn(n,"%t"),e=t[0];continue;case 12:qn(n,"%?"),e=t[0];continue;case 13:qn(n,"%r"),e=t[0];continue;case 14:qn(n,"%_r"),e=t[0];continue}}}(n,r),Cn(n)}function Jn(r,n,e,t){for(;;){var a=t,u=e,o=r;if("number"==typeof a)return v(o,n,u);switch(0|a.tag){case 0:return function(r,e,t){return function(a){var u=b(5,[e,a]);return Jn(r,n,u,t)}}(o,u,a[0]);case 1:return function(r,e,t){return function(a){var u=Bn(a),i=b(4,[e,u]);return Jn(r,n,i,t)}}(o,u,a[0]);case 2:return Wn(o,n,u,a[1],a[0],(function(r){return r}));case 3:return Wn(o,n,u,a[1],a[0],In);case 4:return Yn(o,n,u,a[3],a[1],a[2],Un,a[0]);case 5:return Yn(o,n,u,a[3],a[1],a[2],Qn,a[0]);case 6:return Yn(o,n,u,a[3],a[1],a[2],jn,a[0]);case 7:return Yn(o,n,u,a[3],a[1],a[2],Xn,a[0]);case 8:var c=a[3],f=a[1],l=a[2],d=a[0];if("number"==typeof f)return"number"==typeof l?0!==l?function(r,e,t,a){return function(u,i){var o=zn(a,u,i);return Jn(r,n,b(4,[e,o]),t)}}(o,u,c,d):function(r,e,t,a){return function(u){var i=zn(a,-6,u);return Jn(r,n,b(4,[e,i]),t)}}(o,u,c,d):function(r,e,t,a,u){return function(i){var o=zn(a,u,i);return Jn(r,n,b(4,[e,o]),t)}}(o,u,c,d,l[0]);if(f.tag){var m=f[0];return"number"==typeof l?0!==l?function(r,e,t,a,u){return function(i,o,c){var f=Tn(u,i,zn(a,o,c));return Jn(r,n,b(4,[e,f]),t)}}(o,u,c,d,m):function(r,e,t,a,u){return function(i,o){var c=zn(a,-6,o),f=Tn(u,i,c);return Jn(r,n,b(4,[e,f]),t)}}(o,u,c,d,m):function(r,e,t,a,u,i){return function(o,c){var f=Tn(u,o,zn(a,i,c));return Jn(r,n,b(4,[e,f]),t)}}(o,u,c,d,m,l[0])}var h=f[1],g=f[0];return"number"==typeof l?0!==l?function(r,e,t,a,u,i){return function(o,c){var f=Tn(u,i,zn(a,o,c));return Jn(r,n,b(4,[e,f]),t)}}(o,u,c,d,g,h):function(r,e,t,a,u,i){return function(o){var c=zn(a,-6,o),f=Tn(u,i,c);return Jn(r,n,b(4,[e,f]),t)}}(o,u,c,d,g,h):function(r,e,t,a,u,i,o){return function(c){var f=Tn(u,i,zn(a,o,c));return Jn(r,n,b(4,[e,f]),t)}}(o,u,c,d,g,h,l[0]);case 9:return Wn(o,n,u,a[1],a[0],kr);case 10:t=a[0],e=b(7,[u]);continue;case 11:t=a[1],e=b(2,[u,a[0]]);continue;case 12:t=a[1],e=b(3,[u,a[0]]);continue;case 13:return function(r,e,t,a){return function(u){return Jn(r,n,b(4,[e,a]),t)}}(o,u,a[2],Kn(a[1]));case 14:var p=a[2];return function(r,e,t,a){return function(u){return Jn(r,n,e,_r(On(u[0],t),a))}}(o,u,a[1],p);case 15:return function(r,e,t){return function(a,u){return Jn(r,n,b(6,[e,function(r){return v(a,r,u)}]),t)}}(o,u,a[0]);case 16:return function(r,e,t){return function(a){return Jn(r,n,b(6,[e,a]),t)}}(o,u,a[0]);case 17:t=a[1],e=b(0,[u,a[0]]);continue;case 18:var w=a[0];if(w.tag){var _=function(r,n,e){return function(t,a){return Jn(r,t,b(1,[n,b(1,[a])]),e)}}(o,u,a[1]);t=w[0][0],e=0,r=_;continue}var y=function(r,n,e){return function(t,a){return Jn(r,t,b(1,[n,b(0,[a])]),e)}}(o,u,a[1]);t=w[0][0],e=0,r=y;continue;case 19:throw[i,["camlinternalFormat.ml",1525,4]];case 20:return function(r,e,t){return function(a){return Jn(r,n,t,e)}}(o,a[2],b(8,[u,"Printf: bad conversion %["]));case 21:return function(r,e,t){return function(a){var u=or("%u",a),i=b(4,[e,u]);return Jn(r,n,i,t)}}(o,u,a[1]);case 22:return function(r,e,t){return function(a){var u=b(5,[e,a]);return Jn(r,n,u,t)}}(o,u,a[0]);case 23:return Hn(o,n,u,a[0],a[1]);case 24:return Zn(o,n,u,a[2],a[0],s(a[1],void 0))}}}function Hn(r,n,e,t,a){if("number"!=typeof t)return 9===t.tag?function r(n,e,t,a,u){if("number"==typeof a)return Gn(n,e,t,u);switch(0|a.tag){case 0:var o=a[0];return function(a){return r(n,e,t,o,u)};case 1:var c=a[0];return function(a){return r(n,e,t,c,u)};case 2:var f=a[0];return function(a){return r(n,e,t,f,u)};case 3:var s=a[0];return function(a){return r(n,e,t,s,u)};case 4:var v=a[0];return function(a){return r(n,e,t,v,u)};case 5:var l=a[0];return function(a){return r(n,e,t,l,u)};case 6:var d=a[0];return function(a){return r(n,e,t,d,u)};case 7:var m=a[0];return function(a){return r(n,e,t,m,u)};case 8:var h=a[1];return function(a){return r(n,e,t,h,u)};case 9:var g=a[2],p=Rn(Sn(a[0]),a[1]);return function(a){return r(n,e,t,function r(n,e){if("number"==typeof n)return e;switch(0|n.tag){case 0:return b(0,[r(n[0],e)]);case 1:return b(1,[r(n[0],e)]);case 2:return b(2,[r(n[0],e)]);case 3:return b(3,[r(n[0],e)]);case 4:return b(4,[r(n[0],e)]);case 5:return b(5,[r(n[0],e)]);case 6:return b(6,[r(n[0],e)]);case 7:return b(7,[r(n[0],e)]);case 8:return b(8,[n[0],r(n[1],e)]);case 9:return b(9,[n[0],n[1],r(n[2],e)]);case 10:return b(10,[r(n[0],e)]);case 11:return b(11,[r(n[0],e)]);case 12:return b(12,[r(n[0],e)]);case 13:return b(13,[r(n[0],e)]);case 14:return b(14,[r(n[0],e)])}}(p,g),u)};case 10:var w=a[0];return function(a,i){return r(n,e,t,w,u)};case 11:var _=a[0];return function(a){return r(n,e,t,_,u)};case 12:var y=a[0];return function(a){return r(n,e,t,y,u)};case 13:throw[i,["camlinternalFormat.ml",1616,31]];case 14:throw[i,["camlinternalFormat.ml",1617,31]]}}(r,n,e,t[1],a):Gn(r,n,e,a);if(2!==t)return Gn(r,n,e,a);throw[i,["camlinternalFormat.ml",1593,39]]}function Gn(r,n,e,t){return Jn(r,n,b(8,[e,"Printf: bad conversion %_"]),t)}function Wn(r,n,e,t,a,u){if("number"==typeof a)return function(a){var i=s(u,a),o=b(4,[e,i]);return Jn(r,n,o,t)};if(a.tag){var i=a[0];return function(a,o){var c=Tn(i,a,s(u,o)),f=b(4,[e,c]);return Jn(r,n,f,t)}}var o=a[1],c=a[0];return function(a){var i=Tn(c,o,s(u,a)),f=b(4,[e,i]);return Jn(r,n,f,t)}}function Yn(r,n,e,t,a,u,i,o){if("number"==typeof a){if("number"==typeof u)return 0!==u?function(a,u){var c=Pn(a,v(i,o,u));return Jn(r,n,b(4,[e,c]),t)}:function(a){var u=v(i,o,a);return Jn(r,n,b(4,[e,u]),t)};var c=u[0];return function(a){var u=Pn(c,v(i,o,a));return Jn(r,n,b(4,[e,u]),t)}}if(a.tag){var f=a[0];if("number"==typeof u)return 0!==u?function(a,u,c){var s=Tn(f,a,Pn(u,v(i,o,c)));return Jn(r,n,b(4,[e,s]),t)}:function(a,u){var c=Tn(f,a,v(i,o,u));return Jn(r,n,b(4,[e,c]),t)};var s=u[0];return function(a,u){var c=Tn(f,a,Pn(s,v(i,o,u)));return Jn(r,n,b(4,[e,c]),t)}}var l=a[1],d=a[0];if("number"==typeof u)return 0!==u?function(a,u){var c=Tn(d,l,Pn(a,v(i,o,u)));return Jn(r,n,b(4,[e,c]),t)}:function(a){var u=Tn(d,l,v(i,o,a));return Jn(r,n,b(4,[e,u]),t)};var m=u[0];return function(a){var u=Tn(d,l,Pn(m,v(i,o,a)));return Jn(r,n,b(4,[e,u]),t)}}function Zn(r,n,e,t,a,u){if(!a)return Jn(r,n,b(4,[e,u]),t);var i=a[0];return function(a){return Zn(r,n,e,t,i,s(u,a))}}function re(r,n){return Jn((function(n,t){var a,u,i,o,c={buffer:i=q(u=(a=64)<1?1:a),position:0,length:u,initial_buffer:i};return function r(n,t){for(;;){var a=t,u=0;if("number"==typeof a)return;switch(0|a.tag){case 0:var i=Fn(a[1]);return r(n,a[0]),kn(n,i);case 1:var o=a[1],c=a[0];if(o.tag){r(n,c),kn(n,"@["),t=o[0];continue}r(n,c),kn(n,"@{"),t=o[0];continue;case 2:case 4:u=1;break;case 3:case 5:u=2;break;case 6:return r(n,a[0]),kn(n,s(a[1],void 0));case 7:t=a[0];continue;case 8:throw r(n,a[0]),[e,a[1]]}switch(u){case 1:return r(n,a[0]),kn(n,a[1]);case 2:return r(n,a[0]),yn(n,a[1])}}}(c,t),s(r,Ir((o=c).buffer,0,o.position))}),void 0,0,n[0])}function ne(r){return re((function(r){return r}),r)}function ee(r){var n=r.length;return qr(function(e,t){for(;;){var a=t,u=e;if(a===n)return u;t=a+1|0,e=[vr(r,a),u]}}(0,0))}function te(r,n){return function(r,n){return r.line===n.line?w(n.column,r.column):w(n.line,r.line)}(r.location,n.location)}function ae(r){return l(ne([b(11,["At ",b(2,[0,b(11,["; Expecting ",b(2,[0,b(11,[" but actual ",b(2,[0,0])])])])])]),"At %s; Expecting %s but actual %s"]),function(r){return v(ne([b(11,["Ln ",b(4,[0,0,0,b(11,[", Col ",b(4,[0,0,0,0])])])]),"Ln %d, Col %d"]),r.line,r.column)}(r.location),r.expecting,r.actual)}function ue(r,n,e){var t=s(r,e);if(t.tag)return b(1,[t[0]]);var a=t[0];return v(n,a.result,{location:a.location,input_chars:a.remaining_chars})}function ie(r,n,e,t){var a=s(r,t);if(a.tag)return b(0,[{result:e,location:t.location,remaining_chars:t.input_chars}]);var u=a[0];return v(n,u.result,{location:u.location,input_chars:u.remaining_chars})}function oe(r,n){return b(0,[{result:r,location:n.location,remaining_chars:n.input_chars}])}function ce(r,n,e){var t=s(n,e);if(!t.tag)return t;var a=t[0];return b(1,a?[[{expecting:s(r,Kr(" OR ",Fr((function(r){return r.expecting}),a))),actual:a[0].actual,location:e.location},0]]:[[{expecting:s(r,""),actual:"No input",location:e.location},0]])}function fe(r,n,e){var t=s(n,e);if(!t.tag)return t;var a=t[0];return b(1,a?[[{expecting:r,actual:a[0].actual,location:e.location},a[1]]]:[[{expecting:r,actual:"",location:e.location},0]])}function se(r,n){return function(e){return ue(n,(function(n){var e=s(r,n);return function(r){return oe(e,r)}}),e)}}function ve(r,n,e){var t=s(r,e);if(!t.tag)return t;var a=s(n,e);return a.tag?b(1,[Mr([t[0],[a[0],0]])]):a}function le(r){if(!r)return function(r){return b(1,[0])};var n=r[0],e=le(r[1]);return function(r){return ve(n,e,r)}}function de(r,n){return e=r,t=function(r,n){var e=function(t){return function(a){return ie(r,(function(r){return function(r){return ue(n,(function(r){return e([r,t])}),r)}}),t,a)}};return e(0)}(n,r),function(r){return ue(e,(function(r){return function(n){return ue(t,(function(n){var e=[r,n];return function(r){return oe(e,r)}}),n)}}),r)};var e,t}function me(r,n,e){var t=e.input_chars;if(!t)return b(1,[[{expecting:n,actual:"Ran out of characters",location:e.location},0]]);var a,u,i,o=t[0];return s(r,o)?b(0,[{result:o,location:(a=e.location,u=o,i=a.line,10!==u&&13!==u?{column:a.column+1|0,line:i}:{column:1,line:i+1|0}),remaining_chars:t[1]}]):b(1,[[{expecting:n,actual:s(ne([b(12,[39,b(0,[b(12,[39,0])])]),"'%c'"]),o),location:e.location},0]])}function he(r){var n=s(ne([b(0,[0]),"%c"]),r);return function(e){return me((function(n){return r===n}),n,e)}}function ge(r,n){var e=v(ne([b(11,["A character between ",b(0,[b(11,[" and ",b(0,[0])])])]),"A character between %c and %c"]),r,n);return function(t){return me((function(e){return e>=r&&e<=n}),e,t)}}var pe=function(r){var n=s(ne([b(11,["One of: ",b(2,[0,0])]),"One of: %s"]),Kr(", ",Fr((function(r){return zr(1,r)}),r)));return function(e){return me((function(n){return function(r,n){for(;;){var e=n;if(!e)return!1;if(x(e[0],r))return!0;n=e[1]}}(n,r)}),n,e)}}([32,[9,[13,[10,0]]]]),be=(he(10),he(9),ge(65,90)),we=ge(97,122),_e=ge(48,57),ye=ne([b(2,[0,0]),"%s"]);function ke(r){return ce(ye,(function(r){return ve(we,be,r)}),r)}le([ge(97,102),[ge(65,70),[_e,0]]]);var xe=function r(n){var e=function(e){return ue(n,(function(e){return r(n)}),e)};return function(r){return ve(e,(function(r){return oe(void 0,r)}),r)}}(pe);ge(48,55);function Ne(r){var e=r.length,t=function(n){if(n>=e)return function(n){return oe(r,n)};var a=t(n+1|0),u=he(vr(r,n));return function(r){return ue(u,(function(r){return a}),r)}};if(e<=0)return function(r){throw[n,r]}("token must be a non-empty string");var a=t(0),u=function(r){return ue(xe,(function(r){return a}),r)};return function(n){return fe(r,u,n)}}function qe(r,n){var e=function(r,n){return s(r,{location:{column:1,line:1},input_chars:ee(Hr(n))})}(r,n);if(e.tag)return b(1,[e[0]]);var t=e[0],a=t.remaining_chars,u=t.location;return a?b(1,[[{expecting:"End of input",actual:s(ne([b(11,["Characters remaining: ",b(2,[0,0])]),"Characters remaining: %s"]),Kr("",Fr((function(r){return zr(1,r)}),a))),location:u},0]]):b(0,[{result:t.result,location:u,remaining_chars:a}])}var Ce=ue,Fe=ve,Se=function(r,n){return function(e){return ue(r,(function(r){return n}),e)}},Ae=function(r,n){return function(e){return ue(r,(function(r){return function(e){return ue(n,(function(n){return function(n){return oe(r,n)}}),e)}}),e)}};function Re(r){var n=function(r){return r?r[4]:0},t=function(r,e,t,a){var u=n(r),i=n(a);return[r,e,t,a,u>=i?u+1|0:i+1|0]},u=function(r,n){return[0,r,n,0,1]},o=function(r,a,u,i){var o=r?r[4]:0,c=i?i[4]:0;if(o>(c+2|0)){if(r){var f=r[3],s=r[2],v=r[1],l=r[0];if(n(l)>=n(f))return t(l,v,s,t(f,a,u,i));if(f)return t(t(l,v,s,f[0]),f[1],f[2],t(f[3],a,u,i));throw[e,"Map.bal"]}throw[e,"Map.bal"]}if(c<=(o+2|0))return[r,a,u,i,o>=c?o+1|0:c+1|0];if(i){var d=i[3],m=i[2],h=i[1],g=i[0];if(n(d)>=n(g))return t(t(r,a,u,g),h,m,d);if(g)return t(t(r,a,u,g[0]),g[1],g[2],t(g[3],h,m,d));throw[e,"Map.bal"]}throw[e,"Map.bal"]},c=function(n,e,t){if(!t)return[0,n,e,0,1];var a=t[3],u=t[2],i=t[1],f=t[0],s=v(r.compare,n,i);if(0===s)return u===e?t:[f,n,e,a,t[4]];if(s<0){var l=c(n,e,f);return f===l?t:o(l,i,u,a)}var d=c(n,e,a);return a===d?t:o(f,i,u,d)},f=function(r){for(;;){var n=r;if(!n)throw a;var e=n[0];if(!e)return[n[1],n[2]];r=e}},d=function(r){for(;;){var n=r;if(!n)return;var e=n[0];if(!e)return[n[1],n[2]];r=e}},m=function(r){if(r){var n=r[0];return n?o(m(n),r[1],r[2],r[3]):r[3]}throw[e,"Map.remove_min_elt"]},h=function(r,n){if(!r)return n;if(!n)return r;var e=f(n);return o(r,e[0],e[1],m(n))},g=function(n,e){if(!e)return 0;var t=e[3],a=e[2],u=e[1],i=e[0],c=v(r.compare,n,u);if(0===c)return h(i,t);if(c<0){var f=g(n,i);return i===f?e:o(f,u,a,t)}var s=g(n,t);return t===s?e:o(i,u,a,s)},p=function(n,e,t){if(t){var a=t[3],u=t[2],i=t[1],c=t[0],f=v(r.compare,n,i);if(0===f){var l=s(e,hr(u));if(void 0===l)return h(c,a);var d=gr(l);return u===d?t:[c,n,d,a,t[4]]}if(f<0){var m=p(n,e,c);return c===m?t:o(m,i,u,a)}var g=p(n,e,a);return a===g?t:o(c,i,u,g)}var b=s(e,void 0);return void 0!==b?[0,n,gr(b),0,1]:0},b=function(r,n){for(;;){var e=n;if(!e)return;b(r,e[0]),v(r,e[1],e[2]),n=e[3]}},w=function(r,n){if(!n)return 0;var e=w(r,n[0]),t=s(r,n[2]),a=w(r,n[3]);return[e,n[1],t,a,n[4]]},_=function(r,n){if(!n)return 0;var e=n[1];return[_(r,n[0]),e,v(r,e,n[2]),_(r,n[3]),n[4]]},y=function(r,n,e){for(;;){var t=e,a=n;if(!a)return t;e=l(r,a[1],a[2],y(r,a[0],t)),n=a[3]}},k=function(r,n){for(;;){var e=n;if(!e)return!0;if(!v(r,e[1],e[2]))return!1;if(!k(r,e[0]))return!1;n=e[3]}},x=function(r,n){for(;;){var e=n;if(!e)return!1;if(v(r,e[1],e[2]))return!0;if(x(r,e[0]))return!0;n=e[3]}},N=function(r,n,e){return e?o(N(r,n,e[0]),e[1],e[2],e[3]):u(r,n)},q=function(r,n,e){return e?o(e[0],e[1],e[2],q(r,n,e[3])):u(r,n)},C=function(r,n,e,a){if(!r)return N(n,e,a);if(!a)return q(n,e,r);var u=a[4],i=r[4];return i>(u+2|0)?o(r[0],r[1],r[2],C(r[3],n,e,a)):u>(i+2|0)?o(C(r,n,e,a[0]),a[1],a[2],a[3]):t(r,n,e,a)},F=function(r,n){if(!r)return n;if(!n)return r;var e=f(n);return C(r,e[0],e[1],m(n))},S=function(r,n,e,t){return void 0!==e?C(r,n,gr(e),t):F(r,t)},A=function(n,e){if(!e)return[0,void 0,0];var t=e[3],a=e[2],u=e[1],i=e[0],o=v(r.compare,n,u);if(0===o)return[i,hr(a),t];if(o<0){var c=A(n,i);return[c[0],c[1],C(c[2],u,a,t)]}var f=A(n,t);return[C(i,u,a,f[0]),f[1],f[2]]},R=function(r,e,t){if(e){var a=e[1];if(e[4]>=n(t)){var u=A(a,t);return S(R(r,e[0],u[0]),a,l(r,a,hr(e[2]),u[1]),R(r,e[3],u[2]))}}else if(!t)return 0;if(t){var o=t[1],c=A(o,e);return S(R(r,c[0],t[0]),o,l(r,o,c[1],hr(t[2])),R(r,c[2],t[3]))}throw[i,["map.ml",393,10]]},D=function(r,n,e){if(!n)return e;if(!e)return n;var t=e[2],a=e[1],u=n[2],i=n[1];if(n[4]>=e[4]){var o=A(i,e),c=o[1],f=D(r,n[0],o[0]),s=D(r,n[3],o[2]);return void 0!==c?S(f,i,l(r,i,u,gr(c)),s):C(f,i,u,s)}var v=A(a,n),d=v[1],m=D(r,v[0],e[0]),h=D(r,v[2],e[3]);return void 0!==d?S(m,a,l(r,a,gr(d),t),h):C(m,a,t,h)},M=function(r,n){if(!n)return 0;var e=n[3],t=n[2],a=n[1],u=n[0],i=M(r,u),o=v(r,a,t),c=M(r,e);return o?u===i&&e===c?n:C(i,a,t,c):F(i,c)},$=function(r,n){if(!n)return[0,0];var e=n[2],t=n[1],a=$(r,n[0]),u=a[1],i=a[0],o=v(r,t,e),c=$(r,n[3]),f=c[1],s=c[0];return o?[C(i,t,e,s),F(u,f)]:[F(i,s),C(u,t,e,f)]},E=function(r,n){for(;;){var e=n,t=r;if(!t)return e;n=[t[1],t[2],t[3],e],r=t[0]}},L=function(r){return r?(L(r[0])+1|0)+L(r[3])|0:0},O=function(r,n){for(;;){var e=n,t=r;if(!e)return t;n=e[0],r=[[e[1],e[2]],O(t,e[3])]}};return{empty:0,is_empty:function(r){return!r},mem:function(n,e){for(;;){var t=e;if(!t)return!1;var a=v(r.compare,n,t[1]);if(0===a)return!0;e=a<0?t[0]:t[3]}},add:c,update:p,singleton:u,remove:g,merge:R,union:D,compare:function(n,e,t){for(var a=E(e,0),u=E(t,0);;){var i=u,o=a;if(!o)return i?-1:0;if(!i)return 1;var c=v(r.compare,o[0],i[0]);if(0!==c)return c;var f=v(n,o[1],i[1]);if(0!==f)return f;u=E(i[2],i[3]),a=E(o[2],o[3])}},equal:function(n,e,t){for(var a=E(e,0),u=E(t,0);;){var i=u,o=a;if(!o)return!i;if(!i)return!1;if(0!==v(r.compare,o[0],i[0]))return!1;if(!v(n,o[1],i[1]))return!1;u=E(i[2],i[3]),a=E(o[2],o[3])}},iter:b,fold:y,for_all:k,exists:x,filter:M,partition:$,cardinal:L,bindings:function(r){return O(0,r)},min_binding:f,min_binding_opt:d,max_binding:function(r){for(;;){var n=r;if(!n)throw a;var e=n[3];if(!e)return[n[1],n[2]];r=e}},max_binding_opt:function(r){for(;;){var n=r;if(!n)return;var e=n[3];if(!e)return[n[1],n[2]];r=e}},choose:f,choose_opt:d,split:A,find:function(n,e){for(;;){var t=e;if(!t)throw a;var u=v(r.compare,n,t[1]);if(0===u)return t[2];e=u<0?t[0]:t[3]}},find_opt:function(n,e){for(;;){var t=e;if(!t)return;var a=v(r.compare,n,t[1]);if(0===a)return hr(t[2]);e=a<0?t[0]:t[3]}},find_first:function(r,n){for(;;){var e=n;if(!e)throw a;var t=e[1];if(s(r,t))for(var u=t,i=e[2],o=e[0];;){var c=o;if(!c)return[u,i];var f=c[1];s(r,f)?(o=c[0],i=c[2],u=f):o=c[3]}n=e[3]}},find_first_opt:function(r,n){for(;;){var e=n;if(!e)return;var t=e[1];if(s(r,t))for(var a=t,u=e[2],i=e[0];;){var o=i;if(!o)return[a,u];var c=o[1];s(r,c)?(i=o[0],u=o[2],a=c):i=o[3]}n=e[3]}},find_last:function(r,n){for(;;){var e=n;if(!e)throw a;var t=e[1];if(s(r,t))for(var u=t,i=e[2],o=e[3];;){var c=o;if(!c)return[u,i];var f=c[1];s(r,f)?(o=c[3],i=c[2],u=f):o=c[0]}n=e[0]}},find_last_opt:function(r,n){for(;;){var e=n;if(!e)return;var t=e[1];if(s(r,t))for(var a=t,u=e[2],i=e[3];;){var o=i;if(!o)return[a,u];var c=o[1];s(r,c)?(i=o[3],u=o[2],a=c):i=o[0]}n=e[0]}},map:w,mapi:_}}function De(r,n){var e=n.length;if(0===e)return[];for(var t=function(r,n){for(var e=new Array(r),t=0;t<r;++t)e[t]=n;return e}(e,s(r,n[0])),a=1;a<e;++a)t[a]=s(r,n[a]);return t}function Me(r){for(var n=r.length-1|0,e=0;;){var t=e,a=n;if(a<0)return t;e=[r[a],t],n=a-1|0}}function $e(r,n,e){for(var t=e,a=n.length-1|0;a>=0;--a)t=v(r,n[a],t);return t}dr("Array.Bottom");function Ee(r,n){if(n in r)return hr(r[n])}var Le=function(r){var n=typeof r;return"string"===n?b(0,[r]):"number"===n?b(1,[r]):"boolean"===n?!0===r?1:0:null===r?2:Array.isArray(r)?b(3,[r]):b(2,[r])};function Oe(r,n){return n.tag?n:r}function Te(r,n){return n.tag?hr(n[0]):function(r){if(r.tag)return hr(r[0])}(r)}function Pe(r){return r?r[4]:0}function Ie(r,n,e,t){var a=Pe(r),u=Pe(t);return[r,n,e,t,a>=u?a+1|0:u+1|0]}function Ve(r,n){return[0,r,n,0,1]}function Ue(r,n,t,a){var u=r?r[4]:0,i=a?a[4]:0;if(u>(i+2|0)){if(r){var o=r[3],c=r[2],f=r[1],s=r[0];if(Pe(s)>=Pe(o))return Ie(s,f,c,Ie(o,n,t,a));if(o)return Ie(Ie(s,f,c,o[0]),o[1],o[2],Ie(o[3],n,t,a));throw[e,"Map.bal"]}throw[e,"Map.bal"]}if(i<=(u+2|0))return[r,n,t,a,u>=i?u+1|0:i+1|0];if(a){var v=a[3],l=a[2],d=a[1],m=a[0];if(Pe(v)>=Pe(m))return Ie(Ie(r,n,t,m),d,l,v);if(m)return Ie(Ie(r,n,t,m[0]),m[1],m[2],Ie(m[3],d,l,v));throw[e,"Map.bal"]}throw[e,"Map.bal"]}function Qe(r,n,e){if(!e)return[0,r,n,0,1];var t=e[3],a=e[2],u=e[1],i=e[0],o=_(r,u);if(0===o)return a===n?e:[i,r,n,t,e[4]];if(o<0){var c=Qe(r,n,i);return i===c?e:Ue(c,u,a,t)}var f=Qe(r,n,t);return t===f?e:Ue(i,u,a,f)}function je(r){for(;;){var n=r;if(!n)throw a;var e=n[0];if(!e)return[n[1],n[2]];r=e}}function Xe(r){for(;;){var n=r;if(!n)return;var e=n[0];if(!e)return[n[1],n[2]];r=e}}function ze(r){if(r){var n=r[0];return n?Ue(ze(n),r[1],r[2],r[3]):r[3]}throw[e,"Map.remove_min_elt"]}function Be(r,n){if(!r)return n;if(!n)return r;var e=je(n);return Ue(r,e[0],e[1],ze(n))}function Ke(r,n,e,t){if(!r)return function r(n,e,t){return t?Ue(r(n,e,t[0]),t[1],t[2],t[3]):Ve(n,e)}(n,e,t);if(!t)return function r(n,e,t){return t?Ue(t[0],t[1],t[2],r(n,e,t[3])):Ve(n,e)}(n,e,r);var a=t[4],u=r[4];return u>(a+2|0)?Ue(r[0],r[1],r[2],Ke(r[3],n,e,t)):a>(u+2|0)?Ue(Ke(r,n,e,t[0]),t[1],t[2],t[3]):Ie(r,n,e,t)}function Je(r,n){if(!r)return n;if(!n)return r;var e=je(n);return Ke(r,e[0],e[1],ze(n))}function He(r,n,e,t){return void 0!==e?Ke(r,n,gr(e),t):Je(r,t)}function Ge(r,n){if(!n)return[0,void 0,0];var e=n[3],t=n[2],a=n[1],u=n[0],i=_(r,a);if(0===i)return[u,hr(t),e];if(i<0){var o=Ge(r,u);return[o[0],o[1],Ke(o[2],a,t,e)]}var c=Ge(r,e);return[Ke(u,a,t,c[0]),c[1],c[2]]}function We(r,n){for(;;){var e=n,t=r;if(!t)return e;n=[t[1],t[2],t[3],e],r=t[0]}}var Ye={empty:0,is_empty:function(r){return!r},mem:function(r,n){for(;;){var e=n;if(!e)return!1;var t=_(r,e[1]);if(0===t)return!0;n=t<0?e[0]:e[3]}},add:Qe,update:function r(n,e,t){if(t){var a=t[3],u=t[2],i=t[1],o=t[0],c=_(n,i);if(0===c){var f=s(e,hr(u));if(void 0===f)return Be(o,a);var v=gr(f);return u===v?t:[o,n,v,a,t[4]]}if(c<0){var l=r(n,e,o);return o===l?t:Ue(l,i,u,a)}var d=r(n,e,a);return a===d?t:Ue(o,i,u,d)}var m=s(e,void 0);return void 0!==m?[0,n,gr(m),0,1]:0},singleton:Ve,remove:function r(n,e){if(!e)return 0;var t=e[3],a=e[2],u=e[1],i=e[0],o=_(n,u);if(0===o)return Be(i,t);if(o<0){var c=r(n,i);return i===c?e:Ue(c,u,a,t)}var f=r(n,t);return t===f?e:Ue(i,u,a,f)},merge:function r(n,e,t){if(e){var a=e[1];if(e[4]>=Pe(t)){var u=Ge(a,t);return He(r(n,e[0],u[0]),a,l(n,a,hr(e[2]),u[1]),r(n,e[3],u[2]))}}else if(!t)return 0;if(t){var o=t[1],c=Ge(o,e);return He(r(n,c[0],t[0]),o,l(n,o,c[1],hr(t[2])),r(n,c[2],t[3]))}throw[i,["map.ml",393,10]]},union:function r(n,e,t){if(!e)return t;if(!t)return e;var a=t[2],u=t[1],i=e[2],o=e[1];if(e[4]>=t[4]){var c=Ge(o,t),f=c[1],s=r(n,e[0],c[0]),v=r(n,e[3],c[2]);return void 0!==f?He(s,o,l(n,o,i,gr(f)),v):Ke(s,o,i,v)}var d=Ge(u,e),m=d[1],h=r(n,d[0],t[0]),g=r(n,d[2],t[3]);return void 0!==m?He(h,u,l(n,u,gr(m),a),g):Ke(h,u,a,g)},compare:function(r,n,e){for(var t=We(n,0),a=We(e,0);;){var u=a,i=t;if(!i)return u?-1:0;if(!u)return 1;var o=_(i[0],u[0]);if(0!==o)return o;var c=v(r,i[1],u[1]);if(0!==c)return c;a=We(u[2],u[3]),t=We(i[2],i[3])}},equal:function(r,n,e){for(var t=We(n,0),a=We(e,0);;){var u=a,i=t;if(!i)return!u;if(!u)return!1;if(0!==_(i[0],u[0]))return!1;if(!v(r,i[1],u[1]))return!1;a=We(u[2],u[3]),t=We(i[2],i[3])}},iter:function r(n,e){for(;;){var t=e;if(!t)return;r(n,t[0]),v(n,t[1],t[2]),e=t[3]}},fold:function r(n,e,t){for(;;){var a=t,u=e;if(!u)return a;t=l(n,u[1],u[2],r(n,u[0],a)),e=u[3]}},for_all:function r(n,e){for(;;){var t=e;if(!t)return!0;if(!v(n,t[1],t[2]))return!1;if(!r(n,t[0]))return!1;e=t[3]}},exists:function r(n,e){for(;;){var t=e;if(!t)return!1;if(v(n,t[1],t[2]))return!0;if(r(n,t[0]))return!0;e=t[3]}},filter:function r(n,e){if(!e)return 0;var t=e[3],a=e[2],u=e[1],i=e[0],o=r(n,i),c=v(n,u,a),f=r(n,t);return c?i===o&&t===f?e:Ke(o,u,a,f):Je(o,f)},partition:function r(n,e){if(!e)return[0,0];var t=e[2],a=e[1],u=r(n,e[0]),i=u[1],o=u[0],c=v(n,a,t),f=r(n,e[3]),s=f[1],l=f[0];return c?[Ke(o,a,t,l),Je(i,s)]:[Je(o,l),Ke(i,a,t,s)]},cardinal:function r(n){return n?(r(n[0])+1|0)+r(n[3])|0:0},bindings:function(r){return function r(n,e){for(;;){var t=e,a=n;if(!t)return a;e=t[0],n=[[t[1],t[2]],r(a,t[3])]}}(0,r)},min_binding:je,min_binding_opt:Xe,max_binding:function(r){for(;;){var n=r;if(!n)throw a;var e=n[3];if(!e)return[n[1],n[2]];r=e}},max_binding_opt:function(r){for(;;){var n=r;if(!n)return;var e=n[3];if(!e)return[n[1],n[2]];r=e}},choose:je,choose_opt:Xe,split:Ge,find:function(r,n){for(;;){var e=n;if(!e)throw a;var t=_(r,e[1]);if(0===t)return e[2];n=t<0?e[0]:e[3]}},find_opt:function(r,n){for(;;){var e=n;if(!e)return;var t=_(r,e[1]);if(0===t)return hr(e[2]);n=t<0?e[0]:e[3]}},find_first:function(r,n){for(;;){var e=n;if(!e)throw a;var t=e[1];if(s(r,t))for(var u=t,i=e[2],o=e[0];;){var c=o;if(!c)return[u,i];var f=c[1];s(r,f)?(o=c[0],i=c[2],u=f):o=c[3]}n=e[3]}},find_first_opt:function(r,n){for(;;){var e=n;if(!e)return;var t=e[1];if(s(r,t))for(var a=t,u=e[2],i=e[0];;){var o=i;if(!o)return[a,u];var c=o[1];s(r,c)?(i=o[0],u=o[2],a=c):i=o[3]}n=e[3]}},find_last:function(r,n){for(;;){var e=n;if(!e)throw a;var t=e[1];if(s(r,t))for(var u=t,i=e[2],o=e[3];;){var c=o;if(!c)return[u,i];var f=c[1];s(r,f)?(o=c[3],i=c[2],u=f):o=c[0]}n=e[0]}},find_last_opt:function(r,n){for(;;){var e=n;if(!e)return;var t=e[1];if(s(r,t))for(var a=t,u=e[2],i=e[3];;){var o=i;if(!o)return[a,u];var c=o[1];s(r,c)?(i=o[3],u=o[2],a=c):i=o[0]}n=e[0]}},map:function r(n,e){if(!e)return 0;var t=r(n,e[0]),a=s(n,e[2]),u=r(n,e[3]);return[t,e[1],a,u,e[4]]},mapi:function r(n,e){if(!e)return 0;var t=e[1];return[r(n,e[0]),t,v(n,t,e[2]),r(n,e[3]),e[4]]}},Ze=dr("Tea_json.Decoder.ParseFail");function rt(r){return[function(n){var e=Le(n);return"number"==typeof e&&e>=2?b(0,[r]):b(1,["Non-null value"])}]}function nt(r,n){var e=n[0];return[function(n){var t=Le(n);if("number"==typeof t)return b(1,["Non-fieldable value"]);if(2!==t.tag)return b(1,["Non-fieldable value"]);var a=Ee(t[0],r);if(void 0===a)return b(1,["Field Value is undefined: "+r]);var u=s(e,gr(a));return u.tag?b(1,["field `"+r+"` -> "+u[0]]):u}]}function et(r){return[function(n){var e=function(r,n){for(;;){var t=n;if(!t)return b(1,["No one-of's matched"]);var a=t[1];try{var u=s(t[0][0],r);return u.tag?e(r,a):u}catch(r){n=a;continue}}};return e(n,r)}]}function tt(r,n){var e=n[0];return[function(n){var t=s(e,n);return t.tag?b(1,["map "+t[0]]):b(0,[s(r,t[0])])}]}function at(r,n){var e=n[0];return[function(n){var t=s(e,n);if(t.tag)return t;var a=s(r,t[0]);return s(a[0],n)}]}function ut(r,n){try{return s(r[0],n)}catch(r){var e=br(r);return e[0]===Ze?b(1,[e[1]]):b(1,["Unknown JSON parsing error"])}}var it={ObjectDict:Ye,ParseFail:Ze,string:[function(r){var n=Le(r);return"number"==typeof n||n.tag?b(1,["Non-string value"]):b(0,[n[0]])}],$$int:[function(r){var n=Le(r);if("number"==typeof n)return b(1,["Non-int value"]);if(1!==n.tag)return b(1,["Non-int value"]);var e=n[0];return e>-2147483648&&e<2147483647?b(0,[0|e]):b(1,["number out of int range"])}],$$float:[function(r){var n=Le(r);return"number"==typeof n||1!==n.tag?b(1,["Non-float-value"]):b(0,[n[0]])}],bool:[function(r){var n=Le(r);if("number"!=typeof n)return b(1,["Non-boolean value"]);switch(n){case 0:return b(0,[!1]);case 1:return b(0,[!0]);case 2:return b(1,["Non-boolean value"])}}],$$null:rt,list:function(r){var n=r[0];return[function(r){var e=Le(r);if("number"==typeof e)return b(1,["Non-list value"]);if(3!==e.tag)return b(1,["Non-list value"]);try{return b(0,[Fr((function(r){var e=s(n,r);if(!e.tag)return e[0];throw[Ze,e[0]]}),Me(e[0]))])}catch(r){var t=br(r);if(t[0]===Ze)return b(1,["list -> "+t[1]]);throw t}}]},array:function(r){var n=r[0];return[function(r){var e=Le(r);if("number"==typeof e)return b(1,["Non-array value"]);if(3!==e.tag)return b(1,["Non-array value"]);try{return b(0,[De((function(r){var e=s(n,r);if(!e.tag)return e[0];throw[Ze,e[0]]}),e[0])])}catch(r){var t=br(r);if(t[0]===Ze)return b(1,["array -> "+t[1]]);throw t}}]},keyValuePairs:function(r){var n=r[0];return[function(r){var e=Le(r);if("number"==typeof e)return b(1,["Non-keyValuePair value"]);if(2!==e.tag)return b(1,["Non-keyValuePair value"]);var t=e[0],a=Object.keys(t);try{return b(0,[$e((function(r,e){var a=Ee(t,r);if(void 0!==a){var u=s(n,gr(a));if(!u.tag)return[[r,u[0]],e];throw[Ze,u[0]]}throw[Ze,"Key is undefined: "+r]}),a,0)])}catch(r){var u=br(r);if(u[0]===Ze)return b(1,["Invalid keyValuePair parsing: "+u[1]]);throw u}}]},dict:function(r){var n=r[0];return[function(r){var e=Le(r);if("number"==typeof e)return b(1,["Non-dict value"]);if(2!==e.tag)return b(1,["Non-dict value"]);var t=e[0],a=Object.keys(t);try{return b(0,[$e((function(r,e){var a=Ee(t,r);if(void 0!==a){var u=s(n,gr(a));if(!u.tag)return Qe(r,u[0],e);throw[Ze,u[0]]}throw[Ze,"Key is undefined: "+r]}),a,0)])}catch(r){var u=br(r);if(u[0]===Ze)return b(1,["Invalid dict parsing: "+u[1]]);throw u}}]},field:nt,at:function(r,n){return function r(n,e,t){return e?v(n,e[0],r(n,e[1],t)):t}(nt,r,n)},index:function(r,n){var e=n[0];return[function(n){var t=Le(n);if("number"==typeof t)return b(1,["Non-array value"]);if(3!==t.tag)return b(1,["Non-array value"]);var a=t[0];return r<0||r>a.length?b(1,["Array index out of range: "+String(r)]):s(e,c(a,r))}]},maybe:function(r){var n=r[0];return[function(r){var e=s(n,r);return e.tag?b(0,[void 0]):b(0,[hr(e[0])])}]},oneOf:et,map:tt,map2:function(r,e,t){var a=t[0],u=e[0];return[function(e){var t=s(u,e),i=s(a,e);if(!t.tag&&!i.tag)return b(0,[v(r,t[0],i[0])]);var o=Te(t,i);if(void 0!==o)return b(1,["map2 -> "+o]);throw[n,"Impossible case"]}]},map3:function(r,e,t,a){var u=a[0],i=t[0],o=e[0];return[function(e){var t=s(o,e),a=s(i,e),c=s(u,e);if(!t.tag&&!a.tag&&!c.tag)return b(0,[l(r,t[0],a[0],c[0])]);var f=Oe(c,Oe(a,t));if(f.tag)return b(1,["map3 -> "+f[0]]);throw[n,"Impossible case"]}]},map4:function(r,e,t,a,u){var i=u[0],o=a[0],c=t[0],f=e[0];return[function(e){var t=s(f,e),a=s(c,e),u=s(o,e),v=s(i,e);if(!(t.tag||a.tag||u.tag||v.tag))return b(0,[d(r,t[0],a[0],u[0],v[0])]);var l=Oe(v,Oe(u,Oe(a,t)));if(l.tag)return b(1,["map4 -> "+l[0]]);throw[n,"Impossible case"]}]},map5:function(r,e,t,a,u,i){var o=i[0],c=u[0],f=a[0],v=t[0],l=e[0];return[function(e){var t=s(l,e),a=s(v,e),u=s(f,e),i=s(c,e),d=s(o,e);if(!(t.tag||a.tag||u.tag||i.tag||d.tag))return b(0,[m(r,t[0],a[0],u[0],i[0],d[0])]);var h=Oe(d,Oe(i,Oe(u,Oe(a,t))));if(h.tag)return b(1,["map5 -> "+h[0]]);throw[n,"Impossible case"]}]},map6:function(r,e,t,a,u,i,o){var c=o[0],f=i[0],v=u[0],l=a[0],d=t[0],m=e[0];return[function(e){var t=s(m,e),a=s(d,e),u=s(l,e),i=s(v,e),o=s(f,e),g=s(c,e);if(!(t.tag||a.tag||u.tag||i.tag||o.tag||g.tag))return b(0,[h(r,t[0],a[0],u[0],i[0],o[0],g[0])]);var p=Oe(g,Oe(o,Oe(i,Oe(u,Oe(a,t)))));if(p.tag)return b(1,["map6 -> "+p[0]]);throw[n,"Impossible case"]}]},map7:function(r,e,t,a,u,i,o,c){var f=c[0],v=o[0],l=i[0],d=u[0],m=a[0],h=t[0],p=e[0];return[function(e){var t=s(p,e),a=s(h,e),u=s(m,e),i=s(d,e),o=s(l,e),c=s(v,e),w=s(f,e);if(!(t.tag||a.tag||u.tag||i.tag||o.tag||c.tag||w.tag))return b(0,[g(r,t[0],a[0],u[0],i[0],o[0],c[0],w[0])]);var _=Oe(w,Oe(c,Oe(o,Oe(i,Oe(u,Oe(a,t))))));if(_.tag)return b(1,["map7 -> "+_[0]]);throw[n,"Impossible case"]}]},map8:function(r,e,t,a,u,i,o,c,f){var v=f[0],l=c[0],d=o[0],m=i[0],h=u[0],g=a[0],w=t[0],_=e[0];return[function(e){var t=s(_,e),a=s(w,e),u=s(g,e),i=s(h,e),o=s(m,e),c=s(d,e),f=s(l,e),y=s(v,e);if(!(t.tag||a.tag||u.tag||i.tag||o.tag||c.tag||f.tag||y.tag))return b(0,[p(r,t[0],a[0],u[0],i[0],o[0],c[0],f[0],y[0])]);var k=Oe(y,Oe(f,Oe(c,Oe(o,Oe(i,Oe(u,Oe(a,t)))))));if(k.tag)return b(1,["map8 -> "+k[0]]);throw[n,"Impossible case"]}]},succeed:function(r){return[function(n){return b(0,[r])}]},fail:function(r){return[function(n){return b(1,[r])}]},value:[function(r){return b(0,[r])}],andThen:at,lazy_:function(r){return at(r,[function(r){return b(0,[void 0])}])},nullable:function(r){return et([rt(void 0),[tt((function(r){return hr(r)}),r),0]])},decodeValue:ut,decodeEvent:function(r,n){try{return s(r[0],n)}catch(r){var e=br(r);return e[0]===Ze?b(1,[e[1]]):b(1,["Unknown JSON parsing error"])}},decodeString:function(r,n){try{return ut(r,JSON.parse(n))}catch(r){return b(1,["Invalid JSON string"])}}};function ot(r){return b(1,[r])}function ct(r,n,e,t){return tn("","div",void 0!==r?r:"",void 0!==n?n:"",e,t)}function ft(r,n,e,t){return tn("","span",void 0!==r?r:"",void 0!==n?n:"",e,t)}function st(r,n,e,t){return tn("","h3",void 0!==r?r:"",void 0!==n?n:"",e,t)}function vt(r,n,e,t){return tn("","ul",void 0!==r?r:"",void 0!==n?n:"",e,t)}function lt(r,n,e,t){return tn("","li",void 0!==r?r:"",void 0!==n?n:"",e,t)}function dt(r,n,e,t){return tn("","hr",void 0!==r?r:"",void 0!==n?n:"",e,t)}function mt(r){return b(0,["className",r])}function ht(r){return b(0,["className",Kr(" ",Fr((function(r){return r[0]}),$r((function(r){return r[1]}))(r)))])}function gt(r){return b(0,["value",r])}function pt(r,n){return function(r,n){return an("input",void 0!==r?r:"",(function(r){var e=r.target;if(void 0!==e){var t=e.value;return void 0!==t?s(n,t):void 0}}))}(void 0!==r?r:"",(function(r){return hr(s(n,r))}))}function bt(r){return function(r,n){return b(3,[r,b(1,[n]),{contents:void 0}])}("click",r)}var wt={stopPropagation:!1,preventDefault:!1};function _t(r,n,e){return an(r,"",(function(r){return n.stopPropagation&&r.stopPropagation(),n.preventDefault&&r.preventDefault(),(t=it.decodeEvent(e,r)).tag?void 0:hr(t[0]);var t}))}it.at(["target",["value",0]],it.string),it.at(["target",["checked",0]],it.bool);var yt=it.field("keyCode",it.$$int);var kt={max:function(r){return b(1,["","max",r])},min:function(r){return b(1,["","min",r])},step:function(r){return b(1,["","step",r])},disabled:function(r){return r?b(1,["","disabled","true"]):0},selected:function(r){return r?b(1,["","selected","true"]):0},acceptCharset:function(r){return b(1,["","accept-charset",r])},rel:function(r){return b(1,["","rel",r])}},xt=en,Nt=dr("CamlinternalLazy.Undefined");function qt(r){throw Nt}function Ct(r){var n=0|r.tag;return 250===n?r[0]:246!==n?r:function(r){var n,e=r[0];r[0]=qt;try{var t=s(e,void 0);return r[0]=t,n=250,r.tag=n,t}catch(n){throw r[0]=function(r){throw n},n}}(r)}function Ft(r,n){return Mr(Fr(n,r))}var St={take:function(r,n){var e=function(r,n,e){for(;;){var t=n,a=r;if(0===e)return[a,t];if(!t)return[a,0];e=e-1|0,n=t[1],r=[t[0],a]}}(0,n,r);return[qr(e[0]),e[1]]},apply:function(r,n){return s(n,r)},bind:Ft,concat_map:function(r,n){return Mr(Fr(r,n))},$great$great$eq:Ft,list_from_option:function(r){return void 0!==r?[gr(r),0]:0},first_inconsistent_opt:function(r,n){if(r)for(var e=s(n,r[0]),t=r[1];;){var a=t,u=e;if(!a)return;var i=s(n,a[0]);if(!x(i,u))return[u,i];t=a[1],e=i}}};var At={keydown:function(r){var n,e,t=it.field("ctrlKey",it.bool),a=it.map2((function(r,n){return{ctrlKey:n,keyCode:r}}),yt,t);return n="keydown",e=it.andThen(r,a),_t(n,wt,e)}};function Rt(r){return[r,0]}function Dt(r,n){if(!n)return 0;var e=n[1];return[s(r,n[0]),k((function(n){return Dt(r,Ct(e))}))]}function Mt(r,n){if(!r)return Ct(n);var e=r[1];return[r[0],k((function(r){return Mt(Ct(n),e)}))]}function $t(r){if(!r)return 0;var n=r[1];return Mt(r[0],k((function(r){return $t(Ct(n))})))}function Et(r,n){return $t(Dt(n,r))}var Lt={$$return:Rt,unit:Rt,push:function(r,n){return[r,n]},map:Dt,filter:function r(n,e){for(;;){var t=e;if(!t)return 0;var a=t[1],u=t[0];if(s(n,u))return[u,k(function(e){return function(t){return r(n,Ct(e))}}(a))];e=Ct(a)}},interleave_delayed:Mt,append_delayed:function r(n,e){if(!n)return Ct(e);var t=n[1];return[n[0],k((function(n){return r(Ct(t),e)}))]},flatten:$t,bind:Et,$great$great$eq:Et,from_list:function r(n){if(!n)return 0;var e=n[1];return[n[0],k((function(n){return r(e)}))]},from_option:function(r){return void 0!==r?[gr(r),0]:0}};function Ot(r,n){return[v(ne([b(2,[0,b(4,[0,0,0,0])]),"%s%d"]),r[0],n)]}function Tt(r){return s(ne([b(12,[63,b(2,[0,0])]),"?%s"]),r[0])}var Pt={compare:function(r,n){return _(r[0],n[0])},make_numbered:Ot,to_string:Tt};function It(r,n){return r[0]===n[0]}var Vt={compare:function(r,n){return _(r[0],n[0])},equals:It,to_string:function(r){return r[0]}};function Ut(r){if(!r.tag)return Tt(r[0]);var n=r[0],e=n.related_terms,t=n.relation_name[0];return e?v(ne([b(2,[0,b(12,[40,b(2,[0,b(12,[41,0])])])]),"%s(%s)"]),t,Kr(", ",Fr(Ut,e))):t}function Qt(r){if(!r.tag)return 0;var n=r[0],e=n.related_terms;return[[n.relation_name,xr(e)],St.concat_map(Qt,e)]}var jt={to_string:Ut,relation_arities:Qt};function Xt(r){switch(0|r.tag){case 0:return Ut(r[0]);case 1:return v(ne([b(12,[60,b(2,[0,b(11,[" = ",b(2,[0,b(12,[62,0])])])])]),"<%s = %s>"]),Ut(r[0]),Ut(r[1]));case 2:return v(ne([b(12,[60,b(2,[0,b(11,[" /= ",b(2,[0,b(12,[62,0])])])])]),"<%s /= %s>"]),Ut(r[0]),Ut(r[1]))}}function zt(r){switch(0|r.tag){case 0:return Qt(r[0])}return Mr([Qt(r[0]),[Qt(r[1]),0]])}var Bt={to_string:Xt,relation_arities:zt},Kt=Re(Pt),Jt=Kt.empty;function Ht(r,n){return l(Kt.add,r[0],r[1],n)}function Gt(r,n){var e=v(Kt.find_opt,r,n);if(void 0!==e){if(e.tag)return e;var t=Gt(e[0],n);return void 0!==t?t:e}}function Wt(r,n){var e=function(r){var e=Gt(r,n);return void 0!==e?a(e):b(0,[["?"]])},t=function(r,n){if(n.tag)return Ar(t,r,n[0].related_terms);var a=n[0];return Ht([a,e(a)],r)},a=function(r){if(!r.tag)return e(r[0]);var n=r[0];return b(1,[{relation_name:n.relation_name,related_terms:Fr(a,n.related_terms)}])};return s(Kt.bindings,Ar((function(r,n){switch(0|n.tag){case 0:return t(r,n[0])}return t(t(r,n[0]),n[1])}),Jt,r))}function Yt(r,n,e){var t=function(r){for(;;){var a=r;if(a.tag)return Rr(t,a[0].related_terms);var u=a[0];if(x(u,n))return!0;var i=Gt(u,e);if(void 0===i)return!1;r=i}};return t(r)}var Zt={FrameMap:Kt,empty:Jt,extend:Ht,lookup:Gt,instantiate:function(r){var n=function(e){if(!e.tag){var t=Gt(e[0],r);return void 0!==t?n(t):b(0,[["?"]])}var a=e[0];return b(1,[{relation_name:a.relation_name,related_terms:Fr(n,a.related_terms)}])};return n},variable_bindings_in_query:Wt,to_strings:function(r,n){var e=Wt(r,n);return e?Fr((function(r){return v(ne([b(2,[0,b(11,[" := ",b(2,[0,0])])]),"%s := %s"]),Tt(r[0]),Ut(r[1]))}),e):0},term_depends_on_variable:Yt};function ra(r){return Mr([Cr(Fr(zt,r.antecedents)),[Qt(r.consequent),0]])}var na={contents:0};function ea(r){if(!r.tag)return b(0,[Ot(r[0],na.contents)]);var n=r[0],e=Fr(ea,n.related_terms);return b(1,[{relation_name:n.relation_name,related_terms:e}])}function ta(r){switch(0|r.tag){case 0:return b(0,[ea(r[0])]);case 1:return b(1,[ea(r[0]),ea(r[1])]);case 2:return b(2,[ea(r[0]),ea(r[1])])}}function aa(r){return na.contents=na.contents+1|0,{antecedents:Fr(ta,r.antecedents),consequent:ea(r.consequent)}}var ua={to_string:function(r){var n=r.antecedents,e=Ut(r.consequent);if(!n)return e;var t=Kr(" and ",Fr(Xt,n));return v(ne([b(2,[0,b(11,[" when ",b(2,[0,0])])]),"%s when %s"]),e,t)},relation_arities:ra,rename_rule_variables:aa},ia=Re({compare:Gr});function oa(r){return r.rule}function ca(r,n){return r.id===n.id}var fa=ia.empty;function sa(r,n){var e;if(n.tag){var t=v(ia.find_opt,n[0].relation_name[0],r.indexed_by_consequent_relation);e=void 0!==t?t:0}else e=r.all_rules;return Lt.from_list(qr(e))}function va(r){return r.all_rules}var la={contents:1};var da={VariableName:Pt,RelationName:Vt,Term:jt,ComplexTerm:Bt,Frame:Zt,Rule:ua,RuleDatabase:{empty:{all_rules:0,indexed_by_consequent_relation:fa},rule_from_entry:oa,update_rule_entry:function(r,n){return{id:r.id,rule:n}},is_same:ca,remove_rule:function(r,n){var e=n.id,t=$r((function(r){return r.id!==e})),a=s(t,r.all_rules),u=n.rule.consequent;return u.tag?{all_rules:a,indexed_by_consequent_relation:l(ia.update,u[0].relation_name[0],(function(r){return void 0!==r?s(t,r):0}),r.indexed_by_consequent_relation)}:{all_rules:a,indexed_by_consequent_relation:r.indexed_by_consequent_relation}},add_rule:function(r,n){var e={id:(la.contents=la.contents+1|0,la.contents),rule:n},t=n.consequent;return t.tag?{all_rules:[e,r.all_rules],indexed_by_consequent_relation:l(ia.update,t[0].relation_name[0],(function(r){return void 0!==r?[e,r]:[e,0]}),r.indexed_by_consequent_relation)}:{all_rules:[e,r.all_rules],indexed_by_consequent_relation:r.indexed_by_consequent_relation}},update_rule:function(r,n){var e=function(r){return Fr((function(r){return r.id===n.id?n:r}),r)},t=e(r.all_rules),a=n.rule.consequent;return a.tag?{all_rules:t,indexed_by_consequent_relation:l(ia.update,a[0].relation_name[0],(function(r){return void 0!==r?e(r):[n,0]}),r.indexed_by_consequent_relation)}:{all_rules:t,indexed_by_consequent_relation:r.indexed_by_consequent_relation}},fetch_for_query:sa,all_rules:va}};function ma(r){var n=he(95),e=function(r){return Fe(ke,n,r)},t=s(ne([b(2,[0,b(11,[" requires ",b(2,[0,0])])]),"%s requires %s"]),r),a=function(r){return ce(t,e,r)};return function(r){return Ce(a,(function(r){return se((function(n){return Kr("",Fr((function(r){return zr(1,r)}),[r,n]))}),function r(n){var e=function(e){return ue(n,(function(e){var t=r(n);return function(r){return ue(t,(function(r){var n=[e,r];return function(r){return oe(n,r)}}),r)}}),e)};return function(r){return ve(e,(function(r){return oe(0,r)}),r)}}(le([ke,[_e,[he(95),[he(45),0]]]])))}),r)}}var ha=Se(he(63),se((function(r){return b(0,[[r]])}),ma("Variable")));function ga(r){return fe("Variable starting with ?",ha,r)}var pa=Se(Ne("= "),(function(r){return oe(!0,r)})),ba=Se(Ne("/= "),(function(r){return oe(!1,r)}));function wa(r){return Fe(pa,ba,r)}function _a(r){return de(r,Se(Se(xe,Ne("and")),xe))}function ya(r){return Fe(ga,qa,r)}function ka(r){return de(Ae(ya,xe),Se(he(44),xe))(r)}function xa(r){return Fe(se((function(r){return b(0,[r])}),ya),Na,r)}function Na(r){return Ce(Se(he(60),ya),(function(r){return function(n){return Ce(wa,(function(n){var e=Ae(ya,he(62));return function(t){return Ce(e,(function(e){var t=b(n?1:2,[r,e]);return function(r){return oe(t,r)}}),t)}}),n)}}),r)}function qa(r){return Ce(Ae(ma("Relation"),xe),(function(r){var n=[r],e=b(1,[{relation_name:n,related_terms:0}]),t=Ae(he(40),xe);return function(r){return ie(t,(function(r){return se((function(r){return b(1,[{relation_name:n,related_terms:r}])}),Ae(Ae(ka,xe),he(41)))}),e,r)}}),r)}function Ca(r){return _a(xa)(r)}var Fa,Sa=function(r){return Ae((function(r){return Ce(ya,(function(r){var n={antecedents:0,consequent:r},e=function(r){return oe(n,r)},t=se((function(n){return{antecedents:n,consequent:r}}),Se(Se(Se(xe,Ne("when")),xe),Ca));return function(r){return Fe(t,e,r)}}),r)}),he(46))(r)},Aa=function(r){return _a(xa)(r)},Ra={$$Map:Fa=Re(Vt),make:function(r,n){return Ar((function(n,e){return l(Fa.update,s(r,e),(function(r){return void 0!==r?[e,r]:[e,0]}),n)}),Fa.empty,n)},keys:function(r){return Fr((function(r){return r[0]}),s(Fa.bindings,r))},find_opt:function(r,n){return v(Fa.find_opt,r,n)}};function Da(r,n){return Ar((function(n,e){var t=s(r,e);if(void 0===t)return n;var a=St.first_inconsistent_opt(t,(function(r){return r[1]}));return void 0!==a?[l(ne([b(11,["Relation '",b(2,[0,b(11,["' has inconsistent number of terms applied of ",b(4,[0,0,0,b(11,[" and ",b(4,[0,0,0,0])])])])])]),"Relation '%s' has inconsistent number of terms applied of %d and %d"]),e[0],a[0],a[1]),n]:n}),0,n)}function Ma(r){return v(Ra.make,(function(r){return r[0]}),St.concat_map(ra,r))}function $a(r){return s(Ra.keys,v(Ra.make,(function(r){return r[0]}),ra(r)))}var Ea={rule_database_snapshot:va,issues_in_existing_rule:function(r,n){var e=Ma(Fr(oa,[n,$r((function(r){return!ca(r,n)}))(r)]));return Da((function(r){return v(Ra.find_opt,r,e)}),$a(oa(n)))},issues_in_new_rule:function(r,n){var e=Ma([n,Fr(oa,r)]);return Da((function(r){return v(Ra.find_opt,r,e)}),$a(n))},issues_in_query:function(r,n){var e=St.concat_map(zt,n),t=v(Ra.make,(function(r){return r[0]}),Mr([e,[St.concat_map(ra,Fr(oa,r)),0]]));return Da((function(r){return v(Ra.find_opt,r,t)}),s(Ra.keys,v(Ra.make,(function(r){return r[0]}),e)))}};function La(r){var n=function(r,n){for(var e=0,t=0,a=n;;){var u=a,i=t,o=e;if(!u)return[Nr(o,0),Nr(i,0)];var c=u[1],f=u[0];s(r,f)?(a=c,e=[f,o]):(a=c,t=[f,i])}}((function(r){switch(0|r.tag){case 0:case 1:return!1;case 2:return!0}}),r);return Mr([n[1],[n[0],0]])}function Oa(r,n){var t=function(r,n){for(;;){var e=n,t=r;if(!t)return e;n=a(t[0],e),r=t[1]}},a=function(n,e){switch(0|n.tag){case 0:var a=n[0];return Lt.$great$great$eq(e,(function(n){return Lt.$great$great$eq(sa(r,a),(function(r){var e=aa(oa(r)),i=u(a,e.consequent,n);return void 0!==i?t(e.antecedents,Lt.$$return({frame:i.frame,rules_applied:[r,i.rules_applied]})):0}))}));case 1:var i=n[1],o=n[0];return Lt.$great$great$eq(e,(function(r){return Lt.from_option(u(o,i,r))}));case 2:var c=n[1],f=n[0];return Lt.$great$great$eq(e,(function(r){return void 0!==u(f,c,r)?0:Lt.$$return(r)}))}},u=function(r,n,t){if(x(r,n))return t;if(!r.tag)return i(r[0],n,t);var a=r[0];if(!n.tag)return i(n[0],r,t);var o=n[0];return It(a.relation_name,o.relation_name)?Ar((function(r,n){if(void 0!==r)return u(n[0],n[1],r)}),t,function r(n,t){if(n){if(t)return[[n[0],t[0]],r(n[1],t[1])];throw[e,"List.combine"]}if(!t)return 0;throw[e,"List.combine"]}(a.related_terms,o.related_terms)):void 0},i=function(r,n,e){var t=Gt(r,e.frame);if(void 0!==t)return u(t,n,e);if(n.tag)return Yt(n,r,e.frame)?void 0:{frame:Ht([r,n],e.frame),rules_applied:e.rules_applied};var a=Gt(n[0],e.frame);return void 0!==a?u(b(0,[r]),a,e):{frame:Ht([r,n],e.frame),rules_applied:e.rules_applied}},o=La(n);return function(r){return t(o,r)}}var Ta={query:function(r,n){return Oa(r,n)(Lt.$$return({frame:Jt,rules_applied:0}))}};function Pa(r,n){return{text:s(r,n),compilation_result:b(0,[n])}}function Ia(r,n,e){var t,a=qe(n,r);if(a.tag){var u=Er(te,a[0]);if(u){var i=u[0],o=$r((function(r){return te(r,i)<=0}))(u[1]);t=b(1,[Fr(ae,[i,o])])}else t=b(1,[0])}else{var c=a[0].result,f=s(e,c);t=f?b(1,[f]):b(0,[c])}return{text:r,compilation_result:t}}function Va(r){var n=r.solution_stream;return n?{initiating_query:r.initiating_query,solution_stream:Ct(n[1]),displayed_solutions:[n[0],r.displayed_solutions]}:r}var Ua={CompiledTextEditing:{empty:function(r){return{text:"",compilation_result:b(1,[0])}},edit:Pa,make:Ia},ExecutingQueryInfo:{next_solution:Va},init:function(r){return{rule_database:da.RuleDatabase.empty,interaction_mode:0}}};var Qa={viewRules:0,initiateAddRule:1,initiateEditRule:function(r){return b(0,[r])},initiateEditQuery:2,updateText:function(r){return b(1,[r])},addRule:function(r){return b(2,[r])},editRuleEntry:function(r){return b(3,[r])},deleteRule:function(r){return b(4,[r])},executeQuery:function(r){return b(5,[r])},nextFrame:3};function ja(r){"remove"in Element.prototype||(Element.prototype.remove=function(){this.parentNode&&this.parentNode.removeChild(this)}),function(){for(var r=0,n=["ms","moz","webkit","o"],e=0;e<n.length&&!window.requestAnimationFrame;++e)window.requestAnimationFrame=window[n[e]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[n[e]+"CancelAnimationFrame"]||window[n[e]+"CancelRequestAnimationFrame"];window.requestAnimationFrame||(window.requestAnimationFrame=function(n,e){var t=(new Date).getTime(),a=Math.max(0,16-(t-r)),u=window.setTimeout((function(){n(t+a)}),a);return r=t+a,u}),window.cancelAnimationFrame||(window.cancelAnimationFrame=function(r){clearTimeout(r)})}()}function Xa(r,n,e,t,a,u){if(void 0===u)return function(u){var i={contents:0},o=function(r){var n=s(e,r);i.contents=wn(u,u,i.contents,n)};return{startup:function(r){bn(u,a),o(t)},render_string:function(r){return un(s(n,r))},handleMsg:function(n,e){var t=v(r,n,e),a=t[0];return bn(u,t[1]),o(a),a},shutdown:function(r){bn(u,r),i.contents=wn(u,u,i.contents,0)}}};var i=gr(u);return function(u){var o={contents:0},c={contents:t},f={contents:void 0},l=function(r){if(void 0!==f.contents){var e=[s(n,c.contents),0],t=function(r,n,e,t){return pn(r,n,n.childNodes,0,e,t),t}(u,i,o.contents,e);o.contents=t,f.contents=void 0}},d=function(r){for(;i.childNodes.length>0;){var n=i.firstChild;null!==n&&i.removeChild(n)}},m={contents:0},h=function(r){var n=s(e,r);m.contents=wn(u,u,m.contents,n)};return{startup:function(r){d(),bn(u,a),h(c.contents),f.contents=-1,l()},render_string:function(r){return un(s(n,r))},handleMsg:function(n,e){var t=v(r,n,e),a=t[0];return c.contents=a,bn(u,t[1]),void 0!==f.contents||(f.contents=-1,l()),h(a),a},shutdown:function(r){f.contents=void 0,bn(u,r),m.contents=wn(u,u,m.contents,0),o.contents=0,d()}}}}function za(r,e,t){ja();var a=s(r.init,t),u=a[0],i=null==e?void 0:hr(e);return function(r,e,t){var a={contents:r},u={contents:{enqueue:function(r){console.log("INVALID enqueue CALL!")}}},i=s(e,u),o={contents:void 0},c=function(r){var e=o.contents;if(void 0===e){o.contents=0;var t=v(i.handleMsg,a.contents,r);a.contents=t;var u=o.contents;if(void 0!==u)return u?(o.contents=void 0,Sr(c,qr(u))):void(o.contents=void 0);throw[n,"INVALID message queue state, should never be None during message processing!"]}o.contents=[r,e]},f={enqueue:c};return u.contents=f,s(i.startup,void 0),{pushMsg:c,shutdown:function(r){u.contents={enqueue:function(r){console.log("INVALID message enqueued when shut down")}};var n=s(t,a.contents);s(i.shutdown,n)},getHtmlString:function(r){return s(i.render_string,a.contents)}}}(u,Xa(r.update,r.view,r.subscriptions,u,a[1],i),r.shutdown)}function Ba(r){return{href:r.href,protocol:r.protocol,host:r.host,hostname:r.hostname,port:r.port,pathname:r.pathname,search:r.search,hash:r.hash,username:r.username,password:r.password,origin:r.origin}}var Ka={contents:void 0};function Ja(r){return function(r,n){return b(1,[r,function(r){return s(n,r.contents)},{contents:void 0}])}("navigation",(function(n){Ka.contents=function(e){return s(n.enqueue,s(r,e))};var e,t,a,u=function(r){var n;void 0!==(n=Ka.contents)&&s(n,Ba(document.location))};return e="popstate",t=u,a=!1,window.addEventListener(e,t,a),function(r){return function(r,n,e){return window.removeEventListener(r,n,e)}("popstate",u,!1)}}))}function Ha(r,n,e){var t,a,u,i,o=void 0===r||r;return t=void 0,a=void 0,u=[bt(e),[kt.disabled(!o),0]],i=[ot(n),0],tn("","button",void 0!==t?t:"",void 0!==a?a:"",u,i)}function Ga(r){return ct(void 0,void 0,[mt("button-bar"),0],r)}var Wa="\n\n        ."+String("button-bar")+" {\n            padding-top: 5px; \n            padding-bottom: 5px;\n        }\n\n        button {\n            background-color: white;\n            color: #555;\n            box-shadow: 0 0 0 1px "+String("#48a9dc")+";\n            border: none;\n            border-radius: 4px;\n            padding: 6px;\n            margin-right: 8px;\n            font-size: 14px;\n        }\n\n        button:active {\n            background-color: "+String("#48a9dc")+";\n            color: white;\n        }\n\n        button:disabled {\n            background-color: #ddd;\n            color: #90adbd;\n        }\n\n        a, a:active, a:visited {\n            display: inline-block;\n            color: "+String("#48a9dc")+"\n        }\n\n        a, a:active, a:visited {\n            display: inline-block;\n            color: "+String("#48a9dc")+"\n        }\n    ";function Ya(r,n){return ct(void 0,void 0,[mt("panel-container"),0],[ct(void 0,void 0,[mt("header"),0],[ot(r),0]),[ct(void 0,void 0,[mt("panel-body"),0],n),0]])}var Za="\n        div."+String("header")+" {\n            background-color: blue;\n            color: white;\n            font-weight: bold;\n            padding: 4px;\n        }        \n\n        div."+String("panel-container")+" {\n            float: left;\n            margin: 5px;\n            width: 48%;\n            border: solid 1px #aaa;\n        }\n\n        div."+String("panel-body")+" {\n            padding: 6px;\n        }\n    ",ru="\n        ."+String("variable")+" {\n            color: #ff0; \n        }\n\n        ."+String("fact")+" {\n            color: #0f0;\n        }\n        \n        ."+String("relation")+" {\n            color: #4af;\n        }\n\n        ."+String("punctuation")+" {\n            color: white;\n            font-weight: bold;\n        }\n\n        ."+String("rule-display")+" {\n            background-color: black;\n            font-family: Consolas, monospace;\n            padding: 4px;\n        }\n\n        ."+String("rule-item")+" {\n            color: black;\n            background-color: white;\n\n            border-radius: 6px;\n            padding: 6px;\n            box-shadow: 0 0.5em 1em -0.125em rgba(10,10,10,.1), 0 0 0 1px rgba(10,10,10,.02);\n\n            margin-bottom: 12px;\n        }\n\n        ."+String("rule-item")+"."+String("rule-used")+" {\n            border: solid 2px #44f;\n            background-color: yellow;            \n        }\n\n        ul {\n            list-style: none;\n            margin-block-start: 0;\n            margin-block-end: 0;\n        }\n    ";function nu(r){return ft(void 0,void 0,[mt("punctuation"),0],[ot(r),0])}function eu(r){if(!r.tag)return ft(void 0,void 0,[mt("variable"),0],[ot(r[0][0]),0]);var n=r[0],e=n.related_terms,t=n.relation_name[0];return e?ft(void 0,void 0,0,[ft(void 0,void 0,[mt("relation"),0],[ot(t),0]),[nu("("),[eu(e[0]),[ft(void 0,void 0,0,Fr((function(r){return ft(void 0,void 0,0,[nu(", "),[eu(r),0]])}),e[1])),[nu(")"),0]]]]]):ft(void 0,void 0,[mt("fact"),0],[ot(t),0])}function tu(r){switch(0|r.tag){case 0:return eu(r[0]);case 1:return ft(void 0,void 0,0,[eu(r[0]),[nu("="),[eu(r[1]),0]]]);case 2:return ft(void 0,void 0,0,[eu(r[0]),[nu("/="),[eu(r[1]),0]]])}}function au(r){var n=r.antecedents,e=function(r,n){return lt(void 0,void 0,0,[nu(r),[tu(n),0]])};return ct(void 0,void 0,[mt("rule-display"),0],[eu(r.consequent),[n?vt(void 0,void 0,0,[e("when ",n[0]),Fr((function(r){return e("and ",r)}),n[1])]):xt,0]])}function uu(r){return ct(void 0,void 0,[ht([["rule-item",!0],0]),0],[Ga([Ha(void 0,"Edit",Qa.initiateEditRule(r)),[Ha(void 0,"Delete",Qa.deleteRule(r)),0]]),[au(s(da.RuleDatabase.rule_from_entry,r)),0]])}function iu(r,n,e,t){var a,u,i=r.compilation_result;if(i.tag)a=0;else{var o=i[0];a=s(At.keydown,(function(r){return 13===r.keyCode&&r.ctrlKey?it.succeed(s(e,o)):it.fail("Expecting Ctrl-Enter")}))}u=r.compilation_result.tag?xt:ct(void 0,void 0,0,[ot(s(ne([b(11,["(ctrl+enter to ",b(2,[0,b(12,[41,0])])]),"(ctrl+enter to %s)"]),n)),0]);var c,f,v,l,d,m,h,g=r.compilation_result;return c=g.tag?(f=g[0])?ct(void 0,void 0,[mt("errors-container"),0],[vt(void 0,void 0,0,Fr((function(r){return lt(void 0,void 0,0,[ot(r),0])}),f)),0]):xt:Ha(void 0,n,s(e,g[0])),ct(void 0,void 0,0,[(v=void 0,l=void 0,d=[pt(void 0,Qa.updateText),[mt("language-editing"),[(h=t,b(0,["placeholder",h])),[gt(r.text),[a,0]]]]],m=0,tn("","textarea",void 0!==v?v:"",void 0!==l?l:"",d,m)),[u,[c,0]]])}function ou(r){var n,e=s(da.RuleDatabase.all_rules,r.rule_database),t=function(r){return ct(void 0,void 0,0,Fr((function(n){return function(r,n){return ct(void 0,void 0,[ht([["rule-item",!0],[["rule-used",Rr((function(r){return v(da.RuleDatabase.is_same,r,n)}),r)],0]]),0],[au(s(da.RuleDatabase.rule_from_entry,n)),0])}(r,n)}),e))},a=r.interaction_mode;if("number"==typeof a)n=ct(void 0,void 0,0,[Ga([Ha(void 0,"Add Rule",1),[Ha(void 0,"Query",2),0]]),[dt(void 0,void 0,0,0),[ct(void 0,void 0,0,Fr(uu,e)),0]]]);else switch(0|a.tag){case 0:n=ct(void 0,void 0,0,[iu(a[0],"Add Rule",Qa.addRule,"New rule..."),[Ga([Ha(void 0,"Cancel Add",0),0]),[dt(void 0,void 0,0,0),[t(0),0]]]]);break;case 1:var u=a[0];n=ct(void 0,void 0,0,[iu(a[1],"Update Rule",(function(r){return Qa.editRuleEntry(v(da.RuleDatabase.update_rule_entry,u,r))}),"Edit rule..."),[Ga([Ha(void 0,"Cancel Edit",0),0]),[dt(void 0,void 0,0,0),[t(0),0]]]]);break;case 2:n=t(0);break;case 3:var i=a[0].solution_stream;n=t(i?i[0].rules_applied:0)}return Ya("Rules",[n,0])}function cu(r){var n,e,t,a,u=function(r){return Ya("Query",[r,0])},i=r.interaction_mode;if("number"==typeof i)return xt;switch(0|i.tag){case 2:return u(function(r){return ct(void 0,void 0,0,[iu(r,"Execute Query",Qa.executeQuery,"New query..."),[Ha(void 0,"Cancel",0),0]])}(i[0]));case 3:return u((n=i[0],e=n.solution_stream,t=n.initiating_query,a=function(r){var n=v(da.Frame.to_strings,t,r.frame);return n?ct(void 0,void 0,0,[st(void 0,void 0,0,[ot("Satisfied:"),0]),[vt(void 0,void 0,0,Fr((function(r){return lt(void 0,void 0,0,[ot(r),0])}),n)),0]]):st(void 0,void 0,0,[ot("Satisfied"),0])},ct(void 0,void 0,0,[ct(void 0,void 0,0,Fr(a,n.displayed_solutions)),[e?ct(void 0,void 0,0,[a(e[0]),[Ha(void 0,"Next Frame",3),[Ha(void 0,"New Query",2),[Ha(void 0,"Cancel",0),0]]]]):Ha(void 0,"Another Query",2),0]])));default:return xt}}var fu=Kr(" ",["\n        body {\n            background-color: #eee;\n            display: flex;\n            flex-direction: column;\n            font-family: sans-serif;\n        }\n\n        p {\n            font-size: 14px;\n        }\n    ",[Wa,[Za,[ru,["\n        input {\n            margin-left: 6px;\n        }          \n        \n        ."+String("language-editing")+" {\n            width: 96%;\n            font-family: Consolas, monospace;\n            background-color: black;\n            color: white;\n        }\n\n        ."+String("errors-container")+" ul {\n            padding-left: 20px;\n            list-style: square;\n        }\n\n        ."+String("errors-container")+" li {\n            color: #800;\n            font-size: 14px;\n        }\n    ",["",["",0]]]]]]]);var su=function(r,n){var e={init:function(r){return v(n.init,r,Ba(document.location))},update:n.update,view:n.view,subscriptions:function(e){return b(0,[[Ja(r),[s(n.subscriptions,e),0]]])},shutdown:n.shutdown};return function(r,n){return za(e,r,n)}}((function(r){return Qa.viewRules}),{init:function(r,n){return[Ua.init(void 0),0]},update:function(r,n){var e,t=r.interaction_mode,a=r.rule_database;if("number"==typeof n)switch(n){case 0:e={rule_database:a,interaction_mode:0};break;case 1:e={rule_database:a,interaction_mode:b(0,[{text:"",compilation_result:b(1,[0])}])};break;case 2:e={rule_database:a,interaction_mode:b(2,[{text:"",compilation_result:b(1,[0])}])};break;case 3:e="number"==typeof t||3!==t.tag?{rule_database:a,interaction_mode:t}:{rule_database:a,interaction_mode:b(3,[Va(t[0])])}}else switch(0|n.tag){case 0:var u=n[0],i=s(da.RuleDatabase.rule_from_entry,u);e={rule_database:a,interaction_mode:b(1,[u,Pa(da.Rule.to_string,i)])};break;case 1:var o=n[0],c=Ea.rule_database_snapshot(a);if("number"==typeof t)e={rule_database:a,interaction_mode:t};else switch(0|t.tag){case 0:e={rule_database:a,interaction_mode:b(0,[Ia(o,Sa,(function(r){return Ea.issues_in_new_rule(c,r)}))])};break;case 1:var f=t[0];e={rule_database:a,interaction_mode:b(1,[f,Ia(o,Sa,(function(r){return Ea.issues_in_existing_rule(c,v(da.RuleDatabase.update_rule_entry,f,r))}))])};break;case 2:e={rule_database:a,interaction_mode:b(2,[Ia(o,Aa,(function(r){return Ea.issues_in_query(c,r)}))])};break;case 3:e={rule_database:a,interaction_mode:t}}break;case 2:e={rule_database:v(da.RuleDatabase.add_rule,a,n[0]),interaction_mode:b(0,[{text:"",compilation_result:b(1,[0])}])};break;case 3:e={rule_database:v(da.RuleDatabase.update_rule,a,n[0]),interaction_mode:0};break;case 4:e={rule_database:v(da.RuleDatabase.remove_rule,a,n[0]),interaction_mode:t};break;case 5:var l=n[0];e={rule_database:a,interaction_mode:b(3,[{initiating_query:l,solution_stream:Ta.query(a,l),displayed_solutions:0}])}}return[e,0]},view:function(r){return ct(void 0,void 0,0,[ou(r),[cu(r),0]])},subscriptions:function(r){return 0},shutdown:function(r){return 0}});return r.main=function(r,n){var e=document.createElement("style");return document.head.appendChild(e),e.innerHTML=fu,v(su,r,void 0)},r}({});
