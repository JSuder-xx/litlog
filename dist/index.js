var starter=function(r){"use strict";var n=["Failure",-2],e=["Invalid_argument",-3],t=["Division_by_zero",-5],a=["Not_found",-6],u=["Match_failure",-7],i=["Assert_failure",-10];function o(r,n,e){for(var t=new Array(e),a=0,u=n;a<e;)t[a]=r[u],a=a+1|0,u=u+1|0;return t}function c(r,n){if(n<0||n>=r.length)throw[e,"index out of bounds"];return r[n]}function f(r,n){for(;;){var e=n,t=r,a=t.length,u=0===a?1:a,i=u-e.length|0;if(0===i)return t.apply(null,e);if(i>=0)return function(r,n){return function(e){return f(r,n.concat([e]))}}(t,e);n=o(e,u,0|-i),r=t.apply(null,o(e,0,u))}}function s(r,n){var e=r.length;if(1===e)return r(n);switch(e){case 1:return r(n);case 2:return function(e){return r(n,e)};case 3:return function(e,t){return r(n,e,t)};case 4:return function(e,t,a){return r(n,e,t,a)};case 5:return function(e,t,a,u){return r(n,e,t,a,u)};case 6:return function(e,t,a,u,i){return r(n,e,t,a,u,i)};case 7:return function(e,t,a,u,i,o){return r(n,e,t,a,u,i,o)};default:return f(r,[n])}}function v(r,n,e){var t=r.length;if(2===t)return r(n,e);switch(t){case 1:return f(r(n),[e]);case 2:return r(n,e);case 3:return function(t){return r(n,e,t)};case 4:return function(t,a){return r(n,e,t,a)};case 5:return function(t,a,u){return r(n,e,t,a,u)};case 6:return function(t,a,u,i){return r(n,e,t,a,u,i)};case 7:return function(t,a,u,i,o){return r(n,e,t,a,u,i,o)};default:return f(r,[n,e])}}function l(r,n,e,t){var a=r.length;if(3===a)return r(n,e,t);switch(a){case 1:return f(r(n),[e,t]);case 2:return f(r(n,e),[t]);case 3:return r(n,e,t);case 4:return function(a){return r(n,e,t,a)};case 5:return function(a,u){return r(n,e,t,a,u)};case 6:return function(a,u,i){return r(n,e,t,a,u,i)};case 7:return function(a,u,i,o){return r(n,e,t,a,u,i,o)};default:return f(r,[n,e,t])}}function d(r,n,e,t,a){var u=r.length;if(4===u)return r(n,e,t,a);switch(u){case 1:return f(r(n),[e,t,a]);case 2:return f(r(n,e),[t,a]);case 3:return f(r(n,e,t),[a]);case 4:return r(n,e,t,a);case 5:return function(u){return r(n,e,t,a,u)};case 6:return function(u,i){return r(n,e,t,a,u,i)};case 7:return function(u,i,o){return r(n,e,t,a,u,i,o)};default:return f(r,[n,e,t,a])}}function h(r,n,e,t,a,u){var i=r.length;if(5===i)return r(n,e,t,a,u);switch(i){case 1:return f(r(n),[e,t,a,u]);case 2:return f(r(n,e),[t,a,u]);case 3:return f(r(n,e,t),[a,u]);case 4:return f(r(n,e,t,a),[u]);case 5:return r(n,e,t,a,u);case 6:return function(i){return r(n,e,t,a,u,i)};case 7:return function(i,o){return r(n,e,t,a,u,i,o)};default:return f(r,[n,e,t,a,u])}}function g(r,n,e,t,a,u,i){var o=r.length;if(6===o)return r(n,e,t,a,u,i);switch(o){case 1:return f(r(n),[e,t,a,u,i]);case 2:return f(r(n,e),[t,a,u,i]);case 3:return f(r(n,e,t),[a,u,i]);case 4:return f(r(n,e,t,a),[u,i]);case 5:return f(r(n,e,t,a,u),[i]);case 6:return r(n,e,t,a,u,i);case 7:return function(o){return r(n,e,t,a,u,i,o)};default:return f(r,[n,e,t,a,u,i])}}function m(r,n,e,t,a,u,i,o){var c=r.length;if(7===c)return r(n,e,t,a,u,i,o);switch(c){case 1:return f(r(n),[e,t,a,u,i,o]);case 2:return f(r(n,e),[t,a,u,i,o]);case 3:return f(r(n,e,t),[a,u,i,o]);case 4:return f(r(n,e,t,a),[u,i,o]);case 5:return f(r(n,e,t,a,u),[i,o]);case 6:return f(r(n,e,t,a,u,i),[o]);case 7:return r(n,e,t,a,u,i,o);default:return f(r,[n,e,t,a,u,i,o])}}function b(r,n,e,t,a,u,i,o,c){var s=r.length;if(8===s)return r(n,e,t,a,u,i,o,c);switch(s){case 1:return f(r(n),[e,t,a,u,i,o,c]);case 2:return f(r(n,e),[t,a,u,i,o,c]);case 3:return f(r(n,e,t),[a,u,i,o,c]);case 4:return f(r(n,e,t,a),[u,i,o,c]);case 5:return f(r(n,e,t,a,u),[i,o,c]);case 6:return f(r(n,e,t,a,u,i),[o,c]);case 7:return f(r(n,e,t,a,u,i,o),[c]);default:return f(r,[n,e,t,a,u,i,o,c])}}function p(r,n){return n.tag=r,n}function w(r,n){return r<n?-1:r===n?0:1}function y(r,n){return r===n?0:r<n?-1:1}n.tag=248,e.tag=248,t.tag=248,a.tag=248,u.tag=248,i.tag=248;var _=function(r,n){for(var e in r)n(e)};function k(r){var n=[r];return n.tag=246,n}function x(r,n){for(;;){var t=n,a=r;if(a===t)return!0;var u=typeof a;if("string"===u||"number"===u||"boolean"===u||"undefined"===u||null===a)return!1;var i=typeof t;if("function"===u||"function"===i)throw[e,"equal: functional value"];if("number"===i||"undefined"===i||null===t)return!1;var o=0|a.tag,c=0|t.tag;if(250!==o)if(250!==c){if(248===o)return a[1]===t[1];if(251===o)throw[e,"equal: abstract value"];if(o!==c)return!1;if(256===o)return a[1]===t[1];var f=0|a.length;if(f!==(0|t.length))return!1;if(!Array.isArray(a)){if(a instanceof Date&&t instanceof Date)return!(a>t||a<t);var s={contents:!0},v=function(r,n){return function(e){r.hasOwnProperty(e)||(n.contents=!1)}}(t,s),l=function(r,n,e){return function(t){r.hasOwnProperty(t)&&x(n[t],r[t])||(e.contents=!1)}}(a,t,s);return _(a,v),s.contents&&_(t,l),s.contents}for(var d=0;;){var h=d;if(h===f)return!0;if(!x(a[h],t[h]))return!1;d=h+1|0}}else n=t[0];else r=a[0]}}function N(r,n){return!x(r,n)}function C(r){if(r<0)throw[e,"String.create"];for(var n=new Array(r),t=0;t<r;++t)n[t]=0;return n}function F(r,n,e,t,a){if(!(a<=0))if(r!==e){var u=r.length-n|0;if(a<=u)for(var i=0;i<a;++i)e[t+i|0]=r[n+i|0];else{for(var o=0;o<u;++o)e[t+o|0]=r[n+o|0];for(var c=u;c<a;++c)e[t+c|0]=0}}else{if(n<t){for(var f=(r.length-t|0)-1|0,s=a-1|0,v=f>s?s:f;v>=0;--v)r[t+v|0]=r[n+v|0];return}if(n<=t)return;for(var l=(r.length-n|0)-1|0,d=a-1|0,h=l>d?d:l,g=0;g<=h;++g)r[t+g|0]=r[n+g|0]}}function q(r){var n=r.length,e="",t=n;if(n<=4096&&n===r.length)return String.fromCharCode.apply(null,r);for(var a=0;t>0;){var u=t<1024?t:1024,i=new Array(u);F(r,a,i,0,u),e+=String.fromCharCode.apply(null,i),t=t-u|0,a=a+u|0}return e}function S(r,n,e,t,a){if(!(a<=0)){var u=r.length-n|0;if(a<=u)for(var i=0;i<a;++i)e[t+i|0]=r.charCodeAt(n+i|0);else{for(var o=0;o<u;++o)e[t+o|0]=r.charCodeAt(n+o|0);for(var c=u;c<a;++c)e[t+c|0]=0}}}function A(r){for(var n=r.length,e=new Array(n),t=0;t<n;++t)e[t]=r.charCodeAt(t);return e}var M=Math.imul||function(r,n){return((r>>16)*(n|=0)<<16)+(65535&r)*n|0};function L(r,n){return[n,r>>>0]}var D=[-2147483648,0],$=[2147483647,4294967295],O=[0,1],R=[0,0],E=[-1,4294967295];function T(r){return 0!=(2147483648&r)}function P(r){return 0==(2147483648&r)}function I(r){var n=1+(-1^r[1])|0;return L(n,(-1^r[0])+(0===n?1:0)|0)}function V(r,n,e){var t=r[1],a=t+n|0,u=T(t)&&(T(n)||P(a))||T(n)&&P(a)?1:0;return L(a,r[0]+e+u|0)}function U(r,n){return V(r,n[1],n[0])}function Q(r,n){return r[0]===n[0]&&r[1]===n[1]}function j(r,n,e){var t=1+(-1^n)>>>0;return V(r,t,(-1^e)+(0===t?1:0)|0)}function X(r,n){return j(r,n[1],n[0])}function z(r,n){if(0===n)return r;var e=r[1];return n>=32?L(0,e<<(n-32|0)):L(e<<n,e>>>(32-n|0)|r[0]<<n)}function B(r,n){if(0===n)return r;var e=r[0];return n<32?L(e<<(32-n|0)|r[1]>>>n,e>>n):L(e>>(n-32|0),e>=0?0:-1)}function K(r,n){for(;;){var e,t=n,a=r,u=0,i=0;if(0!==a[0])i=3;else{if(0===a[1])return R;i=3}if(3===i)if(0!==t[0])u=2;else{if(0===t[1])return R;u=2}if(2===u){var o=a[0],c=0;if(-2147483648!==o||0!==a[1]?c=3:e=t[1],3===c){var f=t[0],s=a[1],v=0;if(-2147483648!==f||0!==t[1]?v=4:e=s,4===v){var l=t[1];if(o<0){if(f>=0)return I(K(I(a),t));n=I(t),r=I(a);continue}if(f<0)return I(K(a,I(t)));var d=65535&o,h=s>>>16,g=65535&s,m=65535&f,b=l>>>16,p=65535&l,w=0,y=0,_=0,k=g*p;return w=(y=(y=(_=(k>>>16)+h*p)>>>16)+((_=(65535&_)+g*b)>>>16)+d*p)>>>16,w+=(y=(65535&y)+h*b)>>>16,w+=(y=(65535&y)+g*m)>>>16,L(65535&k|(65535&_)<<16,(y&=65535)|(w=w+((o>>>16)*p+d*b+h*m+g*(f>>>16))&65535)<<16)}}}return 0==(1&e)?R:D}}function J(r,n){var e=n[0],t=r[0];return t>e||!(t<e)&&r[1]>=n[1]}function G(r,n){return!Q(r,n)}function H(r,n){return!J(r,n)}function W(r,n){return r[0]>n[0]||!(r[0]<n[0])&&r[1]>n[1]}function Y(r){return 4294967296*r[0]+r[1]}function Z(r){return isNaN(r)||!isFinite(r)?R:r<=-0x8000000000000000?D:r+1>=0x8000000000000000?$:r<0?I(Z(-r)):L(r%4294967296|0,r/4294967296|0)}function rr(r){if(function(r){var n=r[0],e=n>>21;return 0===e||-1===e&&!(0===r[1]&&-2097152===n)}(r))return String(Y(r));if(r[0]<0)return Q(r,D)?"-9223372036854775808":"-"+rr(I(r));var n=Z(Math.floor(Y(r)/10)),e=n[1],t=n[0],a=j(j(r,e<<3,e>>>29|t<<3),e<<1,e>>>31|t<<1),u=a[1],i=a[0];if(0===u&&0===i)return rr(n)+"0";if(i<0){var o=1+(-1^u)>>>0,c=Math.ceil(o/10),f=10*c-o;return rr(j(n,0|c,0))+String(0|f)}var s=u,v=Math.floor(s/10),l=s-10*v;return rr(V(n,0|v,0))+String(0|l)}function nr(r,n){var e=function r(n,e){for(;;){var a=e,u=n,i=0;if(0===a[0]&&0===a[1])throw t;if(3===3){var o=u[0];if(-2147483648!==o)if(0!==o)i=2;else{if(0===u[1])return R;i=2}else if(0!==u[1])i=2;else{if(Q(a,O)||Q(a,E))return u;if(Q(a,D))return O;var c=z(r(B(u,1),a),1),f=0;if(0!==c[0])f=4;else{if(0===c[1])return a[0]<0?O:I(O);f=4}if(4===f)return U(c,r(X(u,K(a,c)),a))}}if(2===i&&-2147483648===a[0]&&0===a[1])return R;var s=a[0];if(!(u[0]<0)){if(s<0)return I(r(u,I(a)));for(var v=R,l=u;J(l,a);){for(var d=(w=1,y=Math.floor(Y(l)/Y(a)),w>y?w:y),h=Math.ceil(Math.log(d)/Math.LN2),g=h<=48?1:Math.pow(2,h-48),m=Z(d),b=K(m,a);b[0]<0||W(b,l);)b=K(m=Z(d-=g),a);0===(p=m)[0]&&0===p[1]&&(m=O),v=U(v,m),l=X(l,b)}return v}if(s>=0)return I(r(I(u),a));e=I(a),n=I(u)}var p,w,y}(r,n);return[e,X(r,K(e,n))]}function er(r){return 0|r[1]}function tr(r){return[2147483647&r[0],r[1]]}function ar(r){return r>=65&&r<=90||r>=192&&r<=214||r>=216&&r<=222?r+32|0:r}function ur(r){var n=r.length;if(n>31)throw[e,"format_int: format too long"];for(var t={justify:"+",signstyle:"-",filter:" ",alternate:!1,base:2,signedconv:!1,width:0,uppercase:!1,sign:1,prec:-1,conv:"f"},a=0;;){var u=a;if(u>=n)return t;var i=r.charCodeAt(u),o=0;if(i>=69)if(i>=88)if(i>=121)o=1;else switch(i-88|0){case 0:t.base=1,t.uppercase=!0,a=u+1|0;continue;case 13:case 14:case 15:o=5;break;case 12:case 17:o=4;break;case 23:t.base=0,a=u+1|0;continue;case 29:t.base=2,a=u+1|0;continue;case 1:case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 16:case 18:case 19:case 20:case 21:case 22:case 24:case 25:case 26:case 27:case 28:case 30:case 31:o=1;break;case 32:t.base=1,a=u+1|0;continue}else{if(!(i>=72)){t.signedconv=!0,t.uppercase=!0,t.conv=String.fromCharCode(ar(i)),a=u+1|0;continue}o=1}else switch(i){case 35:t.alternate=!0,a=u+1|0;continue;case 32:case 43:o=2;break;case 45:t.justify="-",a=u+1|0;continue;case 46:t.prec=0;for(var c=u+1|0;function(n){return function(){var e=r.charCodeAt(n)-48|0;return e>=0&&e<=9}}(c)();)t.prec=(M(t.prec,10)+r.charCodeAt(c)|0)-48|0,c=c+1|0;a=c;continue;case 33:case 34:case 36:case 37:case 38:case 39:case 40:case 41:case 42:case 44:case 47:o=1;break;case 48:t.filter="0",a=u+1|0;continue;case 49:case 50:case 51:case 52:case 53:case 54:case 55:case 56:case 57:o=3;break;default:o=1}switch(o){case 1:a=u+1|0;continue;case 2:t.signstyle=String.fromCharCode(i),a=u+1|0;continue;case 3:t.width=0;for(var f=u;function(n){return function(){var e=r.charCodeAt(n)-48|0;return e>=0&&e<=9}}(f)();)t.width=(M(t.width,10)+r.charCodeAt(f)|0)-48|0,f=f+1|0;a=f;continue;case 4:t.signedconv=!0,t.base=2,a=u+1|0;continue;case 5:t.signedconv=!0,t.conv=String.fromCharCode(i),a=u+1|0;continue}}}function ir(r,n){var e=r.justify,t=r.signstyle,a=r.filter,u=r.alternate,i=r.base,o=r.signedconv,c=r.width,f=r.uppercase,s=r.sign,v=n.length;o&&(s<0||"-"!==t)&&(v=v+1|0),u&&(0===i?v=v+1|0:1===i&&(v=v+2|0));var l="";if("+"===e&&" "===a)for(var d=v;d<c;++d)l+=a;if(o&&(s<0?l+="-":"-"!==t&&(l+=t)),u&&0===i&&(l+="0"),u&&1===i&&(l+="0x"),"+"===e&&"0"===a)for(var h=v;h<c;++h)l+=a;if(l=f?l+n.toUpperCase():l+n,"-"===e)for(var g=v;g<c;++g)l+=" ";return l}function or(r,n){if("%d"===r)return String(n);var e=ur(r),t=(n<0?e.signedconv?(e.sign=-1,-n):n>>>0:n).toString(function(r){switch(r){case 0:return 8;case 1:return 16;case 2:return 10}}(e.base));if(e.prec>=0){e.filter=" ";var a=e.prec-t.length|0;a>0&&(t="0".repeat(a)+t)}return ir(e,t)}function cr(r,n){if("%d"===r)return rr(n);var e,t,a=ur(r),u=a.signedconv&&H(n,R)?(a.sign=-1,I(n)):n;switch(a.base){case 0:e=function(r){var n="",e=L(8,0),t="01234567";if(H(r,R)){var a=nr(tr(r),e),u=U(L(0,268435456),a[0]),i=a[1];for(n=t[er(i)]+n;G(u,R);){var o=nr(u,e);u=o[0],n=t[er(i=o[1])]+n}}else{var c=nr(r,e),f=c[0],s=c[1];for(n=t[er(s)]+n;G(f,R);){var v=nr(f,e);f=v[0],n=t[er(s=v[1])]+n}}return n}(u);break;case 1:e=function(r){var n=r[1],e=r[0],t=function(r){return(r>>>0).toString(16)};if(0===e&&0===n)return"0";if(0===n)return t(e)+"00000000";if(0===e)return t(n);var a=t(n),u=8-a.length|0;return u<=0?t(e)+a:t(e)+("0".repeat(u)+a)}(u);break;case 2:e=function(r){if(!H(r,R))return rr(r);var n=L(10,0),e=nr(tr(r),n),t=nr(U(L(8,0),e[1]),n);return rr(U(U(L(-858993460,214748364),e[0]),t[0]))+"0123456789"[er(t[1])]}(u)}if(a.prec>=0){a.filter=" ";var i=a.prec-e.length|0;t=i>0?"0".repeat(i)+e:e}else t=e;return ir(a,t)}var fr=or,sr=or;function vr(r,n){if(n>=r.length||n<0)throw[e,"index out of bounds"];return r.charCodeAt(n)}var lr={contents:0};function dr(r){var n=[r,(lr.contents=lr.contents+1,lr.contents)];return n.tag=248,n}var hr=[];function gr(r){if(void 0===r){var n=[hr,0];return n.tag=256,n}if(null===r||r[0]!==hr)return r;var e=r[1]+1|0,t=[hr,e];return t.tag=256,t}function mr(r){if(null===r||r[0]!==hr)return r;var n=r[1];return 0===n?void 0:[hr,n-1|0]}var br=dr("Caml_js_exceptions.Error");function pr(r){return function(r){if(void 0===r)return!1;if(248===r.tag)return!0;var n=r[0];return void 0!==n&&248===n.tag}(r)?r:[br,r]}function wr(r){if("number"==typeof r)return 0;switch(0|r.tag){case 0:return p(0,[wr(r[0])]);case 1:return p(1,[wr(r[0])]);case 2:return p(2,[wr(r[0])]);case 3:return p(3,[wr(r[0])]);case 4:return p(4,[wr(r[0])]);case 5:return p(5,[wr(r[0])]);case 6:return p(6,[wr(r[0])]);case 7:return p(7,[wr(r[0])]);case 8:return p(8,[r[0],wr(r[1])]);case 9:var n=r[0];return p(9,[n,n,wr(r[2])]);case 10:return p(10,[wr(r[0])]);case 11:return p(11,[wr(r[0])]);case 12:return p(12,[wr(r[0])]);case 13:return p(13,[wr(r[0])]);case 14:return p(14,[wr(r[0])])}}function yr(r,n){if("number"==typeof r)return n;switch(0|r.tag){case 0:return p(0,[yr(r[0],n)]);case 1:return p(1,[yr(r[0],n)]);case 2:return p(2,[r[0],yr(r[1],n)]);case 3:return p(3,[r[0],yr(r[1],n)]);case 4:return p(4,[r[0],r[1],r[2],yr(r[3],n)]);case 5:return p(5,[r[0],r[1],r[2],yr(r[3],n)]);case 6:return p(6,[r[0],r[1],r[2],yr(r[3],n)]);case 7:return p(7,[r[0],r[1],r[2],yr(r[3],n)]);case 8:return p(8,[r[0],r[1],r[2],yr(r[3],n)]);case 9:return p(9,[r[0],yr(r[1],n)]);case 10:return p(10,[yr(r[0],n)]);case 11:return p(11,[r[0],yr(r[1],n)]);case 12:return p(12,[r[0],yr(r[1],n)]);case 13:return p(13,[r[0],r[1],yr(r[2],n)]);case 14:return p(14,[r[0],r[1],yr(r[2],n)]);case 15:return p(15,[yr(r[0],n)]);case 16:return p(16,[yr(r[0],n)]);case 17:return p(17,[r[0],yr(r[1],n)]);case 18:return p(18,[r[0],yr(r[1],n)]);case 19:return p(19,[yr(r[0],n)]);case 20:return p(20,[r[0],r[1],yr(r[2],n)]);case 21:return p(21,[r[0],yr(r[1],n)]);case 22:return p(22,[yr(r[0],n)]);case 23:return p(23,[r[0],yr(r[1],n)]);case 24:return p(24,[r[0],r[1],yr(r[2],n)])}}dr("Pervasives.Exit");function _r(r){return r>=0?r:0|-r}function kr(r){return r?"true":"false"}function xr(r){for(var n=0,e=r;;){var t=n;if(!e)return t;e=e[1],n=t+1|0}}function Nr(r,n){for(;;){var e=n,t=r;if(!t)return e;n=[t[0],e],r=t[1]}}function Cr(r){return Nr(r,0)}function Fr(r){return r?function r(n,e){return n?[n[0],r(n[1],e)]:e}(r[0],Fr(r[1])):0}function qr(r,n){return n?[s(r,n[0]),qr(r,n[1])]:0}function Sr(r,n){for(;;){var e=n;if(!e)return;s(r,e[0]),n=e[1]}}function Ar(r,n,e){for(;;){var t=e,a=n;if(!t)return a;e=t[1],n=v(r,a,t[0])}}function Mr(r,n){for(;;){var e=n;if(!e)return!1;if(s(r,e[0]))return!0;n=e[1]}}function Lr(r,n){for(;;){var e=r;if(0===e)return n;if(!n)throw[i,["list.ml",262,11]];n=n[1],r=e-1|0}}var Dr=Fr,$r=function(r){return function(n){for(var e=0,t=n;;){var a=t,u=e;if(!a)return Nr(u,0);var i=a[1],o=a[0];s(r,o)?(t=i,e=[o,u]):t=i}}},Or=function(r,n){var e=function(n,e){if(2!==n){if(3===n&&e){var a=e[1];if(a){var u=a[1];if(u){var i=u[0],o=a[0],c=e[0];return v(r,c,o)<=0?v(r,o,i)<=0?[c,[o,[i,0]]]:v(r,c,i)<=0?[c,[i,[o,0]]]:[i,[c,[o,0]]]:v(r,c,i)<=0?[o,[c,[i,0]]]:v(r,o,i)<=0?[o,[i,[c,0]]]:[i,[o,[c,0]]]}}}}else if(e){var f=e[1];if(f){var s=f[0],l=e[0];return v(r,l,s)<=0?[l,[s,0]]:[s,[l,0]]}}for(var d=n>>1,h=n-d|0,g=Lr(d,e),m=t(d,e),b=t(h,g),p=0;;){var w=p,y=b,_=m;if(!_)return Nr(y,w);if(!y)return Nr(_,w);var k=y[0],x=_[0];v(r,x,k)>0?(p=[x,w],m=_[1]):(p=[k,w],b=y[1])}},t=function(n,t){if(2!==n){if(3===n&&t){var a=t[1];if(a){var u=a[1];if(u){var i=u[0],o=a[0],c=t[0];return v(r,c,o)>0?v(r,o,i)>0?[c,[o,[i,0]]]:v(r,c,i)>0?[c,[i,[o,0]]]:[i,[c,[o,0]]]:v(r,c,i)>0?[o,[c,[i,0]]]:v(r,o,i)>0?[o,[i,[c,0]]]:[i,[o,[c,0]]]}}}}else if(t){var f=t[1];if(f){var s=f[0],l=t[0];return v(r,l,s)>0?[l,[s,0]]:[s,[l,0]]}}for(var d=n>>1,h=n-d|0,g=Lr(d,t),m=e(d,t),b=e(h,g),p=0;;){var w=p,y=b,_=m;if(!_)return Nr(y,w);if(!y)return Nr(_,w);var k=y[0],x=_[0];v(r,x,k)<=0?(p=[x,w],m=_[1]):(p=[k,w],b=y[1])}},a=xr(n);return a<2?n:e(a,n)};function Rr(r){return r>=97&&r<=122?r-32|0:r}function Er(r,n){var e=C(r);return function(r,n,e,t){if(!(e<=0))for(var a=n,u=e+n|0;a<u;++a)r[a]=t}(e,0,r,n),e}var Tr=[];function Pr(r,n,t){if(n<0||t<0||n>(r.length-t|0))throw[e,"String.sub / Bytes.sub"];var a=C(t);return F(r,n,a,0,t),a}function Ir(r,n,e){return q(Pr(r,n,e))}function Vr(r,n,t,a,u){if(u<0||n<0||n>(r.length-u|0)||a<0||a>(t.length-u|0))throw[e,"Bytes.blit"];return F(r,n,t,a,u)}function Ur(r,n,t,a,u){if(u<0||n<0||n>(r.length-u|0)||a<0||a>(t.length-u|0))throw[e,"String.blit / Bytes.blit_string"];return S(r,n,t,a,u)}function Qr(r){var n=r-9|0;return n>4||n<0?23===n:2!==n}function jr(r){for(var n=0,e=0,t=r.length;e<t;++e){var a,u=r[e];if(u>=32){var i=u-34|0;a=i>58||i<0?i>=93?4:1:i>57||i<1?2:1}else a=u>=11?13!==u?4:2:u>=8?2:4;n=n+a|0}if(n===r.length)return function(r){var n=r.length,e=C(n);return F(r,0,e,0,n),e}(r);var o=C(n);n=0;for(var c=0,f=r.length;c<f;++c){var s=r[c],v=0;if(s>=35)92!==s?s>=127?v=1:o[n]=s:v=2;else if(s>=32)s>=34?v=2:o[n]=s;else if(s>=14)v=1;else switch(s){case 8:o[n]=92,o[n=n+1|0]=98;break;case 9:o[n]=92,o[n=n+1|0]=116;break;case 10:o[n]=92,o[n=n+1|0]=110;break;case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:case 11:case 12:v=1;break;case 13:o[n]=92,o[n=n+1|0]=114}switch(v){case 1:o[n]=92,o[n=n+1|0]=48+(s/100|0)|0,o[n=n+1|0]=48+(s/10|0)%10|0,o[n=n+1|0]=48+s%10|0;break;case 2:o[n]=92,o[n=n+1|0]=s}n=n+1|0}return o}function Xr(r){return function(r,n){var e=n.length;if(0===e)return n;for(var t=C(e),a=0;a<e;++a)t[a]=s(r,n[a]);return t}(Rr,r)}function zr(r,n){return q(Er(r,n))}function Br(r,n){if(r>=n)return r;throw[e,"String.concat"]}function Kr(r,n){if(!n)return"";var e=r.length;return q(function(r,n,e,t,a){for(;;){var u=a,i=n;if(!u)return r;var o=u[1],c=u[0];if(!o)return S(c,0,r,i,c.length),r;S(c,0,r,i,c.length),S(e,0,r,i+c.length|0,t),a=o,n=(i+c.length|0)+t|0}}(C(function(r,n,e){for(;;){var t=e,a=r;if(!t)return a;var u=t[1],i=t[0];if(!u)return i.length+a|0;e=u,r=Br((i.length+n|0)+a|0,a)}}(0,e,n)),0,r,e,n))}function Jr(r){var n=r-9|0;return n>4||n<0?23===n:2!==n}function Gr(r){return""===r||!Jr(r.charCodeAt(0))&&!Jr(r.charCodeAt(r.length-1|0))?r:q(function(r){for(var n=r.length,e=0;e<n&&Qr(r[e]);)e=e+1|0;for(var t=n-1|0;t>=e&&Qr(r[t]);)t=t-1|0;return t>=e?Pr(r,e,1+(t-e|0)|0):Tr}(A(r)))}var Hr=y,Wr=Ur;function Yr(r,n,e,t){var a=void 0!==n&&n,u=r.style;return void 0!==u.setProperty?u.setProperty(e,t,a?"important":null):function(r,n,e){r.style[n]=e}(r,e,t)}function Zr(r,n,e){return r.insertBefore(n,e)}function rn(r,n,e,t){return""===n?r.setAttribute(e,t):r.setAttributeNS(n,e,t)}function nn(r,n){return""===r?document.createElement(n):document.createElementNS(r,n)}var en=p(0,[""]);function tn(r,n,e,t,a,u){return p(2,[r,n,e,t,a,u])}function an(r,n,e){return p(3,[r,p(0,[n,e]),{contents:void 0}])}function un(r){for(;;){var n=r;switch(0|n.tag){case 0:return"\x3c!-- "+n[0]+" --\x3e";case 1:return n[0];case 2:var e=n[1],t=n[0];return Kr("",["<",[t,[""===t?"":":",[e,[Kr("",qr((function(r){if("number"==typeof r)return"";switch(0|r.tag){case 0:return Kr("",[" ",[r[0],['="',[r[1],['"',0]]]]]);case 1:return Kr("",[" ",[r[1],['="',[r[2],['"',0]]]]]);case 2:return Kr("",[" data-",[r[0],['="',[r[1],['"',0]]]]]);case 3:return"";case 4:return Kr("",[' style="',[Kr(";",qr((function(r){return Kr("",[r[0],[":",[r[1],[";",0]]]])}),r[0])),['"',0]]])}}),n[4])),[">",[Kr("",qr(un,n[5])),["</",[e,[">",0]]]]]]]]]]);case 3:r=s(n[1],void 0);continue;case 4:r=n[1];continue}}}function on(r){if(!r.tag)return r[1];var n=r[0];return function(r){return gr(n)}}function cn(r,n,e,t){var a,u,i,o={contents:on(t)},c=function(r,n){return function(e){var t=s(n.contents,e);if(void 0!==t)return s(r.contents.enqueue,mr(t))}}(r,o);return a=e,u=c,i=!1,n.addEventListener(a,u,i),{handler:c,cb:o}}function fn(r,n,e){if(void 0!==e)return t=r,a=n,u=e.handler,i=!1,void t.removeEventListener(a,u,i);var t,a,u,i}function sn(r,n,e,t,a,u,i,o){var c=i.contents;if(void 0!==c)if(e!==t)i.contents=fn(n,e,i.contents),o.contents=cn(r,n,t,u);else{if(o.contents=i.contents,function(r,n){return n.tag?!(!r.tag||!x(n[0],r[0])):!r.tag&&n[0]===r[0]}(a,u))return;var f=on(u);c.cb.contents=f}else o.contents=cn(r,n,t,u)}function vn(r,e,t,a,u){!function(r,e,t,a){var u,i,o;if("number"!=typeof a)switch(0|a.tag){case 0:return void(e[a[0]]=void 0);case 1:return u=e,i=a[0],o=a[1],""===i?u.removeAttribute(o):u.removeAttributeNS(i,o);case 2:throw console.log(["TODO:  Remove Data Unhandled",a[0],a[1]]),[n,"TODO:  Remove Data Unhandled"];case 3:var c=a[2];return void(c.contents=fn(e,a[0],c.contents));case 4:Ar((function(r,n){return Yr(e,void 0,n[0],null)}),void 0,a[0])}}(0,e,0,a),function(r,e,t,a){if("number"!=typeof a)switch(0|a.tag){case 0:return void(e[a[0]]=a[1]);case 1:return rn(e,a[0],a[1],a[2]);case 2:throw console.log(["TODO:  Add Data Unhandled",a[0],a[1]]),[n,"TODO:  Add Data Unhandled"];case 3:return void(a[2].contents=cn(r,e,a[0],a[1]));case 4:Ar((function(r,n){return Yr(e,void 0,n[0],n[1])}),void 0,a[0])}}(r,e,0,u)}function ln(r,t,a,u,i){if("number"==typeof i)throw[n,"This should never be called as all entries through NoProp are gated."];switch(0|i.tag){case 0:return void(t[i[0]]=i[1]);case 1:return rn(t,i[0],i[1],i[2]);case 2:throw console.log(["TODO:  Mutate Data Unhandled",i[0],i[1]]),[n,"TODO:  Mutate Data Unhandled"];case 3:throw[n,"This will never be called because it is gated"];case 4:if("number"==typeof u)throw[n,"Passed a non-Style to a new Style as a Mutations while the old Style is not actually a style!"];if(4===u.tag)return function(r,n,t,a){for(;;){var u=a,i=t,o=n;if(i){if(u){a=u[1],t=i[1],n=l(r,o,i[0],u[0]);continue}throw[e,"List.fold_left2"]}if(u)throw[e,"List.fold_left2"];return o}}((function(r,n,e){var a=e[1],u=e[0],i=n[0];return i===u?n[1]===a?void 0:Yr(t,void 0,u,a):(Yr(t,void 0,i,null),Yr(t,void 0,u,a))}),void 0,u[0],i[0]);throw[n,"Passed a non-Style to a new Style as a Mutations while the old Style is not actually a style!"]}}function dn(r,n,e,t){return function(r,n,e,t,a){for(;;){var u=a,i=t,o=e;if(!i)return!u;var c=i[0];if(!u)return!1;if("number"==typeof c){if("number"==typeof u[0]){a=u[1],t=i[1],e=o+1|0;continue}}else switch(0|c.tag){case 0:var f=u[0];if("number"!=typeof f&&!f.tag){c[0]===f[0]&&c[1]===f[1]||ln(0,n,0,c,f),a=u[1],t=i[1],e=o+1|0;continue}break;case 1:var s=u[0];if("number"!=typeof s&&1===s.tag){c[0]===s[0]&&c[1]===s[1]&&c[2]===s[2]||ln(0,n,0,c,s),a=u[1],t=i[1],e=o+1|0;continue}break;case 2:var v=u[0];if("number"!=typeof v&&2===v.tag){c[0]===v[0]&&c[1]===v[1]||ln(0,n,0,c,v),a=u[1],t=i[1],e=o+1|0;continue}break;case 3:var l=u[0];if("number"!=typeof l&&3===l.tag){sn(r,n,c[0],l[0],c[1],l[1],c[2],l[2]),a=u[1],t=i[1],e=o+1|0;continue}break;case 4:var d=u[0];if("number"!=typeof d&&4===d.tag){x(c[0],d[0])||ln(0,n,0,c,d),a=u[1],t=i[1],e=o+1|0;continue}}vn(r,n,0,c,u[0]),a=u[1],t=i[1],e=o+1|0}}(r,n,0,e,t)}function hn(r,e,t,a,i){if(2===i.tag){var o=i[4],f=c(t,a),s=nn(i[0],i[1]);if(dn(r,s,qr((function(r){return 0}),o),o))return bn(r,s,s.childNodes,0,0,i[5]),Zr(e,s,f),void e.removeChild(f);throw[u,["vdom.ml",319,30]]}throw[n,"Node replacement should never be passed anything but a node itself"]}function gn(r,n){for(;;){var e=n,t=r;switch(0|e.tag){case 0:var a=e[0];return document.createComment(a);case 1:var i=e[0];return document.createTextNode(i);case 2:var o=e[4],c=nn(e[0],e[1]);if(dn(t,c,qr((function(r){return 0}),o),o))return bn(t,c,c.childNodes,0,0,e[5]),c;throw[u,["vdom.ml",333,30]];case 3:var f=s(e[1],void 0);e[2].contents=f,n=f;continue;case 4:n=e[1],r=s(e[0],t);continue}}}function mn(r,e,t,a,u,i){if(2===u.tag){if(2===i.tag){if(u[3]!==i[3]||u[1]!==i[1])return hn(r,e,t,a,i);var o=c(t,a),f=o.childNodes;return dn(r,o,u[4],i[4])||(console.log("VDom:  Failed swapping properties because the property list length changed, use `noProp` to swap properties instead, not by altering the list structure.  This is a massive inefficiency until this issue is resolved."),hn(r,e,t,a,i)),bn(r,o,f,0,u[5],i[5])}throw[n,"Non-node passed to patchVNodesOnElems_MutateNode"]}throw[n,"Non-node passed to patchVNodesOnElems_MutateNode"]}function bn(r,n,e,t,a,u){for(;;){var i=u,o=a,f=t;if(o){var v=o[0];switch(0|v.tag){case 0:if(i){var l=i[0];if(!l.tag&&v[0]===l[0]){u=i[1],a=o[1],t=f+1|0;continue}}break;case 1:if(i){var d=i[0];if(1===d.tag){var h=d[0];if(v[0]!==h)c(e,f).nodeValue=h;u=i[1],a=o[1],t=f+1|0;continue}}break;case 2:if(i){var g=i[0];if(2===g.tag){var m=i[1],b=g[2],p=g[1],w=g[0],y=o[1],_=v[2],k=v[1],x=v[0];if(_===b&&""!==_){u=m,a=y,t=f+1|0;continue}if(""===_||""===b){mn(r,n,e,f,v,g),u=m,a=y,t=f+1|0;continue}var N=0,C=0;if(y){var F=y[0];if(2===F.tag){var q=y[1],S=F[2],A=F[1],M=F[0],L=0;if(m){var D=m[0];if(2===D.tag){if(M===w&&A===p&&S===b&&x===D[0]&&k===D[1]&&_===D[2]){var $=c(e,f),O=c(e,f+1|0);n.removeChild(O),Zr(n,O,$),u=m[1],a=q,t=f+2|0;continue}L=4}else L=4}else L=4;if(4===L){if(M===w&&A===p&&S===b){var R=c(e,f);n.removeChild(R),u=m,a=q,t=f+1|0;continue}C=3}}else C=3}else C=3;if(3===C)if(m){var E=m[0];if(2===E.tag){if(x===E[0]&&k===E[1]&&_===E[2]){var T=c(e,f);Zr(n,gn(r,g),T),u=m,t=f+1|0;continue}N=2}else N=2}else N=2;if(2===N){mn(r,n,e,f,v,g),u=m,a=y,t=f+1|0;continue}}}break;case 3:if(i){var P=i[0];if(3===P.tag){var I=i[1],V=P[2],U=P[1],Q=P[0],j=o[1],X=v[2],z=v[0];if(z===Q){V.contents=X.contents,u=I,a=j,t=f+1|0;continue}var B=0,K=0;if(j){var J=j[0];if(3===J.tag){var G=j[1],H=J[0],W=0;if(I){var Y=I[0];if(3===Y.tag){if(H===Q&&z===Y[0]){var Z=c(e,f),rr=c(e,f+1|0);n.removeChild(rr),Zr(n,rr,Z),u=I[1],a=G,t=f+2|0;continue}W=4}else W=4}else W=4;if(4===W){if(H===Q){var nr=c(e,f);n.removeChild(nr);var er=J[2].contents;V.contents=er,u=I,a=G,t=f+1|0;continue}K=3}}else K=3}else K=3;if(3===K)if(I){var tr=I[0];if(3===tr.tag){if(tr[0]===z){var ar=c(e,f),ur=s(U,void 0);V.contents=ur,Zr(n,gn(r,ur),ar),u=I,t=f+1|0;continue}B=2}else B=2}else B=2;if(2===B){var ir=X.contents,or=s(U,void 0);V.contents=or,u=[or,I],a=[ir,j];continue}}}break;case 4:a=[v[1],o[1]];continue}var cr=o[1];if(i){var fr=i[0];if(4===fr.tag){bn(s(fr[0],r),n,e,f,[v,0],[fr[1],0]),u=i[1],a=cr,t=f+1|0;continue}var sr=c(e,f);Zr(n,gn(r,fr),sr),n.removeChild(sr),u=i[1],a=cr,t=f+1|0;continue}var vr=c(e,f);n.removeChild(vr),u=0,a=cr}else{if(!i)return;var lr=gn(r,i[0]);n.appendChild(lr),u=i[1],a=0,t=f+1|0}}}function pn(r,n){if("number"!=typeof n)switch(0|n.tag){case 1:return Ar((function(n,e){return pn(r,e)}),void 0,n[0]);case 0:case 2:return s(n[0],r)}}function wn(r,n,e,t){var a=function(r,n){for(;;){var e=n,t=r;if("number"==typeof e)return;switch(0|e.tag){case 0:var u=e[0];return u?Sr(function(r){return function(n){return a(r,n)}}(t),u):void 0;case 1:return void(e[2].contents=s(e[1],t));case 2:var i=s(e[0],t);n=e[1],r=i;continue}}},u=function(r,n){for(;;){var e=n,t=r;if("number"==typeof e)return;switch(0|e.tag){case 0:var a=e[0];return a?Sr(function(r){return function(n){return u(r,n)}}(t),a):void 0;case 1:var i=e[2],o=i.contents;return void 0!==o?(i.contents=void 0,s(o,void 0)):void 0;case 2:var c=s(e[0],t);n=e[1],r=c;continue}}};if("number"==typeof e){if("number"==typeof t)return t}else switch(0|e.tag){case 0:if("number"!=typeof t&&!t.tag){return function(e,t){for(;;){var i=t,o=e;if(o){var c=o[1],f=o[0];if(i){wn(r,n,f,i[0]),t=i[1],e=c;continue}u(r,f),t=0,e=c}else{if(!i)return;a(n,i[0]),t=i[1],e=0}}}(e[0],t[0]),t}break;case 1:if("number"!=typeof t&&1===t.tag&&e[0]===t[0])return t[2].contents=e[2].contents,t;break;case 2:if("number"!=typeof t&&2===t.tag)return wn(s(e[0],r),s(t[0],n),e[1],t[1]),t}return u(r,e),a(n,t),t}function yn(r,n){for(var e=r.length;(r.position+n|0)>e;)e<<=1;var t=C(e);Vr(r.buffer,0,t,0,r.position),r.buffer=t,r.length=e}function _n(r,n){var e=r.position;e>=r.length&&yn(r,1),r.buffer[e]=n,r.position=e+1|0}function kn(r,n){var e=n.length,t=r.position+e|0;t>r.length&&yn(r,e),Ur(n,0,r.buffer,r.position,e),r.position=t}function xn(r,n){var e=r.bytes.length,t=r.ind+n|0;if(!(t<=e)){var a,u,i=C((a=e<<1)>(u=t)?a:u);Vr(r.bytes,0,i,0,e),r.bytes=i}}function Nn(r,n){xn(r,1),r.bytes[r.ind]=n,r.ind=r.ind+1|0}function Cn(r,n){var e=n.length;xn(r,e),Wr(n,0,r.bytes,r.ind,e),r.ind=r.ind+e|0}function Fn(r){return Ir(r.bytes,0,r.ind)}function qn(r){if("number"==typeof r)switch(r){case 0:return"@]";case 1:return"@}";case 2:return"@?";case 3:return"@\n";case 4:return"@.";case 5:return"@@";case 6:return"@%"}else switch(0|r.tag){case 0:case 1:return r[0];case 2:return"@"+q(Er(1,r[0]))}}function Sn(r){if("number"==typeof r)return 0;switch(0|r.tag){case 0:return p(0,[Sn(r[0])]);case 1:return p(1,[Sn(r[0])]);case 2:return p(2,[Sn(r[0])]);case 3:return p(3,[Sn(r[0])]);case 4:return p(4,[Sn(r[0])]);case 5:return p(5,[Sn(r[0])]);case 6:return p(6,[Sn(r[0])]);case 7:return p(7,[Sn(r[0])]);case 8:return p(8,[r[0],Sn(r[1])]);case 9:return p(9,[r[1],r[0],Sn(r[2])]);case 10:return p(10,[Sn(r[0])]);case 11:return p(11,[Sn(r[0])]);case 12:return p(12,[Sn(r[0])]);case 13:return p(13,[Sn(r[0])]);case 14:return p(14,[Sn(r[0])])}}function An(r){if("number"==typeof r)return[function(r){return 0},function(r){return 0},function(r){return 0},function(r){return 0}];switch(0|r.tag){case 0:var n=An(r[0]),e=n[1],t=n[0];return[function(r){return s(t,0),0},function(r){return s(e,0),0},n[2],n[3]];case 1:var a=An(r[0]),u=a[1],i=a[0];return[function(r){return s(i,0),0},function(r){return s(u,0),0},a[2],a[3]];case 2:var o=An(r[0]),c=o[1],f=o[0];return[function(r){return s(f,0),0},function(r){return s(c,0),0},o[2],o[3]];case 3:var v=An(r[0]),l=v[1],d=v[0];return[function(r){return s(d,0),0},function(r){return s(l,0),0},v[2],v[3]];case 4:var h=An(r[0]),g=h[1],m=h[0];return[function(r){return s(m,0),0},function(r){return s(g,0),0},h[2],h[3]];case 5:var b=An(r[0]),p=b[1],w=b[0];return[function(r){return s(w,0),0},function(r){return s(p,0),0},b[2],b[3]];case 6:var y=An(r[0]),_=y[1],k=y[0];return[function(r){return s(k,0),0},function(r){return s(_,0),0},y[2],y[3]];case 7:var x=An(r[0]),N=x[1],C=x[0];return[function(r){return s(C,0),0},function(r){return s(N,0),0},x[2],x[3]];case 8:var F=An(r[1]),q=F[1],S=F[0];return[function(r){return s(S,0),0},function(r){return s(q,0),0},F[2],F[3]];case 9:var A=An(r[2]),M=A[3],L=A[2],D=A[1],$=A[0],O=An(Mn(Sn(r[0]),r[1])),R=O[3],E=O[2],T=O[1],P=O[0];return[function(r){return s($,0),s(P,0),0},function(r){return s(T,0),s(D,0),0},function(r){return s(L,0),s(E,0),0},function(r){return s(R,0),s(M,0),0}];case 10:var I=An(r[0]),V=I[1],U=I[0];return[function(r){return s(U,0),0},function(r){return s(V,0),0},I[2],I[3]];case 11:var Q=An(r[0]),j=Q[1],X=Q[0];return[function(r){return s(X,0),0},function(r){return s(j,0),0},Q[2],Q[3]];case 12:var z=An(r[0]),B=z[1],K=z[0];return[function(r){return s(K,0),0},function(r){return s(B,0),0},z[2],z[3]];case 13:var J=An(r[0]),G=J[3],H=J[2],W=J[1],Y=J[0];return[function(r){return s(Y,0),0},function(r){return s(W,0),0},function(r){return s(H,0),0},function(r){return s(G,0),0}];case 14:var Z=An(r[0]),rr=Z[3],nr=Z[2],er=Z[1],tr=Z[0];return[function(r){return s(tr,0),0},function(r){return s(er,0),0},function(r){return s(nr,0),0},function(r){return s(rr,0),0}]}}function Mn(r,n){var e=0;if("number"==typeof r){if("number"==typeof n)return 0;switch(0|n.tag){case 8:e=6;break;case 9:e=7;break;case 10:e=1;break;case 11:e=2;break;case 12:e=3;break;case 13:e=4;break;case 14:e=5;break;default:throw[i,["camlinternalFormat.ml",846,23]]}}else switch(0|r.tag){case 0:if("number"==typeof n)e=8;else switch(0|n.tag){case 0:return p(0,[Mn(r[0],n[0])]);case 8:e=6;break;case 9:e=7;break;case 10:e=1;break;case 11:e=2;break;case 12:e=3;break;case 13:e=4;break;case 14:e=5}break;case 1:if("number"==typeof n)e=8;else switch(0|n.tag){case 1:return p(1,[Mn(r[0],n[0])]);case 8:e=6;break;case 9:e=7;break;case 10:e=1;break;case 11:e=2;break;case 12:e=3;break;case 13:e=4;break;case 14:e=5}break;case 2:if("number"==typeof n)e=8;else switch(0|n.tag){case 2:return p(2,[Mn(r[0],n[0])]);case 8:e=6;break;case 9:e=7;break;case 10:e=1;break;case 11:e=2;break;case 12:e=3;break;case 13:e=4;break;case 14:e=5}break;case 3:if("number"==typeof n)e=8;else switch(0|n.tag){case 3:return p(3,[Mn(r[0],n[0])]);case 8:e=6;break;case 9:e=7;break;case 10:e=1;break;case 11:e=2;break;case 12:e=3;break;case 13:e=4;break;case 14:e=5}break;case 4:if("number"==typeof n)e=8;else switch(0|n.tag){case 4:return p(4,[Mn(r[0],n[0])]);case 8:e=6;break;case 9:e=7;break;case 10:e=1;break;case 11:e=2;break;case 12:e=3;break;case 13:e=4;break;case 14:e=5}break;case 5:if("number"==typeof n)e=8;else switch(0|n.tag){case 5:return p(5,[Mn(r[0],n[0])]);case 8:e=6;break;case 9:e=7;break;case 10:e=1;break;case 11:e=2;break;case 12:e=3;break;case 13:e=4;break;case 14:e=5}break;case 6:if("number"==typeof n)e=8;else switch(0|n.tag){case 6:return p(6,[Mn(r[0],n[0])]);case 8:e=6;break;case 9:e=7;break;case 10:e=1;break;case 11:e=2;break;case 12:e=3;break;case 13:e=4;break;case 14:e=5}break;case 7:if("number"==typeof n)e=8;else switch(0|n.tag){case 7:return p(7,[Mn(r[0],n[0])]);case 8:e=6;break;case 9:e=7;break;case 10:e=1;break;case 11:e=2;break;case 12:e=3;break;case 13:e=4;break;case 14:e=5}break;case 8:if("number"==typeof n)throw[i,["camlinternalFormat.ml",832,26]];switch(0|n.tag){case 8:return p(8,[Mn(r[0],n[0]),Mn(r[1],n[1])]);case 10:e=1;break;case 11:e=2;break;case 12:e=3;break;case 13:e=4;break;case 14:e=5;break;default:throw[i,["camlinternalFormat.ml",832,26]]}break;case 9:if("number"==typeof n)throw[i,["camlinternalFormat.ml",842,28]];switch(0|n.tag){case 8:e=6;break;case 9:var t=An(Mn(Sn(r[1]),n[0]));return s(t[1],0),s(t[3],0),p(9,[r[0],n[1],Mn(r[2],n[2])]);case 10:e=1;break;case 11:e=2;break;case 12:e=3;break;case 13:e=4;break;case 14:e=5;break;default:throw[i,["camlinternalFormat.ml",842,28]]}break;case 10:if("number"==typeof n)throw[i,["camlinternalFormat.ml",810,21]];if(10===n.tag)return p(10,[Mn(r[0],n[0])]);throw[i,["camlinternalFormat.ml",810,21]];case 11:if("number"==typeof n)throw[i,["camlinternalFormat.ml",814,21]];switch(0|n.tag){case 10:e=1;break;case 11:return p(11,[Mn(r[0],n[0])]);default:throw[i,["camlinternalFormat.ml",814,21]]}break;case 12:if("number"==typeof n)throw[i,["camlinternalFormat.ml",818,19]];switch(0|n.tag){case 10:e=1;break;case 11:e=2;break;case 12:return p(12,[Mn(r[0],n[0])]);default:throw[i,["camlinternalFormat.ml",818,19]]}break;case 13:if("number"==typeof n)throw[i,["camlinternalFormat.ml",822,22]];switch(0|n.tag){case 10:e=1;break;case 11:e=2;break;case 12:e=3;break;case 13:return p(13,[Mn(r[0],n[0])]);default:throw[i,["camlinternalFormat.ml",822,22]]}break;case 14:if("number"==typeof n)throw[i,["camlinternalFormat.ml",827,30]];switch(0|n.tag){case 10:e=1;break;case 11:e=2;break;case 12:e=3;break;case 13:e=4;break;case 14:return p(14,[Mn(r[0],n[0])]);default:throw[i,["camlinternalFormat.ml",827,30]]}}switch(e){case 1:throw[i,["camlinternalFormat.ml",811,21]];case 2:throw[i,["camlinternalFormat.ml",815,21]];case 3:throw[i,["camlinternalFormat.ml",819,19]];case 4:throw[i,["camlinternalFormat.ml",823,22]];case 5:throw[i,["camlinternalFormat.ml",828,30]];case 6:throw[i,["camlinternalFormat.ml",833,26]];case 7:throw[i,["camlinternalFormat.ml",843,28]];case 8:throw[i,["camlinternalFormat.ml",847,23]]}}var Ln=dr("CamlinternalFormat.Type_mismatch");function Dn(r,n){if("number"==typeof r)return[0,n];if(!r.tag)return[p(0,[r[0],r[1]]),n];if("number"==typeof n)throw Ln;if(2===n.tag)return[p(1,[r[0]]),n[0]];throw Ln}function $n(r,n,e){var t=Dn(r,e);if("number"!=typeof n)return[t[0],[n[0]],t[1]];if(0===n)return[t[0],0,t[1]];var a=t[1];if("number"==typeof a)throw Ln;if(2===a.tag)return[t[0],1,a[0]];throw Ln}function On(r,n){if("number"==typeof r)return[0,n];switch(0|r.tag){case 0:if("number"==typeof n)throw Ln;if(n.tag)throw Ln;var e=On(r[0],n[0]);return[p(0,[e[0]]),e[1]];case 1:if("number"==typeof n)throw Ln;if(n.tag)throw Ln;var t=On(r[0],n[0]);return[p(1,[t[0]]),t[1]];case 2:var a=Dn(r[0],n),u=a[1];if("number"==typeof u)throw Ln;if(1===u.tag){var i=On(r[1],u[0]);return[p(2,[a[0],i[0]]),i[1]]}throw Ln;case 3:var o=Dn(r[0],n),c=o[1];if("number"==typeof c)throw Ln;if(1===c.tag){var f=On(r[1],c[0]);return[p(3,[o[0],f[0]]),f[1]]}throw Ln;case 4:var v=$n(r[1],r[2],n),l=v[2];if("number"==typeof l)throw Ln;if(2===l.tag){var d=On(r[3],l[0]);return[p(4,[r[0],v[0],v[1],d[0]]),d[1]]}throw Ln;case 5:var h=$n(r[1],r[2],n),g=h[2];if("number"==typeof g)throw Ln;if(3===g.tag){var m=On(r[3],g[0]);return[p(5,[r[0],h[0],h[1],m[0]]),m[1]]}throw Ln;case 6:var b=$n(r[1],r[2],n),w=b[2];if("number"==typeof w)throw Ln;if(4===w.tag){var y=On(r[3],w[0]);return[p(6,[r[0],b[0],b[1],y[0]]),y[1]]}throw Ln;case 7:var _=$n(r[1],r[2],n),k=_[2];if("number"==typeof k)throw Ln;if(5===k.tag){var x=On(r[3],k[0]);return[p(7,[r[0],_[0],_[1],x[0]]),x[1]]}throw Ln;case 8:var C=$n(r[1],r[2],n),F=C[2];if("number"==typeof F)throw Ln;if(6===F.tag){var q=On(r[3],F[0]);return[p(8,[r[0],C[0],C[1],q[0]]),q[1]]}throw Ln;case 9:var S=Dn(r[0],n),A=S[1];if("number"==typeof A)throw Ln;if(7===A.tag){var M=On(r[1],A[0]);return[p(9,[S[0],M[0]]),M[1]]}throw Ln;case 10:var L=On(r[0],n);return[p(10,[L[0]]),L[1]];case 11:var D=On(r[1],n);return[p(11,[r[0],D[0]]),D[1]];case 12:var $=On(r[1],n);return[p(12,[r[0],$[0]]),$[1]];case 13:if("number"==typeof n)throw Ln;if(8===n.tag){var O=n[0];if(N([r[1]],[O]))throw Ln;var R=On(r[2],n[1]);return[p(13,[r[0],O,R[0]]),R[1]]}throw Ln;case 14:if("number"==typeof n)throw Ln;if(9===n.tag){var E=n[0];if(N([wr(r[1])],[wr(E)]))throw Ln;var T=On(r[2],wr(n[2]));return[p(14,[r[0],E,T[0]]),T[1]]}throw Ln;case 15:if("number"==typeof n)throw Ln;if(10===n.tag){var P=On(r[0],n[0]);return[p(15,[P[0]]),P[1]]}throw Ln;case 16:if("number"==typeof n)throw Ln;if(11===n.tag){var I=On(r[0],n[0]);return[p(16,[I[0]]),I[1]]}throw Ln;case 17:var V=On(r[1],n);return[p(17,[r[0],V[0]]),V[1]];case 18:var U=r[0],Q=r[1];if(U.tag){var j=U[0],X=On(j[0],n),z=On(Q,X[1]);return[p(18,[p(1,[[X[0],j[1]]]),z[0]]),z[1]]}var B=U[0],K=On(B[0],n),J=On(Q,K[1]);return[p(18,[p(0,[[K[0],B[1]]]),J[0]]),J[1]];case 19:if("number"==typeof n)throw Ln;if(13===n.tag){var G=On(r[0],n[0]);return[p(19,[G[0]]),G[1]]}throw Ln;case 20:if("number"==typeof n)throw Ln;if(1===n.tag){var H=On(r[2],n[0]);return[p(20,[r[0],r[1],H[0]]),H[1]]}throw Ln;case 21:if("number"==typeof n)throw Ln;if(2===n.tag){var W=On(r[1],n[0]);return[p(21,[r[0],W[0]]),W[1]]}throw Ln;case 23:var Y=r[0],Z=r[1];if("number"==typeof Y){if(2!==Y)return Rn(Y,Z,n);if("number"==typeof n)throw Ln;if(14===n.tag){var rr=On(Z,n[0]);return[p(23,[2,rr[0]]),rr[1]]}throw Ln}switch(0|Y.tag){case 8:return Rn(p(8,[Y[0],Y[1]]),Z,n);case 9:var nr=function r(n,e,t){if("number"==typeof n)return[0,On(e,t)];switch(0|n.tag){case 0:if("number"==typeof t)throw Ln;if(t.tag)throw Ln;var a=r(n[0],e,t[0]);return[p(0,[a[0]]),a[1]];case 1:if("number"==typeof t)throw Ln;if(1===t.tag){var u=r(n[0],e,t[0]);return[p(1,[u[0]]),u[1]]}throw Ln;case 2:if("number"==typeof t)throw Ln;if(2===t.tag){var i=r(n[0],e,t[0]);return[p(2,[i[0]]),i[1]]}throw Ln;case 3:if("number"==typeof t)throw Ln;if(3===t.tag){var o=r(n[0],e,t[0]);return[p(3,[o[0]]),o[1]]}throw Ln;case 4:if("number"==typeof t)throw Ln;if(4===t.tag){var c=r(n[0],e,t[0]);return[p(4,[c[0]]),c[1]]}throw Ln;case 5:if("number"==typeof t)throw Ln;if(5===t.tag){var f=r(n[0],e,t[0]);return[p(5,[f[0]]),f[1]]}throw Ln;case 6:if("number"==typeof t)throw Ln;if(6===t.tag){var v=r(n[0],e,t[0]);return[p(6,[v[0]]),v[1]]}throw Ln;case 7:if("number"==typeof t)throw Ln;if(7===t.tag){var l=r(n[0],e,t[0]);return[p(7,[l[0]]),l[1]]}throw Ln;case 8:if("number"==typeof t)throw Ln;if(8===t.tag){var d=t[0];if(N([n[0]],[d]))throw Ln;var h=r(n[1],e,t[1]);return[p(8,[d,h[0]]),h[1]]}throw Ln;case 9:if("number"==typeof t)throw Ln;if(9===t.tag){var g=t[1],m=t[0];if(N([wr(n[0])],[wr(m)]))throw Ln;if(N([wr(n[1])],[wr(g)]))throw Ln;var b=An(Mn(Sn(m),g));s(b[1],0),s(b[3],0);var w=r(wr(n[2]),e,t[2]);return[p(9,[m,g,Sn(w[0])]),w[1]]}throw Ln;case 10:if("number"==typeof t)throw Ln;if(10===t.tag){var y=r(n[0],e,t[0]);return[p(10,[y[0]]),y[1]]}throw Ln;case 11:if("number"==typeof t)throw Ln;if(11===t.tag){var _=r(n[0],e,t[0]);return[p(11,[_[0]]),_[1]]}throw Ln;case 12:throw Ln;case 13:if("number"==typeof t)throw Ln;if(13===t.tag){var k=r(n[0],e,t[0]);return[p(13,[k[0]]),k[1]]}throw Ln;case 14:if("number"==typeof t)throw Ln;if(14===t.tag){var x=r(n[0],e,t[0]);return[p(14,[x[0]]),x[1]]}throw Ln}}(Y[1],Z,n),er=nr[1];return[p(23,[p(9,[Y[0],nr[0]]),er[0]]),er[1]];default:return Rn(Y,Z,n)}case 22:case 24:throw Ln}}function Rn(r,n,e){var t=On(n,e);return[p(23,[r,t[0]]),t[1]]}function En(r,n){return function(r,n){var e=On(r,n);if("number"==typeof e[1])return e[0];throw Ln}(r,wr(Sn(n)))}function Tn(r,n,e){var t=e.length,a=_r(n),u=n<0?0:r;if(a<=t)return e;var i=Er(a,2===u?48:32);switch(u){case 0:Wr(e,0,i,0,t);break;case 1:Wr(e,0,i,a-t|0,t);break;case 2:t>0&&(43===vr(e,0)||45===vr(e,0)||32===vr(e,0))?(i[0]=vr(e,0),Wr(e,1,i,1+(a-t|0)|0,t-1|0)):t>1&&48===vr(e,0)&&(120===vr(e,1)||88===vr(e,1))?(i[1]=vr(e,1),Wr(e,2,i,2+(a-t|0)|0,t-2|0)):Wr(e,0,i,a-t|0,t)}return q(i)}function Pn(r,n){var e=_r(r),t=n.length,a=vr(n,0),u=0;if(a>=58)if(a>=71){if(a>102||a<97)return n;u=2}else{if(a<65)return n;u=2}else if(32!==a){if(a<43)return n;switch(a-43|0){case 0:case 2:u=1;break;case 1:case 3:case 4:return n;case 5:if((e+2|0)>t&&t>1&&(120===vr(n,1)||88===vr(n,1))){var i=Er(e+2|0,48);return i[1]=vr(n,1),Wr(n,2,i,4+(e-t|0)|0,t-2|0),q(i)}u=2;break;case 6:case 7:case 8:case 9:case 10:case 11:case 12:case 13:case 14:u=2}}else u=1;switch(u){case 1:if((e+1|0)<=t)return n;var o=Er(e+1|0,48);return o[0]=a,Wr(n,1,o,2+(e-t|0)|0,t-1|0),q(o);case 2:if(e<=t)return n;var c=Er(e,48);return Wr(n,0,c,e-t|0,t),q(c)}}function In(r){var n,e=(n=r,function(r){for(;;){var e=r;if(e>=n.length)return!1;var t=n.charCodeAt(e);if(t<32)return!0;var a=t-34|0;if(a>58||a<0){if(a>=93)return!0;r=e+1|0}else{if(a>57||a<1)return!0;r=e+1|0}}}(0)?q(jr(A(n))):n),t=e.length,a=Er(t+2|0,34);return S(e,0,a,1,t),q(a)}function Vn(r,n){if(15===r)return"%.12g";var e=_r(n),t=function(r){switch(r){case 0:case 1:case 2:return 102;case 3:case 4:case 5:return 101;case 6:case 7:case 8:return 69;case 9:case 10:case 11:return 103;case 12:case 13:case 14:return 71;case 15:return 70;case 16:case 17:case 18:return 104;case 19:case 20:case 21:return 72}}(r),a={ind:0,bytes:C(16)};return Nn(a,37),function(r,n){switch(n){case 0:case 3:case 6:case 9:case 12:case 15:case 16:case 19:return;case 1:case 4:case 7:case 10:case 13:case 17:case 20:return Nn(r,43);case 2:case 5:case 8:case 11:case 14:case 18:case 21:Nn(r,32)}}(a,r),Nn(a,46),Cn(a,String(e)),Nn(a,t),Fn(a)}function Un(r,n){return or(function(r){switch(r){case 0:return"%d";case 1:return"%+d";case 2:return"% d";case 3:return"%i";case 4:return"%+i";case 5:return"% i";case 6:return"%x";case 7:return"%#x";case 8:return"%X";case 9:return"%#X";case 10:return"%o";case 11:return"%#o";case 12:return"%u"}}(r),n)}function Qn(r,n){return sr(function(r){switch(r){case 0:return"%ld";case 1:return"%+ld";case 2:return"% ld";case 3:return"%li";case 4:return"%+li";case 5:return"% li";case 6:return"%lx";case 7:return"%#lx";case 8:return"%lX";case 9:return"%#lX";case 10:return"%lo";case 11:return"%#lo";case 12:return"%lu"}}(r),n)}function jn(r,n){return fr(function(r){switch(r){case 0:return"%nd";case 1:return"%+nd";case 2:return"% nd";case 3:return"%ni";case 4:return"%+ni";case 5:return"% ni";case 6:return"%nx";case 7:return"%#nx";case 8:return"%nX";case 9:return"%#nX";case 10:return"%no";case 11:return"%#no";case 12:return"%nu"}}(r),n)}function Xn(r,n){return cr(function(r){switch(r){case 0:return"%Ld";case 1:return"%+Ld";case 2:return"% Ld";case 3:return"%Li";case 4:return"%+Li";case 5:return"% Li";case 6:return"%Lx";case 7:return"%#Lx";case 8:return"%LX";case 9:return"%#LX";case 10:return"%Lo";case 11:return"%#Lo";case 12:return"%Lu"}}(r),n)}function zn(r,n,e){if(r>=16){var t;if(r>=17)switch(r-17|0){case 2:t=45;break;case 0:case 3:t=43;break;case 1:case 4:t=32}else t=45;var a=function(r,n,e){if(!isFinite(r))return isNaN(r)?"nan":r>0?"infinity":"-infinity";var t=0==r&&1/r==-1/0?1:r>=0?0:1;t&&(r=-r);var a=0;if(0==r);else if(r<1)for(;r<1&&a>-1022;)r*=2,a--;else for(;r>=2;)r/=2,a++;var u=a<0?"":"+",i="";if(t)i="-";else switch(e){case 43:i="+";break;case 32:i=" "}if(n>=0&&n<13){var o=Math.pow(2,4*n);r=Math.round(r*o)/o}var c=r.toString(16);if(n>=0){var f=c.indexOf(".");if(f<0)c+="."+"0".repeat(n);else{var s=f+1+n;c.length<s?c+="0".repeat(s-c.length):c=c.substr(0,s)}}return i+"0x"+c+"p"+u+a.toString(10)}(e,n,t);return r>=19?q(Xr(A(a))):a}var u=function(r,n){var e=ur(r),t=e.prec<0?6:e.prec,a=n<0?(e.sign=-1,-n):n,u="";if(isNaN(a))u="nan",e.filter=" ";else if(isFinite(a)){switch(e.conv){case"e":var i=(u=a.toExponential(t)).length;"e"===u[i-3|0]&&(u=u.slice(0,i-1|0)+"0"+u.slice(i-1|0));break;case"f":u=a.toFixed(t);break;case"g":var o=0!==t?t:1,c=(u=a.toExponential(o-1|0)).indexOf("e"),f=0|Number(u.slice(c+1|0));if(f<-4||a>=1e21||a.toFixed().length>o){for(var s=c-1|0;"0"===u[s];)s=s-1|0;"."===u[s]&&(s=s-1|0);var v=(u=u.slice(0,s+1|0)+u.slice(c)).length;"e"===u[v-3|0]&&(u=u.slice(0,v-1|0)+"0"+u.slice(v-1|0))}else{var l=o;if(f<0)l=l-(f+1|0)|0,u=a.toFixed(l);else for(;(u=a.toFixed(l)).length>(o+1|0);)l=l-1|0;if(0!==l){for(var d=u.length-1|0;"0"===u[d];)d=d-1|0;"."===u[d]&&(d=d-1|0),u=u.slice(0,d+1|0)}}}}else u="inf",e.filter=" ";return ir(e,u)}(Vn(r,n),e);if(15!==r)return u;var i=u.length,o=function(r){return isFinite(r)?Math.abs(r)>=22250738585072014e-324?0:0!==r?1:2:isNaN(r)?4:3}(e);return 3!==o?o>=4?"nan":function(r){for(;;){var n=r;if(n===i)return!1;var e=vr(u,n)-46|0;if(e>23||e<0){if(55===e)return!0;r=n+1|0}else{if(e>22||e<1)return!0;r=n+1|0}}}(0)?u:u+".":e<0?"neg_infinity":"infinity"}function Bn(r){var n=function(r){var n=0;if(r>=40){if(92===r)return"\\\\";n=r>=127?1:2}else if(r>=32){if(r>=39)return"\\'";n=2}else if(r>=14)n=1;else switch(r){case 8:return"\\b";case 9:return"\\t";case 10:return"\\n";case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:case 11:case 12:n=1;break;case 13:return"\\r"}switch(n){case 1:var e=[0,0,0,0];return e[0]=92,e[1]=48+(r/100|0)|0,e[2]=48+(r/10|0)%10|0,e[3]=48+r%10|0,q(e);case 2:var t=[0];return t[0]=r,q(t)}}(r),e=n.length,t=Er(e+2|0,39);return S(n,0,t,1,e),q(t)}function Kn(r){var n={ind:0,bytes:C(16)};return function r(n,e){for(;;){var t=e;if("number"==typeof t)return;switch(0|t.tag){case 0:Cn(n,"%c"),e=t[0];continue;case 1:Cn(n,"%s"),e=t[0];continue;case 2:Cn(n,"%i"),e=t[0];continue;case 3:Cn(n,"%li"),e=t[0];continue;case 4:Cn(n,"%ni"),e=t[0];continue;case 5:Cn(n,"%Li"),e=t[0];continue;case 6:Cn(n,"%f"),e=t[0];continue;case 7:Cn(n,"%B"),e=t[0];continue;case 8:Cn(n,"%{"),r(n,t[0]),Cn(n,"%}"),e=t[1];continue;case 9:Cn(n,"%("),r(n,t[0]),Cn(n,"%)"),e=t[2];continue;case 10:Cn(n,"%a"),e=t[0];continue;case 11:Cn(n,"%t"),e=t[0];continue;case 12:Cn(n,"%?"),e=t[0];continue;case 13:Cn(n,"%r"),e=t[0];continue;case 14:Cn(n,"%_r"),e=t[0];continue}}}(n,r),Fn(n)}function Jn(r,n,e,t){for(;;){var a=t,u=e,o=r;if("number"==typeof a)return v(o,n,u);switch(0|a.tag){case 0:return function(r,e,t){return function(a){var u=p(5,[e,a]);return Jn(r,n,u,t)}}(o,u,a[0]);case 1:return function(r,e,t){return function(a){var u=Bn(a),i=p(4,[e,u]);return Jn(r,n,i,t)}}(o,u,a[0]);case 2:return Wn(o,n,u,a[1],a[0],(function(r){return r}));case 3:return Wn(o,n,u,a[1],a[0],In);case 4:return Yn(o,n,u,a[3],a[1],a[2],Un,a[0]);case 5:return Yn(o,n,u,a[3],a[1],a[2],Qn,a[0]);case 6:return Yn(o,n,u,a[3],a[1],a[2],jn,a[0]);case 7:return Yn(o,n,u,a[3],a[1],a[2],Xn,a[0]);case 8:var c=a[3],f=a[1],l=a[2],d=a[0];if("number"==typeof f)return"number"==typeof l?0!==l?function(r,e,t,a){return function(u,i){var o=zn(a,u,i);return Jn(r,n,p(4,[e,o]),t)}}(o,u,c,d):function(r,e,t,a){return function(u){var i=zn(a,-6,u);return Jn(r,n,p(4,[e,i]),t)}}(o,u,c,d):function(r,e,t,a,u){return function(i){var o=zn(a,u,i);return Jn(r,n,p(4,[e,o]),t)}}(o,u,c,d,l[0]);if(f.tag){var h=f[0];return"number"==typeof l?0!==l?function(r,e,t,a,u){return function(i,o,c){var f=Tn(u,i,zn(a,o,c));return Jn(r,n,p(4,[e,f]),t)}}(o,u,c,d,h):function(r,e,t,a,u){return function(i,o){var c=zn(a,-6,o),f=Tn(u,i,c);return Jn(r,n,p(4,[e,f]),t)}}(o,u,c,d,h):function(r,e,t,a,u,i){return function(o,c){var f=Tn(u,o,zn(a,i,c));return Jn(r,n,p(4,[e,f]),t)}}(o,u,c,d,h,l[0])}var g=f[1],m=f[0];return"number"==typeof l?0!==l?function(r,e,t,a,u,i){return function(o,c){var f=Tn(u,i,zn(a,o,c));return Jn(r,n,p(4,[e,f]),t)}}(o,u,c,d,m,g):function(r,e,t,a,u,i){return function(o){var c=zn(a,-6,o),f=Tn(u,i,c);return Jn(r,n,p(4,[e,f]),t)}}(o,u,c,d,m,g):function(r,e,t,a,u,i,o){return function(c){var f=Tn(u,i,zn(a,o,c));return Jn(r,n,p(4,[e,f]),t)}}(o,u,c,d,m,g,l[0]);case 9:return Wn(o,n,u,a[1],a[0],kr);case 10:t=a[0],e=p(7,[u]);continue;case 11:t=a[1],e=p(2,[u,a[0]]);continue;case 12:t=a[1],e=p(3,[u,a[0]]);continue;case 13:return function(r,e,t,a){return function(u){return Jn(r,n,p(4,[e,a]),t)}}(o,u,a[2],Kn(a[1]));case 14:var b=a[2];return function(r,e,t,a){return function(u){return Jn(r,n,e,yr(En(u[0],t),a))}}(o,u,a[1],b);case 15:return function(r,e,t){return function(a,u){return Jn(r,n,p(6,[e,function(r){return v(a,r,u)}]),t)}}(o,u,a[0]);case 16:return function(r,e,t){return function(a){return Jn(r,n,p(6,[e,a]),t)}}(o,u,a[0]);case 17:t=a[1],e=p(0,[u,a[0]]);continue;case 18:var w=a[0];if(w.tag){var y=function(r,n,e){return function(t,a){return Jn(r,t,p(1,[n,p(1,[a])]),e)}}(o,u,a[1]);t=w[0][0],e=0,r=y;continue}var _=function(r,n,e){return function(t,a){return Jn(r,t,p(1,[n,p(0,[a])]),e)}}(o,u,a[1]);t=w[0][0],e=0,r=_;continue;case 19:throw[i,["camlinternalFormat.ml",1525,4]];case 20:return function(r,e,t){return function(a){return Jn(r,n,t,e)}}(o,a[2],p(8,[u,"Printf: bad conversion %["]));case 21:return function(r,e,t){return function(a){var u=or("%u",a),i=p(4,[e,u]);return Jn(r,n,i,t)}}(o,u,a[1]);case 22:return function(r,e,t){return function(a){var u=p(5,[e,a]);return Jn(r,n,u,t)}}(o,u,a[0]);case 23:return Gn(o,n,u,a[0],a[1]);case 24:return Zn(o,n,u,a[2],a[0],s(a[1],void 0))}}}function Gn(r,n,e,t,a){if("number"!=typeof t)return 9===t.tag?function r(n,e,t,a,u){if("number"==typeof a)return Hn(n,e,t,u);switch(0|a.tag){case 0:var o=a[0];return function(a){return r(n,e,t,o,u)};case 1:var c=a[0];return function(a){return r(n,e,t,c,u)};case 2:var f=a[0];return function(a){return r(n,e,t,f,u)};case 3:var s=a[0];return function(a){return r(n,e,t,s,u)};case 4:var v=a[0];return function(a){return r(n,e,t,v,u)};case 5:var l=a[0];return function(a){return r(n,e,t,l,u)};case 6:var d=a[0];return function(a){return r(n,e,t,d,u)};case 7:var h=a[0];return function(a){return r(n,e,t,h,u)};case 8:var g=a[1];return function(a){return r(n,e,t,g,u)};case 9:var m=a[2],b=Mn(Sn(a[0]),a[1]);return function(a){return r(n,e,t,function r(n,e){if("number"==typeof n)return e;switch(0|n.tag){case 0:return p(0,[r(n[0],e)]);case 1:return p(1,[r(n[0],e)]);case 2:return p(2,[r(n[0],e)]);case 3:return p(3,[r(n[0],e)]);case 4:return p(4,[r(n[0],e)]);case 5:return p(5,[r(n[0],e)]);case 6:return p(6,[r(n[0],e)]);case 7:return p(7,[r(n[0],e)]);case 8:return p(8,[n[0],r(n[1],e)]);case 9:return p(9,[n[0],n[1],r(n[2],e)]);case 10:return p(10,[r(n[0],e)]);case 11:return p(11,[r(n[0],e)]);case 12:return p(12,[r(n[0],e)]);case 13:return p(13,[r(n[0],e)]);case 14:return p(14,[r(n[0],e)])}}(b,m),u)};case 10:var w=a[0];return function(a,i){return r(n,e,t,w,u)};case 11:var y=a[0];return function(a){return r(n,e,t,y,u)};case 12:var _=a[0];return function(a){return r(n,e,t,_,u)};case 13:throw[i,["camlinternalFormat.ml",1616,31]];case 14:throw[i,["camlinternalFormat.ml",1617,31]]}}(r,n,e,t[1],a):Hn(r,n,e,a);if(2!==t)return Hn(r,n,e,a);throw[i,["camlinternalFormat.ml",1593,39]]}function Hn(r,n,e,t){return Jn(r,n,p(8,[e,"Printf: bad conversion %_"]),t)}function Wn(r,n,e,t,a,u){if("number"==typeof a)return function(a){var i=s(u,a),o=p(4,[e,i]);return Jn(r,n,o,t)};if(a.tag){var i=a[0];return function(a,o){var c=Tn(i,a,s(u,o)),f=p(4,[e,c]);return Jn(r,n,f,t)}}var o=a[1],c=a[0];return function(a){var i=Tn(c,o,s(u,a)),f=p(4,[e,i]);return Jn(r,n,f,t)}}function Yn(r,n,e,t,a,u,i,o){if("number"==typeof a){if("number"==typeof u)return 0!==u?function(a,u){var c=Pn(a,v(i,o,u));return Jn(r,n,p(4,[e,c]),t)}:function(a){var u=v(i,o,a);return Jn(r,n,p(4,[e,u]),t)};var c=u[0];return function(a){var u=Pn(c,v(i,o,a));return Jn(r,n,p(4,[e,u]),t)}}if(a.tag){var f=a[0];if("number"==typeof u)return 0!==u?function(a,u,c){var s=Tn(f,a,Pn(u,v(i,o,c)));return Jn(r,n,p(4,[e,s]),t)}:function(a,u){var c=Tn(f,a,v(i,o,u));return Jn(r,n,p(4,[e,c]),t)};var s=u[0];return function(a,u){var c=Tn(f,a,Pn(s,v(i,o,u)));return Jn(r,n,p(4,[e,c]),t)}}var l=a[1],d=a[0];if("number"==typeof u)return 0!==u?function(a,u){var c=Tn(d,l,Pn(a,v(i,o,u)));return Jn(r,n,p(4,[e,c]),t)}:function(a){var u=Tn(d,l,v(i,o,a));return Jn(r,n,p(4,[e,u]),t)};var h=u[0];return function(a){var u=Tn(d,l,Pn(h,v(i,o,a)));return Jn(r,n,p(4,[e,u]),t)}}function Zn(r,n,e,t,a,u){if(!a)return Jn(r,n,p(4,[e,u]),t);var i=a[0];return function(a){return Zn(r,n,e,t,i,s(u,a))}}function re(r,n){return Jn((function(n,t){var a,u,i,o,c={buffer:i=C(u=(a=64)<1?1:a),position:0,length:u,initial_buffer:i};return function r(n,t){for(;;){var a=t,u=0;if("number"==typeof a)return;switch(0|a.tag){case 0:var i=qn(a[1]);return r(n,a[0]),kn(n,i);case 1:var o=a[1],c=a[0];if(o.tag){r(n,c),kn(n,"@["),t=o[0];continue}r(n,c),kn(n,"@{"),t=o[0];continue;case 2:case 4:u=1;break;case 3:case 5:u=2;break;case 6:return r(n,a[0]),kn(n,s(a[1],void 0));case 7:t=a[0];continue;case 8:throw r(n,a[0]),[e,a[1]]}switch(u){case 1:return r(n,a[0]),kn(n,a[1]);case 2:return r(n,a[0]),_n(n,a[1])}}}(c,t),s(r,Ir((o=c).buffer,0,o.position))}),void 0,0,n[0])}function ne(r){return re((function(r){return r}),r)}function ee(r){var n=r.length;return Cr(function(e,t){for(;;){var a=t,u=e;if(a===n)return u;t=a+1|0,e=[vr(r,a),u]}}(0,0))}function te(r,n){return function(r,n){return r.line===n.line?w(n.column,r.column):w(n.line,r.line)}(r.location,n.location)}function ae(r,n,e){var t=s(r,e);if(t.tag)return p(1,[t[0]]);var a=t[0];return v(n,a.result,{location:a.location,input_chars:a.remaining_chars})}function ue(r,n,e,t){var a=s(r,t);if(a.tag)return p(0,[{result:e,location:t.location,remaining_chars:t.input_chars}]);var u=a[0];return v(n,u.result,{location:u.location,input_chars:u.remaining_chars})}function ie(r,n){return p(0,[{result:r,location:n.location,remaining_chars:n.input_chars}])}function oe(r,n,e){var t=s(n,e);if(!t.tag)return t;var a=t[0];return p(1,a?[[{expecting:s(r,Kr(" OR ",qr((function(r){return r.expecting}),a))),actual:a[0].actual,location:e.location},0]]:[[{expecting:s(r,""),actual:"No input",location:e.location},0]])}function ce(r,n,e){var t=s(n,e);if(!t.tag)return t;var a=t[0];return p(1,a?[[{expecting:r,actual:a[0].actual,location:e.location},a[1]]]:[[{expecting:r,actual:"",location:e.location},0]])}function fe(r,n){return function(e){return ae(n,(function(n){var e=s(r,n);return function(r){return ie(e,r)}}),e)}}function se(r,n,e){var t=s(r,e);if(!t.tag)return t;var a=s(n,e);return a.tag?p(1,[Dr([t[0],[a[0],0]])]):a}function ve(r){if(!r)return function(r){return p(1,[0])};var n=r[0],e=ve(r[1]);return function(r){return se(n,e,r)}}function le(r,n){return e=r,t=function(r,n){var e=function(t){return function(a){return ue(r,(function(r){return function(r){return ae(n,(function(r){return e([r,t])}),r)}}),t,a)}};return e(0)}(n,r),function(r){return ae(e,(function(r){return function(n){return ae(t,(function(n){var e=[r,n];return function(r){return ie(e,r)}}),n)}}),r)};var e,t}function de(r,n,e){var t=e.input_chars;if(!t)return p(1,[[{expecting:n,actual:"Ran out of characters",location:e.location},0]]);var a,u,i,o=t[0];return s(r,o)?p(0,[{result:o,location:(a=e.location,u=o,i=a.line,10!==u&&13!==u?{column:a.column+1|0,line:i}:{column:1,line:i+1|0}),remaining_chars:t[1]}]):p(1,[[{expecting:n,actual:s(ne([p(12,[39,p(0,[p(12,[39,0])])]),"'%c'"]),o),location:e.location},0]])}function he(r){var n=s(ne([p(0,[0]),"%c"]),r);return function(e){return de((function(n){return r===n}),n,e)}}function ge(r,n){var e=v(ne([p(11,["A character between ",p(0,[p(11,[" and ",p(0,[0])])])]),"A character between %c and %c"]),r,n);return function(t){return de((function(e){return e>=r&&e<=n}),e,t)}}var me=function(r){var n=s(ne([p(11,["One of: ",p(2,[0,0])]),"One of: %s"]),Kr(", ",qr((function(r){return zr(1,r)}),r)));return function(e){return de((function(n){return function(r,n){for(;;){var e=n;if(!e)return!1;if(x(e[0],r))return!0;n=e[1]}}(n,r)}),n,e)}}([32,[9,[13,[10,0]]]]),be=(he(10),he(9),ge(65,90)),pe=ge(97,122),we=ge(48,57),ye=ne([p(2,[0,0]),"%s"]);function _e(r){return oe(ye,(function(r){return se(pe,be,r)}),r)}ve([ge(97,102),[ge(65,70),[we,0]]]);var ke=function r(n){var e=function(e){return ae(n,(function(e){return r(n)}),e)};return function(r){return se(e,(function(r){return ie(void 0,r)}),r)}}(me);ge(48,55);function xe(r){var e=r.length,t=function(n){if(n>=e)return function(n){return ie(r,n)};var a=t(n+1|0),u=he(vr(r,n));return function(r){return ae(u,(function(r){return a}),r)}};if(e<=0)return function(r){throw[n,r]}("token must be a non-empty string");var a=t(0),u=function(r){return ae(ke,(function(r){return a}),r)};return function(n){return ce(r,u,n)}}function Ne(r,n){var e=function(r,n){return s(r,{location:{column:1,line:1},input_chars:ee(Gr(n))})}(r,n);if(e.tag)return p(1,[e[0]]);var t=e[0],a=t.remaining_chars,u=t.location;return a?p(1,[[{expecting:"End of input",actual:s(ne([p(11,["Characters remaining: ",p(2,[0,0])]),"Characters remaining: %s"]),Kr("",qr((function(r){return zr(1,r)}),a))),location:u},0]]):p(0,[{result:t.result,location:u,remaining_chars:a}])}var Ce=ae,Fe=se,qe=function(r,n){return function(e){return ae(r,(function(r){return n}),e)}},Se=function(r,n){return function(e){return ae(r,(function(r){return function(e){return ae(n,(function(n){return function(n){return ie(r,n)}}),e)}}),e)}};function Ae(r){var n=function(r){return r?r[4]:0},t=function(r,e,t,a){var u=n(r),i=n(a);return[r,e,t,a,u>=i?u+1|0:i+1|0]},u=function(r,n){return[0,r,n,0,1]},o=function(r,a,u,i){var o=r?r[4]:0,c=i?i[4]:0;if(o>(c+2|0)){if(r){var f=r[3],s=r[2],v=r[1],l=r[0];if(n(l)>=n(f))return t(l,v,s,t(f,a,u,i));if(f)return t(t(l,v,s,f[0]),f[1],f[2],t(f[3],a,u,i));throw[e,"Map.bal"]}throw[e,"Map.bal"]}if(c<=(o+2|0))return[r,a,u,i,o>=c?o+1|0:c+1|0];if(i){var d=i[3],h=i[2],g=i[1],m=i[0];if(n(d)>=n(m))return t(t(r,a,u,m),g,h,d);if(m)return t(t(r,a,u,m[0]),m[1],m[2],t(m[3],g,h,d));throw[e,"Map.bal"]}throw[e,"Map.bal"]},c=function(n,e,t){if(!t)return[0,n,e,0,1];var a=t[3],u=t[2],i=t[1],f=t[0],s=v(r.compare,n,i);if(0===s)return u===e?t:[f,n,e,a,t[4]];if(s<0){var l=c(n,e,f);return f===l?t:o(l,i,u,a)}var d=c(n,e,a);return a===d?t:o(f,i,u,d)},f=function(r){for(;;){var n=r;if(!n)throw a;var e=n[0];if(!e)return[n[1],n[2]];r=e}},d=function(r){for(;;){var n=r;if(!n)return;var e=n[0];if(!e)return[n[1],n[2]];r=e}},h=function(r){if(r){var n=r[0];return n?o(h(n),r[1],r[2],r[3]):r[3]}throw[e,"Map.remove_min_elt"]},g=function(r,n){if(!r)return n;if(!n)return r;var e=f(n);return o(r,e[0],e[1],h(n))},m=function(n,e){if(!e)return 0;var t=e[3],a=e[2],u=e[1],i=e[0],c=v(r.compare,n,u);if(0===c)return g(i,t);if(c<0){var f=m(n,i);return i===f?e:o(f,u,a,t)}var s=m(n,t);return t===s?e:o(i,u,a,s)},b=function(n,e,t){if(t){var a=t[3],u=t[2],i=t[1],c=t[0],f=v(r.compare,n,i);if(0===f){var l=s(e,gr(u));if(void 0===l)return g(c,a);var d=mr(l);return u===d?t:[c,n,d,a,t[4]]}if(f<0){var h=b(n,e,c);return c===h?t:o(h,i,u,a)}var m=b(n,e,a);return a===m?t:o(c,i,u,m)}var p=s(e,void 0);return void 0!==p?[0,n,mr(p),0,1]:0},p=function(r,n){for(;;){var e=n;if(!e)return;p(r,e[0]),v(r,e[1],e[2]),n=e[3]}},w=function(r,n){if(!n)return 0;var e=w(r,n[0]),t=s(r,n[2]),a=w(r,n[3]);return[e,n[1],t,a,n[4]]},y=function(r,n){if(!n)return 0;var e=n[1];return[y(r,n[0]),e,v(r,e,n[2]),y(r,n[3]),n[4]]},_=function(r,n,e){for(;;){var t=e,a=n;if(!a)return t;e=l(r,a[1],a[2],_(r,a[0],t)),n=a[3]}},k=function(r,n){for(;;){var e=n;if(!e)return!0;if(!v(r,e[1],e[2]))return!1;if(!k(r,e[0]))return!1;n=e[3]}},x=function(r,n){for(;;){var e=n;if(!e)return!1;if(v(r,e[1],e[2]))return!0;if(x(r,e[0]))return!0;n=e[3]}},N=function(r,n,e){return e?o(N(r,n,e[0]),e[1],e[2],e[3]):u(r,n)},C=function(r,n,e){return e?o(e[0],e[1],e[2],C(r,n,e[3])):u(r,n)},F=function(r,n,e,a){if(!r)return N(n,e,a);if(!a)return C(n,e,r);var u=a[4],i=r[4];return i>(u+2|0)?o(r[0],r[1],r[2],F(r[3],n,e,a)):u>(i+2|0)?o(F(r,n,e,a[0]),a[1],a[2],a[3]):t(r,n,e,a)},q=function(r,n){if(!r)return n;if(!n)return r;var e=f(n);return F(r,e[0],e[1],h(n))},S=function(r,n,e,t){return void 0!==e?F(r,n,mr(e),t):q(r,t)},A=function(n,e){if(!e)return[0,void 0,0];var t=e[3],a=e[2],u=e[1],i=e[0],o=v(r.compare,n,u);if(0===o)return[i,gr(a),t];if(o<0){var c=A(n,i);return[c[0],c[1],F(c[2],u,a,t)]}var f=A(n,t);return[F(i,u,a,f[0]),f[1],f[2]]},M=function(r,e,t){if(e){var a=e[1];if(e[4]>=n(t)){var u=A(a,t);return S(M(r,e[0],u[0]),a,l(r,a,gr(e[2]),u[1]),M(r,e[3],u[2]))}}else if(!t)return 0;if(t){var o=t[1],c=A(o,e);return S(M(r,c[0],t[0]),o,l(r,o,c[1],gr(t[2])),M(r,c[2],t[3]))}throw[i,["map.ml",393,10]]},L=function(r,n,e){if(!n)return e;if(!e)return n;var t=e[2],a=e[1],u=n[2],i=n[1];if(n[4]>=e[4]){var o=A(i,e),c=o[1],f=L(r,n[0],o[0]),s=L(r,n[3],o[2]);return void 0!==c?S(f,i,l(r,i,u,mr(c)),s):F(f,i,u,s)}var v=A(a,n),d=v[1],h=L(r,v[0],e[0]),g=L(r,v[2],e[3]);return void 0!==d?S(h,a,l(r,a,mr(d),t),g):F(h,a,t,g)},D=function(r,n){if(!n)return 0;var e=n[3],t=n[2],a=n[1],u=n[0],i=D(r,u),o=v(r,a,t),c=D(r,e);return o?u===i&&e===c?n:F(i,a,t,c):q(i,c)},$=function(r,n){if(!n)return[0,0];var e=n[2],t=n[1],a=$(r,n[0]),u=a[1],i=a[0],o=v(r,t,e),c=$(r,n[3]),f=c[1],s=c[0];return o?[F(i,t,e,s),q(u,f)]:[q(i,s),F(u,t,e,f)]},O=function(r,n){for(;;){var e=n,t=r;if(!t)return e;n=[t[1],t[2],t[3],e],r=t[0]}},R=function(r){return r?(R(r[0])+1|0)+R(r[3])|0:0},E=function(r,n){for(;;){var e=n,t=r;if(!e)return t;n=e[0],r=[[e[1],e[2]],E(t,e[3])]}};return{empty:0,is_empty:function(r){return!r},mem:function(n,e){for(;;){var t=e;if(!t)return!1;var a=v(r.compare,n,t[1]);if(0===a)return!0;e=a<0?t[0]:t[3]}},add:c,update:b,singleton:u,remove:m,merge:M,union:L,compare:function(n,e,t){for(var a=O(e,0),u=O(t,0);;){var i=u,o=a;if(!o)return i?-1:0;if(!i)return 1;var c=v(r.compare,o[0],i[0]);if(0!==c)return c;var f=v(n,o[1],i[1]);if(0!==f)return f;u=O(i[2],i[3]),a=O(o[2],o[3])}},equal:function(n,e,t){for(var a=O(e,0),u=O(t,0);;){var i=u,o=a;if(!o)return!i;if(!i)return!1;if(0!==v(r.compare,o[0],i[0]))return!1;if(!v(n,o[1],i[1]))return!1;u=O(i[2],i[3]),a=O(o[2],o[3])}},iter:p,fold:_,for_all:k,exists:x,filter:D,partition:$,cardinal:R,bindings:function(r){return E(0,r)},min_binding:f,min_binding_opt:d,max_binding:function(r){for(;;){var n=r;if(!n)throw a;var e=n[3];if(!e)return[n[1],n[2]];r=e}},max_binding_opt:function(r){for(;;){var n=r;if(!n)return;var e=n[3];if(!e)return[n[1],n[2]];r=e}},choose:f,choose_opt:d,split:A,find:function(n,e){for(;;){var t=e;if(!t)throw a;var u=v(r.compare,n,t[1]);if(0===u)return t[2];e=u<0?t[0]:t[3]}},find_opt:function(n,e){for(;;){var t=e;if(!t)return;var a=v(r.compare,n,t[1]);if(0===a)return gr(t[2]);e=a<0?t[0]:t[3]}},find_first:function(r,n){for(;;){var e=n;if(!e)throw a;var t=e[1];if(s(r,t))for(var u=t,i=e[2],o=e[0];;){var c=o;if(!c)return[u,i];var f=c[1];s(r,f)?(o=c[0],i=c[2],u=f):o=c[3]}n=e[3]}},find_first_opt:function(r,n){for(;;){var e=n;if(!e)return;var t=e[1];if(s(r,t))for(var a=t,u=e[2],i=e[0];;){var o=i;if(!o)return[a,u];var c=o[1];s(r,c)?(i=o[0],u=o[2],a=c):i=o[3]}n=e[3]}},find_last:function(r,n){for(;;){var e=n;if(!e)throw a;var t=e[1];if(s(r,t))for(var u=t,i=e[2],o=e[3];;){var c=o;if(!c)return[u,i];var f=c[1];s(r,f)?(o=c[3],i=c[2],u=f):o=c[0]}n=e[0]}},find_last_opt:function(r,n){for(;;){var e=n;if(!e)return;var t=e[1];if(s(r,t))for(var a=t,u=e[2],i=e[3];;){var o=i;if(!o)return[a,u];var c=o[1];s(r,c)?(i=o[3],u=o[2],a=c):i=o[0]}n=e[0]}},map:w,mapi:y}}function Me(r,n){var e=n.length;if(0===e)return[];for(var t=function(r,n){for(var e=new Array(r),t=0;t<r;++t)e[t]=n;return e}(e,s(r,n[0])),a=1;a<e;++a)t[a]=s(r,n[a]);return t}function Le(r){for(var n=r.length-1|0,e=0;;){var t=e,a=n;if(a<0)return t;e=[r[a],t],n=a-1|0}}function De(r,n,e){for(var t=e,a=n.length-1|0;a>=0;--a)t=v(r,n[a],t);return t}dr("Array.Bottom");function $e(r,n){if(n in r)return gr(r[n])}var Oe=function(r){var n=typeof r;return"string"===n?p(0,[r]):"number"===n?p(1,[r]):"boolean"===n?!0===r?1:0:null===r?2:Array.isArray(r)?p(3,[r]):p(2,[r])};function Re(r,n){return n.tag?n:r}function Ee(r,n){return n.tag?gr(n[0]):function(r){if(r.tag)return gr(r[0])}(r)}function Te(r){return r?r[4]:0}function Pe(r,n,e,t){var a=Te(r),u=Te(t);return[r,n,e,t,a>=u?a+1|0:u+1|0]}function Ie(r,n){return[0,r,n,0,1]}function Ve(r,n,t,a){var u=r?r[4]:0,i=a?a[4]:0;if(u>(i+2|0)){if(r){var o=r[3],c=r[2],f=r[1],s=r[0];if(Te(s)>=Te(o))return Pe(s,f,c,Pe(o,n,t,a));if(o)return Pe(Pe(s,f,c,o[0]),o[1],o[2],Pe(o[3],n,t,a));throw[e,"Map.bal"]}throw[e,"Map.bal"]}if(i<=(u+2|0))return[r,n,t,a,u>=i?u+1|0:i+1|0];if(a){var v=a[3],l=a[2],d=a[1],h=a[0];if(Te(v)>=Te(h))return Pe(Pe(r,n,t,h),d,l,v);if(h)return Pe(Pe(r,n,t,h[0]),h[1],h[2],Pe(h[3],d,l,v));throw[e,"Map.bal"]}throw[e,"Map.bal"]}function Ue(r,n,e){if(!e)return[0,r,n,0,1];var t=e[3],a=e[2],u=e[1],i=e[0],o=y(r,u);if(0===o)return a===n?e:[i,r,n,t,e[4]];if(o<0){var c=Ue(r,n,i);return i===c?e:Ve(c,u,a,t)}var f=Ue(r,n,t);return t===f?e:Ve(i,u,a,f)}function Qe(r){for(;;){var n=r;if(!n)throw a;var e=n[0];if(!e)return[n[1],n[2]];r=e}}function je(r){for(;;){var n=r;if(!n)return;var e=n[0];if(!e)return[n[1],n[2]];r=e}}function Xe(r){if(r){var n=r[0];return n?Ve(Xe(n),r[1],r[2],r[3]):r[3]}throw[e,"Map.remove_min_elt"]}function ze(r,n){if(!r)return n;if(!n)return r;var e=Qe(n);return Ve(r,e[0],e[1],Xe(n))}function Be(r,n,e,t){if(!r)return function r(n,e,t){return t?Ve(r(n,e,t[0]),t[1],t[2],t[3]):Ie(n,e)}(n,e,t);if(!t)return function r(n,e,t){return t?Ve(t[0],t[1],t[2],r(n,e,t[3])):Ie(n,e)}(n,e,r);var a=t[4],u=r[4];return u>(a+2|0)?Ve(r[0],r[1],r[2],Be(r[3],n,e,t)):a>(u+2|0)?Ve(Be(r,n,e,t[0]),t[1],t[2],t[3]):Pe(r,n,e,t)}function Ke(r,n){if(!r)return n;if(!n)return r;var e=Qe(n);return Be(r,e[0],e[1],Xe(n))}function Je(r,n,e,t){return void 0!==e?Be(r,n,mr(e),t):Ke(r,t)}function Ge(r,n){if(!n)return[0,void 0,0];var e=n[3],t=n[2],a=n[1],u=n[0],i=y(r,a);if(0===i)return[u,gr(t),e];if(i<0){var o=Ge(r,u);return[o[0],o[1],Be(o[2],a,t,e)]}var c=Ge(r,e);return[Be(u,a,t,c[0]),c[1],c[2]]}function He(r,n){for(;;){var e=n,t=r;if(!t)return e;n=[t[1],t[2],t[3],e],r=t[0]}}var We={empty:0,is_empty:function(r){return!r},mem:function(r,n){for(;;){var e=n;if(!e)return!1;var t=y(r,e[1]);if(0===t)return!0;n=t<0?e[0]:e[3]}},add:Ue,update:function r(n,e,t){if(t){var a=t[3],u=t[2],i=t[1],o=t[0],c=y(n,i);if(0===c){var f=s(e,gr(u));if(void 0===f)return ze(o,a);var v=mr(f);return u===v?t:[o,n,v,a,t[4]]}if(c<0){var l=r(n,e,o);return o===l?t:Ve(l,i,u,a)}var d=r(n,e,a);return a===d?t:Ve(o,i,u,d)}var h=s(e,void 0);return void 0!==h?[0,n,mr(h),0,1]:0},singleton:Ie,remove:function r(n,e){if(!e)return 0;var t=e[3],a=e[2],u=e[1],i=e[0],o=y(n,u);if(0===o)return ze(i,t);if(o<0){var c=r(n,i);return i===c?e:Ve(c,u,a,t)}var f=r(n,t);return t===f?e:Ve(i,u,a,f)},merge:function r(n,e,t){if(e){var a=e[1];if(e[4]>=Te(t)){var u=Ge(a,t);return Je(r(n,e[0],u[0]),a,l(n,a,gr(e[2]),u[1]),r(n,e[3],u[2]))}}else if(!t)return 0;if(t){var o=t[1],c=Ge(o,e);return Je(r(n,c[0],t[0]),o,l(n,o,c[1],gr(t[2])),r(n,c[2],t[3]))}throw[i,["map.ml",393,10]]},union:function r(n,e,t){if(!e)return t;if(!t)return e;var a=t[2],u=t[1],i=e[2],o=e[1];if(e[4]>=t[4]){var c=Ge(o,t),f=c[1],s=r(n,e[0],c[0]),v=r(n,e[3],c[2]);return void 0!==f?Je(s,o,l(n,o,i,mr(f)),v):Be(s,o,i,v)}var d=Ge(u,e),h=d[1],g=r(n,d[0],t[0]),m=r(n,d[2],t[3]);return void 0!==h?Je(g,u,l(n,u,mr(h),a),m):Be(g,u,a,m)},compare:function(r,n,e){for(var t=He(n,0),a=He(e,0);;){var u=a,i=t;if(!i)return u?-1:0;if(!u)return 1;var o=y(i[0],u[0]);if(0!==o)return o;var c=v(r,i[1],u[1]);if(0!==c)return c;a=He(u[2],u[3]),t=He(i[2],i[3])}},equal:function(r,n,e){for(var t=He(n,0),a=He(e,0);;){var u=a,i=t;if(!i)return!u;if(!u)return!1;if(0!==y(i[0],u[0]))return!1;if(!v(r,i[1],u[1]))return!1;a=He(u[2],u[3]),t=He(i[2],i[3])}},iter:function r(n,e){for(;;){var t=e;if(!t)return;r(n,t[0]),v(n,t[1],t[2]),e=t[3]}},fold:function r(n,e,t){for(;;){var a=t,u=e;if(!u)return a;t=l(n,u[1],u[2],r(n,u[0],a)),e=u[3]}},for_all:function r(n,e){for(;;){var t=e;if(!t)return!0;if(!v(n,t[1],t[2]))return!1;if(!r(n,t[0]))return!1;e=t[3]}},exists:function r(n,e){for(;;){var t=e;if(!t)return!1;if(v(n,t[1],t[2]))return!0;if(r(n,t[0]))return!0;e=t[3]}},filter:function r(n,e){if(!e)return 0;var t=e[3],a=e[2],u=e[1],i=e[0],o=r(n,i),c=v(n,u,a),f=r(n,t);return c?i===o&&t===f?e:Be(o,u,a,f):Ke(o,f)},partition:function r(n,e){if(!e)return[0,0];var t=e[2],a=e[1],u=r(n,e[0]),i=u[1],o=u[0],c=v(n,a,t),f=r(n,e[3]),s=f[1],l=f[0];return c?[Be(o,a,t,l),Ke(i,s)]:[Ke(o,l),Be(i,a,t,s)]},cardinal:function r(n){return n?(r(n[0])+1|0)+r(n[3])|0:0},bindings:function(r){return function r(n,e){for(;;){var t=e,a=n;if(!t)return a;e=t[0],n=[[t[1],t[2]],r(a,t[3])]}}(0,r)},min_binding:Qe,min_binding_opt:je,max_binding:function(r){for(;;){var n=r;if(!n)throw a;var e=n[3];if(!e)return[n[1],n[2]];r=e}},max_binding_opt:function(r){for(;;){var n=r;if(!n)return;var e=n[3];if(!e)return[n[1],n[2]];r=e}},choose:Qe,choose_opt:je,split:Ge,find:function(r,n){for(;;){var e=n;if(!e)throw a;var t=y(r,e[1]);if(0===t)return e[2];n=t<0?e[0]:e[3]}},find_opt:function(r,n){for(;;){var e=n;if(!e)return;var t=y(r,e[1]);if(0===t)return gr(e[2]);n=t<0?e[0]:e[3]}},find_first:function(r,n){for(;;){var e=n;if(!e)throw a;var t=e[1];if(s(r,t))for(var u=t,i=e[2],o=e[0];;){var c=o;if(!c)return[u,i];var f=c[1];s(r,f)?(o=c[0],i=c[2],u=f):o=c[3]}n=e[3]}},find_first_opt:function(r,n){for(;;){var e=n;if(!e)return;var t=e[1];if(s(r,t))for(var a=t,u=e[2],i=e[0];;){var o=i;if(!o)return[a,u];var c=o[1];s(r,c)?(i=o[0],u=o[2],a=c):i=o[3]}n=e[3]}},find_last:function(r,n){for(;;){var e=n;if(!e)throw a;var t=e[1];if(s(r,t))for(var u=t,i=e[2],o=e[3];;){var c=o;if(!c)return[u,i];var f=c[1];s(r,f)?(o=c[3],i=c[2],u=f):o=c[0]}n=e[0]}},find_last_opt:function(r,n){for(;;){var e=n;if(!e)return;var t=e[1];if(s(r,t))for(var a=t,u=e[2],i=e[3];;){var o=i;if(!o)return[a,u];var c=o[1];s(r,c)?(i=o[3],u=o[2],a=c):i=o[0]}n=e[0]}},map:function r(n,e){if(!e)return 0;var t=r(n,e[0]),a=s(n,e[2]),u=r(n,e[3]);return[t,e[1],a,u,e[4]]},mapi:function r(n,e){if(!e)return 0;var t=e[1];return[r(n,e[0]),t,v(n,t,e[2]),r(n,e[3]),e[4]]}},Ye=dr("Tea_json.Decoder.ParseFail");function Ze(r){return[function(n){var e=Oe(n);return"number"==typeof e&&e>=2?p(0,[r]):p(1,["Non-null value"])}]}function rt(r,n){var e=n[0];return[function(n){var t=Oe(n);if("number"==typeof t)return p(1,["Non-fieldable value"]);if(2!==t.tag)return p(1,["Non-fieldable value"]);var a=$e(t[0],r);if(void 0===a)return p(1,["Field Value is undefined: "+r]);var u=s(e,mr(a));return u.tag?p(1,["field `"+r+"` -> "+u[0]]):u}]}function nt(r){return[function(n){var e=function(r,n){for(;;){var t=n;if(!t)return p(1,["No one-of's matched"]);var a=t[1];try{var u=s(t[0][0],r);return u.tag?e(r,a):u}catch(r){n=a;continue}}};return e(n,r)}]}function et(r,n){var e=n[0];return[function(n){var t=s(e,n);return t.tag?p(1,["map "+t[0]]):p(0,[s(r,t[0])])}]}function tt(r,n){var e=n[0];return[function(n){var t=s(e,n);if(t.tag)return t;var a=s(r,t[0]);return s(a[0],n)}]}function at(r,n){try{return s(r[0],n)}catch(r){var e=pr(r);return e[0]===Ye?p(1,[e[1]]):p(1,["Unknown JSON parsing error"])}}var ut={ObjectDict:We,ParseFail:Ye,string:[function(r){var n=Oe(r);return"number"==typeof n||n.tag?p(1,["Non-string value"]):p(0,[n[0]])}],$$int:[function(r){var n=Oe(r);if("number"==typeof n)return p(1,["Non-int value"]);if(1!==n.tag)return p(1,["Non-int value"]);var e=n[0];return e>-2147483648&&e<2147483647?p(0,[0|e]):p(1,["number out of int range"])}],$$float:[function(r){var n=Oe(r);return"number"==typeof n||1!==n.tag?p(1,["Non-float-value"]):p(0,[n[0]])}],bool:[function(r){var n=Oe(r);if("number"!=typeof n)return p(1,["Non-boolean value"]);switch(n){case 0:return p(0,[!1]);case 1:return p(0,[!0]);case 2:return p(1,["Non-boolean value"])}}],$$null:Ze,list:function(r){var n=r[0];return[function(r){var e=Oe(r);if("number"==typeof e)return p(1,["Non-list value"]);if(3!==e.tag)return p(1,["Non-list value"]);try{return p(0,[qr((function(r){var e=s(n,r);if(!e.tag)return e[0];throw[Ye,e[0]]}),Le(e[0]))])}catch(r){var t=pr(r);if(t[0]===Ye)return p(1,["list -> "+t[1]]);throw t}}]},array:function(r){var n=r[0];return[function(r){var e=Oe(r);if("number"==typeof e)return p(1,["Non-array value"]);if(3!==e.tag)return p(1,["Non-array value"]);try{return p(0,[Me((function(r){var e=s(n,r);if(!e.tag)return e[0];throw[Ye,e[0]]}),e[0])])}catch(r){var t=pr(r);if(t[0]===Ye)return p(1,["array -> "+t[1]]);throw t}}]},keyValuePairs:function(r){var n=r[0];return[function(r){var e=Oe(r);if("number"==typeof e)return p(1,["Non-keyValuePair value"]);if(2!==e.tag)return p(1,["Non-keyValuePair value"]);var t=e[0],a=Object.keys(t);try{return p(0,[De((function(r,e){var a=$e(t,r);if(void 0!==a){var u=s(n,mr(a));if(!u.tag)return[[r,u[0]],e];throw[Ye,u[0]]}throw[Ye,"Key is undefined: "+r]}),a,0)])}catch(r){var u=pr(r);if(u[0]===Ye)return p(1,["Invalid keyValuePair parsing: "+u[1]]);throw u}}]},dict:function(r){var n=r[0];return[function(r){var e=Oe(r);if("number"==typeof e)return p(1,["Non-dict value"]);if(2!==e.tag)return p(1,["Non-dict value"]);var t=e[0],a=Object.keys(t);try{return p(0,[De((function(r,e){var a=$e(t,r);if(void 0!==a){var u=s(n,mr(a));if(!u.tag)return Ue(r,u[0],e);throw[Ye,u[0]]}throw[Ye,"Key is undefined: "+r]}),a,0)])}catch(r){var u=pr(r);if(u[0]===Ye)return p(1,["Invalid dict parsing: "+u[1]]);throw u}}]},field:rt,at:function(r,n){return function r(n,e,t){return e?v(n,e[0],r(n,e[1],t)):t}(rt,r,n)},index:function(r,n){var e=n[0];return[function(n){var t=Oe(n);if("number"==typeof t)return p(1,["Non-array value"]);if(3!==t.tag)return p(1,["Non-array value"]);var a=t[0];return r<0||r>a.length?p(1,["Array index out of range: "+String(r)]):s(e,c(a,r))}]},maybe:function(r){var n=r[0];return[function(r){var e=s(n,r);return e.tag?p(0,[void 0]):p(0,[gr(e[0])])}]},oneOf:nt,map:et,map2:function(r,e,t){var a=t[0],u=e[0];return[function(e){var t=s(u,e),i=s(a,e);if(!t.tag&&!i.tag)return p(0,[v(r,t[0],i[0])]);var o=Ee(t,i);if(void 0!==o)return p(1,["map2 -> "+o]);throw[n,"Impossible case"]}]},map3:function(r,e,t,a){var u=a[0],i=t[0],o=e[0];return[function(e){var t=s(o,e),a=s(i,e),c=s(u,e);if(!t.tag&&!a.tag&&!c.tag)return p(0,[l(r,t[0],a[0],c[0])]);var f=Re(c,Re(a,t));if(f.tag)return p(1,["map3 -> "+f[0]]);throw[n,"Impossible case"]}]},map4:function(r,e,t,a,u){var i=u[0],o=a[0],c=t[0],f=e[0];return[function(e){var t=s(f,e),a=s(c,e),u=s(o,e),v=s(i,e);if(!(t.tag||a.tag||u.tag||v.tag))return p(0,[d(r,t[0],a[0],u[0],v[0])]);var l=Re(v,Re(u,Re(a,t)));if(l.tag)return p(1,["map4 -> "+l[0]]);throw[n,"Impossible case"]}]},map5:function(r,e,t,a,u,i){var o=i[0],c=u[0],f=a[0],v=t[0],l=e[0];return[function(e){var t=s(l,e),a=s(v,e),u=s(f,e),i=s(c,e),d=s(o,e);if(!(t.tag||a.tag||u.tag||i.tag||d.tag))return p(0,[h(r,t[0],a[0],u[0],i[0],d[0])]);var g=Re(d,Re(i,Re(u,Re(a,t))));if(g.tag)return p(1,["map5 -> "+g[0]]);throw[n,"Impossible case"]}]},map6:function(r,e,t,a,u,i,o){var c=o[0],f=i[0],v=u[0],l=a[0],d=t[0],h=e[0];return[function(e){var t=s(h,e),a=s(d,e),u=s(l,e),i=s(v,e),o=s(f,e),m=s(c,e);if(!(t.tag||a.tag||u.tag||i.tag||o.tag||m.tag))return p(0,[g(r,t[0],a[0],u[0],i[0],o[0],m[0])]);var b=Re(m,Re(o,Re(i,Re(u,Re(a,t)))));if(b.tag)return p(1,["map6 -> "+b[0]]);throw[n,"Impossible case"]}]},map7:function(r,e,t,a,u,i,o,c){var f=c[0],v=o[0],l=i[0],d=u[0],h=a[0],g=t[0],b=e[0];return[function(e){var t=s(b,e),a=s(g,e),u=s(h,e),i=s(d,e),o=s(l,e),c=s(v,e),w=s(f,e);if(!(t.tag||a.tag||u.tag||i.tag||o.tag||c.tag||w.tag))return p(0,[m(r,t[0],a[0],u[0],i[0],o[0],c[0],w[0])]);var y=Re(w,Re(c,Re(o,Re(i,Re(u,Re(a,t))))));if(y.tag)return p(1,["map7 -> "+y[0]]);throw[n,"Impossible case"]}]},map8:function(r,e,t,a,u,i,o,c,f){var v=f[0],l=c[0],d=o[0],h=i[0],g=u[0],m=a[0],w=t[0],y=e[0];return[function(e){var t=s(y,e),a=s(w,e),u=s(m,e),i=s(g,e),o=s(h,e),c=s(d,e),f=s(l,e),_=s(v,e);if(!(t.tag||a.tag||u.tag||i.tag||o.tag||c.tag||f.tag||_.tag))return p(0,[b(r,t[0],a[0],u[0],i[0],o[0],c[0],f[0],_[0])]);var k=Re(_,Re(f,Re(c,Re(o,Re(i,Re(u,Re(a,t)))))));if(k.tag)return p(1,["map8 -> "+k[0]]);throw[n,"Impossible case"]}]},succeed:function(r){return[function(n){return p(0,[r])}]},fail:function(r){return[function(n){return p(1,[r])}]},value:[function(r){return p(0,[r])}],andThen:tt,lazy_:function(r){return tt(r,[function(r){return p(0,[void 0])}])},nullable:function(r){return nt([Ze(void 0),[et((function(r){return gr(r)}),r),0]])},decodeValue:at,decodeEvent:function(r,n){try{return s(r[0],n)}catch(r){var e=pr(r);return e[0]===Ye?p(1,[e[1]]):p(1,["Unknown JSON parsing error"])}},decodeString:function(r,n){try{return at(r,JSON.parse(n))}catch(r){return p(1,["Invalid JSON string"])}}};function it(r){return p(1,[r])}function ot(r,n,e,t){return tn("","div",void 0!==r?r:"",void 0!==n?n:"",e,t)}function ct(r,n,e,t){return tn("","span",void 0!==r?r:"",void 0!==n?n:"",e,t)}function ft(r,n,e,t){return tn("","h3",void 0!==r?r:"",void 0!==n?n:"",e,t)}function st(r,n,e,t){return tn("","label",void 0!==r?r:"",void 0!==n?n:"",e,t)}function vt(r,n,e,t){return tn("","ul",void 0!==r?r:"",void 0!==n?n:"",e,t)}function lt(r,n,e,t){return tn("","li",void 0!==r?r:"",void 0!==n?n:"",e,t)}function dt(r){return p(0,["className",r])}function ht(r){return p(0,["value",r])}function gt(r,n){return function(r,n){return an("input",void 0!==r?r:"",(function(r){var e=r.target;if(void 0!==e){var t=e.value;return void 0!==t?s(n,t):void 0}}))}(void 0!==r?r:"",(function(r){return gr(s(n,r))}))}function mt(r){return function(r,n){return p(3,[r,p(1,[n]),{contents:void 0}])}("click",r)}var bt={stopPropagation:!1,preventDefault:!1};function pt(r,n,e){return an(r,"",(function(r){return n.stopPropagation&&r.stopPropagation(),n.preventDefault&&r.preventDefault(),function(r){return r.tag?void 0:gr(r[0])}(ut.decodeEvent(e,r))}))}ut.at(["target",["value",0]],ut.string),ut.at(["target",["checked",0]],ut.bool);var wt=ut.field("keyCode",ut.$$int);var yt={max:function(r){return p(1,["","max",r])},min:function(r){return p(1,["","min",r])},step:function(r){return p(1,["","step",r])},disabled:function(r){return r?p(1,["","disabled","true"]):0},selected:function(r){return r?p(1,["","selected","true"]):0},acceptCharset:function(r){return p(1,["","accept-charset",r])},rel:function(r){return p(1,["","rel",r])}},_t=en,kt=dr("CamlinternalLazy.Undefined");function xt(r){throw kt}function Nt(r){var n=0|r.tag;return 250===n?r[0]:246!==n?r:function(r){var n,e=r[0];r[0]=xt;try{var t=s(e,void 0);return r[0]=t,n=250,r.tag=n,t}catch(n){throw r[0]=function(r){throw n},n}}(r)}var Ct={keydown:function(r){var n,e,t=ut.field("ctrlKey",ut.bool),a=ut.map2((function(r,n){return{ctrlKey:n,keyCode:r}}),wt,t);return n="keydown",e=ut.andThen(r,a),pt(n,bt,e)}};function Ft(r){return[r,0]}function qt(r,n){if(!n)return 0;var e=n[1];return[s(r,n[0]),k((function(n){return qt(r,Nt(e))}))]}function St(r,n){if(!r)return Nt(n);var e=r[1];return[r[0],k((function(r){return St(Nt(n),e)}))]}function At(r){if(!r)return 0;var n=r[1];return St(r[0],k((function(r){return At(Nt(n))})))}function Mt(r,n){return At(qt(n,r))}var Lt={$$return:Ft,unit:Ft,push:function(r,n){return[r,n]},map:qt,filter:function r(n,e){for(;;){var t=e;if(!t)return 0;var a=t[1],u=t[0];if(s(n,u))return[u,k(function(e){return function(t){return r(n,Nt(e))}}(a))];e=Nt(a)}},interleave_delayed:St,append_delayed:function r(n,e){if(!n)return Nt(e);var t=n[1];return[n[0],k((function(n){return r(Nt(t),e)}))]},flatten:At,bind:Mt,$great$great$eq:Mt,from_list:function r(n){if(!n)return 0;var e=n[1];return[n[0],k((function(n){return r(e)}))]},from_option:function(r){return void 0!==r?[mr(r),0]:0}};function Dt(r,n){return[v(ne([p(2,[0,p(4,[0,0,0,0])]),"%s%d"]),r[0],n)]}function $t(r){return s(ne([p(12,[63,p(2,[0,0])]),"?%s"]),r[0])}var Ot={compare:function(r,n){return y(r[0],n[0])},make_numbered:Dt,to_string:$t};function Rt(r,n){return r[0]===n[0]}var Et={compare:function(r,n){return y(r[0],n[0])},equals:Rt,to_string:function(r){return r[0]}};function Tt(r){if(!r.tag)return $t(r[0]);var n=r[0],e=n.related_terms,t=n.relation_name[0];return e?v(ne([p(12,[91,p(2,[0,p(11,[": ",p(2,[0,p(12,[93,0])])])])]),"[%s: %s]"]),t,Kr(", ",qr(Tt,e))):t}function Pt(r){if(!r.tag)return 0;var n=r[0],e=n.related_terms;return[[n.relation_name[0],xr(e)],Dr(qr(Pt,e))]}var It={to_string:Tt,relation_arities:Pt};function Vt(r){switch(0|r.tag){case 0:return Tt(r[0]);case 1:return v(ne([p(12,[60,p(2,[0,p(11,[" = ",p(2,[0,p(12,[62,0])])])])]),"<%s = %s>"]),Tt(r[0]),Tt(r[1]));case 2:return v(ne([p(12,[60,p(2,[0,p(11,[" /= ",p(2,[0,p(12,[62,0])])])])]),"<%s /= %s>"]),Tt(r[0]),Tt(r[1]))}}function Ut(r){switch(0|r.tag){case 0:return Pt(r[0])}return Dr([Pt(r[0]),[Pt(r[1]),0]])}var Qt={to_string:Vt,relation_arities:Ut},jt=Ae(Ot),Xt=jt.empty;function zt(r,n){return l(jt.add,r[0],r[1],n)}function Bt(r,n){var e=v(jt.find_opt,r,n);if(void 0!==e){if(e.tag)return e;var t=Bt(e[0],n);return void 0!==t?t:e}}function Kt(r,n){var e=function(r){var e=Bt(r,n);return void 0!==e?a(e):p(0,[["?"]])},t=function(r,n){if(n.tag)return Ar(t,r,n[0].related_terms);var a=n[0];return zt([a,e(a)],r)},a=function(r){if(!r.tag)return e(r[0]);var n=r[0];return p(1,[{relation_name:n.relation_name,related_terms:qr(a,n.related_terms)}])};return s(jt.bindings,Ar((function(r,n){switch(0|n.tag){case 0:return t(r,n[0])}return t(t(r,n[0]),n[1])}),Xt,r))}function Jt(r,n,e){var t=function(r){for(;;){var a=r;if(a.tag)return Mr(t,a[0].related_terms);var u=a[0];if(x(u,n))return!0;var i=Bt(u,e);if(void 0===i)return!1;r=i}};return t(r)}var Gt={FrameMap:jt,empty:Xt,extend:zt,lookup:Bt,instantiate:function(r){var n=function(e){if(!e.tag){var t=Bt(e[0],r);return void 0!==t?n(t):p(0,[["?"]])}var a=e[0];return p(1,[{relation_name:a.relation_name,related_terms:qr(n,a.related_terms)}])};return n},variable_bindings_in_query:Kt,to_strings:function(r,n){var e=Kt(r,n);return e?qr((function(r){return v(ne([p(2,[0,p(11,[" := ",p(2,[0,0])])]),"%s := %s"]),$t(r[0]),Tt(r[1]))}),e):0},term_depends_on_variable:Jt};var Ht={contents:0};function Wt(r){if(!r.tag)return p(0,[Dt(r[0],Ht.contents)]);var n=r[0],e=qr(Wt,n.related_terms);return p(1,[{relation_name:n.relation_name,related_terms:e}])}function Yt(r){switch(0|r.tag){case 0:return p(0,[Wt(r[0])]);case 1:return p(1,[Wt(r[0]),Wt(r[1])]);case 2:return p(2,[Wt(r[0]),Wt(r[1])])}}function Zt(r){return Ht.contents=Ht.contents+1|0,{antecedents:qr(Yt,r.antecedents),consequent:Wt(r.consequent)}}var ra={to_string:function(r){var n=Kr(", ",qr(Vt,r.antecedents));return v(ne([p(12,[40,p(2,[0,p(11,[") => ",p(2,[0,0])])])]),"(%s) => %s"]),n,Tt(r.consequent))},relation_arities:function(r){return Dr([Fr(qr(Ut,r.antecedents)),[Pt(r.consequent),0]])},rename_rule_variables:Zt},na=Ae({compare:Hr});function ea(r){return r.rule}var ta=na.empty;function aa(r,n){var e;if(n.tag){var t=v(na.find_opt,n[0].relation_name[0],r.indexed_by_consequent_relation);e=void 0!==t?t:0}else e=r.all_rules;return Lt.from_list(Cr(e))}var ua={contents:1};var ia={VariableName:Ot,RelationName:Et,Term:It,ComplexTerm:Qt,Frame:Gt,Rule:ra,RuleDatabase:{rule_from_entry:ea,empty:{all_rules:0,indexed_by_consequent_relation:ta},fetch_for_query:aa,remove_rule:function(r,n){var e=n.id,t=$r((function(r){return r.id!==e})),a=s(t,r.all_rules),u=n.rule.consequent;return u.tag?{all_rules:a,indexed_by_consequent_relation:l(na.update,u[0].relation_name[0],(function(r){return void 0!==r?s(t,r):0}),r.indexed_by_consequent_relation)}:{all_rules:a,indexed_by_consequent_relation:r.indexed_by_consequent_relation}},add_rule:function(r,n){var e={id:(ua.contents=ua.contents+1|0,ua.contents),rule:n},t=n.consequent;return t.tag?{all_rules:[e,r.all_rules],indexed_by_consequent_relation:l(na.update,t[0].relation_name[0],(function(r){return void 0!==r?[e,r]:[e,0]}),r.indexed_by_consequent_relation)}:{all_rules:[e,r.all_rules],indexed_by_consequent_relation:r.indexed_by_consequent_relation}},all_rules:function(r){return r.all_rules},is_same:function(r,n){return r.id===n.id}}};function oa(r){var n=he(95),e=function(r){return Fe(_e,n,r)},t=s(ne([p(2,[0,p(11,[" requires ",p(2,[0,0])])]),"%s requires %s"]),r),a=function(r){return oe(t,e,r)};return function(r){return Ce(a,(function(r){return fe((function(n){return Kr("",qr((function(r){return zr(1,r)}),[r,n]))}),function r(n){var e=function(e){return ae(n,(function(e){var t=r(n);return function(r){return ae(t,(function(r){var n=[e,r];return function(r){return ie(n,r)}}),r)}}),e)};return function(r){return se(e,(function(r){return ie(0,r)}),r)}}(ve([_e,[we,[he(95),[he(45),0]]]])))}),r)}}var ca=qe(he(63),fe((function(r){return p(0,[[r]])}),oa("Variable")));function fa(r){return ce("Variable starting with ?",ca,r)}var sa=qe(xe("= "),(function(r){return ie(!0,r)})),va=qe(xe("/= "),(function(r){return ie(!1,r)}));function la(r){return Fe(sa,va,r)}function da(r){return le(r,qe(qe(ke,xe("and")),ke))}function ha(r){return Fe(fa,ga,r)}function ga(r){return Ce(Se(oa("Relation"),ke),(function(r){var n=[r],e=p(1,[{relation_name:n,related_terms:0}]),t=Se(he(40),ke);return function(r){return ue(t,(function(r){return fe((function(r){return p(1,[{relation_name:n,related_terms:r}])}),Se(Se(ba,ke),he(41)))}),e,r)}}),r)}function ma(r){return Ce(qe(he(60),ha),(function(r){return function(n){return Ce(la,(function(n){var e=Se(ha,he(62));return function(t){return Ce(e,(function(e){var t=p(n?1:2,[r,e]);return function(r){return ie(t,r)}}),t)}}),n)}}),r)}function ba(r){return le(Se(ha,ke),qe(he(44),ke))(r)}function pa(r){return Fe(fe((function(r){return p(0,[r])}),ha),ma,r)}function wa(r){return da(pa)(r)}var ya=function(r){return Se((function(r){return Ce(ha,(function(r){var n={antecedents:0,consequent:r},e=function(r){return ie(n,r)},t=fe((function(n){return{antecedents:n,consequent:r}}),qe(qe(qe(ke,xe("when")),ke),wa));return function(r){return Fe(t,e,r)}}),r)}),he(46))(r)},_a=function(r){return da(pa)(r)};function ka(r){var n=function(r,n){for(var e=0,t=0,a=n;;){var u=a,i=t,o=e;if(!u)return[Nr(o,0),Nr(i,0)];var c=u[1],f=u[0];s(r,f)?(a=c,e=[f,o]):(a=c,t=[f,i])}}((function(r){switch(0|r.tag){case 0:case 1:return!1;case 2:return!0}}),r);return Dr([n[1],[n[0],0]])}function xa(r,n){var t=function(r,n){for(;;){var e=n,t=r;if(!t)return e;n=a(t[0],e),r=t[1]}},a=function(n,e){switch(0|n.tag){case 0:var a=n[0];return Lt.$great$great$eq(e,(function(n){return Lt.$great$great$eq(aa(r,a),(function(r){var e=Zt(ea(r)),i=u(a,e.consequent,n);return void 0!==i?t(e.antecedents,Lt.$$return({frame:i.frame,rules_applied:[r,i.rules_applied]})):0}))}));case 1:var i=n[1],o=n[0];return Lt.$great$great$eq(e,(function(r){return Lt.from_option(u(o,i,r))}));case 2:var c=n[1],f=n[0];return Lt.$great$great$eq(e,(function(r){return void 0!==u(f,c,r)?0:Lt.$$return(r)}))}},u=function(r,n,t){if(x(r,n))return t;if(!r.tag)return i(r[0],n,t);var a=r[0];if(!n.tag)return i(n[0],r,t);var o=n[0];return Rt(a.relation_name,o.relation_name)?Ar((function(r,n){if(void 0!==r)return u(n[0],n[1],r)}),t,function r(n,t){if(n){if(t)return[[n[0],t[0]],r(n[1],t[1])];throw[e,"List.combine"]}if(!t)return 0;throw[e,"List.combine"]}(a.related_terms,o.related_terms)):void 0},i=function(r,n,e){var t=Bt(r,e.frame);if(void 0!==t)return u(t,n,e);if(n.tag)return Jt(n,r,e.frame)?void 0:{frame:zt([r,n],e.frame),rules_applied:e.rules_applied};var a=Bt(n[0],e.frame);return void 0!==a?u(p(0,[r]),a,e):{frame:zt([r,n],e.frame),rules_applied:e.rules_applied}},o=ka(n);return function(r){return t(o,r)}}var Na={query:function(r,n){return xa(r,n)(Lt.$$return({frame:Xt,rules_applied:0}))}};function Ca(r,n){return{text:r,parse_result:Ne(n,r)}}function Fa(r){var n=r.solution_stream;return n?{initiating_query:r.initiating_query,solution_stream:Nt(n[1]),displayed_solutions:[n[0],r.displayed_solutions]}:r}var qa={ParsedTextEditing:{empty:function(r){return{text:"",parse_result:p(1,[0])}},make:Ca},ExecutingQueryInfo:{next_solution:Fa},init:function(r){return{rule_database:ia.RuleDatabase.empty,interaction_mode:p(0,[{text:"",parse_result:p(1,[0])}])}}};var Sa={loadRulesFromLocation:function(r){return p(0,[r])},updateText:function(r){return p(1,[r])},switchToAddRule:0,switchToEditQuery:1,addRule:function(r){return p(2,[r])},deleteRule:function(r){return p(3,[r])},executeQuery:function(r){return p(4,[r])},nextFrame:2};function Aa(r){"remove"in Element.prototype||(Element.prototype.remove=function(){this.parentNode&&this.parentNode.removeChild(this)}),function(){for(var r=0,n=["ms","moz","webkit","o"],e=0;e<n.length&&!window.requestAnimationFrame;++e)window.requestAnimationFrame=window[n[e]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[n[e]+"CancelAnimationFrame"]||window[n[e]+"CancelRequestAnimationFrame"];window.requestAnimationFrame||(window.requestAnimationFrame=function(n,e){var t=(new Date).getTime(),a=Math.max(0,16-(t-r)),u=window.setTimeout((function(){n(t+a)}),a);return r=t+a,u}),window.cancelAnimationFrame||(window.cancelAnimationFrame=function(r){clearTimeout(r)})}()}function Ma(r,n,e,t,a,u){if(void 0===u)return function(u){var i={contents:0},o=function(r){var n=s(e,r);i.contents=wn(u,u,i.contents,n)};return{startup:function(r){pn(u,a),o(t)},render_string:function(r){return un(s(n,r))},handleMsg:function(n,e){var t=v(r,n,e),a=t[0];return pn(u,t[1]),o(a),a},shutdown:function(r){pn(u,r),i.contents=wn(u,u,i.contents,0)}}};var i=mr(u);return function(u){var o={contents:0},c={contents:t},f={contents:void 0},l=function(r){if(void 0!==f.contents){var e=[s(n,c.contents),0],t=function(r,n,e,t){return bn(r,n,n.childNodes,0,e,t),t}(u,i,o.contents,e);o.contents=t,f.contents=void 0}},d=function(r){for(;i.childNodes.length>0;){var n=i.firstChild;null!==n&&i.removeChild(n)}},h={contents:0},g=function(r){var n=s(e,r);h.contents=wn(u,u,h.contents,n)};return{startup:function(r){d(),pn(u,a),g(c.contents),f.contents=-1,l()},render_string:function(r){return un(s(n,r))},handleMsg:function(n,e){var t=v(r,n,e),a=t[0];return c.contents=a,pn(u,t[1]),void 0!==f.contents||(f.contents=-1,l()),g(a),a},shutdown:function(r){f.contents=void 0,pn(u,r),h.contents=wn(u,u,h.contents,0),o.contents=0,d()}}}}function La(r,e,t){Aa();var a=s(r.init,t),u=a[0],i=null==e?void 0:gr(e);return function(r,e,t){var a={contents:r},u={contents:{enqueue:function(r){console.log("INVALID enqueue CALL!")}}},i=s(e,u),o={contents:void 0},c=function(r){var e=o.contents;if(void 0===e){o.contents=0;var t=v(i.handleMsg,a.contents,r);a.contents=t;var u=o.contents;if(void 0!==u)return u?(o.contents=void 0,Sr(c,Cr(u))):void(o.contents=void 0);throw[n,"INVALID message queue state, should never be None during message processing!"]}o.contents=[r,e]},f={enqueue:c};return u.contents=f,s(i.startup,void 0),{pushMsg:c,shutdown:function(r){u.contents={enqueue:function(r){console.log("INVALID message enqueued when shut down")}};var n=s(t,a.contents);s(i.shutdown,n)},getHtmlString:function(r){return s(i.render_string,a.contents)}}}(u,Ma(r.update,r.view,r.subscriptions,u,a[1],i),r.shutdown)}function Da(r){return{href:r.href,protocol:r.protocol,host:r.host,hostname:r.hostname,port:r.port,pathname:r.pathname,search:r.search,hash:r.hash,username:r.username,password:r.password,origin:r.origin}}var $a={contents:void 0};function Oa(r){return function(r,n){return p(1,[r,function(r){return s(n,r.contents)},{contents:void 0}])}("navigation",(function(n){$a.contents=function(e){return s(n.enqueue,s(r,e))};var e,t,a,u=function(r){var n;void 0!==(n=$a.contents)&&s(n,Da(document.location))};return e="popstate",t=u,a=!1,window.addEventListener(e,t,a),function(r){return function(r,n,e){return window.removeEventListener(r,n,e)}("popstate",u,!1)}}))}function Ra(r,n,e){var t,a,u,i,o=void 0===r||r;return t=void 0,a=void 0,u=[mt(e),[yt.disabled(!o),0]],i=[it(n),0],tn("","button",void 0!==t?t:"",void 0!==a?a:"",u,i)}var Ea="\n        button {\n            background-color: white;\n            color: "+String("#48a9dc")+";\n            box-shadow: 0 0 0 1px "+String("#48a9dc")+";\n            border: none;\n            padding: 6px;\n            margin-left: 4px;\n            font-size: 14px;\n        }\n\n        button:active {\n            background-color: "+String("#48a9dc")+";\n            color: white;\n        }\n\n        button:disabled {\n            background-color: #ddd;\n            color: #90adbd;\n        }\n\n        a, a:active, a:visited {\n            display: inline-block;\n            color: "+String("#48a9dc")+"\n        }\n\n        a, a:active, a:visited {\n            display: inline-block;\n            color: "+String("#48a9dc")+"\n        }\n    ";function Ta(r,n){return ot(void 0,void 0,[dt("panel-container"),0],[ot(void 0,void 0,[dt("header"),0],[it(r),0]),[ot(void 0,void 0,[dt("panel-body"),0],n),0]])}var Pa="\n        div."+String("header")+" {\n            background-color: blue;\n            color: white;\n            font-weight: bold;\n            padding: 4px;\n        }        \n\n        div."+String("panel-container")+" {\n            float: left;\n            margin: 5px;\n            width: 48%;\n            border: solid 1px #aaa;\n        }\n\n        div."+String("panel-body")+" {\n            padding: 6px;\n        }\n    ",Ia="\n        ."+String("variable")+" {\n            color: #ff0; \n        }\n\n        ."+String("fact")+" {\n            color: #0f0;\n        }\n        \n        ."+String("relation")+" {\n            color: #4af;\n        }\n\n        ."+String("punctuation")+" {\n            color: white;\n            font-weight: bold;\n        }\n\n        ."+String("rule-display")+" {\n            background-color: black;\n            font-family: Consolas, monospace;\n            padding: 4px;\n        }\n\n        ."+String("rule-item")+" {\n            border: solid 1px #888;\n            margin-bottom: 10px;\n            background-color: white;\n        }\n\n        ."+String("rule-item")+"."+String("rule-used")+" {\n            border: solid 2px #44f;\n            background-color: yellow;            \n        }\n\n        ul {\n            list-style: none;\n            margin-block-start: 0;\n            margin-block-end: 0;\n        }\n    ";function Va(r){return ct(void 0,void 0,[dt("punctuation"),0],[it(r),0])}function Ua(r){if(!r.tag)return ct(void 0,void 0,[dt("variable"),0],[it(r[0][0]),0]);var n=r[0],e=n.related_terms,t=n.relation_name[0];return e?ct(void 0,void 0,0,[ct(void 0,void 0,[dt("relation"),0],[it(t),0]),[Va("("),[Ua(e[0]),[ct(void 0,void 0,0,qr((function(r){return ct(void 0,void 0,0,[Va(", "),[Ua(r),0]])}),e[1])),[Va(")"),0]]]]]):ct(void 0,void 0,[dt("fact"),0],[it(t),0])}function Qa(r){switch(0|r.tag){case 0:return Ua(r[0]);case 1:return ct(void 0,void 0,0,[Ua(r[0]),[Va("="),[Ua(r[1]),0]]]);case 2:return ct(void 0,void 0,0,[Ua(r[0]),[Va("/="),[Ua(r[1]),0]]])}}function ja(r,n,e,t){var a,u,i=r.parse_result;if(i.tag)a=0;else{var o=i[0].result;a=s(Ct.keydown,(function(r){return 13===r.keyCode&&r.ctrlKey?ut.succeed(s(e,o)):ut.fail("Expecting Ctrl-Enter")}))}u=r.parse_result.tag?_t:ot(void 0,void 0,0,[it(s(ne([p(11,["(ctrl+enter to ",p(2,[0,p(12,[41,0])])]),"(ctrl+enter to %s)"]),n)),0]);var c,f,l,d,h,g,m=r.parse_result;return c=m.tag?function(r){var n=Or(te,r);if(!n)return _t;var e=n[0],t=$r((function(r){return te(r,e)<=0}))(n[1]),a=[e,t];return ot(void 0,void 0,[dt("errors-container"),0],[ft(void 0,void 0,0,[it("Parse Messages"),0]),[vt(void 0,void 0,0,qr((function(r){return lt(void 0,void 0,0,[st(void 0,void 0,0,[it(s(ne([p(11,["At ",p(2,[0,0])]),"At %s"]),(n=r.location,v(ne([p(11,["Ln ",p(4,[0,0,0,p(11,[", Col ",p(4,[0,0,0,0])])])]),"Ln %d, Col %d"]),n.line,n.column)))),0]),[st(void 0,void 0,0,[it(s(ne([p(11,["; Expecting ",p(2,[0,0])]),"; Expecting %s"]),r.expecting)),0]),[st(void 0,void 0,0,[it(s(ne([p(11,["; Got ",p(2,[0,0])]),"; Got %s"]),r.actual)),0]),0]]]);var n}),a)),0]])}(m[0]):Ra(void 0,n,s(e,m[0].result)),ot(void 0,void 0,0,[(f=void 0,l=void 0,d=[gt(void 0,Sa.updateText),[dt("language-editing"),[(g=t,p(0,["placeholder",g])),[ht(r.text),[a,0]]]]],h=0,tn("","textarea",void 0!==f?f:"",void 0!==l?l:"",d,h)),[u,[c,0]]])}function Xa(r){var n,e=s(ia.RuleDatabase.all_rules,r.rule_database),t=function(r){return ot(void 0,void 0,0,qr((function(n){return e=r,t=n,f=s(ia.RuleDatabase.rule_from_entry,t),l=f.antecedents,d=Mr((function(r){return v(ia.RuleDatabase.is_same,r,t)}),e),h=function(r,n){return lt(void 0,void 0,0,[Va(r),[Qa(n),0]])},ot(void 0,void 0,[(c=[["rule-item",!0],[["rule-used",d],0]],p(0,["className",Kr(" ",qr((function(r){return r[0]}),$r((function(r){return r[1]}))(c)))])),0],[(a=void 0,u=void 0,i=[mt(Sa.deleteRule(t)),0],o=[it("Delete"),0],tn("","a",void 0!==a?a:"",void 0!==u?u:"",i,o)),[ot(void 0,void 0,[dt("rule-display"),0],[Ua(f.consequent),[l?vt(void 0,void 0,0,[h("when ",l[0]),qr((function(r){return h("and ",r)}),l[1])]):_t,0]]),0]]);var e,t,a,u,i,o,c,f,l,d,h}),e))},a=r.interaction_mode;switch(0|a.tag){case 0:n=ot(void 0,void 0,0,[ja(a[0],"Add Rule",Sa.addRule,"New rule..."),[Ra(void 0,"Cancel and Query",1),[t(0),0]]]);break;case 1:n=t(0);break;case 2:var u=a[0].solution_stream;n=t(u?u[0].rules_applied:0)}return Ta("Rules",[n,0])}function za(r){var n,e,t,a,u,i=r.interaction_mode;switch(0|i.tag){case 0:n=_t;break;case 1:n=ot(void 0,void 0,0,[ja(i[0],"Execute Query",Sa.executeQuery,"New query..."),[Ra(void 0,"Cancel and Add Rule",0),0]]);break;case 2:e=i[0],t=e.solution_stream,a=e.initiating_query,u=function(r){var n=v(ia.Frame.to_strings,a,r.frame);return n?ot(void 0,void 0,0,[ft(void 0,void 0,0,[it("Satisfied:"),0]),[vt(void 0,void 0,0,qr((function(r){return lt(void 0,void 0,0,[it(r),0])}),n)),0]]):ft(void 0,void 0,0,[it("Satisfied"),0])},n=ot(void 0,void 0,0,[ot(void 0,void 0,0,qr(u,e.displayed_solutions)),[t?ot(void 0,void 0,0,[u(t[0]),[Ra(void 0,"Next Frame",2),[Ra(void 0,"Cancel and New Query",1),[Ra(void 0,"Cancel and Add Rule",0),0]]]]):Ra(void 0,"Another Query",1),0]])}return Ta("Query",[n,0])}var Ba=Kr(" ",["\n        body {\n            background-color: #eee;\n            display: flex;\n            flex-direction: column;\n            font-family: sans-serif;\n        }\n\n        p {\n            font-size: 14px;\n        }\n    ",[Ea,[Pa,[Ia,["\n        input {\n            margin-left: 6px;\n        }          \n        \n        ."+String("language-editing")+" {\n            width: 96%;\n            font-family: Consolas, monospace;\n            background-color: black;\n            color: white;\n        }\n\n        ."+String("errors-container")+" h3 {\n            font-size: 16px;\n            font-weight: bold;            \n        }\n    ",["",["",0]]]]]]]);var Ka=function(r,n){var e={init:function(r){return v(n.init,r,Da(document.location))},update:n.update,view:n.view,subscriptions:function(e){return p(0,[[Oa(r),[s(n.subscriptions,e),0]]])},shutdown:n.shutdown};return function(r,n){return La(e,r,n)}}(Sa.loadRulesFromLocation,{init:function(r,n){return[qa.init(void 0),0]},update:function(r,n){var e,t=r.interaction_mode,a=r.rule_database;if("number"==typeof n)switch(n){case 0:e={rule_database:a,interaction_mode:p(0,[{text:"",parse_result:p(1,[0])}])};break;case 1:e={rule_database:a,interaction_mode:p(1,[{text:"",parse_result:p(1,[0])}])};break;case 2:switch(0|t.tag){case 0:case 1:e={rule_database:a,interaction_mode:t};break;case 2:e={rule_database:a,interaction_mode:p(2,[Fa(t[0])])}}}else switch(0|n.tag){case 0:e={rule_database:a,interaction_mode:t};break;case 1:var u=n[0];switch(0|t.tag){case 0:e={rule_database:a,interaction_mode:p(0,[Ca(u,ya)])};break;case 1:e={rule_database:a,interaction_mode:p(1,[Ca(u,_a)])};break;case 2:e={rule_database:a,interaction_mode:t}}break;case 2:e={rule_database:v(ia.RuleDatabase.add_rule,a,n[0]),interaction_mode:p(0,[{text:"",parse_result:p(1,[0])}])};break;case 3:e={rule_database:v(ia.RuleDatabase.remove_rule,a,n[0]),interaction_mode:t};break;case 4:var i=n[0];e={rule_database:a,interaction_mode:p(2,[{initiating_query:i,solution_stream:Na.query(a,i),displayed_solutions:0}])}}return[e,0]},view:function(r){return ot(void 0,void 0,0,[Xa(r),[za(r),0]])},subscriptions:function(r){return 0},shutdown:function(r){return 0}});return r.main=function(r,n){var e=document.createElement("style");return document.head.appendChild(e),e.innerHTML=Ba,v(Ka,r,void 0)},r}({});
