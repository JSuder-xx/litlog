var starter=function(e){"use strict";var w=["Failure",-2],F=["Invalid_argument",-3],S=["Division_by_zero",-5],M=["Not_found",-6],s=["Match_failure",-7],E=["Assert_failure",-10];function o(e,r,n){for(var t=new Array(n),a=0,i=r;a<n;)t[a]=e[i],a=a+1|0,i=i+1|0;return t}function le(e,r){if(r<0||r>=e.length)throw[F,"index out of bounds"];return e[r]}function y(e,r){for(;;){var n=r,t=e,a=t.length,i=0===a?1:a,u=i-n.length|0;if(0==u)return t.apply(null,n);if(0<=u)return function(r,n){return function(e){return y(r,n.concat([e]))}}(t,n);r=o(n,i,0|-u),e=t.apply(null,o(n,0,i))}}function ve(u,o){var e=u.length;if(1===e)return u(o);switch(e){case 1:return u(o);case 2:return function(e){return u(o,e)};case 3:return function(e,r){return u(o,e,r)};case 4:return function(e,r,n){return u(o,e,r,n)};case 5:return function(e,r,n,t){return u(o,e,r,n,t)};case 6:return function(e,r,n,t,a){return u(o,e,r,n,t,a)};case 7:return function(e,r,n,t,a,i){return u(o,e,r,n,t,a,i)};default:return y(u,[o])}}function D(i,u,o){var e=i.length;if(2===e)return i(u,o);switch(e){case 1:return y(i(u),[o]);case 2:return i(u,o);case 3:return function(e){return i(u,o,e)};case 4:return function(e,r){return i(u,o,e,r)};case 5:return function(e,r,n){return i(u,o,e,r,n)};case 6:return function(e,r,n,t){return i(u,o,e,r,n,t)};case 7:return function(e,r,n,t,a){return i(u,o,e,r,n,t,a)};default:return y(i,[u,o])}}function C(a,i,u,o){var e=a.length;if(3===e)return a(i,u,o);switch(e){case 1:return y(a(i),[u,o]);case 2:return y(a(i,u),[o]);case 3:return a(i,u,o);case 4:return function(e){return a(i,u,o,e)};case 5:return function(e,r){return a(i,u,o,e,r)};case 6:return function(e,r,n){return a(i,u,o,e,r,n)};case 7:return function(e,r,n,t){return a(i,u,o,e,r,n,t)};default:return y(a,[i,u,o])}}function ee(e,r){return r.tag=e,r}function h(e,r){return e===r?0:e<r?-1:1}w.tag=248,F.tag=248,S.tag=248,M.tag=248,s.tag=248,E.tag=248;var p=function(e,r){for(var n in e)r(n)};function i(e){var r=[e];return r.tag=246,r}function m(e,r){for(;;){var n=r,t=e;if(t===n)return!0;var a=typeof t;if("string"==a||"number"==a||"boolean"==a||"undefined"==a||null===t)return!1;var i=typeof n;if("function"==a||"function"==i)throw[F,"equal: functional value"];if("number"==i||"undefined"==i||null===n)return!1;var u=0|t.tag,o=0|n.tag;if(250!=u)if(250!=o){if(248==u)return t[1]===n[1];if(251==u)throw[F,"equal: abstract value"];if(u!=o)return!1;if(256==u)return t[1]===n[1];var c=0|t.length;if(c!=(0|n.length))return!1;if(!Array.isArray(t)){if(t instanceof Date&&n instanceof Date)return!(n<t||t<n);var s={contents:!0},f=function(r,n){return function(e){r.hasOwnProperty(e)||(n.contents=!1)}}(n,s),l=function(r,n,t){return function(e){r.hasOwnProperty(e)&&m(n[e],r[e])||(t.contents=!1)}}(t,n,s);return p(t,f),s.contents&&p(n,l),s.contents}for(var v=0;;){var d=v;if(d===c)return!0;if(!m(t[d],n[d]))return!1;v=d+1|0}}else r=n[0];else e=t[0]}}function re(e,r){return!m(e,r)}function g(e){if(e<0)throw[F,"String.create"];for(var r=new Array(e),n=0;n<e;++n)r[n]=0;return r}function b(e,r,n,t,a){if(!(a<=0))if(e!==n){var i=e.length-r|0;if(a<=i)for(var u=0;u<a;++u)n[t+u|0]=e[r+u|0];else{for(var o=0;o<i;++o)n[t+o|0]=e[r+o|0];for(var c=i;c<a;++c)n[t+c|0]=0}}else{if(r<t){for(var s=(e.length-t|0)-1|0,f=a-1|0,l=f<s?f:s;0<=l;--l)e[t+l|0]=e[r+l|0];return}if(r<=t)return;for(var v=(e.length-r|0)-1|0,d=a-1|0,h=d<v?d:v,p=0;p<=h;++p)e[t+p|0]=e[r+p|0]}}function f(e){var r=e.length,n="",t=r;if(r<=4096&&r===e.length)return String.fromCharCode.apply(null,e);for(var a=0;0<t;){var i=t<1024?t:1024,u=new Array(i);b(e,a,u,0,i),n+=String.fromCharCode.apply(null,u),t=t-i|0,a=a+i|0}return n}function c(e,r,n,t,a){if(!(a<=0)){var i=e.length-r|0;if(a<=i)for(var u=0;u<a;++u)n[t+u|0]=e.charCodeAt(r+u|0);else{for(var o=0;o<i;++o)n[t+o|0]=e.charCodeAt(r+o|0);for(var c=i;c<a;++c)n[t+c|0]=0}}}function l(e){for(var r=e.length,n=new Array(r),t=0;t<r;++t)n[t]=e.charCodeAt(t);return n}var v=Math.imul||function(e,r){return((e>>16)*(r|=0)<<16)+(65535&e)*r|0};function k(e,r){return[r,e>>>0]}var x=[-2147483648,0],r=[2147483647,4294967295],A=[0,1],N=[0,0],O=[-1,4294967295];function u(e){return 0!=(2147483648&e)}function d(e){return 0==(2147483648&e)}function R(e){var r=1+(-1^e[1])|0;return k(r,(-1^e[0])+(0==r?1:0)|0)}function _(e,r,n){var t=e[1],a=t+r|0,i=u(t)&&(u(r)||d(a))||u(r)&&d(a)?1:0;return k(a,e[0]+n+i|0)}function q(e,r){return _(e,r[1],r[0])}function T(e,r){return e[0]===r[0]&&e[1]===r[1]}function L(e,r,n){var t=1+(-1^r)>>>0;return _(e,t,(-1^n)+(0==t?1:0)|0)}function I(e,r){return L(e,r[1],r[0])}function P(e,r){for(;;){var n,t=r,a=e,i=0,u=0;if(0!==a[0])u=3;else{if(0===a[1])return N;u=3}if(3===u)if(0!==t[0])i=2;else{if(0===t[1])return N;i=2}if(2===i){var o=a[0],c=0;if(-2147483648!==o||0!==a[1]?c=3:n=t[1],3===c){var s=t[0],f=a[1],l=0;if(-2147483648!==s||0!==t[1]?l=4:n=f,4===l){var v=t[1];if(o<0){if(0<=s)return R(P(R(a),t));r=R(t),e=R(a);continue}if(s<0)return R(P(a,R(t)));var d=65535&o,h=f>>>16,p=65535&f,m=65535&s,g=v>>>16,b=65535&v,w=0,y=0,_=0,S=p*b,w=(y=(y=(_=(S>>>16)+h*b)>>>16)+((_=(65535&_)+p*g)>>>16)+d*b)>>>16;return w+=(y=(65535&y)+h*g)>>>16,w+=(y=(65535&y)+p*m)>>>16,k(65535&S|(65535&_)<<16,(y&=65535)|(w=(o>>>16)*b+d*g+h*m+p*(s>>>16)+w&65535)<<16)}}}return 0==(1&n)?N:x}}function W(e,r){var n=r[0],t=e[0];return n<t||!(t<n)&&e[1]>=r[1]}function $(e,r){return!T(e,r)}function J(e,r){return!W(e,r)}function Z(e){return 4294967296*e[0]+e[1]}function Q(e){return isNaN(e)||!isFinite(e)?N:e<=-0x8000000000000000?x:0x8000000000000000<=e+1?r:e<0?R(Q(-e)):k(e%4294967296|0,e/4294967296|0)}function B(e){if(n=(r=e)[0],0==(t=n>>21)||-1==t&&(0!==r[1]||-2097152!==n))return String(Z(e));var r,n,t;if(e[0]<0)return T(e,x)?"-9223372036854775808":"-"+B(R(e));var a=Q(Math.floor(Z(e)/10)),i=a[1],u=a[0],o=L(L(e,i<<3,i>>>29|u<<3),i<<1,i>>>31|u<<1),c=o[1],s=o[0];if(0===c&&0===s)return B(a)+"0";if(s<0){var f=1+(-1^c)>>>0,l=Math.ceil(f/10),v=10*l-f;return B(L(a,0|l,0))+String(0|v)}var d=c,h=Math.floor(d/10),p=d-10*h;return B(_(a,0|h,0))+String(0|p)}function V(e,r){for(;;){var n=r,t=e,a=0,i=0;if(0===n[0]&&0===n[1])throw S;if((i=3)===i){var u=t[0];if(-2147483648!==u)if(0!==u)a=2;else{if(0===t[1])return N;a=2}else if(0!==t[1])a=2;else{if(T(n,A)||T(n,O))return t;if(T(n,x))return A;var o=function(e,r){if(0===r)return e;var n=e[1];return 32<=r?k(0,n<<(r-32|0)):k(n<<r,n>>>(32-r|0)|e[0]<<r)}(V(function(e,r){if(0===r)return e;var n=e[0];return r<32?k(n<<(32-r|0)|e[1]>>>r,n>>r):k(n>>(r-32|0),0<=n?0:-1)}(t,1),n),1),c=0;if(0!==o[0])c=4;else{if(0===o[1])return n[0]<0?A:R(A);c=4}if(4===c)return q(o,V(I(t,P(n,o)),n))}}if(2===a&&-2147483648===n[0]&&0===n[1])return N;var s=n[0];if(!(t[0]<0)){if(s<0)return R(V(t,R(n)));for(var f=N,l=t;W(l,n);){for(var v=(y=1,(_=Math.floor(Z(l)/Z(n)))<y?y:_),d=Math.ceil(Math.log(v)/Math.LN2),h=d<=48?1:Math.pow(2,d-48),p=Q(v),m=P(p,n);m[0]<0||(w=l,(b=m)[0]>w[0]||!(b[0]<w[0])&&b[1]>w[1]);)m=P(p=Q(v-=h),n);0===(g=p)[0]&&0===g[1]&&(p=A),f=q(f,p),l=I(l,m)}return f}if(0<=s)return R(V(R(t),n));r=R(n),e=R(t)}var g,b,w,y,_}function z(e,r){var n=V(e,r);return[n,I(e,P(n,r))]}function H(e){return 0|e[1]}function U(e){function r(e){return(e>>>0).toString(16)}var n=e[1],t=e[0];if(0===t&&0===n)return"0";if(0===n)return r(t)+"00000000";if(0===t)return r(n);var a=r(n),i=8-a.length|0;return i<=0?r(t)+a:r(t)+("0".repeat(i)+a)}function j(e){return[2147483647&e[0],e[1]]}function G(n){var e=n.length;if(31<e)throw[F,"format_int: format too long"];for(var r,t={justify:"+",signstyle:"-",filter:" ",alternate:!1,base:2,signedconv:!1,width:0,uppercase:!1,sign:1,prec:-1,conv:"f"},a=0;;){var i=a;if(e<=i)return t;var u=n.charCodeAt(i),o=0;if(69<=u)if(88<=u)if(121<=u)o=1;else switch(u-88|0){case 0:t.base=1,t.uppercase=!0,a=i+1|0;continue;case 13:case 14:case 15:o=5;break;case 12:case 17:o=4;break;case 23:a=i+1|(t.base=0);continue;case 29:t.base=2,a=i+1|0;continue;case 1:case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 16:case 18:case 19:case 20:case 21:case 22:case 24:case 25:case 26:case 27:case 28:case 30:case 31:o=1;break;case 32:a=i+(t.base=1)|0;continue}else{if(!(72<=u)){t.signedconv=!0,t.uppercase=!0,t.conv=String.fromCharCode(65<=(r=u)&&r<=90||192<=r&&r<=214||216<=r&&r<=222?r+32|0:r),a=i+1|0;continue}o=1}else switch(u){case 35:t.alternate=!0,a=i+1|0;continue;case 32:case 43:o=2;break;case 45:t.justify="-",a=i+1|0;continue;case 46:for(var c=i+1|(t.prec=0);function(r){return function(){var e=n.charCodeAt(r)-48|0;return 0<=e&&e<=9}}(c)();)t.prec=(v(t.prec,10)+n.charCodeAt(c)|0)-48|0,c=c+1|0;a=c;continue;case 33:case 34:case 36:case 37:case 38:case 39:case 40:case 41:case 42:case 44:case 47:o=1;break;case 48:t.filter="0",a=i+1|0;continue;case 49:case 50:case 51:case 52:case 53:case 54:case 55:case 56:case 57:o=3;break;default:o=1}switch(o){case 1:a=i+1|0;continue;case 2:t.signstyle=String.fromCharCode(u),a=i+1|0;continue;case 3:t.width=0;for(var s=i;function(r){return function(){var e=n.charCodeAt(r)-48|0;return 0<=e&&e<=9}}(s)();)t.width=(v(t.width,10)+n.charCodeAt(s)|0)-48|0,s=s+1|0;a=s;continue;case 4:t.signedconv=!0,t.base=2,a=i+1|0;continue;case 5:t.signedconv=!0,t.conv=String.fromCharCode(u),a=i+1|0;continue}}}function X(e,r){var n=e.justify,t=e.signstyle,a=e.filter,i=e.alternate,u=e.base,o=e.signedconv,c=e.width,s=e.uppercase,f=e.sign,l=r.length;o&&(f<0||"-"!==t)&&(l=l+1|0),i&&(0===u?l=l+1|0:1===u&&(l=l+2|0));var v="";if("+"===n&&" "===a)for(var d=l;d<c;++d)v+=a;if(o&&(f<0?v+="-":"-"!==t&&(v+=t)),i&&0===u&&(v+="0"),i&&1===u&&(v+="0x"),"+"===n&&"0"===a)for(var h=l;h<c;++h)v+=a;if(v=s?v+r.toUpperCase():v+r,"-"===n)for(var p=l;p<c;++p)v+=" ";return v}function Y(e,r){if("%d"===e)return String(r);var n,t=G(e),a=(r<0?t.signedconv?(t.sign=-1,-r):r>>>0:r).toString(function(e){switch(e){case 0:return 8;case 1:return 16;case 2:return 10}}(t.base));return 0<=t.prec&&(t.filter=" ",0<(n=t.prec-a.length|0)&&(a="0".repeat(n)+a)),X(t,a)}function n(e,r){if("%d"===e)return B(r);var n,t,a,i=G(e),u=i.signedconv&&J(r,N)?(i.sign=-1,R(r)):r;switch(i.base){case 0:n=function(e){var r="",n=k(8,0),t="01234567";if(J(e,N)){var a=z(j(e),n),i=q(k(0,268435456),a[0]);for(r=t[H(a[1])]+r;$(i,N);)var u=z(i,n),i=u[0],r=t[H(u[1])]+r}else{var o=z(e,n),c=o[0];for(r=t[H(o[1])]+r;$(c,N);){var s=z(c,n),c=s[0];r=t[H(s[1])]+r}}return r}(u);break;case 1:n=U(u);break;case 2:n=function(e){if(!J(e,N))return B(e);var r=k(10,0),n=z(j(e),r),t=z(q(k(8,0),n[1]),r);return B(q(q(k(-858993460,214748364),n[0]),t[0]))+"0123456789"[H(t[1])]}(u)}return a=0<=i.prec?(i.filter=" ",0<(t=i.prec-n.length|0)?"0".repeat(t)+n:n):n,X(i,a)}var K=function(e,r,n){if(!isFinite(e))return isNaN(e)?"nan":0<e?"infinity":"-infinity";var t=(0!=e||1/e!=-1/0)&&0<=e?0:1;t&&(e=-e);var a=0;if(0!=e)if(e<1)for(;e<1&&-1022<a;)e*=2,a--;else for(;2<=e;)e/=2,a++;var i,u=a<0?"":"+",o="";if(t)o="-";else switch(n){case 43:o="+";break;case 32:o=" "}0<=r&&r<13&&(i=Math.pow(2,4*r),e=Math.round(e*i)/i);var c,s,f=e.toString(16);return 0<=r&&((c=f.indexOf("."))<0?f+="."+"0".repeat(r):(s=c+1+r,f.length<s?f+="0".repeat(s-f.length):f=f.substr(0,s))),o+"0x"+f+"p"+u+a.toString(10)},t=Y,a=Y;function ne(e,r){if(r>=e.length||r<0)throw[F,"index out of bounds"];return e.charCodeAt(r)}var te={contents:0};function ae(e){var r=[e,(te.contents=te.contents+1,te.contents)];return r.tag=248,r}var ie=[];function ue(e){if(void 0===e){var r=[ie,0];return r.tag=256,r}if(null===e||e[0]!==ie)return e;var n=e[1]+1|0,t=[ie,n];return t.tag=256,t}function oe(e){if(null===e||e[0]!==ie)return e;var r=e[1];return 0===r?void 0:[ie,r-1|0]}var ce=ae("Caml_js_exceptions.Error");function se(e){return function(e){if(void 0!==e){if(248===e.tag)return 1;var r=e[0];return void 0!==r&&248===r.tag}}(e)?e:[ce,e]}function fe(e){if("number"==typeof e)return 0;switch(0|e.tag){case 0:return ee(0,[fe(e[0])]);case 1:return ee(1,[fe(e[0])]);case 2:return ee(2,[fe(e[0])]);case 3:return ee(3,[fe(e[0])]);case 4:return ee(4,[fe(e[0])]);case 5:return ee(5,[fe(e[0])]);case 6:return ee(6,[fe(e[0])]);case 7:return ee(7,[fe(e[0])]);case 8:return ee(8,[e[0],fe(e[1])]);case 9:var r=e[0];return ee(9,[r,r,fe(e[2])]);case 10:return ee(10,[fe(e[0])]);case 11:return ee(11,[fe(e[0])]);case 12:return ee(12,[fe(e[0])]);case 13:return ee(13,[fe(e[0])]);case 14:return ee(14,[fe(e[0])])}}function de(e,r){if("number"==typeof e)return r;switch(0|e.tag){case 0:return ee(0,[de(e[0],r)]);case 1:return ee(1,[de(e[0],r)]);case 2:return ee(2,[de(e[0],r)]);case 3:return ee(3,[de(e[0],r)]);case 4:return ee(4,[de(e[0],r)]);case 5:return ee(5,[de(e[0],r)]);case 6:return ee(6,[de(e[0],r)]);case 7:return ee(7,[de(e[0],r)]);case 8:return ee(8,[e[0],de(e[1],r)]);case 9:return ee(9,[e[0],e[1],de(e[2],r)]);case 10:return ee(10,[de(e[0],r)]);case 11:return ee(11,[de(e[0],r)]);case 12:return ee(12,[de(e[0],r)]);case 13:return ee(13,[de(e[0],r)]);case 14:return ee(14,[de(e[0],r)])}}ae("Pervasives.Exit");function he(e){return 0<=e?e:0|-e}function pe(e){return e?"true":"false"}function me(e){for(var r=0,n=e;;){if(!n)return r;n=n[1],r=r+1|0}}function ge(e,r){for(;;){if(!e)return r;r=[e[0],r],e=e[1]}}function be(e){return ge(e,0)}function we(e){return e?function e(r,n){return r?[r[0],e(r[1],n)]:n}(e[0],we(e[1])):0}function ye(e,r){return r?[ve(e,r[0]),ye(e,r[1])]:0}function _e(e,r){for(;;){var n=r;if(!n)return;ve(e,n[0]),r=n[1]}}function Se(e,r,n){for(;;){var t=n;if(!t)return r;n=t[1],r=D(e,r,t[0])}}function ke(e,r){if(e){if(r)return[[e[0],r[0]],ke(e[1],r[1])];throw[F,"List.combine"]}if(!r)return 0;throw[F,"List.combine"]}var xe=we,Ae=function(o){return function(e){for(var r=0,n=e;;){var t=n,a=r;if(!t)return ge(a,0);var i=t[1],u=t[0];ve(o,u)?(n=i,r=[u,a]):n=i}}};function Ne(e){return 97<=e&&e<=122?e-32|0:e}function Oe(e,r){var n=g(e);return function(e,r,n,t){if(!(n<=0))for(var a=r,i=n+r|0;a<i;++a)e[a]=t}(n,0,e,r),n}var Re=[];function qe(e,r,n){if(r<0||n<0||r>(e.length-n|0))throw[F,"String.sub / Bytes.sub"];var t=g(n);return b(e,r,t,0,n),t}function Te(e,r,n){return f(qe(e,r,n))}function Le(e,r,n,t,a){if(a<0||r<0||r>(e.length-a|0)||t<0||t>(n.length-a|0))throw[F,"Bytes.blit"];return b(e,r,n,t,a),0}function Fe(e,r,n,t,a){if(a<0||r<0||r>(e.length-a|0)||t<0||t>(n.length-a|0))throw[F,"String.blit / Bytes.blit_string"];return c(e,r,n,t,a)}function Me(e){var r=e-9|0;return 4<r||r<0?23==r:2!=r}function Ee(e){for(var r,n,t,a=0,i=0,u=e.length;i<u;++i)var o,c=e[i],a=a+(32<=c?58<(o=c-34|0)||o<0?93<=o?4:1:57<o||o<1?2:1:11<=c?13!==c?4:2:8<=c?2:4)|0;if(a===e.length)return n=(r=e).length,t=g(n),b(r,0,t,0,n),t;for(var s=g(a),f=a=0,l=e.length;f<l;++f){var v=e[f],d=0;if(35<=v)92!==v?127<=v?d=1:s[a]=v:d=2;else if(32<=v)34<=v?d=2:s[a]=v;else if(14<=v)d=1;else switch(v){case 8:s[a]=92,s[a=a+1|0]=98;break;case 9:s[a]=92,s[a=a+1|0]=116;break;case 10:s[a]=92,s[a=a+1|0]=110;break;case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:case 11:case 12:d=1;break;case 13:s[a]=92,s[a=a+1|0]=114}switch(d){case 1:s[a]=92,s[a=a+1|0]=48+(v/100|0)|0,s[a=a+1|0]=48+(v/10|0)%10|0,s[a=a+1|0]=48+v%10|0;break;case 2:s[a]=92,s[a=a+1|0]=v}a=a+1|0}return s}function De(e){return function(e,r){var n=r.length;if(0===n)return r;for(var t=g(n),a=0;a<n;++a)t[a]=ve(e,r[a]);return t}(Ne,e)}function Ce(e,r){return f(Oe(e,r))}function Ie(e,r,n){for(;;){if(!n)return e;var t=n[1],a=n[0];if(!t)return a.length+e|0;n=t,e=function(e,r){if(r<=e)return e;throw[F,"String.concat"]}((a.length+r|0)+e|0,e)}}function Pe(e,r){if(!r)return"";var n=e.length;return f(function(e,r,n,t,a){for(;;){var i=r;if(!a)return e;var u=a[1],o=a[0];if(!u)return c(o,0,e,i,o.length),e;c(o,0,e,i,o.length),c(n,0,e,i+o.length|0,t),a=u,r=(i+o.length|0)+t|0}}(g(Ie(0,n,r)),0,e,n,r))}function We(e){var r=e-9|0;return 4<r||r<0?23==r:2!=r}function $e(e){return""===e||!We(e.charCodeAt(0))&&!We(e.charCodeAt(e.length-1|0))?e:f(function(e){for(var r=e.length,n=0;n<r&&Me(e[n]);)n=n+1|0;for(var t=r-1|0;n<=t&&Me(e[t]);)t=t-1|0;return n<=t?qe(e,n,1+(t-n|0)|0):Re}(l(e)))}var Je=h,Ze=Fe;function Qe(e,r,n,t){var a,i,u=void 0!==r&&r,o=e.style;return void 0!==o.setProperty?o.setProperty(n,t,u?"important":null):(a=n,i=t,void(e.style[a]=i))}function Be(e,r,n){return e.insertBefore(r,n)}function Ve(e,r,n,t){return""===r?e.setAttribute(n,t):e.setAttributeNS(r,n,t)}function ze(e,r){return""===e?document.createElement(r):document.createElementNS(e,r)}var He=ee(0,[""]);function Ue(e,r,n,t,a,i){return ee(2,[e,r,n,t,a,i])}function je(e,r,n){return ee(3,[e,ee(0,[r,n]),{contents:void 0}])}function Ge(e){for(;;){var r=e;switch(0|r.tag){case 0:return"\x3c!-- "+r[0]+" --\x3e";case 1:return r[0];case 2:var n=r[1],t=r[0];return Pe("",["<",[t,[""===t?"":":",[n,[Pe("",ye(function(e){if("number"==typeof e)return"";switch(0|e.tag){case 0:return Pe("",[" ",[e[0],['="',[e[1],['"',0]]]]]);case 1:return Pe("",[" ",[e[1],['="',[e[2],['"',0]]]]]);case 2:return Pe("",[" data-",[e[0],['="',[e[1],['"',0]]]]]);case 3:return"";case 4:return Pe("",[' style="',[Pe(";",ye(function(e){return Pe("",[e[0],[":",[e[1],[";",0]]]])},e[0])),['"',0]]])}},r[4])),[">",[Pe("",ye(Ge,r[5])),["</",[n,[">",0]]]]]]]]]]);case 3:e=ve(r[1],void 0);continue;case 4:e=r[1];continue}}}function Xe(e){if(!e.tag)return e[1];var r=e[0];return function(e){return ue(r)}}function Ye(e,r,n,t){var a,i,u,o,c,s={contents:Xe(t)},f=(a=e,i=s,function(e){var r=ve(i.contents,e);if(void 0!==r)return ve(a.contents.enqueue,oe(r))});return u=n,o=f,c=!1,r.addEventListener(u,o,c),{handler:f,cb:s}}function Ke(e,r,n){if(void 0!==n)return t=e,a=r,i=n.handler,u=!1,void t.removeEventListener(a,i,u);var t,a,i,u}function er(e,r,n,t,a,i,u,o){var c,s,f=u.contents;if(void 0!==f)if(n!==t){u.contents=Ke(r,n,u.contents),o.contents=Ye(e,r,t,i)}else{if(o.contents=u.contents,c=a,(s=i).tag?c.tag&&m(s[0],c[0]):!c.tag&&s[0]===c[0])return;var l=Xe(i);f.cb.contents=l}else o.contents=Ye(e,r,t,i)}function rr(e,r,n,t,a){!function(n,e){var r,t,a;if("number"!=typeof e)switch(0|e.tag){case 0:return n[e[0]]=void 0;case 1:return r=n,t=e[0],a=e[1],""===t?r.removeAttribute(a):r.removeAttributeNS(t,a);case 2:throw console.log(["TODO:  Remove Data Unhandled",e[0],e[1]]),[w,"TODO:  Remove Data Unhandled"];case 3:var i=e[2];return i.contents=Ke(n,e[0],i.contents);case 4:Se(function(e,r){return Qe(n,void 0,r[0],null)},void 0,e[0])}}(r,t),function(e,n,r){if("number"!=typeof r)switch(0|r.tag){case 0:return n[r[0]]=r[1];case 1:return Ve(n,r[0],r[1],r[2]);case 2:throw console.log(["TODO:  Add Data Unhandled",r[0],r[1]]),[w,"TODO:  Add Data Unhandled"];case 3:return r[2].contents=Ye(e,n,r[0],r[1]);case 4:Se(function(e,r){return Qe(n,void 0,r[0],r[1])},void 0,r[0])}}(e,r,a)}function nr(e,u,r,n,t){if("number"==typeof t)throw[w,"This should never be called as all entries through NoProp are gated."];switch(0|t.tag){case 0:return void(u[t[0]]=t[1]);case 1:return Ve(u,t[0],t[1],t[2]);case 2:throw console.log(["TODO:  Mutate Data Unhandled",t[0],t[1]]),[w,"TODO:  Mutate Data Unhandled"];case 3:throw[w,"This will never be called because it is gated"];case 4:if("number"==typeof n)throw[w,"Passed a non-Style to a new Style as a Mutations while the old Style is not actually a style!"];if(4===n.tag)return function(e,r,n,t){for(;;){var a=t,i=n,u=r;if(i){if(a){t=a[1],n=i[1],r=C(e,u,i[0],a[0]);continue}throw[F,"List.fold_left2"]}if(a)throw[F,"List.fold_left2"];return u}}(function(e,r,n){var t=n[1],a=n[0],i=r[0];return i===a?r[1]===t?void 0:Qe(u,void 0,a,t):(Qe(u,void 0,i,null),Qe(u,void 0,a,t))},void 0,n[0],t[0]);throw[w,"Passed a non-Style to a new Style as a Mutations while the old Style is not actually a style!"]}}function tr(e,r,n,t){return function(e,r,n,t){for(;;){var a=t,i=n;if(!i)return!a;var u=i[0];if(!a)return!1;if("number"==typeof u){if("number"==typeof a[0]){t=a[1],n=i[1],0;continue}}else switch(0|u.tag){case 0:var o=a[0];if("number"==typeof o||o.tag)break;u[0]===o[0]&&u[1]===o[1]||nr(0,r,0,u,o),t=a[1],n=i[1],0;continue;case 1:var c=a[0];if("number"==typeof c||1!==c.tag)break;u[0]===c[0]&&u[1]===c[1]&&u[2]===c[2]||nr(0,r,0,u,c),t=a[1],n=i[1],0;continue;case 2:var s=a[0];if("number"==typeof s||2!==s.tag)break;u[0]===s[0]&&u[1]===s[1]||nr(0,r,0,u,s),t=a[1],n=i[1],0;continue;case 3:var f=a[0];if("number"==typeof f||3!==f.tag)break;er(e,r,u[0],f[0],u[1],f[1],u[2],f[2]),t=a[1],n=i[1],0;continue;case 4:var l=a[0];if("number"==typeof l||4!==l.tag)break;m(u[0],l[0])||nr(0,r,0,u,l),t=a[1],n=i[1],0;continue}rr(e,r,0,u,a[0]),t=a[1],n=i[1],0}}(e,r,n,t)}function ar(e,r,n,t,a){if(2!==a.tag)throw[w,"Node replacement should never be passed anything but a node itself"];var i=a[4],u=le(n,t),o=ze(a[0],a[1]);if(tr(e,o,ye(function(e){return 0},i),i))return or(e,o,o.childNodes,0,0,a[5]),Be(r,o,u),void r.removeChild(u);throw[s,["vdom.ml",319,30]]}function ir(e,r){for(;;){var n=r,t=e;switch(0|n.tag){case 0:var a=n[0];return document.createComment(a);case 1:var i=n[0];return document.createTextNode(i);case 2:var u=n[4],o=ze(n[0],n[1]);if(tr(t,o,ye(function(e){return 0},u),u))return or(t,o,o.childNodes,0,0,n[5]),o;throw[s,["vdom.ml",333,30]];case 3:var c=ve(n[1],void 0);r=n[2].contents=c;continue;case 4:r=n[1],e=ve(n[0],t);continue}}}function ur(e,r,n,t,a,i){if(2!==a.tag)throw[w,"Non-node passed to patchVNodesOnElems_MutateNode"];if(2!==i.tag)throw[w,"Non-node passed to patchVNodesOnElems_MutateNode"];if(a[3]!==i[3]||a[1]!==i[1])return ar(e,r,n,t,i),0;var u=le(n,t),o=u.childNodes;return tr(e,u,a[4],i[4])||(console.log("VDom:  Failed swapping properties because the property list length changed, use `noProp` to swap properties instead, not by altering the list structure.  This is a massive inefficiency until this issue is resolved."),ar(e,r,n,t,i)),or(e,u,o,0,a[5],i[5])}function or(e,r,n,t,a,i){for(;;){var u=i,o=a,c=t;if(o){var s=o[0];switch(0|s.tag){case 0:if(u){var f=u[0];if(!f.tag&&s[0]===f[0]){i=u[1],a=o[1],t=c+1|0;continue}}break;case 1:if(u){var l=u[0];if(1===l.tag){var v=l[0];s[0]!==v&&(le(n,c).nodeValue=v),i=u[1],a=o[1],t=c+1|0;continue}}break;case 2:if(u){var d=u[0];if(2===d.tag){var h=u[1],p=d[2],m=d[1],g=d[0],b=o[1],w=s[2],y=s[1],_=s[0];if(w===p&&""!==w){i=h,a=b,t=c+1|0;continue}if(""===w||""===p){ur(e,r,n,c,s,d),i=h,a=b,t=c+1|0;continue}var S=0,k=0;if(b){var x=b[0];if(2===x.tag){var A=b[1],N=x[2],O=x[1],R=x[0],q=0;if(h){var T=h[0];if(2===T.tag){if(R===g&&O===m&&N===p&&_===T[0]&&y===T[1]&&w===T[2]){var L=le(n,c),F=le(n,c+1|0);r.removeChild(F),Be(r,F,L),i=h[1],a=A,t=c+2|0;continue}q=4}else q=4}else q=4;if(4===q){if(R===g&&O===m&&N===p){var M=le(n,c);r.removeChild(M),i=h,a=A,t=c+1|0;continue}k=3}}else k=3}else k=3;if(3===k)if(h){var E=h[0];if(2===E.tag){if(_===E[0]&&y===E[1]&&w===E[2]){var D=le(n,c);Be(r,ir(e,d),D),i=h,t=c+1|0;continue}S=2}else S=2}else S=2;if(2===S){ur(e,r,n,c,s,d),i=h,a=b,t=c+1|0;continue}}}break;case 3:if(u){var C=u[0];if(3===C.tag){var I=u[1],P=C[2],W=C[1],$=C[0],J=o[1],Z=s[2],Q=s[0];if(Q===$){P.contents=Z.contents,i=I,a=J,t=c+1|0;continue}var B=0,V=0;if(J){var z=J[0];if(3===z.tag){var H=J[1],U=z[0],j=0;if(I){var G=I[0];if(3===G.tag){if(U===$&&Q===G[0]){var X=le(n,c),Y=le(n,c+1|0);r.removeChild(Y),Be(r,Y,X),i=I[1],a=H,t=c+2|0;continue}j=4}else j=4}else j=4;if(4===j){if(U===$){var K=le(n,c);r.removeChild(K);var ee=z[2].contents;P.contents=ee,i=I,a=H,t=c+1|0;continue}V=3}}else V=3}else V=3;if(3===V)if(I){var re=I[0];if(3===re.tag){if(re[0]===Q){var ne=le(n,c),te=ve(W,void 0);Be(r,ir(e,P.contents=te),ne),i=I,t=c+1|0;continue}B=2}else B=2}else B=2;if(2===B){var ae=Z.contents,ie=ve(W,void 0);i=[P.contents=ie,I],a=[ae,J];continue}}}break;case 4:a=[s[1],o[1]];continue}var ue=o[1];if(u){var oe=u[0];if(4===oe.tag){or(ve(oe[0],e),r,n,c,[s,0],[oe[1],0]),i=u[1],a=ue,t=c+1|0;continue}var ce=le(n,c);Be(r,ir(e,oe),ce),r.removeChild(ce),i=u[1],a=ue,t=c+1|0;continue}var se=le(n,c);r.removeChild(se),i=0,a=ue}else{if(!u)return;var fe=ir(e,u[0]);r.appendChild(fe),i=u[1],t=c+1|(a=0)}}}function cr(n,e){if("number"!=typeof e)switch(0|e.tag){case 1:return Se(function(e,r){return cr(n,r)},void 0,e[0]);case 0:case 2:return ve(e[0],n)}}function sr(i,u,e,r){var o=function(e,r){for(;;){var n=r,t=e;if("number"==typeof n)return;switch(0|n.tag){case 0:var a=n[0];return a?_e(function(r){return function(e){return o(r,e)}}(t),a):void 0;case 1:return void(n[2].contents=ve(n[1],t));case 2:var i=ve(n[0],t);r=n[1],e=i;continue}}},c=function(e,r){for(;;){var n=r,t=e;if("number"==typeof n)return;switch(0|n.tag){case 0:var a=n[0];return a?_e(function(r){return function(e){return c(r,e)}}(t),a):void 0;case 1:var i=n[2],u=i.contents;return void 0!==u?ve(u,i.contents=void 0):void 0;case 2:var o=ve(n[0],t);r=n[1],e=o;continue}}};if("number"==typeof e){if("number"==typeof r)return r}else switch(0|e.tag){case 0:if("number"==typeof r||r.tag)break;return function(e,r){for(;;){var n=r;if(e){var t=e[1],a=e[0];if(n){sr(i,u,a,n[0]),r=n[1],e=t;continue}c(i,a),r=0,e=t}else{if(!n)return;o(u,n[0]),r=n[1],e=0}}}(e[0],r[0]),r;case 1:if("number"!=typeof r&&1===r.tag&&e[0]===r[0])return r[2].contents=e[2].contents,r;break;case 2:if("number"==typeof r||2!==r.tag)break;return sr(ve(e[0],i),ve(r[0],u),e[1],r[1]),r}return c(i,e),o(u,r),r}function fr(e,r){for(var n=e.length;(e.position+r|0)>n;)n<<=1;var t=g(n);Le(e.buffer,0,t,0,e.position),e.buffer=t,e.length=n}function lr(e,r){var n=r.length,t=e.position+n|0;t>e.length&&fr(e,n),Fe(r,0,e.buffer,e.position,n),e.position=t}function vr(e,r){var n,t,a,i=e.bytes.length,u=e.ind+r|0;u<=i||(a=g((t=u)<(n=i<<1)?n:t),Le(e.bytes,0,a,0,i),e.bytes=a)}function dr(e,r){vr(e,1),e.bytes[e.ind]=r,e.ind=e.ind+1|0}function hr(e,r){var n=r.length;vr(e,n),Ze(r,0,e.bytes,e.ind,n),e.ind=e.ind+n|0}function pr(e){return Te(e.bytes,0,e.ind)}function mr(e){if("number"==typeof e)return 0;switch(0|e.tag){case 0:return ee(0,[mr(e[0])]);case 1:return ee(1,[mr(e[0])]);case 2:return ee(2,[mr(e[0])]);case 3:return ee(3,[mr(e[0])]);case 4:return ee(4,[mr(e[0])]);case 5:return ee(5,[mr(e[0])]);case 6:return ee(6,[mr(e[0])]);case 7:return ee(7,[mr(e[0])]);case 8:return ee(8,[e[0],mr(e[1])]);case 9:return ee(9,[e[1],e[0],mr(e[2])]);case 10:return ee(10,[mr(e[0])]);case 11:return ee(11,[mr(e[0])]);case 12:return ee(12,[mr(e[0])]);case 13:return ee(13,[mr(e[0])]);case 14:return ee(14,[mr(e[0])])}}function gr(e){if("number"==typeof e)return[function(e){return 0},function(e){return 0},function(e){return 0},function(e){return 0}];switch(0|e.tag){case 0:var r=gr(e[0]),n=r[1],t=r[0];return[function(e){return ve(t,0),0},function(e){return ve(n,0),0},r[2],r[3]];case 1:var a=gr(e[0]),i=a[1],u=a[0];return[function(e){return ve(u,0),0},function(e){return ve(i,0),0},a[2],a[3]];case 2:var o=gr(e[0]),c=o[1],s=o[0];return[function(e){return ve(s,0),0},function(e){return ve(c,0),0},o[2],o[3]];case 3:var f=gr(e[0]),l=f[1],v=f[0];return[function(e){return ve(v,0),0},function(e){return ve(l,0),0},f[2],f[3]];case 4:var d=gr(e[0]),h=d[1],p=d[0];return[function(e){return ve(p,0),0},function(e){return ve(h,0),0},d[2],d[3]];case 5:var m=gr(e[0]),g=m[1],b=m[0];return[function(e){return ve(b,0),0},function(e){return ve(g,0),0},m[2],m[3]];case 6:var w=gr(e[0]),y=w[1],_=w[0];return[function(e){return ve(_,0),0},function(e){return ve(y,0),0},w[2],w[3]];case 7:var S=gr(e[0]),k=S[1],x=S[0];return[function(e){return ve(x,0),0},function(e){return ve(k,0),0},S[2],S[3]];case 8:var A=gr(e[1]),N=A[1],O=A[0];return[function(e){return ve(O,0),0},function(e){return ve(N,0),0},A[2],A[3]];case 9:var R=gr(e[2]),q=R[3],T=R[2],L=R[1],F=R[0],M=gr(br(mr(e[0]),e[1])),E=M[3],D=M[2],C=M[1],I=M[0];return[function(e){return ve(F,0),ve(I,0),0},function(e){return ve(C,0),ve(L,0),0},function(e){return ve(T,0),ve(D,0),0},function(e){return ve(E,0),ve(q,0),0}];case 10:var P=gr(e[0]),W=P[1],$=P[0];return[function(e){return ve($,0),0},function(e){return ve(W,0),0},P[2],P[3]];case 11:var J=gr(e[0]),Z=J[1],Q=J[0];return[function(e){return ve(Q,0),0},function(e){return ve(Z,0),0},J[2],J[3]];case 12:var B=gr(e[0]),V=B[1],z=B[0];return[function(e){return ve(z,0),0},function(e){return ve(V,0),0},B[2],B[3]];case 13:var H=gr(e[0]),U=H[3],j=H[2],G=H[1],X=H[0];return[function(e){return ve(X,0),0},function(e){return ve(G,0),0},function(e){return ve(j,0),0},function(e){return ve(U,0),0}];case 14:var Y=gr(e[0]),K=Y[3],ee=Y[2],re=Y[1],ne=Y[0];return[function(e){return ve(ne,0),0},function(e){return ve(re,0),0},function(e){return ve(ee,0),0},function(e){return ve(K,0),0}]}}function br(e,r){var n=0;if("number"==typeof e){if("number"==typeof r)return 0;switch(0|r.tag){case 8:n=6;break;case 9:n=7;break;case 10:n=1;break;case 11:n=2;break;case 12:n=3;break;case 13:n=4;break;case 14:n=5;break;default:throw[E,["camlinternalFormat.ml",846,23]]}}else switch(0|e.tag){case 0:if("number"==typeof r)n=8;else switch(0|r.tag){case 0:return ee(0,[br(e[0],r[0])]);case 8:n=6;break;case 9:n=7;break;case 10:n=1;break;case 11:n=2;break;case 12:n=3;break;case 13:n=4;break;case 14:n=5}break;case 1:if("number"==typeof r)n=8;else switch(0|r.tag){case 1:return ee(1,[br(e[0],r[0])]);case 8:n=6;break;case 9:n=7;break;case 10:n=1;break;case 11:n=2;break;case 12:n=3;break;case 13:n=4;break;case 14:n=5}break;case 2:if("number"==typeof r)n=8;else switch(0|r.tag){case 2:return ee(2,[br(e[0],r[0])]);case 8:n=6;break;case 9:n=7;break;case 10:n=1;break;case 11:n=2;break;case 12:n=3;break;case 13:n=4;break;case 14:n=5}break;case 3:if("number"==typeof r)n=8;else switch(0|r.tag){case 3:return ee(3,[br(e[0],r[0])]);case 8:n=6;break;case 9:n=7;break;case 10:n=1;break;case 11:n=2;break;case 12:n=3;break;case 13:n=4;break;case 14:n=5}break;case 4:if("number"==typeof r)n=8;else switch(0|r.tag){case 4:return ee(4,[br(e[0],r[0])]);case 8:n=6;break;case 9:n=7;break;case 10:n=1;break;case 11:n=2;break;case 12:n=3;break;case 13:n=4;break;case 14:n=5}break;case 5:if("number"==typeof r)n=8;else switch(0|r.tag){case 5:return ee(5,[br(e[0],r[0])]);case 8:n=6;break;case 9:n=7;break;case 10:n=1;break;case 11:n=2;break;case 12:n=3;break;case 13:n=4;break;case 14:n=5}break;case 6:if("number"==typeof r)n=8;else switch(0|r.tag){case 6:return ee(6,[br(e[0],r[0])]);case 8:n=6;break;case 9:n=7;break;case 10:n=1;break;case 11:n=2;break;case 12:n=3;break;case 13:n=4;break;case 14:n=5}break;case 7:if("number"==typeof r)n=8;else switch(0|r.tag){case 7:return ee(7,[br(e[0],r[0])]);case 8:n=6;break;case 9:n=7;break;case 10:n=1;break;case 11:n=2;break;case 12:n=3;break;case 13:n=4;break;case 14:n=5}break;case 8:if("number"==typeof r)throw[E,["camlinternalFormat.ml",832,26]];switch(0|r.tag){case 8:return ee(8,[br(e[0],r[0]),br(e[1],r[1])]);case 10:n=1;break;case 11:n=2;break;case 12:n=3;break;case 13:n=4;break;case 14:n=5;break;default:throw[E,["camlinternalFormat.ml",832,26]]}break;case 9:if("number"==typeof r)throw[E,["camlinternalFormat.ml",842,28]];switch(0|r.tag){case 8:n=6;break;case 9:var t=gr(br(mr(e[1]),r[0]));return ve(t[1],0),ve(t[3],0),ee(9,[e[0],r[1],br(e[2],r[2])]);case 10:n=1;break;case 11:n=2;break;case 12:n=3;break;case 13:n=4;break;case 14:n=5;break;default:throw[E,["camlinternalFormat.ml",842,28]]}break;case 10:if("number"==typeof r)throw[E,["camlinternalFormat.ml",810,21]];if(10===r.tag)return ee(10,[br(e[0],r[0])]);throw[E,["camlinternalFormat.ml",810,21]];case 11:if("number"==typeof r)throw[E,["camlinternalFormat.ml",814,21]];switch(0|r.tag){case 10:n=1;break;case 11:return ee(11,[br(e[0],r[0])]);default:throw[E,["camlinternalFormat.ml",814,21]]}break;case 12:if("number"==typeof r)throw[E,["camlinternalFormat.ml",818,19]];switch(0|r.tag){case 10:n=1;break;case 11:n=2;break;case 12:return ee(12,[br(e[0],r[0])]);default:throw[E,["camlinternalFormat.ml",818,19]]}break;case 13:if("number"==typeof r)throw[E,["camlinternalFormat.ml",822,22]];switch(0|r.tag){case 10:n=1;break;case 11:n=2;break;case 12:n=3;break;case 13:return ee(13,[br(e[0],r[0])]);default:throw[E,["camlinternalFormat.ml",822,22]]}break;case 14:if("number"==typeof r)throw[E,["camlinternalFormat.ml",827,30]];switch(0|r.tag){case 10:n=1;break;case 11:n=2;break;case 12:n=3;break;case 13:n=4;break;case 14:return ee(14,[br(e[0],r[0])]);default:throw[E,["camlinternalFormat.ml",827,30]]}}switch(n){case 1:throw[E,["camlinternalFormat.ml",811,21]];case 2:throw[E,["camlinternalFormat.ml",815,21]];case 3:throw[E,["camlinternalFormat.ml",819,19]];case 4:throw[E,["camlinternalFormat.ml",823,22]];case 5:throw[E,["camlinternalFormat.ml",828,30]];case 6:throw[E,["camlinternalFormat.ml",833,26]];case 7:throw[E,["camlinternalFormat.ml",843,28]];case 8:throw[E,["camlinternalFormat.ml",847,23]]}}var wr=ae("CamlinternalFormat.Type_mismatch");function yr(e,r){if("number"==typeof e)return[0,r];if(!e.tag)return[ee(0,[e[0],e[1]]),r];if("number"==typeof r)throw wr;if(2===r.tag)return[ee(1,[e[0]]),r[0]];throw wr}function _r(e,r,n){var t=yr(e,n);if("number"!=typeof r)return[t[0],[r[0]],t[1]];if(0===r)return[t[0],0,t[1]];var a=t[1];if("number"==typeof a)throw wr;if(2===a.tag)return[t[0],1,a[0]];throw wr}function Sr(e,r){if("number"==typeof e)return[0,r];switch(0|e.tag){case 0:if("number"==typeof r)throw wr;if(r.tag)throw wr;var n=Sr(e[0],r[0]);return[ee(0,[n[0]]),n[1]];case 1:if("number"==typeof r)throw wr;if(r.tag)throw wr;var t=Sr(e[0],r[0]);return[ee(1,[t[0]]),t[1]];case 2:var a=yr(e[0],r),i=a[1];if("number"==typeof i)throw wr;if(1!==i.tag)throw wr;var u=Sr(e[1],i[0]);return[ee(2,[a[0],u[0]]),u[1]];case 3:var o=yr(e[0],r),c=o[1];if("number"==typeof c)throw wr;if(1!==c.tag)throw wr;var s=Sr(e[1],c[0]);return[ee(3,[o[0],s[0]]),s[1]];case 4:var f=_r(e[1],e[2],r),l=f[2];if("number"==typeof l)throw wr;if(2!==l.tag)throw wr;var v=Sr(e[3],l[0]);return[ee(4,[e[0],f[0],f[1],v[0]]),v[1]];case 5:var d=_r(e[1],e[2],r),h=d[2];if("number"==typeof h)throw wr;if(3!==h.tag)throw wr;var p=Sr(e[3],h[0]);return[ee(5,[e[0],d[0],d[1],p[0]]),p[1]];case 6:var m=_r(e[1],e[2],r),g=m[2];if("number"==typeof g)throw wr;if(4!==g.tag)throw wr;var b=Sr(e[3],g[0]);return[ee(6,[e[0],m[0],m[1],b[0]]),b[1]];case 7:var w=_r(e[1],e[2],r),y=w[2];if("number"==typeof y)throw wr;if(5!==y.tag)throw wr;var _=Sr(e[3],y[0]);return[ee(7,[e[0],w[0],w[1],_[0]]),_[1]];case 8:var S=_r(e[1],e[2],r),k=S[2];if("number"==typeof k)throw wr;if(6!==k.tag)throw wr;var x=Sr(e[3],k[0]);return[ee(8,[e[0],S[0],S[1],x[0]]),x[1]];case 9:var A=yr(e[0],r),N=A[1];if("number"==typeof N)throw wr;if(7!==N.tag)throw wr;var O=Sr(e[1],N[0]);return[ee(9,[A[0],O[0]]),O[1]];case 10:var R=Sr(e[0],r);return[ee(10,[R[0]]),R[1]];case 11:var q=Sr(e[1],r);return[ee(11,[e[0],q[0]]),q[1]];case 12:var T=Sr(e[1],r);return[ee(12,[e[0],T[0]]),T[1]];case 13:if("number"==typeof r)throw wr;if(8!==r.tag)throw wr;var L=r[0];if(re([e[1]],[L]))throw wr;var F=Sr(e[2],r[1]);return[ee(13,[e[0],L,F[0]]),F[1]];case 14:if("number"==typeof r)throw wr;if(9!==r.tag)throw wr;var M=r[0];if(re([fe(e[1])],[fe(M)]))throw wr;var E=Sr(e[2],fe(r[2]));return[ee(14,[e[0],M,E[0]]),E[1]];case 15:if("number"==typeof r)throw wr;if(10!==r.tag)throw wr;var D=Sr(e[0],r[0]);return[ee(15,[D[0]]),D[1]];case 16:if("number"==typeof r)throw wr;if(11!==r.tag)throw wr;var C=Sr(e[0],r[0]);return[ee(16,[C[0]]),C[1]];case 17:var I=Sr(e[1],r);return[ee(17,[e[0],I[0]]),I[1]];case 18:var P=e[0],W=e[1];if(P.tag){var $=P[0],J=Sr($[0],r),Z=Sr(W,J[1]);return[ee(18,[ee(1,[[J[0],$[1]]]),Z[0]]),Z[1]]}var Q=P[0],B=Sr(Q[0],r),V=Sr(W,B[1]);return[ee(18,[ee(0,[[B[0],Q[1]]]),V[0]]),V[1]];case 19:if("number"==typeof r)throw wr;if(13!==r.tag)throw wr;var z=Sr(e[0],r[0]);return[ee(19,[z[0]]),z[1]];case 20:if("number"==typeof r)throw wr;if(1!==r.tag)throw wr;var H=Sr(e[2],r[0]);return[ee(20,[e[0],e[1],H[0]]),H[1]];case 21:if("number"==typeof r)throw wr;if(2!==r.tag)throw wr;var U=Sr(e[1],r[0]);return[ee(21,[e[0],U[0]]),U[1]];case 23:var j=e[0],G=e[1];if("number"==typeof j){if(2!==j)return kr(j,G,r);if("number"==typeof r)throw wr;if(14!==r.tag)throw wr;var X=Sr(G,r[0]);return[ee(23,[2,X[0]]),X[1]]}switch(0|j.tag){case 8:return kr(ee(8,[j[0],j[1]]),G,r);case 9:var Y=function e(r,n,t){if("number"==typeof r)return[0,Sr(n,t)];switch(0|r.tag){case 0:if("number"==typeof t)throw wr;if(t.tag)throw wr;var a=e(r[0],n,t[0]);return[ee(0,[a[0]]),a[1]];case 1:if("number"==typeof t)throw wr;if(1!==t.tag)throw wr;var i=e(r[0],n,t[0]);return[ee(1,[i[0]]),i[1]];case 2:if("number"==typeof t)throw wr;if(2!==t.tag)throw wr;var u=e(r[0],n,t[0]);return[ee(2,[u[0]]),u[1]];case 3:if("number"==typeof t)throw wr;if(3!==t.tag)throw wr;var o=e(r[0],n,t[0]);return[ee(3,[o[0]]),o[1]];case 4:if("number"==typeof t)throw wr;if(4!==t.tag)throw wr;var c=e(r[0],n,t[0]);return[ee(4,[c[0]]),c[1]];case 5:if("number"==typeof t)throw wr;if(5!==t.tag)throw wr;var s=e(r[0],n,t[0]);return[ee(5,[s[0]]),s[1]];case 6:if("number"==typeof t)throw wr;if(6!==t.tag)throw wr;var f=e(r[0],n,t[0]);return[ee(6,[f[0]]),f[1]];case 7:if("number"==typeof t)throw wr;if(7!==t.tag)throw wr;var l=e(r[0],n,t[0]);return[ee(7,[l[0]]),l[1]];case 8:if("number"==typeof t)throw wr;if(8!==t.tag)throw wr;var v=t[0];if(re([r[0]],[v]))throw wr;var d=e(r[1],n,t[1]);return[ee(8,[v,d[0]]),d[1]];case 9:if("number"==typeof t)throw wr;if(9!==t.tag)throw wr;var h=t[1],p=t[0];if(re([fe(r[0])],[fe(p)]))throw wr;if(re([fe(r[1])],[fe(h)]))throw wr;var m=gr(br(mr(p),h));ve(m[1],0),ve(m[3],0);var g=e(fe(r[2]),n,t[2]);return[ee(9,[p,h,mr(g[0])]),g[1]];case 10:if("number"==typeof t)throw wr;if(10!==t.tag)throw wr;var b=e(r[0],n,t[0]);return[ee(10,[b[0]]),b[1]];case 11:if("number"==typeof t)throw wr;if(11!==t.tag)throw wr;var w=e(r[0],n,t[0]);return[ee(11,[w[0]]),w[1]];case 12:throw wr;case 13:if("number"==typeof t)throw wr;if(13!==t.tag)throw wr;var y=e(r[0],n,t[0]);return[ee(13,[y[0]]),y[1]];case 14:if("number"==typeof t)throw wr;if(14!==t.tag)throw wr;var _=e(r[0],n,t[0]);return[ee(14,[_[0]]),_[1]]}}(j[1],G,r),K=Y[1];return[ee(23,[ee(9,[j[0],Y[0]]),K[0]]),K[1]];default:return kr(j,G,r)}case 22:case 24:throw wr}}function kr(e,r,n){var t=Sr(r,n);return[ee(23,[e,t[0]]),t[1]]}function xr(e,r){return function(e,r){var n=Sr(e,r);if("number"==typeof n[1])return n[0];throw wr}(e,fe(mr(r)))}function Ar(e,r,n){var t=n.length,a=he(r),i=r<0?0:e;if(a<=t)return n;var u=Oe(a,2===i?48:32);switch(i){case 0:Ze(n,0,u,0,t);break;case 1:Ze(n,0,u,a-t|0,t);break;case 2:0<t&&(43===ne(n,0)||45===ne(n,0)||32===ne(n,0))?(u[0]=ne(n,0),Ze(n,1,u,1+(a-t|0)|0,t-1|0)):1<t&&48===ne(n,0)&&(120===ne(n,1)||88===ne(n,1))?(u[1]=ne(n,1),Ze(n,2,u,2+(a-t|0)|0,t-2|0)):Ze(n,0,u,a-t|0,t)}return f(u)}function Nr(e,r){var n=he(e),t=r.length,a=ne(r,0),i=0;if(58<=a)if(71<=a){if(102<a||a<97)return r;i=2}else{if(a<65)return r;i=2}else if(32!==a){if(a<43)return r;switch(a-43|0){case 0:case 2:i=1;break;case 1:case 3:case 4:return r;case 5:if(t<(n+2|0)&&1<t&&(120===ne(r,1)||88===ne(r,1))){var u=Oe(n+2|0,48);return u[1]=ne(r,1),Ze(r,2,u,4+(n-t|0)|0,t-2|0),f(u)}i=2;break;case 6:case 7:case 8:case 9:case 10:case 11:case 12:case 13:case 14:i=2}}else i=1;switch(i){case 1:if((n+1|0)<=t)return r;var o=Oe(n+1|0,48);return o[0]=a,Ze(r,1,o,2+(n-t|0)|0,t-1|0),f(o);case 2:if(n<=t)return r;var c=Oe(n,48);return Ze(r,0,c,n-t|0,t),f(c)}}function Or(e){var a,r=(a=e,function(e){for(;;){var r=e;if(r>=a.length)return;var n=a.charCodeAt(r);if(n<32)return 1;var t=n-34|0;if(58<t||t<0){if(93<=t)return 1;e=r+1|0}else{if(57<t||t<1)return 1;e=r+1|0}}}(0)?f(Ee(l(a))):a),n=r.length,t=Oe(n+2|0,34);return c(r,0,t,1,n),f(t)}function Rr(e,r){if(15===e)return"%.12g";var n=he(r),t=function(e){switch(e){case 0:case 1:case 2:return 102;case 3:case 4:case 5:return 101;case 6:case 7:case 8:return 69;case 9:case 10:case 11:return 103;case 12:case 13:case 14:return 71;case 15:return 70;case 16:case 17:case 18:return 104;case 19:case 20:case 21:return 72}}(e),a={ind:0,bytes:g(16)};return dr(a,37),function(e,r){switch(r){case 0:case 3:case 6:case 9:case 12:case 15:case 16:case 19:return;case 1:case 4:case 7:case 10:case 13:case 17:case 20:return dr(e,43);case 2:case 5:case 8:case 11:case 14:case 18:case 21:dr(e,32)}}(a,e),dr(a,46),hr(a,String(n)),dr(a,t),pr(a)}function qr(e,r){return Y(function(e){switch(e){case 0:return"%d";case 1:return"%+d";case 2:return"% d";case 3:return"%i";case 4:return"%+i";case 5:return"% i";case 6:return"%x";case 7:return"%#x";case 8:return"%X";case 9:return"%#X";case 10:return"%o";case 11:return"%#o";case 12:return"%u"}}(e),r)}function Tr(e,r){return a(function(e){switch(e){case 0:return"%ld";case 1:return"%+ld";case 2:return"% ld";case 3:return"%li";case 4:return"%+li";case 5:return"% li";case 6:return"%lx";case 7:return"%#lx";case 8:return"%lX";case 9:return"%#lX";case 10:return"%lo";case 11:return"%#lo";case 12:return"%lu"}}(e),r)}function Lr(e,r){return t(function(e){switch(e){case 0:return"%nd";case 1:return"%+nd";case 2:return"% nd";case 3:return"%ni";case 4:return"%+ni";case 5:return"% ni";case 6:return"%nx";case 7:return"%#nx";case 8:return"%nX";case 9:return"%#nX";case 10:return"%no";case 11:return"%#no";case 12:return"%nu"}}(e),r)}function Fr(e,r){return n(function(e){switch(e){case 0:return"%Ld";case 1:return"%+Ld";case 2:return"% Ld";case 3:return"%Li";case 4:return"%+Li";case 5:return"% Li";case 6:return"%Lx";case 7:return"%#Lx";case 8:return"%LX";case 9:return"%#LX";case 10:return"%Lo";case 11:return"%#Lo";case 12:return"%Lu"}}(e),r)}function Mr(e,r,n){if(16<=e){var t;if(17<=e)switch(e-17|0){case 2:t=45;break;case 0:case 3:t=43;break;case 1:case 4:t=32}else t=45;var a=K(n,r,t);return 19<=e?f(De(l(a))):a}var i=function(e,r){var n=G(e),t=n.prec<0?6:n.prec,a=r<0?(n.sign=-1,-r):r,i="";if(isNaN(a))i="nan",n.filter=" ";else if(isFinite(a)){switch(n.conv){case"e":var u=(i=a.toExponential(t)).length;"e"===i[u-3|0]&&(i=i.slice(0,u-1|0)+("0"+i.slice(u-1|0)));break;case"f":i=a.toFixed(t);break;case"g":var o=0!==t?t:1,c=(i=a.toExponential(o-1|0)).indexOf("e"),s=0|Number(i.slice(c+1|0));if(s<-4||1e21<=a||a.toFixed().length>o){for(var f=c-1|0;"0"===i[f];)f=f-1|0;"."===i[f]&&(f=f-1|0);var l=(i=i.slice(0,f+1|0)+i.slice(c)).length;"e"===i[l-3|0]&&(i=i.slice(0,l-1|0)+("0"+i.slice(l-1|0)))}else{var v=o;if(s<0)v=v-(1+s|0)|0,i=a.toFixed(v);else for(;(i=a.toFixed(v)).length>(o+1|0);)v=v-1|0;if(0!==v){for(var d=i.length-1|0;"0"===i[d];)d=d-1|0;"."===i[d]&&(d=d-1|0),i=i.slice(0,d+1|0)}}}}else i="inf",n.filter=" ";return X(n,i)}(Rr(e,r),n);if(15!==e)return i;var u,o=i.length,c=(u=n,isFinite(u)?22250738585072014e-324<=Math.abs(u)?0:0!==u?1:2:isNaN(u)?4:3);return 3!=c?4<=c?"nan":function(e){for(;;){var r=e;if(r===o)return!1;var n=ne(i,r)-46|0;if(23<n||n<0){if(55==n)return!0;e=r+1|0}else{if(22<n||n<1)return!0;e=r+1|0}}}(0)?i:i+".":n<0?"neg_infinity":"infinity"}function Er(e){var r=function(e){var r=0;if(40<=e){if(92===e)return"\\\\";r=127<=e?1:2}else if(32<=e){if(39<=e)return"\\'";r=2}else if(14<=e)r=1;else switch(e){case 8:return"\\b";case 9:return"\\t";case 10:return"\\n";case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:case 11:case 12:r=1;break;case 13:return"\\r"}switch(r){case 1:var n=[0,0,0,0];return n[0]=92,n[1]=48+(e/100|0)|0,n[2]=48+(e/10|0)%10|0,n[3]=48+e%10|0,f(n);case 2:var t=[0];return t[0]=e,f(t)}}(e),n=r.length,t=Oe(n+2|0,39);return c(r,0,t,1,n),f(t)}function Dr(e){var r={ind:0,bytes:g(16)};return function e(r,n){for(;;){var t=n;if("number"==typeof t)return;switch(0|t.tag){case 0:hr(r,"%c"),n=t[0];continue;case 1:hr(r,"%s"),n=t[0];continue;case 2:hr(r,"%i"),n=t[0];continue;case 3:hr(r,"%li"),n=t[0];continue;case 4:hr(r,"%ni"),n=t[0];continue;case 5:hr(r,"%Li"),n=t[0];continue;case 6:hr(r,"%f"),n=t[0];continue;case 7:hr(r,"%B"),n=t[0];continue;case 8:hr(r,"%{"),e(r,t[0]),hr(r,"%}"),n=t[1];continue;case 9:hr(r,"%("),e(r,t[0]),hr(r,"%)"),n=t[2];continue;case 10:hr(r,"%a"),n=t[0];continue;case 11:hr(r,"%t"),n=t[0];continue;case 12:hr(r,"%?"),n=t[0];continue;case 13:hr(r,"%r"),n=t[0];continue;case 14:hr(r,"%_r"),n=t[0];continue}}}(r,e),pr(r)}function Cr(e,s,r,n){for(;;){var t=n,a=r,i=e;if("number"==typeof t)return D(i,s,a);switch(0|t.tag){case 0:return function(n,t,a){return function(e){var r=ee(5,[t,e]);return Cr(n,s,r,a)}}(i,a,t[0]);case 1:return function(t,a,i){return function(e){var r=Er(e),n=ee(4,[a,r]);return Cr(t,s,n,i)}}(i,a,t[0]);case 2:return Pr(i,s,a,t[1],t[0],function(e){return e});case 3:return Pr(i,s,a,t[1],t[0],Or);case 4:return Wr(i,s,a,t[3],t[1],t[2],qr,t[0]);case 5:return Wr(i,s,a,t[3],t[1],t[2],Tr,t[0]);case 6:return Wr(i,s,a,t[3],t[1],t[2],Lr,t[0]);case 7:return Wr(i,s,a,t[3],t[1],t[2],Fr,t[0]);case 8:var u=t[3],o=t[1],c=t[2],f=t[0];if("number"==typeof o)return"number"==typeof c?(0!==c?function(t,a,i,u){return function(e,r){var n=Mr(u,e,r);return Cr(t,s,ee(4,[a,n]),i)}}:function(n,t,a,i){return function(e){var r=Mr(i,-6,e);return Cr(n,s,ee(4,[t,r]),a)}})(i,a,u,f):function(n,t,a,i,u){return function(e){var r=Mr(i,u,e);return Cr(n,s,ee(4,[t,r]),a)}}(i,a,u,f,c[0]);if(o.tag){var l=o[0];return"number"==typeof c?(0!==c?function(a,i,u,o,c){return function(e,r,n){var t=Ar(c,e,Mr(o,r,n));return Cr(a,s,ee(4,[i,t]),u)}}:function(a,i,u,o,c){return function(e,r){var n=Mr(o,-6,r),t=Ar(c,e,n);return Cr(a,s,ee(4,[i,t]),u)}})(i,a,u,f,l):function(t,a,i,u,o,c){return function(e,r){var n=Ar(o,e,Mr(u,c,r));return Cr(t,s,ee(4,[a,n]),i)}}(i,a,u,f,l,c[0])}var v=o[1],d=o[0];return"number"==typeof c?(0!==c?function(t,a,i,u,o,c){return function(e,r){var n=Ar(o,c,Mr(u,e,r));return Cr(t,s,ee(4,[a,n]),i)}}:function(t,a,i,u,o,c){return function(e){var r=Mr(u,-6,e),n=Ar(o,c,r);return Cr(t,s,ee(4,[a,n]),i)}})(i,a,u,f,d,v):function(n,t,a,i,u,o,c){return function(e){var r=Ar(u,o,Mr(i,c,e));return Cr(n,s,ee(4,[t,r]),a)}}(i,a,u,f,d,v,c[0]);case 9:return Pr(i,s,a,t[1],t[0],pe);case 10:n=t[0],r=ee(7,[a]);continue;case 11:n=t[1],r=ee(2,[a,t[0]]);continue;case 12:n=t[1],r=ee(3,[a,t[0]]);continue;case 13:return function(r,n,t,a){return function(e){return Cr(r,s,ee(4,[n,a]),t)}}(i,a,t[2],Dr(t[1]));case 14:var h=t[2];return function(r,n,t,a){return function(e){return Cr(r,s,n,function e(r,n){if("number"==typeof r)return n;switch(0|r.tag){case 0:return ee(0,[e(r[0],n)]);case 1:return ee(1,[e(r[0],n)]);case 2:return ee(2,[r[0],e(r[1],n)]);case 3:return ee(3,[r[0],e(r[1],n)]);case 4:return ee(4,[r[0],r[1],r[2],e(r[3],n)]);case 5:return ee(5,[r[0],r[1],r[2],e(r[3],n)]);case 6:return ee(6,[r[0],r[1],r[2],e(r[3],n)]);case 7:return ee(7,[r[0],r[1],r[2],e(r[3],n)]);case 8:return ee(8,[r[0],r[1],r[2],e(r[3],n)]);case 9:return ee(9,[r[0],e(r[1],n)]);case 10:return ee(10,[e(r[0],n)]);case 11:return ee(11,[r[0],e(r[1],n)]);case 12:return ee(12,[r[0],e(r[1],n)]);case 13:return ee(13,[r[0],r[1],e(r[2],n)]);case 14:return ee(14,[r[0],r[1],e(r[2],n)]);case 15:return ee(15,[e(r[0],n)]);case 16:return ee(16,[e(r[0],n)]);case 17:return ee(17,[r[0],e(r[1],n)]);case 18:return ee(18,[r[0],e(r[1],n)]);case 19:return ee(19,[e(r[0],n)]);case 20:return ee(20,[r[0],r[1],e(r[2],n)]);case 21:return ee(21,[r[0],e(r[1],n)]);case 22:return ee(22,[e(r[0],n)]);case 23:return ee(23,[r[0],e(r[1],n)]);case 24:return ee(24,[r[0],r[1],e(r[2],n)])}}(xr(e[0],t),a))}}(i,a,t[1],h);case 15:return function(e,t,a){return function(r,n){return Cr(e,s,ee(6,[t,function(e){return D(r,e,n)}]),a)}}(i,a,t[0]);case 16:return function(r,n,t){return function(e){return Cr(r,s,ee(6,[n,e]),t)}}(i,a,t[0]);case 17:n=t[1],r=ee(0,[a,t[0]]);continue;case 18:var p=t[0];if(p.tag){var m=function(n,t,a){return function(e,r){return Cr(n,e,ee(1,[t,ee(1,[r])]),a)}}(i,a,t[1]);n=p[0][0],r=0,e=m;continue}var g=function(n,t,a){return function(e,r){return Cr(n,e,ee(1,[t,ee(0,[r])]),a)}}(i,a,t[1]);n=p[0][0],r=0,e=g;continue;case 19:throw[E,["camlinternalFormat.ml",1525,4]];case 20:return function(r,n,t){return function(e){return Cr(r,s,t,n)}}(i,t[2],ee(8,[a,"Printf: bad conversion %["]));case 21:return function(t,a,i){return function(e){var r=Y("%u",e),n=ee(4,[a,r]);return Cr(t,s,n,i)}}(i,a,t[1]);case 22:return function(n,t,a){return function(e){var r=ee(5,[t,e]);return Cr(n,s,r,a)}}(i,a,t[0]);case 23:return function(e,r,n,t,a){if("number"!=typeof t)return 9===t.tag?function n(t,a,i,e,u){if("number"==typeof e)return Ir(t,a,i,u);switch(0|e.tag){case 0:var r=e[0];return function(e){return n(t,a,i,r,u)};case 1:var o=e[0];return function(e){return n(t,a,i,o,u)};case 2:var c=e[0];return function(e){return n(t,a,i,c,u)};case 3:var s=e[0];return function(e){return n(t,a,i,s,u)};case 4:var f=e[0];return function(e){return n(t,a,i,f,u)};case 5:var l=e[0];return function(e){return n(t,a,i,l,u)};case 6:var v=e[0];return function(e){return n(t,a,i,v,u)};case 7:var d=e[0];return function(e){return n(t,a,i,d,u)};case 8:var h=e[1];return function(e){return n(t,a,i,h,u)};case 9:var p=e[2],m=br(mr(e[0]),e[1]);return function(e){return n(t,a,i,de(m,p),u)};case 10:var g=e[0];return function(e,r){return n(t,a,i,g,u)};case 11:var b=e[0];return function(e){return n(t,a,i,b,u)};case 12:var w=e[0];return function(e){return n(t,a,i,w,u)};case 13:throw[E,["camlinternalFormat.ml",1616,31]];case 14:throw[E,["camlinternalFormat.ml",1617,31]]}}(e,r,n,t[1],a):Ir(e,r,n,a);if(2===t)throw[E,["camlinternalFormat.ml",1593,39]];return Ir(e,r,n,a)}(i,s,a,t[0],t[1]);case 24:return function r(n,t,a,i,e,u){if(!e)return Cr(n,t,ee(4,[a,u]),i);var o=e[0];return function(e){return r(n,t,a,i,o,ve(u,e))}}(i,s,a,t[2],t[0],ve(t[1],void 0))}}}function Ir(e,r,n,t){return Cr(e,r,ee(8,[n,"Printf: bad conversion %_"]),t)}function Pr(a,i,u,o,e,c){if("number"==typeof e)return function(e){var r=ve(c,e),n=ee(4,[u,r]);return Cr(a,i,n,o)};if(e.tag){var s=e[0];return function(e,r){var n=Ar(s,e,ve(c,r)),t=ee(4,[u,n]);return Cr(a,i,t,o)}}var t=e[1],f=e[0];return function(e){var r=Ar(f,t,ve(c,e)),n=ee(4,[u,r]);return Cr(a,i,n,o)}}function Wr(a,i,u,o,e,r,c,s){if("number"==typeof e){if("number"==typeof r)return 0!==r?function(e,r){var n=Nr(e,D(c,s,r));return Cr(a,i,ee(4,[u,n]),o)}:function(e){var r=D(c,s,e);return Cr(a,i,ee(4,[u,r]),o)};var n=r[0];return function(e){var r=Nr(n,D(c,s,e));return Cr(a,i,ee(4,[u,r]),o)}}if(e.tag){var f=e[0];if("number"==typeof r)return 0!==r?function(e,r,n){var t=Ar(f,e,Nr(r,D(c,s,n)));return Cr(a,i,ee(4,[u,t]),o)}:function(e,r){var n=Ar(f,e,D(c,s,r));return Cr(a,i,ee(4,[u,n]),o)};var t=r[0];return function(e,r){var n=Ar(f,e,Nr(t,D(c,s,r)));return Cr(a,i,ee(4,[u,n]),o)}}var l=e[1],v=e[0];if("number"==typeof r)return 0!==r?function(e,r){var n=Ar(v,l,Nr(e,D(c,s,r)));return Cr(a,i,ee(4,[u,n]),o)}:function(e){var r=Ar(v,l,D(c,s,e));return Cr(a,i,ee(4,[u,r]),o)};var d=r[0];return function(e){var r=Ar(v,l,Nr(d,D(c,s,e)));return Cr(a,i,ee(4,[u,r]),o)}}function $r(e,r){for(;;){var n=r,t=0;if("number"==typeof n)return;switch(0|n.tag){case 0:var a=function(e){if("number"==typeof e)switch(e){case 0:return"@]";case 1:return"@}";case 2:return"@?";case 3:return"@\n";case 4:return"@.";case 5:return"@@";case 6:return"@%"}else switch(0|e.tag){case 0:case 1:return e[0];case 2:return"@"+f(Oe(1,e[0]))}}(n[1]);return $r(e,n[0]),lr(e,a),0;case 1:var i=n[1],u=n[0];if(i.tag){$r(e,u),lr(e,"@["),r=i[0];continue}$r(e,u),lr(e,"@{"),r=i[0];continue;case 2:case 4:t=1;break;case 3:case 5:t=2;break;case 6:return $r(e,n[0]),lr(e,ve(n[1],void 0)),0;case 7:r=n[0];continue;case 8:throw $r(e,n[0]),[F,n[1]]}switch(t){case 1:return $r(e,n[0]),lr(e,n[1]),0;case 2:return $r(e,n[0]),o=e,c=n[1],s=void 0,(s=o.position)>=o.length&&fr(o,1),o.buffer[s]=c,o.position=s+1|0,0}}var o,c,s}function Jr(o,e){return Cr(function(e,r){var n,t,a,i,u={buffer:a=g(t=(n=64)<1?1:n),position:0,length:t,initial_buffer:a};return $r(u,r),ve(o,Te((i=u).buffer,0,i.position))},void 0,0,e[0])}function Zr(e){return Jr(function(e){return e},e)}function Qr(e){return C(Zr([ee(11,["At ",ee(2,[0,ee(11,["; Expecting ",ee(2,[0,ee(11,[" but actual ",ee(2,[0,0])])])])])]),"At %s; Expecting %s but actual %s"]),(r=e.location,D(Zr([ee(11,["Ln ",ee(4,[0,0,0,ee(11,[", Col ",ee(4,[0,0,0,0])])])]),"Ln %d, Col %d"]),r.line,r.column)),e.expecting,e.actual);var r}function Br(e){return e.result}function Vr(e,r,n){var t=ve(e,n);if(t.tag)return ee(1,[t[0]]);var a=t[0];return D(r,a.result,{location:a.location,input_chars:a.remaining_chars})}function zr(e,r,n,t){var a=ve(e,t);if(a.tag)return ee(0,[{result:n,location:t.location,remaining_chars:t.input_chars}]);var i=a[0];return D(r,i.result,{location:i.location,input_chars:i.remaining_chars})}function Hr(e,r){return ee(0,[{result:e,location:r.location,remaining_chars:r.input_chars}])}function Ur(e,r,n){var t=ve(r,n);if(!t.tag)return t;var a=t[0];return ee(1,a?[[{expecting:ve(e,Pe(" OR ",ye(function(e){return e.expecting},a))),actual:a[0].actual,location:n.location},0]]:[[{expecting:ve(e,""),actual:"No input",location:n.location},0]])}function jr(e,r,n){var t=ve(r,n);if(!t.tag)return t;var a=t[0];return ee(1,a?[[{expecting:e,actual:a[0].actual,location:n.location},a[1]]]:[[{expecting:e,actual:"",location:n.location},0]])}function Gr(n,r){return function(e){return Vr(r,function(e){var r=ve(n,e);return function(e){return Hr(r,e)}},e)}}function Xr(e,r,n){var t=ve(e,n);if(!t.tag)return t;var a=ve(r,n);return a.tag?ee(1,[xe([t[0],[a[0],0]])]):a}function Yr(e){if(!e)return function(e){return ee(1,[0])};var r=e[0],n=Yr(e[1]);return function(e){return Xr(r,n,e)}}function Kr(t){function r(e){return Vr(t,function(n){var r=Kr(t);return function(e){return Vr(r,function(e){var r=[n,e];return function(e){return Hr(r,e)}},e)}},e)}return function(e){return Xr(r,function(e){return Hr(0,e)},e)}}function en(e,r){return a=r,i=n=e,t=(u=function(r){var n=be(r);return function(e){return zr(a,function(e){return function(e){return Vr(i,function(e){return u([e,r])},e)}},n,e)}})(0),function(e){return Vr(n,function(n){return function(e){return Vr(t,function(e){var r=[n,e];return function(e){return Hr(r,e)}},e)}},e)};var n,t,a,i,u}function rn(e,r,n){var t=n.input_chars;if(!t)return ee(1,[[{expecting:r,actual:"Ran out of characters",location:n.location},0]]);var a,i,u,o=t[0];return ve(e,o)?ee(0,[{result:o,location:(a=n.location,i=o,u=a.line,10!==i&&13!==i?{column:a.column+1|0,line:u}:{column:1,line:u+1|0}),remaining_chars:t[1]}]):ee(1,[[{expecting:r,actual:ve(Zr([ee(12,[39,ee(0,[ee(12,[39,0])])]),"'%c'"]),o),location:n.location},0]])}function nn(r){var n=ve(Zr([ee(0,[0]),"%c"]),r);return function(e){return rn(function(e){return r===e},n,e)}}function tn(r,n){var t=D(Zr([ee(11,["A character between ",ee(0,[ee(11,[" and ",ee(0,[0])])])]),"A character between %c and %c"]),r,n);return function(e){return rn(function(e){return r<=e&&e<=n},t,e)}}var an,un,on=(an=[32,[9,[13,[10,0]]]],un=ve(Zr([ee(11,["One of: ",ee(2,[0,0])]),"One of: %s"]),Pe(", ",ye(function(e){return Ce(1,e)},an))),function(e){return rn(function(e){return function(e,r){for(;;){var n=r;if(!n)return!1;if(m(n[0],e))return!0;r=n[1]}}(e,an)},un,e)}),cn=(nn(10),nn(9),tn(65,90)),sn=tn(97,122),fn=tn(48,57),ln=Zr([ee(2,[0,0]),"%s"]);function vn(e){return Ur(ln,function(e){return Xr(sn,cn,e)},e)}Yr([tn(97,102),[tn(65,70),[fn,0]]]);var dn=function r(n){function t(e){return Vr(n,function(e){return r(n)},e)}return function(e){return Xr(t,function(e){return Hr(void 0,e)},e)}}(on);tn(48,55);function hn(t){var a=t.length,i=function(e){if(a<=e)return function(e){return Hr(t,e)};var r=i(e+1|0),n=nn(ne(t,e));return function(e){return Vr(n,function(e){return r},e)}};if(a<=0)return function(e){throw[w,e]}("token must be a non-empty string");function r(e){return Vr(dn,function(e){return n},e)}var n=i(0);return function(e){return jr(t,r,e)}}function pn(e,r){return ve(e,{location:{column:1,line:1},input_chars:(a=$e(r),i=a.length,be(function(e,r){for(;;){var n=r,t=e;if(n===i)return t;r=n+1|0,e=[ne(a,n),t]}}(0,0)))});var a,i}function mn(e,r){var n=pn(e,r);if(n.tag)return ee(1,[n[0]]);var t=n[0],a=t.remaining_chars,i=t.location;return a?ee(1,[[{expecting:"End of input",actual:ve(Zr([ee(11,["Characters remaining: ",ee(2,[0,0])]),"Characters remaining: %s"]),Pe("",ye(function(e){return Ce(1,e)},a))),location:i},0]]):ee(0,[{result:t.result,location:i,remaining_chars:a}])}var gn=Vr,bn=Xr,wn=function(r,n){return function(e){return Vr(r,function(e){return n},e)}},yn=function(r,n){return function(e){return Vr(r,function(r){return function(e){return Vr(n,function(e){return function(e){return Hr(r,e)}},e)}},e)}};function _n(d){function h(e){return e?e[4]:0}function p(e,r,n,t){var a=h(e),i=h(t);return[e,r,n,t,i<=a?a+1|0:i+1|0]}function t(e,r){return[0,e,r,0,1]}function m(e,r,n,t){var a=e?e[4]:0,i=t?t[4]:0;if((i+2|0)<a){if(e){var u=e[3],o=e[2],c=e[1],s=e[0];if(h(s)>=h(u))return p(s,c,o,p(u,r,n,t));if(u)return p(p(s,c,o,u[0]),u[1],u[2],p(u[3],r,n,t));throw[F,"Map.bal"]}throw[F,"Map.bal"]}if(i<=(a+2|0))return[e,r,n,t,i<=a?a+1|0:i+1|0];if(t){var f=t[3],l=t[2],v=t[1],d=t[0];if(h(f)>=h(d))return p(p(e,r,n,d),v,l,f);if(d)return p(p(e,r,n,d[0]),d[1],d[2],p(d[3],v,l,f));throw[F,"Map.bal"]}throw[F,"Map.bal"]}function a(e){for(;;){if(!e)throw M;var r=e[0];if(!r)return[e[1],e[2]];e=r}}function e(e){for(;;){if(!e)return;var r=e[0];if(!r)return[e[1],e[2]];e=r}}function g(e,r){if(!e)return r;if(!r)return e;var n=a(r);return m(e,n[0],n[1],i(r))}function l(e,r){if(!e)return r;if(!r)return e;var n=a(r);return A(e,n[0],n[1],i(r))}function b(e,r,n,t){return void 0!==n?A(e,r,oe(n),t):l(e,t)}function s(e,r){for(;;){if(!e)return r;r=[e[1],e[2],e[3],r],e=e[0]}}var f=function(e,r,n){if(!n)return[0,e,r,0,1];var t=n[3],a=n[2],i=n[1],u=n[0],o=D(d.compare,e,i);if(0===o)return a===r?n:[u,e,r,t,n[4]];if(o<0){var c=f(e,r,u);return u===c?n:m(c,i,a,t)}var s=f(e,r,t);return t===s?n:m(u,i,a,s)},i=function(e){if(e){var r=e[0];return r?m(i(r),e[1],e[2],e[3]):e[3]}throw[F,"Map.remove_min_elt"]},v=function(e,r){if(!r)return 0;var n=r[3],t=r[2],a=r[1],i=r[0],u=D(d.compare,e,a);if(0===u)return g(i,n);if(u<0){var o=v(e,i);return i===o?r:m(o,a,t,n)}var c=v(e,n);return n===c?r:m(i,a,t,c)},w=function(e,r,n){if(n){var t=n[3],a=n[2],i=n[1],u=n[0],o=D(d.compare,e,i);if(0===o){var c=ve(r,ue(a));if(void 0===c)return g(u,t);var s=oe(c);return a===s?n:[u,e,s,t,n[4]]}if(o<0){var f=w(e,r,u);return u===f?n:m(f,i,a,t)}var l=w(e,r,t);return t===l?n:m(u,i,a,l)}var v=ve(r,void 0);return void 0!==v?[0,e,oe(v),0,1]:0},u=function(e,r){for(;;){var n=r;if(!n)return;u(e,n[0]),D(e,n[1],n[2]),r=n[3]}},o=function(e,r){if(!r)return 0;var n=o(e,r[0]),t=ve(e,r[2]),a=o(e,r[3]);return[n,r[1],t,a,r[4]]},c=function(e,r){if(!r)return 0;var n=r[1];return[c(e,r[0]),n,D(e,n,r[2]),c(e,r[3]),r[4]]},y=function(e,r,n){for(;;){var t=r;if(!t)return n;n=C(e,t[1],t[2],y(e,t[0],n)),r=t[3]}},_=function(e,r){for(;;){var n=r;if(!n)return!0;if(!D(e,n[1],n[2]))return!1;if(!_(e,n[0]))return!1;r=n[3]}},S=function(e,r){for(;;){var n=r;if(!n)return!1;if(D(e,n[1],n[2]))return!0;if(S(e,n[0]))return!0;r=n[3]}},k=function(e,r,n){return n?m(k(e,r,n[0]),n[1],n[2],n[3]):t(e,r)},x=function(e,r,n){return n?m(n[0],n[1],n[2],x(e,r,n[3])):t(e,r)},A=function(e,r,n,t){if(!e)return k(r,n,t);if(!t)return x(r,n,e);var a=t[4],i=e[4];return(a+2|0)<i?m(e[0],e[1],e[2],A(e[3],r,n,t)):(i+2|0)<a?m(A(e,r,n,t[0]),t[1],t[2],t[3]):p(e,r,n,t)},N=function(e,r){if(!r)return[0,void 0,0];var n=r[3],t=r[2],a=r[1],i=r[0],u=D(d.compare,e,a);if(0===u)return[i,ue(t),n];if(u<0){var o=N(e,i);return[o[0],o[1],A(o[2],a,t,n)]}var c=N(e,n);return[A(i,a,t,c[0]),c[1],c[2]]},O=function(e,r,n){if(r){var t=r[1];if(r[4]>=h(n)){var a=N(t,n);return b(O(e,r[0],a[0]),t,C(e,t,ue(r[2]),a[1]),O(e,r[3],a[2]))}}else if(!n)return 0;if(n){var i=n[1],u=N(i,r);return b(O(e,u[0],n[0]),i,C(e,i,u[1],ue(n[2])),O(e,u[2],n[3]))}throw[E,["map.ml",393,10]]},R=function(e,r,n){if(!r)return n;if(!n)return r;var t=n[2],a=n[1],i=r[2],u=r[1];if(r[4]>=n[4]){var o=N(u,n),c=o[1],s=R(e,r[0],o[0]),f=R(e,r[3],o[2]);return void 0!==c?b(s,u,C(e,u,i,oe(c)),f):A(s,u,i,f)}var l=N(a,r),v=l[1],d=R(e,l[0],n[0]),h=R(e,l[2],n[3]);return void 0!==v?b(d,a,C(e,a,oe(v),t),h):A(d,a,t,h)},q=function(e,r){if(!r)return 0;var n=r[3],t=r[2],a=r[1],i=r[0],u=q(e,i),o=D(e,a,t),c=q(e,n);return o?i===u&&n===c?r:A(u,a,t,c):l(u,c)},T=function(e,r){if(!r)return[0,0];var n=r[2],t=r[1],a=T(e,r[0]),i=a[1],u=a[0],o=D(e,t,n),c=T(e,r[3]),s=c[1],f=c[0];return o?[A(u,t,n,f),l(i,s)]:[l(u,f),A(i,t,n,s)]},r=function(e){return e?(r(e[0])+1|0)+r(e[3])|0:0},L=function(e,r){for(;;){var n=r;if(!n)return e;r=n[0],e=[[n[1],n[2]],L(e,n[3])]}};return{empty:0,is_empty:function(e){return!e},mem:function(e,r){for(;;){var n=r;if(!n)return!1;var t=D(d.compare,e,n[1]);if(0===t)return!0;r=t<0?n[0]:n[3]}},add:f,update:w,singleton:t,remove:v,merge:O,union:R,compare:function(e,r,n){for(var t=s(r,0),a=s(n,0);;){var i=a,u=t;if(!u)return i?-1:0;if(!i)return 1;var o=D(d.compare,u[0],i[0]);if(0!==o)return o;var c=D(e,u[1],i[1]);if(0!==c)return c;a=s(i[2],i[3]),t=s(u[2],u[3])}},equal:function(e,r,n){for(var t=s(r,0),a=s(n,0);;){var i=a,u=t;if(!u)return!i;if(!i)return!1;if(0!==D(d.compare,u[0],i[0]))return!1;if(!D(e,u[1],i[1]))return!1;a=s(i[2],i[3]),t=s(u[2],u[3])}},iter:u,fold:y,for_all:_,exists:S,filter:q,partition:T,cardinal:r,bindings:function(e){return L(0,e)},min_binding:a,min_binding_opt:e,max_binding:function(e){for(;;){if(!e)throw M;var r=e[3];if(!r)return[e[1],e[2]];e=r}},max_binding_opt:function(e){for(;;){if(!e)return;var r=e[3];if(!r)return[e[1],e[2]];e=r}},choose:a,choose_opt:e,split:N,find:function(e,r){for(;;){var n=r;if(!n)throw M;var t=D(d.compare,e,n[1]);if(0===t)return n[2];r=t<0?n[0]:n[3]}},find_opt:function(e,r){for(;;){var n=r;if(!n)return;var t=D(d.compare,e,n[1]);if(0===t)return ue(n[2]);r=t<0?n[0]:n[3]}},find_first:function(e,r){for(;;){var n=r;if(!n)throw M;var t=n[1];if(ve(e,t))for(var a=t,i=n[2],u=n[0];;){var o=u;if(!o)return[a,i];var c=o[1];ve(e,c)?(u=o[0],i=o[2],a=c):u=o[3]}r=n[3]}},find_first_opt:function(e,r){for(;;){var n=r;if(!n)return;var t=n[1];if(ve(e,t))for(var a=t,i=n[2],u=n[0];;){var o=u;if(!o)return[a,i];var c=o[1];ve(e,c)?(u=o[0],i=o[2],a=c):u=o[3]}r=n[3]}},find_last:function(e,r){for(;;){var n=r;if(!n)throw M;var t=n[1];if(ve(e,t))for(var a=t,i=n[2],u=n[3];;){var o=u;if(!o)return[a,i];var c=o[1];ve(e,c)?(u=o[3],i=o[2],a=c):u=o[0]}r=n[0]}},find_last_opt:function(e,r){for(;;){var n=r;if(!n)return;var t=n[1];if(ve(e,t))for(var a=t,i=n[2],u=n[3];;){var o=u;if(!o)return[a,i];var c=o[1];ve(e,c)?(u=o[3],i=o[2],a=c):u=o[0]}r=n[0]}},map:o,mapi:c}}function Sn(e,r){var n=r.length;if(0===n)return[];for(var t=function(e,r){for(var n=new Array(e),t=0;t<e;++t)n[t]=r;return n}(n,ve(e,r[0])),a=1;a<n;++a)t[a]=ve(e,r[a]);return t}function kn(e,r,n){for(var t=n,a=r.length-1|0;0<=a;--a)t=D(e,r[a],t);return t}ae("Array.Bottom");function xn(e,r){if(r in e)return ue(e[r])}var An=function(e){var r=typeof e;return"string"==r?ee(0,[e]):"number"==r?ee(1,[e]):"boolean"==r?!0===e?1:0:null===e?2:Array.isArray(e)?ee(3,[e]):ee(2,[e])};function Nn(e,r){return r.tag?r:e}function On(e,r){return r.tag?ue(r[0]):function(e){if(e.tag)return ue(e[0])}(e)}function Rn(e){return e?e[4]:0}function qn(e,r,n,t){var a=Rn(e),i=Rn(t);return[e,r,n,t,i<=a?a+1|0:i+1|0]}function Tn(e,r){return[0,e,r,0,1]}function Ln(e,r,n,t){var a=e?e[4]:0,i=t?t[4]:0;if((i+2|0)<a){if(e){var u=e[3],o=e[2],c=e[1],s=e[0];if(Rn(s)>=Rn(u))return qn(s,c,o,qn(u,r,n,t));if(u)return qn(qn(s,c,o,u[0]),u[1],u[2],qn(u[3],r,n,t));throw[F,"Map.bal"]}throw[F,"Map.bal"]}if(i<=(a+2|0))return[e,r,n,t,i<=a?a+1|0:i+1|0];if(t){var f=t[3],l=t[2],v=t[1],d=t[0];if(Rn(f)>=Rn(d))return qn(qn(e,r,n,d),v,l,f);if(d)return qn(qn(e,r,n,d[0]),d[1],d[2],qn(d[3],v,l,f));throw[F,"Map.bal"]}throw[F,"Map.bal"]}function Fn(e,r,n){if(!n)return[0,e,r,0,1];var t=n[3],a=n[2],i=n[1],u=n[0],o=h(e,i);if(0===o)return a===r?n:[u,e,r,t,n[4]];if(o<0){var c=Fn(e,r,u);return u===c?n:Ln(c,i,a,t)}var s=Fn(e,r,t);return t===s?n:Ln(u,i,a,s)}function Mn(e){for(;;){if(!e)throw M;var r=e[0];if(!r)return[e[1],e[2]];e=r}}function En(e){for(;;){if(!e)return;var r=e[0];if(!r)return[e[1],e[2]];e=r}}function Dn(e){if(e){var r=e[0];return r?Ln(Dn(r),e[1],e[2],e[3]):e[3]}throw[F,"Map.remove_min_elt"]}function Cn(e,r){if(!e)return r;if(!r)return e;var n=Mn(r);return Ln(e,n[0],n[1],Dn(r))}function In(e,r,n,t){if(!e)return function e(r,n,t){return t?Ln(e(r,n,t[0]),t[1],t[2],t[3]):Tn(r,n)}(r,n,t);if(!t)return function e(r,n,t){return t?Ln(t[0],t[1],t[2],e(r,n,t[3])):Tn(r,n)}(r,n,e);var a=t[4],i=e[4];return(a+2|0)<i?Ln(e[0],e[1],e[2],In(e[3],r,n,t)):(i+2|0)<a?Ln(In(e,r,n,t[0]),t[1],t[2],t[3]):qn(e,r,n,t)}function Pn(e,r){if(!e)return r;if(!r)return e;var n=Mn(r);return In(e,n[0],n[1],Dn(r))}function Wn(e,r,n,t){return void 0!==n?In(e,r,oe(n),t):Pn(e,t)}function $n(e,r){if(!r)return[0,void 0,0];var n=r[3],t=r[2],a=r[1],i=r[0],u=h(e,a);if(0===u)return[i,ue(t),n];if(u<0){var o=$n(e,i);return[o[0],o[1],In(o[2],a,t,n)]}var c=$n(e,n);return[In(i,a,t,c[0]),c[1],c[2]]}function Jn(e,r){for(;;){if(!e)return r;r=[e[1],e[2],e[3],r],e=e[0]}}var Zn={empty:0,is_empty:function(e){return!e},mem:function(e,r){for(;;){if(!r)return!1;var n=h(e,r[1]);if(0===n)return!0;r=n<0?r[0]:r[3]}},add:Fn,update:function e(r,n,t){if(t){var a=t[3],i=t[2],u=t[1],o=t[0],c=h(r,u);if(0===c){var s=ve(n,ue(i));if(void 0===s)return Cn(o,a);var f=oe(s);return i===f?t:[o,r,f,a,t[4]]}if(c<0){var l=e(r,n,o);return o===l?t:Ln(l,u,i,a)}var v=e(r,n,a);return a===v?t:Ln(o,u,i,v)}var d=ve(n,void 0);return void 0!==d?[0,r,oe(d),0,1]:0},singleton:Tn,remove:function e(r,n){if(!n)return 0;var t=n[3],a=n[2],i=n[1],u=n[0],o=h(r,i);if(0===o)return Cn(u,t);if(o<0){var c=e(r,u);return u===c?n:Ln(c,i,a,t)}var s=e(r,t);return t===s?n:Ln(u,i,a,s)},merge:function e(r,n,t){if(n){var a=n[1];if(n[4]>=Rn(t)){var i=$n(a,t);return Wn(e(r,n[0],i[0]),a,C(r,a,ue(n[2]),i[1]),e(r,n[3],i[2]))}}else if(!t)return 0;if(t){var u=t[1],o=$n(u,n);return Wn(e(r,o[0],t[0]),u,C(r,u,o[1],ue(t[2])),e(r,o[2],t[3]))}throw[E,["map.ml",393,10]]},union:function e(r,n,t){if(!n)return t;if(!t)return n;var a=t[2],i=t[1],u=n[2],o=n[1];if(n[4]>=t[4]){var c=$n(o,t),s=c[1],f=e(r,n[0],c[0]),l=e(r,n[3],c[2]);return void 0!==s?Wn(f,o,C(r,o,u,oe(s)),l):In(f,o,u,l)}var v=$n(i,n),d=v[1],h=e(r,v[0],t[0]),p=e(r,v[2],t[3]);return void 0!==d?Wn(h,i,C(r,i,oe(d),a),p):In(h,i,a,p)},compare:function(e,r,n){for(var t=Jn(r,0),a=Jn(n,0);;){var i=a,u=t;if(!u)return i?-1:0;if(!i)return 1;var o=h(u[0],i[0]);if(0!==o)return o;var c=D(e,u[1],i[1]);if(0!==c)return c;a=Jn(i[2],i[3]),t=Jn(u[2],u[3])}},equal:function(e,r,n){for(var t=Jn(r,0),a=Jn(n,0);;){var i=a,u=t;if(!u)return!i;if(!i)return!1;if(0!==h(u[0],i[0]))return!1;if(!D(e,u[1],i[1]))return!1;a=Jn(i[2],i[3]),t=Jn(u[2],u[3])}},iter:function e(r,n){for(;;){var t=n;if(!t)return;e(r,t[0]),D(r,t[1],t[2]),n=t[3]}},fold:function e(r,n,t){for(;;){var a=n;if(!a)return t;t=C(r,a[1],a[2],e(r,a[0],t)),n=a[3]}},for_all:function e(r,n){for(;;){var t=n;if(!t)return!0;if(!D(r,t[1],t[2]))return!1;if(!e(r,t[0]))return!1;n=t[3]}},exists:function e(r,n){for(;;){var t=n;if(!t)return!1;if(D(r,t[1],t[2]))return!0;if(e(r,t[0]))return!0;n=t[3]}},filter:function e(r,n){if(!n)return 0;var t=n[3],a=n[2],i=n[1],u=n[0],o=e(r,u),c=D(r,i,a),s=e(r,t);return c?u===o&&t===s?n:In(o,i,a,s):Pn(o,s)},partition:function e(r,n){if(!n)return[0,0];var t=n[2],a=n[1],i=e(r,n[0]),u=i[1],o=i[0],c=D(r,a,t),s=e(r,n[3]),f=s[1],l=s[0];return c?[In(o,a,t,l),Pn(u,f)]:[Pn(o,l),In(u,a,t,f)]},cardinal:function e(r){return r?(e(r[0])+1|0)+e(r[3])|0:0},bindings:function(e){return function e(r,n){for(;;){var t=n;if(!t)return r;n=t[0],r=[[t[1],t[2]],e(r,t[3])]}}(0,e)},min_binding:Mn,min_binding_opt:En,max_binding:function(e){for(;;){if(!e)throw M;var r=e[3];if(!r)return[e[1],e[2]];e=r}},max_binding_opt:function(e){for(;;){if(!e)return;var r=e[3];if(!r)return[e[1],e[2]];e=r}},choose:Mn,choose_opt:En,split:$n,find:function(e,r){for(;;){if(!r)throw M;var n=h(e,r[1]);if(0===n)return r[2];r=n<0?r[0]:r[3]}},find_opt:function(e,r){for(;;){var n=r;if(!n)return;var t=h(e,n[1]);if(0===t)return ue(n[2]);r=t<0?n[0]:n[3]}},find_first:function(e,r){for(;;){var n=r;if(!n)throw M;var t=n[1];if(ve(e,t))for(var a=t,i=n[2],u=n[0];;){var o=u;if(!o)return[a,i];var c=o[1];ve(e,c)?(u=o[0],i=o[2],a=c):u=o[3]}r=n[3]}},find_first_opt:function(e,r){for(;;){var n=r;if(!n)return;var t=n[1];if(ve(e,t))for(var a=t,i=n[2],u=n[0];;){var o=u;if(!o)return[a,i];var c=o[1];ve(e,c)?(u=o[0],i=o[2],a=c):u=o[3]}r=n[3]}},find_last:function(e,r){for(;;){var n=r;if(!n)throw M;var t=n[1];if(ve(e,t))for(var a=t,i=n[2],u=n[3];;){var o=u;if(!o)return[a,i];var c=o[1];ve(e,c)?(u=o[3],i=o[2],a=c):u=o[0]}r=n[0]}},find_last_opt:function(e,r){for(;;){var n=r;if(!n)return;var t=n[1];if(ve(e,t))for(var a=t,i=n[2],u=n[3];;){var o=u;if(!o)return[a,i];var c=o[1];ve(e,c)?(u=o[3],i=o[2],a=c):u=o[0]}r=n[0]}},map:function e(r,n){if(!n)return 0;var t=e(r,n[0]),a=ve(r,n[2]),i=e(r,n[3]);return[t,n[1],a,i,n[4]]},mapi:function e(r,n){if(!n)return 0;var t=n[1];return[e(r,n[0]),t,D(r,t,n[2]),e(r,n[3]),n[4]]}},Qn=ae("Tea_json.Decoder.ParseFail");function Bn(n){return[function(e){var r=An(e);return"number"==typeof r&&2<=r?ee(0,[n]):ee(1,["Non-null value"])}]}function Vn(a,e){var i=e[0];return[function(e){var r=An(e);if("number"==typeof r)return ee(1,["Non-fieldable value"]);if(2!==r.tag)return ee(1,["Non-fieldable value"]);var n=xn(r[0],a);if(void 0===n)return ee(1,["Field Value is undefined: "+a]);var t=ve(i,oe(n));return t.tag?ee(1,["field `"+a+("` -> "+t[0])]):t}]}function zn(r){return[function(e){var i=function(e,r){for(;;){var n=r;if(!n)return ee(1,["No one-of's matched"]);var t=n[1];try{var a=ve(n[0][0],e);return a.tag?i(e,t):a}catch(e){r=t;continue}}};return i(e,r)}]}function Hn(n,e){var t=e[0];return[function(e){var r=ve(t,e);return r.tag?ee(1,["map "+r[0]]):ee(0,[ve(n,r[0])])}]}function Un(t,e){var a=e[0];return[function(e){var r=ve(a,e);if(r.tag)return r;var n=ve(t,r[0]);return ve(n[0],e)}]}function jn(e,r){try{return ve(e[0],r)}catch(e){var n=se(e);return n[0]===Qn?ee(1,[n[1]]):ee(1,["Unknown JSON parsing error"])}}var Gn={ObjectDict:Zn,ParseFail:Qn,string:[function(e){var r=An(e);return"number"==typeof r||r.tag?ee(1,["Non-string value"]):ee(0,[r[0]])}],$$int:[function(e){var r=An(e);if("number"==typeof r)return ee(1,["Non-int value"]);if(1!==r.tag)return ee(1,["Non-int value"]);var n=r[0];return-2147483648<n&&n<2147483647?ee(0,[0|n]):ee(1,["number out of int range"])}],$$float:[function(e){var r=An(e);return"number"==typeof r||1!==r.tag?ee(1,["Non-float-value"]):ee(0,[r[0]])}],bool:[function(e){var r=An(e);if("number"!=typeof r)return ee(1,["Non-boolean value"]);switch(r){case 0:return ee(0,[!1]);case 1:return ee(0,[!0]);case 2:return ee(1,["Non-boolean value"])}}],$$null:Bn,list:function(e){var t=e[0];return[function(e){var r=An(e);if("number"==typeof r)return ee(1,["Non-list value"]);if(3!==r.tag)return ee(1,["Non-list value"]);try{return ee(0,[ye(function(e){var r=ve(t,e);if(!r.tag)return r[0];throw[Qn,r[0]]},function(e){for(var r=e.length-1|0,n=0;;){if(r<0)return n;n=[e[r],n],r=r-1|0}}(r[0]))])}catch(e){var n=se(e);if(n[0]===Qn)return ee(1,["list -> "+n[1]]);throw n}}]},array:function(e){var t=e[0];return[function(e){var r=An(e);if("number"==typeof r)return ee(1,["Non-array value"]);if(3!==r.tag)return ee(1,["Non-array value"]);try{return ee(0,[Sn(function(e){var r=ve(t,e);if(!r.tag)return r[0];throw[Qn,r[0]]},r[0])])}catch(e){var n=se(e);if(n[0]===Qn)return ee(1,["array -> "+n[1]]);throw n}}]},keyValuePairs:function(e){var i=e[0];return[function(e){var r=An(e);if("number"==typeof r)return ee(1,["Non-keyValuePair value"]);if(2!==r.tag)return ee(1,["Non-keyValuePair value"]);var a=r[0],n=Object.keys(a);try{return ee(0,[kn(function(e,r){var n=xn(a,e);if(void 0===n)throw[Qn,"Key is undefined: "+e];var t=ve(i,oe(n));if(!t.tag)return[[e,t[0]],r];throw[Qn,t[0]]},n,0)])}catch(e){var t=se(e);if(t[0]===Qn)return ee(1,["Invalid keyValuePair parsing: "+t[1]]);throw t}}]},dict:function(e){var i=e[0];return[function(e){var r=An(e);if("number"==typeof r)return ee(1,["Non-dict value"]);if(2!==r.tag)return ee(1,["Non-dict value"]);var a=r[0],n=Object.keys(a);try{return ee(0,[kn(function(e,r){var n=xn(a,e);if(void 0===n)throw[Qn,"Key is undefined: "+e];var t=ve(i,oe(n));if(!t.tag)return Fn(e,t[0],r);throw[Qn,t[0]]},n,0)])}catch(e){var t=se(e);if(t[0]===Qn)return ee(1,["Invalid dict parsing: "+t[1]]);throw t}}]},field:Vn,at:function(e,r){return function e(r,n,t){return n?D(r,n[0],e(r,n[1],t)):t}(Vn,e,r)},index:function(t,e){var a=e[0];return[function(e){var r=An(e);if("number"==typeof r)return ee(1,["Non-array value"]);if(3!==r.tag)return ee(1,["Non-array value"]);var n=r[0];return t<0||t>n.length?ee(1,["Array index out of range: "+String(t)]):ve(a,le(n,t))}]},maybe:function(e){var n=e[0];return[function(e){var r=ve(n,e);return r.tag?ee(0,[void 0]):ee(0,[ue(r[0])])}]},oneOf:zn,map:Hn,map2:function(a,e,r){var i=r[0],u=e[0];return[function(e){var r=ve(u,e),n=ve(i,e);if(!r.tag&&!n.tag)return ee(0,[D(a,r[0],n[0])]);var t=On(r,n);if(void 0!==t)return ee(1,["map2 -> "+t]);throw[w,"Impossible case"]}]},map3:function(i,e,r,n){var u=n[0],o=r[0],c=e[0];return[function(e){var r=ve(c,e),n=ve(o,e),t=ve(u,e);if(!r.tag&&!n.tag&&!t.tag)return ee(0,[C(i,r[0],n[0],t[0])]);var a=Nn(t,Nn(n,r));if(a.tag)return ee(1,["map3 -> "+a[0]]);throw[w,"Impossible case"]}]},map4:function(u,e,r,n,t){var o=t[0],c=n[0],s=r[0],f=e[0];return[function(e){var r=ve(f,e),n=ve(s,e),t=ve(c,e),a=ve(o,e);if(!(r.tag||n.tag||t.tag||a.tag))return ee(0,[function(t,a,i,u,o){var e=t.length;if(4===e)return t(a,i,u,o);switch(e){case 1:return y(t(a),[i,u,o]);case 2:return y(t(a,i),[u,o]);case 3:return y(t(a,i,u),[o]);case 4:return t(a,i,u,o);case 5:return function(e){return t(a,i,u,o,e)};case 6:return function(e,r){return t(a,i,u,o,e,r)};case 7:return function(e,r,n){return t(a,i,u,o,e,r,n)};default:return y(t,[a,i,u,o])}}(u,r[0],n[0],t[0],a[0])]);var i=Nn(a,Nn(t,Nn(n,r)));if(i.tag)return ee(1,["map4 -> "+i[0]]);throw[w,"Impossible case"]}]},map5:function(o,e,r,n,t,a){var c=a[0],s=t[0],f=n[0],l=r[0],v=e[0];return[function(e){var r=ve(v,e),n=ve(l,e),t=ve(f,e),a=ve(s,e),i=ve(c,e);if(!(r.tag||n.tag||t.tag||a.tag||i.tag))return ee(0,[function(n,t,a,i,u,o){var e=n.length;if(5===e)return n(t,a,i,u,o);switch(e){case 1:return y(n(t),[a,i,u,o]);case 2:return y(n(t,a),[i,u,o]);case 3:return y(n(t,a,i),[u,o]);case 4:return y(n(t,a,i,u),[o]);case 5:return n(t,a,i,u,o);case 6:return function(e){return n(t,a,i,u,o,e)};case 7:return function(e,r){return n(t,a,i,u,o,e,r)};default:return y(n,[t,a,i,u,o])}}(o,r[0],n[0],t[0],a[0],i[0])]);var u=Nn(i,Nn(a,Nn(t,Nn(n,r))));if(u.tag)return ee(1,["map5 -> "+u[0]]);throw[w,"Impossible case"]}]},map6:function(c,e,r,n,t,a,i){var s=i[0],f=a[0],l=t[0],v=n[0],d=r[0],h=e[0];return[function(e){var r=ve(h,e),n=ve(d,e),t=ve(v,e),a=ve(l,e),i=ve(f,e),u=ve(s,e);if(!(r.tag||n.tag||t.tag||a.tag||i.tag||u.tag))return ee(0,[function(r,n,t,a,i,u,o){var e=r.length;if(6===e)return r(n,t,a,i,u,o);switch(e){case 1:return y(r(n),[t,a,i,u,o]);case 2:return y(r(n,t),[a,i,u,o]);case 3:return y(r(n,t,a),[i,u,o]);case 4:return y(r(n,t,a,i),[u,o]);case 5:return y(r(n,t,a,i,u),[o]);case 6:return r(n,t,a,i,u,o);case 7:return function(e){return r(n,t,a,i,u,o,e)};default:return y(r,[n,t,a,i,u,o])}}(c,r[0],n[0],t[0],a[0],i[0],u[0])]);var o=Nn(u,Nn(i,Nn(a,Nn(t,Nn(n,r)))));if(o.tag)return ee(1,["map6 -> "+o[0]]);throw[w,"Impossible case"]}]},map7:function(s,e,r,n,t,a,i,u){var f=u[0],l=i[0],v=a[0],d=t[0],h=n[0],p=r[0],m=e[0];return[function(e){var r=ve(m,e),n=ve(p,e),t=ve(h,e),a=ve(d,e),i=ve(v,e),u=ve(l,e),o=ve(f,e);if(!(r.tag||n.tag||t.tag||a.tag||i.tag||u.tag||o.tag))return ee(0,[function(e,r,n,t,a,i,u,o){var c=e.length;if(7===c)return e(r,n,t,a,i,u,o);switch(c){case 1:return y(e(r),[n,t,a,i,u,o]);case 2:return y(e(r,n),[t,a,i,u,o]);case 3:return y(e(r,n,t),[a,i,u,o]);case 4:return y(e(r,n,t,a),[i,u,o]);case 5:return y(e(r,n,t,a,i),[u,o]);case 6:return y(e(r,n,t,a,i,u),[o]);case 7:return e(r,n,t,a,i,u,o);default:return y(e,[r,n,t,a,i,u,o])}}(s,r[0],n[0],t[0],a[0],i[0],u[0],o[0])]);var c=Nn(o,Nn(u,Nn(i,Nn(a,Nn(t,Nn(n,r))))));if(c.tag)return ee(1,["map7 -> "+c[0]]);throw[w,"Impossible case"]}]},map8:function(f,e,r,n,t,a,i,u,o){var l=o[0],v=u[0],d=i[0],h=a[0],p=t[0],m=n[0],g=r[0],b=e[0];return[function(e){var r=ve(b,e),n=ve(g,e),t=ve(m,e),a=ve(p,e),i=ve(h,e),u=ve(d,e),o=ve(v,e),c=ve(l,e);if(!(r.tag||n.tag||t.tag||a.tag||i.tag||u.tag||o.tag||c.tag))return ee(0,[function(e,r,n,t,a,i,u,o,c){var s=e.length;if(8===s)return e(r,n,t,a,i,u,o,c);switch(s){case 1:return y(e(r),[n,t,a,i,u,o,c]);case 2:return y(e(r,n),[t,a,i,u,o,c]);case 3:return y(e(r,n,t),[a,i,u,o,c]);case 4:return y(e(r,n,t,a),[i,u,o,c]);case 5:return y(e(r,n,t,a,i),[u,o,c]);case 6:return y(e(r,n,t,a,i,u),[o,c]);case 7:return y(e(r,n,t,a,i,u,o),[c]);default:return y(e,[r,n,t,a,i,u,o,c])}}(f,r[0],n[0],t[0],a[0],i[0],u[0],o[0],c[0])]);var s=Nn(c,Nn(o,Nn(u,Nn(i,Nn(a,Nn(t,Nn(n,r)))))));if(s.tag)return ee(1,["map8 -> "+s[0]]);throw[w,"Impossible case"]}]},succeed:function(r){return[function(e){return ee(0,[r])}]},fail:function(r){return[function(e){return ee(1,[r])}]},value:[function(e){return ee(0,[e])}],andThen:Un,lazy_:function(e){return Un(e,[function(e){return ee(0,[void 0])}])},nullable:function(e){return zn([Bn(void 0),[Hn(ue,e),0]])},decodeValue:jn,decodeEvent:function(e,r){try{return ve(e[0],r)}catch(e){var n=se(e);return n[0]===Qn?ee(1,[n[1]]):ee(1,["Unknown JSON parsing error"])}},decodeString:function(e,r){try{return jn(e,JSON.parse(r))}catch(e){return ee(1,["Invalid JSON string"])}}};function Xn(e){return ee(1,[e])}function Yn(e,r,n,t){return Ue("","div",void 0!==e?e:"",void 0!==r?r:"",n,t)}function Kn(e,r,n,t){return Ue("","span",void 0!==e?e:"",void 0!==r?r:"",n,t)}function et(e,r,n,t){return Ue("","p",void 0!==e?e:"",void 0!==r?r:"",n,t)}function rt(e,r,n,t){return Ue("","h3",void 0!==e?e:"",void 0!==r?r:"",n,t)}function nt(e,r,n,t){return Ue("","button",void 0!==e?e:"",void 0!==r?r:"",n,t)}function tt(e,r,n,t){return Ue("","textarea",void 0!==e?e:"",void 0!==r?r:"",n,t)}function at(e,r,n,t){return Ue("","label",void 0!==e?e:"",void 0!==r?r:"",n,t)}function it(e,r,n,t){return Ue("","ul",void 0!==e?e:"",void 0!==r?r:"",n,t)}function ut(e,r,n,t){return Ue("","li",void 0!==e?e:"",void 0!==r?r:"",n,t)}function ot(e,r,n,t){return Ue("","option",void 0!==e?e:"",void 0!==r?r:"",n,t)}function ct(e,r,n,t){return Ue("","hr",void 0!==e?e:"",void 0!==r?r:"",n,t)}function st(e){return ee(0,["className",e])}function ft(e){return ee(0,["className",Pe(" ",ye(function(e){return e[0]},Ae(function(e){return e[1]})(e)))])}function lt(e){return ee(0,["placeholder",e])}function vt(e){return ee(0,["value",e])}var dt=je;function ht(e,r){var n,t;return t=function(e){return ue(ve(r,e))},je("input",void 0!==(n=void 0!==e?e:"")?n:"",function(e){var r=e.target;if(void 0!==r){var n=r.value;return void 0!==n?ve(t,n):void 0}})}function pt(e,r){var n,t;return t=function(e){return ue(ve(r,e))},je("change",void 0!==(n=void 0!==e?e:"")?n:"",function(e){var r=e.target;if(void 0!==r){var n=r.value;return void 0!==n?ve(t,n):void 0}})}function mt(e){return ee(3,["click",ee(1,[e]),{contents:void 0}])}var gt={stopPropagation:!1,preventDefault:!1},bt=(Gn.at(["target",["value",0]],Gn.string),Gn.at(["target",["checked",0]],Gn.bool),Gn.field("keyCode",Gn.$$int));var wt={max:function(e){return ee(1,["","max",e])},min:function(e){return ee(1,["","min",e])},step:function(e){return ee(1,["","step",e])},disabled:function(e){return e?ee(1,["","disabled","true"]):0},selected:function(e){return e?ee(1,["","selected","true"]):0},acceptCharset:function(e){return ee(1,["","accept-charset",e])},rel:function(e){return ee(1,["","rel",e])}},yt=He,_t=0,St=246,kt=250,xt=ae("CamlinternalLazy.Undefined");function At(e){throw xt}function Nt(e){var r=0|e.tag;return r===kt?e[0]:r!==St?e:function(e){var r,n=e[0];e[0]=At;try{var t=ve(n,void 0);return e[0]=t,r=kt,e.tag=r,t}catch(r){throw e[0]=function(e){throw r},r}}(e)}function Ot(e,r){return xe(ye(r,e))}var Rt={take:function(e,r){var n=function(e,r,n){for(;;){var t=r;if(0===n)return[e,t];if(!t)return[e,0];n=n-1|0,r=t[1],e=[t[0],e]}}(0,r,e);return[be(n[0]),n[1]]},apply:function(e,r){return ve(r,e)},bind:Ot,concat_map:function(e,r){return xe(ye(e,r))},$great$great$eq:Ot,next_or_this_item:function(e,r){for(var n=r;;){if(!n)return e;var t=n[1];if(m(e,n[0]))return t?t[0]:e;n=t}},count:function(e,r){for(var n=0,t=r;;){var a=n;if(!t)return a;var i=t[1];ve(e,t[0])?(t=i,n=a+1|0):t=i}},list_from_option:function(e){return void 0!==e?[oe(e),0]:0},first_inconsistent_opt:function(e,r){if(e)for(var n=ve(r,e[0]),t=e[1];;){var a=t,i=n;if(!a)return;var u=ve(r,a[0]);if(!m(u,i))return[i,u];t=a[1],n=u}}};function qt(e,r,n){return dt(e,r,function(e){return gt.stopPropagation&&e.stopPropagation(),gt.preventDefault&&e.preventDefault(),(r=Gn.decodeEvent(n,e)).tag?void 0:ue(r[0]);var r})}var Tt={keydown:function(e,r,n){var t=Gn.field("ctrlKey",Gn.bool),a=Gn.map2(function(e,r){return{ctrlKey:r,keyCode:e}},bt,t);return qt("keydown",e,Gn.andThen(function(e){return ve(n,e)?Gn.succeed(r):Gn.fail("Incorrect keys")},a))}},Lt={on_keyed:qt,Keydown:Tt};function Ft(e,r){return r.tag?r:ee(0,[ve(e,r[0])])}function Mt(e){return e.tag?e:e[0]}function Et(e,r){return Mt(Ft(r,e))}var Dt={map:Ft,map_error:function(e,r){return r.tag?ee(1,[ve(e,r[0])]):r},flatten:Mt,flat_map:function(e,r){return Mt(Ft(e,r))},bind:Et,$great$great$eq:Et};function Ct(e){return[e,0]}function It(r,e){if(!e)return 0;var n=e[1];return[ve(r,e[0]),i(function(e){return It(r,Nt(n))})]}function Pt(e,r){if(!e)return Nt(r);var n=e[1];return[e[0],i(function(e){return Pt(Nt(r),n)})]}function Wt(e){if(!e)return 0;var r=e[1];return Pt(e[0],i(function(e){return Wt(Nt(r))}))}function $t(e,r){return Wt(It(r,e))}var Jt={$$return:Ct,unit:Ct,push:function(e,r){return[e,r]},zip:function r(e,n){if(!e)return 0;if(!n)return 0;var t=n[1],a=e[1];return[[e[0],n[0]],i(function(e){return r(Nt(a),Nt(t))})]},numbers_from:function r(n){return[n,i(function(e){return r(n+1|0)})]},map:It,filter:function n(t,e){for(;;){if(!e)return 0;var r=e[1],a=e[0];if(ve(t,a))return[a,i(function(r){return function(e){return n(t,Nt(r))}}(r))];e=Nt(r)}},interleave_delayed:Pt,append_delayed:function r(e,n){if(!e)return Nt(n);var t=e[1];return[e[0],i(function(e){return r(Nt(t),n)})]},flatten:Wt,bind:$t,$great$great$eq:$t,from_list:function r(e){if(!e)return 0;var n=e[1];return[e[0],i(function(e){return r(n)})]},from_option:function(e){return void 0!==e?[oe(e),0]:0}};function Zt(e,r){return[D(Zr([ee(2,[0,ee(11,["__Renamed",ee(4,[0,0,0,0])])]),"%s__Renamed%d"]),e[0],r)]}function Qt(e){return ve(Zr([ee(12,[63,ee(2,[0,0])]),"?%s"]),e[0])}var Bt={compare:function(e,r){return h(e[0],r[0])},make:function(e){return[e]},make_numbered:Zt,to_string:Qt};function Vt(e,r){return h(e[0],r[0])}function zt(e,r){return e[0]===r[0]}var Ht={make:function(e){return[e]},compare:Vt,equals:zt,to_string:function(e){return e[0]}};function Ut(e){if(!e.tag)return Qt(e[0]);var r=e[0],n=r.related_terms,t=r.relation_name[0];return n?D(Zr([ee(2,[0,ee(12,[40,ee(2,[0,ee(12,[41,0])])])]),"%s(%s)"]),t,Pe(", ",ye(Ut,n))):t}function jt(e){if(!e.tag)return 0;var r=e[0],n=r.related_terms;return[[r.relation_name,me(n)],Rt.concat_map(jt,n)]}var Gt={make_relation:function(e,r){return ee(1,[{relation_name:[e],related_terms:r}])},make_variable:function(e){return ee(0,[[e]])},to_string:Ut,relation_arities:jt};function Xt(e){switch(0|e.tag){case 0:return Ut(e[0]);case 1:return D(Zr([ee(12,[60,ee(2,[0,ee(11,[" = ",ee(2,[0,ee(12,[62,0])])])])]),"<%s = %s>"]),Ut(e[0]),Ut(e[1]));case 2:return D(Zr([ee(12,[60,ee(2,[0,ee(11,[" /= ",ee(2,[0,ee(12,[62,0])])])])]),"<%s /= %s>"]),Ut(e[0]),Ut(e[1]))}}function Yt(e){switch(0|e.tag){case 0:return jt(e[0])}return xe([jt(e[0]),[jt(e[1]),0]])}var Kt={to_string:Xt,relation_arities:Yt};function ea(e){return Pe("\n\tand ",ye(Xt,e))}var ra={empty:0,to_string:ea},na=_n(Bt),ta=na.empty;function aa(e,r){return C(na.add,e[0],e[1],r)}function ia(e,r){var n=D(na.find_opt,e,r);if(void 0!==n){if(n.tag)return n;var t=ia(n[0],r);return void 0!==t?t:n}}function ua(e,n){function t(e){var r=ia(e,n);return void 0!==r?i(r):ee(0,[["?"]])}var a=function(e,r){if(r.tag)return Se(a,e,r[0].related_terms);var n=r[0];return aa([n,t(n)],e)},i=function(e){if(!e.tag)return t(e[0]);var r=e[0];return ee(1,[{relation_name:r.relation_name,related_terms:ye(i,r.related_terms)}])};return ve(na.bindings,Se(function(e,r){switch(0|r.tag){case 0:return a(e,r[0])}return a(a(e,r[0]),r[1])},ta,e))}function oa(e,a,i){var u=function(e){for(;;){var r=e;if(r.tag)return function(e,r){for(;;){var n=r;if(!n)return!1;if(ve(e,n[0]))return!0;r=n[1]}}(u,r[0].related_terms);var n=r[0];if(m(n,a))return!0;var t=ia(n,i);if(void 0===t)return!1;e=t}};return u(e)}var ca={FrameMap:na,empty:ta,extend:aa,to_all_bindings:function(e){return ye(function(e){return D(Zr([ee(2,[0,ee(11,[" := ",ee(2,[0,0])])]),"%s := %s"]),Qt(e[0]),Ut(e[1]))},ve(na.bindings,e))},lookup:ia,instantiate:function(t){var a=function(e){if(!e.tag){var r=ia(e[0],t);return void 0!==r?a(r):ee(0,[["?"]])}var n=e[0];return ee(1,[{relation_name:n.relation_name,related_terms:ye(a,n.related_terms)}])};return a},variable_bindings_in_query:ua,to_strings:function(e,r){var n=ua(e,r);return n?ye(function(e){return D(Zr([ee(2,[0,ee(11,[" := ",ee(2,[0,0])])]),"%s := %s"]),Qt(e[0]),Ut(e[1]))},n):0},term_depends_on_variable:oa};function sa(e){return xe([we(ye(Yt,e.antecedents)),[jt(e.consequent),0]])}var fa={contents:1};function la(e){if(!e.tag)return ee(0,[Zt(e[0],fa.contents)]);var r=e[0],n=ye(la,r.related_terms);return ee(1,[{relation_name:r.relation_name,related_terms:n}])}function va(e){switch(0|e.tag){case 0:return ee(0,[la(e[0])]);case 1:return ee(1,[la(e[0]),la(e[1])]);case 2:return ee(2,[la(e[0]),la(e[1])])}}function da(e){return fa.contents=fa.contents+1|0,{antecedents:ye(va,e.antecedents),consequent:la(e.consequent)}}var ha={to_string:function(e){var r,n,t=e.antecedents,a=Ut(e.consequent);return n=t?(r=ea(t),D(Zr([ee(2,[0,ee(11,["\n\twhen ",ee(2,[0,0])])]),"%s\n\twhen %s"]),a,r)):a,ve(Zr([ee(2,[0,ee(12,[46,0])]),"%s."]),n)},relation_arities:sa,rename_rule_variables:da},pa=_n({compare:Je});function ma(e){return e.rule}function ga(e,r){return e.id===r.id}var ba={all_rules:0,indexed_by_consequent_relation:pa.empty};function wa(e,r){var n,t;return t=r.tag?void 0!==(n=D(pa.find_opt,r[0].relation_name[0],e.indexed_by_consequent_relation))?n:0:e.all_rules,Jt.from_list(be(t))}function ya(e){return be(e.all_rules)}var _a={contents:1};function Sa(e,r){var n={id:(_a.contents=_a.contents+1|0,_a.contents),rule:r},t=r.consequent;return t.tag?{all_rules:[n,e.all_rules],indexed_by_consequent_relation:C(pa.update,t[0].relation_name[0],function(e){return void 0!==e?[n,e]:[n,0]},e.indexed_by_consequent_relation)}:{all_rules:[n,e.all_rules],indexed_by_consequent_relation:e.indexed_by_consequent_relation}}var ka,xa={VariableName:Bt,RelationName:Ht,Term:Gt,ComplexTerm:Kt,Query:ra,Frame:ca,Rule:ha,RuleDatabase:{empty:ba,rule_from_entry:ma,identifier_of_rule_entry:function(e){return ve(Zr([ee(4,[0,0,0,0]),"%d"]),e.id)},update_rule_entry:function(e,r){return{id:e.id,rule:r}},is_same:ga,remove_rule:function(e,r){var n=r.id,t=Ae(function(e){return e.id!==n}),a=ve(t,e.all_rules),i=r.rule.consequent;return i.tag?{all_rules:a,indexed_by_consequent_relation:C(pa.update,i[0].relation_name[0],function(e){return void 0!==e?ve(t,e):0},e.indexed_by_consequent_relation)}:{all_rules:a,indexed_by_consequent_relation:e.indexed_by_consequent_relation}},add_rule:Sa,update_rule:function(e,r){function n(e){return ye(function(e){return e.id===r.id?r:e},e)}var t=n(e.all_rules),a=r.rule.consequent;return a.tag?{all_rules:t,indexed_by_consequent_relation:C(pa.update,a[0].relation_name[0],function(e){return void 0!==e?n(e):[r,0]},e.indexed_by_consequent_relation)}:{all_rules:t,indexed_by_consequent_relation:e.indexed_by_consequent_relation}},fetch_for_query:wa,all_rules:ya}},Aa={$$Map:ka=_n({compare:Vt}),make:function(n,e){return Se(function(e,r){return C(ka.update,ve(n,r),function(e){return void 0!==e?[r,e]:[r,0]},e)},ka.empty,e)},keys:function(e){return ye(function(e){return e[0]},ve(ka.bindings,e))},find_opt:function(e,r){return D(ka.find_opt,e,r)}};function Na(a,e){return Se(function(e,r){var n=ve(a,r);if(void 0===n)return e;var t=Rt.first_inconsistent_opt(n,function(e){return e[1]});return void 0!==t?[C(Zr([ee(11,["Relation '",ee(2,[0,ee(11,["' has inconsistent number of terms applied of ",ee(4,[0,0,0,ee(11,[" and ",ee(4,[0,0,0,0])])])])])]),"Relation '%s' has inconsistent number of terms applied of %d and %d"]),r[0],t[0],t[1]),e]:e},0,e)}function Oa(e){return D(Aa.make,function(e){return e[0]},Rt.concat_map(sa,e))}function Ra(e){return ve(Aa.keys,D(Aa.make,function(e){return e[0]},sa(e)))}function qa(e,r){var n=Oa([r,ye(ma,e)]);return Na(function(e){return D(Aa.find_opt,e,n)},Ra(r))}var Ta={rule_database_snapshot:ya,issues_in_existing_rule:function(e,r){var n=Oa(ye(ma,[r,Ae(function(e){return!ga(e,r)})(e)]));return Na(function(e){return D(Aa.find_opt,e,n)},Ra(ma(r)))},issues_in_new_rule:qa,issues_in_query:function(e,r){var n=Rt.concat_map(Yt,r),t=D(Aa.make,function(e){return e[0]},xe([n,[Rt.concat_map(sa,ye(ma,e)),0]]));return Na(function(e){return D(Aa.find_opt,e,t)},ve(Aa.keys,D(Aa.make,function(e){return e[0]},n)))}};function La(e){function r(e){return bn(vn,t,e)}function n(e){return Ur(a,r,e)}var t=nn(95),a=ve(Zr([ee(2,[0,ee(11,[" requires ",ee(2,[0,0])])]),"%s requires %s"]),e);return function(e){return gn(n,function(r){return Gr(function(e){return Pe("",ye(function(e){return Ce(1,e)},[r,e]))},Kr(Yr([vn,[fn,[nn(95),[nn(45),0]]]])))},e)}}var Fa=wn(nn(63),Gr(function(e){return ee(0,[[e]])},La("Variable")));function Ma(e){return jr("Variable starting with ?",Fa,e)}var Ea=wn(hn("= "),function(e){return Hr(!0,e)}),Da=wn(hn("/= "),function(e){return Hr(!1,e)});function Ca(e){return bn(Ea,Da,e)}function Ia(e){return en(e,wn(wn(dn,hn("and")),dn))}function Pa(e){return bn(Ma,Za,e)}function Wa(e){return bn(Gr(function(e){return ee(0,[e])},Pa),Ja,e)}function $a(e){return en(yn(Pa,dn),wn(nn(44),dn))(e)}function Ja(e){return gn(wn(nn(60),Pa),function(t){return function(e){return gn(Ca,function(n){var r=yn(Pa,nn(62));return function(e){return gn(r,function(e){var r=ee(n?1:2,[t,e]);return function(e){return Hr(r,e)}},e)}},e)}},e)}function Za(e){return gn(yn(La("Relation"),dn),function(e){var r=[e],n=ee(1,[{relation_name:r,related_terms:0}]),t=yn(nn(40),dn);return function(e){return zr(t,function(e){return Gr(function(e){return ee(1,[{relation_name:r,related_terms:e}])},yn(yn($a,dn),nn(41)))},n,e)}},e)}function Qa(e){return Ia(Wa)(e)}function Ba(e){return yn(function(e){return gn(Pa,function(r){function n(e){return Hr(t,e)}var t={antecedents:0,consequent:r},a=Gr(function(e){return{antecedents:e,consequent:r}},wn(wn(wn(dn,hn("when")),dn),Qa));return function(e){return bn(a,n,e)}},e)},nn(46))(e)}var Va={rule_parser:Ba,query_parser:function(e){return Ia(Wa)(e)},rule_database_result_from_rule_strings:function(e){return Se(function(e,r){return Dt.flat_map(function(t){return Dt.flat_map(function(e){var r=e.result,n=qa(ya(t),r);return 0<me(n)?ee(1,[n]):ee(0,[Sa(t,r)])},Dt.map_error(function(e){return ye(Qr,e)},mn(Ba,r)))},e)},ee(0,[ba]),e)}};function za(e){var r=function(e,r){for(var n=0,t=0,a=r;;){var i=a,u=t,o=n;if(!i)return[ge(o,0),ge(u,0)];var c=i[1],s=i[0];ve(e,s)?(a=c,n=[s,o]):(a=c,t=[s,u])}}(function(e){switch(0|e.tag){case 0:case 1:return!1;case 2:return!0}},e);return xe([r[1],[r[0],0]])}function Ha(c,e){var s=function(o,e,r){for(;;){var n=r,t=e;if(200<o)return Jt.$$return({frame:ta,rules_applied:0,failed_at_depth:o});var a=function(u){return function(e){switch(0|e.tag){case 0:var a=e[0];return Jt.$great$great$eq(u,function(t){return Jt.$great$great$eq(wa(c,a),function(e){var r=da(ma(e)),n=f(a,r.consequent,t);return void 0!==n?s(o+1|0,r.antecedents,Jt.$$return({frame:n.frame,rules_applied:[e,n.rules_applied],failed_at_depth:n.failed_at_depth})):0})});case 1:var r=e[1],n=e[0];return Jt.$great$great$eq(u,function(e){return Jt.from_option(f(n,r,e))});case 2:var t=e[1],i=e[0];return Jt.$great$great$eq(u,function(e){return void 0!==f(i,t,e)?0:Jt.$$return(e)})}}}(n);if(!t)return n;r=a(t[0]),e=t[1]}},f=function(e,r,n){function t(e,r,n){var t=ia(e,n.frame);if(void 0!==t)return f(t,r,n);if(r.tag)return oa(r,e,n.frame)?void 0:{frame:aa([e,r],n.frame),rules_applied:n.rules_applied,failed_at_depth:n.failed_at_depth};var a=ia(r[0],n.frame);return void 0!==a?f(ee(0,[e]),a,n):{frame:aa([e,r],n.frame),rules_applied:n.rules_applied,failed_at_depth:n.failed_at_depth}}if(m(e,r))return n;if(!e.tag)return t(e[0],r,n);var a=e[0];if(!r.tag)return t(r[0],e,n);var i=r[0];return zt(a.relation_name,i.relation_name)?Se(function(e,r){if(void 0!==e)return f(r[0],r[1],e)},n,ke(a.related_terms,i.related_terms)):void 0},r=za(e);return function(e){return s(1,r,e)}}var Ua={query:function(e,r){return Ha(e,r)(Jt.$$return({frame:ta,rules_applied:0,failed_at_depth:void 0}))}};function ja(e){var r=function e(r){if(!r)return ee(0,[0]);var n=r[1],t=r[0];if(!n)return t.tag?t:ee(0,[[t[0],0]]);if(t.tag)return t;var a=e(n);return a.tag?a:ee(0,[[t[0],a[0]]])}(ye(function(e){return mn(Va.query_parser,e)},ye(function(e){return e[0]},e.queries)));return r.tag?(console.error(r[0]),0):ke(ye(Br,r[0]),ye(function(e){return e[1]},e.queries))}var Ga=[{name:"Simple Facts",rule_instructions:["FACTs are unconditionally true statements. As soon as a fact is entered into the database it is known to be true. \n        A Fact can relate other terms together or it can stand on its own. In this chapter we show just simple facts that stand on their own.",["A Fact is represented as an identifier written in any case. Spaces cannot be used inside Fact names but underscores can be.",["Click the <Query> button to explore the queries that can be written against this simple database.",0]]],rules:["OrangesAreSpherical.",["oranges_are_spherical.",["SoccerBallsAreSpherical.",["soccerBalls_ARE_spherical.",0]]]],queries:[["SoccerBallsAreSpherical",["This query just asks whether the fact is found in the database. Execute this query to reveal that this fact is found in the database."]],[["FootballsAreSpherical",["Try this query. Observe that no solution was found because the fact is not in the database."]],0]]},[{name:"Facts as Predicates",rule_instructions:["Facts can also express the truth of a _relationship_ between things. A Fact that expresses a relationship with a single term can be viewed as a declaration of \n            inclusion in a Set (a Predicate). For example, the facts from the previous chapter about spherical items can be more usefully represented as predicates.",0],rules:["Spherical(Oranges).",["Spherical(SoccerBalls).",["Spherical(BasketBalls).",["Spherical(Sun).",0]]]],queries:[["Spherical(Oranges)",["This query just asks if this specific fact is in the database. It is."]],[["Spherical(FootBalls)",["Observe that this query fails to find a solution."]],0]]},[{name:"Querying with Variables",rule_instructions:["The queries in the prior chapters were pretty lame because they could only ask if very _specific_ facts were present in the database.",["To introduce a little abstraction we need variables which act as kind of wildcard placeholders for any value. Variables are written with a ? prefix.",["When a query includes a variable, the solution to the query will display the variable binding which satisfies the query.",0]]],rules:["Spherical(Oranges).",["Spherical(SoccerBalls).",["Spherical(BasketBalls).",["Spherical(Sun).",0]]]],queries:[["Spherical(?sphericalThing)",["When you execute this query you will observe multiple things: 1) the solution now includes the value of the binding and \n            2) there are now multiple solutions which can be requested with Next Solution. Logic programming environments\n            require user to explicitly ask for the Next Solution because logic programming supports INFINITE solution spaces!!!"]],0]},[{name:"Relationships",rule_instructions:["Facts can express relationships between multiple things. This child demonstrates declaration of mother-child relationships.",0],rules:["MotherOf(Sally, Bob).",["MotherOf(Sally, Janice).",["MotherOf(Sally, Debrah).",["MotherOf(Janice, Malcom).",0]]]],queries:[["MotherOf(Sally, ?childOfSally)",["This query will find all children of Sally in the database."]],[["MotherOf(?motherOfBob, Bob)",["This query will find the mother (or mothers) of Bob. NOTE: We have now seen that variables can be put in any place. That is a powerful concept we will explore later."]],[["MotherOf(?mother, ?child)",["In fact, we can use variables for both locations to get all mother-child solutions in the database."]],0]]]},[{name:"Unification in Queries",rule_instructions:["",0],rules:["MotherOf(Sally, Bob).",["MotherOf(Sally, Janice).",["MotherOf(Sally, Debrah).",["MotherOf(Janice, Malcom).",0]]]],queries:[["MotherOf(?mother, ?siblingOne) and MotherOf(?mother, ?siblingTwo)",["Match on all mother/child pairs where the SAME mother is common to both. When running this query you will observe that a person is their own sibling."]],[["MotherOf(?mother, ?siblingOne) and MotherOf(?mother, ?siblingTwo) and <?siblingOne /= ?siblingTwo>",["To filter out cases where siblingOne and siblingTwo are the same person we use the /= operator which stands for 'does not unify'."]],0]]},[{name:"Unification: Database",rule_instructions:[" ",0],rules:["Job(Cindy, QualityEngineer).",["Smart(Cindy).",["GetsThingsDone(Cindy).",["Salary(Cindy, Moderate).",["Job(Swathi, QualityEngineer).",["Smart(Swathi).",["GetsThingsDone(Swathi).",["Salary(Swathi, High).",["Job(William, QualityEngineer).",["GetsThingsDone(William).",["Salary(William, Low).",["Job(Janet, QualityEngineer).",["Smart(Janet).",["Salary(Janet, Low).",["Job(Alice, SoftwareEngineer).",["Smart(Alice).",["GetsThingsDone(Alice).",["Salary(Alice, Low).",["Job(Beatrice, Marketing).",["Smart(Beatrice).",["GetsThingsDone(Beatrice).",["Salary(Beatrice, High).",0]]]]]]]]]]]]]]]]]]]]]],queries:[["Job(?person, QualityEngineer)",["Simply find all the persons who are quality engineers."]],[["Job(?person, QualityEngineer) and Smart(?person) and GetsThingsDone(?person)",["Now find all the quality engineers who are both smart and get things done."]],[["Job(?person, ?jobRole) and Smart(?person) and GetsThingsDone(?person)",["Just find the smart industrious people and report on their job role."]],[["Job(?person, QualityEngineer) and Smart(?person) and GetsThingsDone(?person) and Salary(?person, ?salary) and <?salary /= High>",["Now find all the smart, industrious quality engineers who do not get paid a high salary."]],0]]]]},[{name:"Implication (Rules)",rule_instructions:["While Facts are uncondtionally true, a RULE specifies a _conclusion_ whose truth is dependent upon one or more conditions. For example, someone is a parent of someone else if \n        we can prove that they are the mother or father. Parenthood follows from motherhood and fatherhood.",0],rules:["ParentOf(?parent, ?child) when MotherOf(?parent, ?child).",["ParentOf(?parent, ?child) when FatherOf(?parent, ?child).",["MotherOf(Sally, Janice).",["MotherOf(Sally, Debrah).",["MotherOf(Janice, Malcom).",["FatherOf(Roberto, Janice).",0]]]]]],queries:[["ParentOf(Sally, Janice)",["Here we will simply ask the database if it can prove that Sally is the parent of Janice. NOTE: The database does not explicitly declare Sally is the parent of Janice. The logic system deduced the fact from the rules given."]],[["ParentOf(?parent, Janice)",["We can also use variables in the query to find all parents of Janice."]],[["ParentOf(Sally, ?child)",["Or find all the children of Sally."]],0]]]},[{name:"Unification in Rules",rule_instructions:["In this next example consider the definition of Siblings. Note that the variable ?parent is found in two sub-queries of ParentOf. \n        This means that the Siblings rule can only be proven true when a ParentOf can be proven for the first sibling and for the second and\n        that the parent must be able to be unified (in this case the same). This is an example of unification and it is one of most interesting powers \n        in logic programming because it can accomplish a lot work in a very subtle and succinct way.",0],rules:["ParentOf(?parent, ?child) when MotherOf(?parent, ?child).",["Siblings(?firstSibling, ?secondSibling) when ParentOf(?parent, ?firstSibling) and ParentOf(?parent, ?secondSibling).",["MotherOf(Sally, Janice).",["MotherOf(Sally, Debrah).",["MotherOf(Sally, Malcom).",0]]]]],queries:[["Siblings(Janice, Debrah)",["A yes/no style query that just asks the system to deduce whether Janice and Debrah are siblings."]],[["Siblings(?sibling, Debrah)",["Here we ask about the siblings of Debrah. OBSERVE: Debrah is her own sibling! Weird. We will explain and fix this behavior in the next Chapter."]],0]]},[{name:"Asserting Not Unifiable",rule_instructions:["In the last chapter we saw that our definition of sibling was such that it would report that a person was their own sibling. This was because\n        we defined sibling as ANY other term in the database that has the same parent. We did not explicitly ask not to be informed when both terms were the same.",0],rules:["ParentOf(?parent, ?child) when MotherOf(?parent, ?child).",["Siblings(?firstSibling, ?secondSibling) when ParentOf(?parent, ?firstSibling) and ParentOf(?parent, ?secondSibling) and <?firstSibling /= ?secondSibling>.",["MotherOf(Sally, Janice).",["MotherOf(Sally, Debrah).",["MotherOf(Sally, Malcom).",0]]]]],queries:[["Siblings(?sibling, Debrah)",["Now we should only get other terms that have the same parent but which are not Debrah herself."]],0]},[{name:"Recursion in Rules (Genealogy Example)",rule_instructions:["A rule can depend upon itself recursively! This chapter demonstrates a recursive declaration for proving that something is an ancestor of another.",["As is always the case with recursion, BEWARE to always have a terminating base case. Observe that the recursive specification of AncestorOf has a ParentOf \n        sub-query which is not a reference to AncestorOf. When the ParentOf sub-query in the body of the AncestorOf rule fails the recursion terminates.",0]],rules:["ParentOf(?Mother, ?Child) when MotherOf(?Mother, ?Child).",["AncestorOf(?Ancestor, ?Descendant) when ParentOf(?Ancestor, ?Descendant).",["AncestorOf(?Ancestor, ?Descendant) when ParentOf(?ParentOfDescendant, ?Descendant) and AncestorOf(?Ancestor, ?ParentOfDescendant).",["MotherOf(Erica, Sally).",["MotherOf(Sally, Jane).",["MotherOf(Jane, Maria).",["MotherOf(Maria, Roberta).",0]]]]]]],queries:[["AncestorOf(Erica, Sally)",["Here Erica is just Sally's mother so we don't even need to use recursion"]],[["AncestorOf(Erica, Jane)",["Note that there is ONE application of the recursive rule."]],[["AncestorOf(Erica, Roberta)",["Observe that there are THREE applications of the recursive rule."]],[["AncestorOf(?ancestor, Roberta)",["Demonstrating a variable to ask for ALL ancestors of Roberta."]],[["AncestorOf(Erica, ?descendant)",["Demonstrating a variable to ask for ALL descendants of Erica."]],0]]]]]},[{name:"Pattern Matching and Recursion (Linked List: Append)",rule_instructions:["So far we have covered use cases that probably seem relatively natural to a database system. We are now going to\n          explore patterns that approximate general purpose programming but using an entirely declarative information based approach.",["We begin with appending two linked lists together. In this example, the N relation defines a linked-list node (abbreviated to N for reasons that become quickly apparent.)",["A node in a linked list has a value and a pointer to the next item in the list. The last node in the list typically has a null pointer in most imperative programming languages.",["Here we represent the terminating value as Empty. So an empty list is just Empty.",["A list of a single item would be N(FirstItem, Empty).",["A list of two items N(FirstItem, N(SecondItem, Empty))",["...and so on. Obviously this is a tedious way to write lists but it is still pretty amazing to consider it is possible to define list behavior with two rules.",["The AMAZING property is that this append operation can be queried from any direction just like every other query we have seen. In other languages the \n          append operation takes two INPUTs and yields an OUTPUT. In a logic programming language there are NO inputs or outputs in the specification of rules and facts. The author\n          of the query determines what is given and what must be solved (variables).",0]]]]]]]],rules:["Append(Empty, ?List, ?List).",["Append(N(?HeadValue, ?Tail), ?RightLinkedList, N(?HeadValue, ?Result)) when Append(?Tail, ?RightLinkedList, ?Result).",0]],queries:[["Append(N(a, N(b, N(c, Empty))), N(one, N(two, N(three, Empty))), ?Result)",["Appends a list of [a, b, c] and a list of [one, two, three]."]],[["Append(N(a, N(b, Empty)), ?right, N(a, N(b, N(c, N(d, Empty)))))",["AMAZING!!! We are asking what list would we have to add to [a, b] to get [a, b, c, d]."]],[["Append(?left, ?right, N(a, N(b, N(c, N(d, Empty)))))",["This is even crazier. We are now asking for all combinations of input that might produce the output."]],0]]]},[{name:"Accumulators in Recursion (Linked List: Reverse)",rule_instructions:0,rules:["ReverseList(Empty, Empty).",["ReverseListWithAccumulator(?accumulator, Empty, ?accumulator).",["ReverseListWithAccumulator(?accumulator, N(?head, ?tail), ?reversed) when ReverseListWithAccumulator(N(?head, ?accumulator), ?tail, ?reversed).",["ReverseList(?List, ?ReversedList) when ReverseListWithAccumulator(Empty, ?List, ?ReversedList).",0]]]],queries:[["ReverseList(N(a, N(b, N(c, N(d, Empty)))), ?reversed)",[""]],0]},[{name:"Linked List: Remove",rule_instructions:["This chapter illustrates how one might implement removal of all instances of an element from a list.",["The technique involves complex pattern matching, unification, recursion, and not-unifies.",["It is entirely OK if this seems hard. This example is included only to demonstrate the extent to which the declarative paradigm \n          can be stretched to implement ",0]]],rules:["Remove(?Item, Empty, Empty).",["Remove(?Item, N(?Item, ?Tail), ?RecursiveTail) when Remove(?Item, ?Tail, ?RecursiveTail).",["Remove(?Item, N(?HeadValue, ?Tail), N(?HeadValue, ?RecursiveTail)) when <?Item /= ?HeadValue> and Remove(?Item, ?Tail, ?RecursiveTail).",0]]],queries:[["Remove(a, Empty, ?result)",[""]],[["Remove(a, N(a, Empty), ?result)",[""]],[["Remove(a, N(b, Empty), ?result)",[""]],[["Remove(b, N(a, N(b, N(a, Empty))), ?result)",[""]],[["Remove(cherry, N(apple, N(banana, N(cherry, N(date, N(elderberry, Empty))))), ?result)",[""]],[["Remove(x, N(x, N(o, N(x, N(o, N(x, Empty))))), ?result)",[""]],[["Remove(?whatWouldIRemove, N(x, N(o, N(x, N(o, N(x, Empty))))), N(o, N(o, Empty)))",[""]],0]]]]]]]},[{name:"Rules and Recursion #2 (Natural Number Summation)",rule_instructions:["Real Prolog natively understands how to work with numbers. LitLog does not. HOWEVER, there is enough expressive power in pattern matching, unification and recursive rules\n          to define numbers and numeric behaviors for cardinal numbers (counting numbers).",["The representation in the example is based off the Peano Axioms (internet search). It is based on Zero and a Succ(?number) operation which simply means Successor or ?number + 1.",["In this system, Zero is... well Zero. The number one is represented by simply taking the successor of Zero so Succ(Zero). Naturally, two is the successor or one so Succ(Succ(Zero)). \n          This technique should feel very similar to what we did in the Linked List example.",["In fact, the SumOf operation looks a lot like Appending two linked lists and so the Append operations are included here for comparison.",0]]]],rules:["SumOf(Zero, ?Number, ?Number).",["SumOf(Succ(?InnerLeft), ?Right, Succ(?SumOfRightAndInnerLeft)) when SumOf(?InnerLeft, ?Right, ?SumOfRightAndInnerLeft).",["Append(Empty, ?List, ?List).",["Append(N(?HeadValue, ?Tail), ?RightLinkedList, N(?HeadValue, ?Result)) when Append(?Tail, ?RightLinkedList, ?Result).",0]]]],queries:[["SumOf(Zero, Zero, ?sum)",["Query for the result of 0 + 0"]],[["SumOf(Zero, Succ(Succ(Zero)), ?sum)",["0 + 2"]],[["SumOf(Succ(Zero), Succ(Succ(Zero)), ?sum)",["1 + 2"]],[["SumOf(Succ(Succ(Zero)), Succ(Succ(Zero)), ?sum)",["2 + 2"]],[["SumOf(Succ(Succ(Succ(Zero))), Succ(Succ(Zero)), ?sum)",["3 + 2. Not only is this tedious to write but it is also difficult to decipher the output. We will clean that up in the next Chapter."]],0]]]]]},[{name:"Mapping Structure to Readable Aliases (Pretty Summation)",rule_instructions:["The SumOf operation works by pattern matching on the structure of Succ. Therefore, the nesting structure, which is so difficult to read, as at the heart of what makes it works. We have to keep the nesting structure.",["However, we can alias the structured representation of numbers and define a pretty sum that relates terms at the level of the aliases.",["Observe that the code defines aliases for zero thru ten.",["It then defines SumOf identical to the definition from the prior chapter.",["PrettySum works by 1) solving for the structured representation of the left number, 2) solving for the structured representation of the right number, 3) solving for the structure representation of the sum, and 4) finally solves for the alias of the structured sum.",0]]]]],rules:["Alias(Zero, Zero).",["Alias(One, Succ(Zero)).",["Alias(Two, Succ(Succ(Zero))).",["Alias(Three, Succ(?twoStructure)) when Alias(Two, ?twoStructure).",["Alias(Four, Succ(?threeStructure)) when Alias(Three, ?threeStructure).",["Alias(Five, Succ(?fourStructure)) when Alias(Four, ?fourStructure).",["Alias(Six, Succ(?fiveStructure)) when Alias(Five, ?fiveStructure).",["Alias(Seven, Succ(?sixStructure)) when Alias(Six, ?sixStructure).",["Alias(Eight, Succ(?sevenStructure)) when Alias(Seven, ?sevenStructure).",["Alias(Nine, Succ(?eightStructure)) when Alias(Eight, ?eightStructure).",["Alias(Ten, Succ(?nineStructure)) when Alias(Nine, ?nineStructure).",["SumOf(Zero, ?Number, ?Number).",["SumOf(Succ(?InnerLeft), ?Right, Succ(?SumOfRightAndInnerLeft)) when SumOf(?InnerLeft, ?Right, ?SumOfRightAndInnerLeft).",["PrettySum(?leftAlias, ?rightAlias, ?prettySum) when Alias(?leftAlias, ?leftStructure) and Alias(?rightAlias, ?rightStructure) and SumOf(?leftStructure, ?rightStructure, ?sumStructure) and Alias(?prettySum, ?sumStructure).",["PrettyDifference(?leftAlias, ?rightAlias, ?result) when PrettySum(?rightAlias, ?result, ?leftAlias).",0]]]]]]]]]]]]]]],queries:[["PrettySum(Two, Three, ?prettySum)",["Execute this query and breath a sigh of relief. The answer is displayed as a very clear Five."]],[["PrettySum(Three, Five, ?prettySum)",[""]],[["PrettySum(Four, Five, ?prettySum)",[""]],[["PrettySum(?left, Three, Ten)",["Discover what can be added to Three to equal Ten."]],[["PrettySum(?left, ?right, Five)",["Find all the ways to add numbers to achieve Five"]],[["PrettySum(?half, ?half, ?num)",["Find all the pairs of numbers and their half."]],0]]]]]]},[{name:"Algorithmic Problem Solving (Towers of Hanoi)",rule_instructions:0,rules:["Alias(Zero, Zero).",["Alias(One, Succ(Zero)).",["Alias(Two, Succ(Succ(Zero))).",["Alias(Three, Succ(?twoStructure)) when Alias(Two, ?twoStructure).",["Alias(Four, Succ(?threeStructure)) when Alias(Three, ?threeStructure).",["Alias(Five, Succ(?fourStructure)) when Alias(Four, ?fourStructure).",["Alias(Six, Succ(?fiveStructure)) when Alias(Five, ?fiveStructure).",["Alias(Seven, Succ(?sixStructure)) when Alias(Six, ?sixStructure).",["Alias(Eight, Succ(?sevenStructure)) when Alias(Seven, ?sevenStructure).",["Alias(Nine, Succ(?eightStructure)) when Alias(Eight, ?eightStructure).",["ReverseList(Empty, Empty).",["ReverseListWithAccumulator(?accumulator, Empty, ?accumulator).",["ReverseListWithAccumulator(?accumulator, N(?head, ?tail), ?reversed) when ReverseListWithAccumulator(N(?head, ?accumulator), ?tail, ?reversed).",["ReverseList(?List, ?ReversedList) when ReverseListWithAccumulator(Empty, ?List, ?ReversedList).",["Move(Zero, ?X, ?Y, ?dontCare, ?PriorMoves, N(MoveTopDiskFrom(?X, ?Y), ?PriorMoves)).",["Move(Succ(?M), ?X, ?Y, ?Z, ?PriorMoves, ?FinalMoves) \n                when Move(?M, ?X, ?Z, ?Y, ?PriorMoves, ?MovesAfterFirst) \n                and Move(Zero, ?X, ?Y, ?_, ?MovesAfterFirst, ?MovesAfterZero) \n                and Move(?M, ?Z, ?Y, ?X, ?MovesAfterZero, ?FinalMoves).\n          ",["TowerOfHanoiWithDiscs(?numberOfDiscs, ?resultingMoves)\n                when Alias(?numberOfDiscs, Succ(?zeroBasedStructure))\n                and Move(?zeroBasedStructure, Left, Right, Center, Empty, ?resultingMovesReversed)\n                and ReverseList(?resultingMovesReversed, ?resultingMoves).\n          ",0]]]]]]]]]]]]]]]]],queries:[["TowerOfHanoiWithDiscs(One, ?solution)",[""]],[["TowerOfHanoiWithDiscs(Two, ?solution)",[""]],[["TowerOfHanoiWithDiscs(Three, ?solution)",[""]],[["TowerOfHanoiWithDiscs(Four, ?solution)",[""]],[["TowerOfHanoiWithDiscs(Five, ?solution)",[""]],0]]]]]},[{name:"Finite State Automata",rule_instructions:0,rules:["_Recognize(?Node, Empty) when FinalState(?Node).",["_Recognize(?OriginalNode, ?InputList) when TransitionFromToWithInput(?OriginalNode, ?NextNode, ?Label) and _Traverse(?Label, ?InputList, ?NewInputList) and _Recognize(?NextNode, ?NewInputList).",["_Traverse(?Label, N(?Label, ?Remaining), ?Remaining).",["Recognize(?InputList) when InitialState(?StartingState) and _Recognize(?StartingState, ?InputList).",["InitialState(AcceptingApplesOrDone).",["FinalState(Finished).",["TransitionFromToWithInput(AcceptingApplesOrDone, Finished, Done).",["TransitionFromToWithInput(AcceptingApplesOrDone, AcceptingApplesOrDone, Apples).",["TransitionFromToWithInput(AcceptingApplesOrDone, AcceptingOranges, Apples).",["TransitionFromToWithInput(AcceptingOranges, AcceptingApplesOrDone, Oranges).",0]]]]]]]]]],queries:[["Recognize(N(Apples, N(Oranges, N(Done, Empty))))",[""]],[["Recognize(N(Apples, N(Oranges, N(Apples, N(Oranges, N(Done, Empty))))))",[""]],[["Recognize(N(Apples, N(Oranges, N(Apples, N(Oranges, N(Apples, N(Oranges, N(Done, Empty))))))))",[""]],[["Recognize(N(Apples, Done))",[""]],[["Recognize(?Inputs)",[""]],0]]]]]},0]]]]]]]]]]]]]]]]];var Xa=["LitLog, short for Literate Logic programming, is a subset of Prolog with a simpler syntax and an on-line editor. \n    The goal of LitLog is to offer a path to quickly learning the basics of declarative logic programming in three lunch breaks or less.",["When Logic Programming fits the problem space, it beats other programming paradigms by orders of magnitude so it is a helpful tool to\n    have in your mental toolbox (even if an applicable problem may only arise once in a decade). It is also just neat and that alone is worth a few lunch periods.",["The act of declarative logic programming is building a knowledge database that can be queried. It is the query powers that are surprising and interesting.",["Rules & Facts are the two forms of knowledge representation. Get started by choosing the first chapter.",0]]]];function Ya(e,r){return{text:ve(e,r),compilation_result:ee(0,[r])}}function Ka(e,r,n){var t,a,i=mn(r,e);return{text:e,compilation_result:i.tag?ee(1,[["Parse Error",0]]):(a=ve(n,t=i[0].result))?ee(1,[a]):ee(0,[t])}}function ei(e){var r=e.solution_stream;return r?{initiating_query:e.initiating_query,solution_stream:Nt(r[1]),displayed_solutions:[r[0],e.displayed_solutions]}:e}var ri={CompiledTextEditing:{empty:function(e){return{text:"",compilation_result:ee(1,[0])}},edit:Ya,make:Ka},ExecutingQueryInfo:{next_solution:ei},init:function(e){return{rule_database:xa.RuleDatabase.empty,available_chapters:Ga,chapter_opt:void 0,interaction_mode:0}}};var ni={viewRules:0,initiateAddRule:1,initiateEditRule:function(e){return ee(0,[e])},initiateEditQuery:function(e){return ee(1,[e])},chooseChapter:function(e){return ee(2,[e])},nextChapter:2,updateText:function(e){return ee(3,[e])},addRule:function(e){return ee(4,[e])},editRuleEntry:function(e){return ee(5,[e])},deleteRule:function(e){return ee(6,[e])},executeQuery:function(e){return ee(7,[e])},nextFrame:3};function ti(){"remove"in Element.prototype||(Element.prototype.remove=function(){this.parentNode&&this.parentNode.removeChild(this)}),function(){for(var i=0,e=["ms","moz","webkit","o"],r=0;r<e.length&&!window.requestAnimationFrame;++r)window.requestAnimationFrame=window[e[r]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[e[r]+"CancelAnimationFrame"]||window[e[r]+"CancelRequestAnimationFrame"];window.requestAnimationFrame||(window.requestAnimationFrame=function(e,r){var n=(new Date).getTime(),t=Math.max(0,16-(n-i)),a=window.setTimeout(function(){e(n+t)},t);return i=n+t,a}),window.cancelAnimationFrame||(window.cancelAnimationFrame=function(e){clearTimeout(e)})}()}function ai(u,l,t,v,d,e){if(void 0===e)return function(a){function i(e){var r=ve(t,e);n.contents=sr(a,a,n.contents,r)}var n={contents:0};return{startup:function(e){cr(a,d),i(v)},render_string:function(e){return Ge(ve(l,e))},handleMsg:function(e,r){var n=D(u,e,r),t=n[0];return cr(a,n[1]),i(t),t},shutdown:function(e){cr(a,e),n.contents=sr(a,a,n.contents,0)}}};var h=oe(e);return function(o){function a(e){var r,n,t,a,i,u;void 0!==f.contents&&(r=[ve(l,s.contents),0],t=o,a=h,i=c.contents,u=r,or(t,a,a.childNodes,0,i,u),n=u,c.contents=n,f.contents=void 0)}function r(e){for(;0<h.childNodes.length;){var r=h.firstChild;null!==r&&h.removeChild(r)}}function i(e){var r=ve(t,e);n.contents=sr(o,o,n.contents,r)}var c={contents:0},s={contents:v},f={contents:void 0},n={contents:0};return{startup:function(e){r(),cr(o,d),i(s.contents),f.contents=-1,a()},render_string:function(e){return Ge(ve(l,e))},handleMsg:function(e,r){var n=D(u,e,r),t=n[0];return s.contents=t,cr(o,n[1]),void 0===f.contents&&(f.contents=-1,a()),i(t),t},shutdown:function(e){f.contents=void 0,cr(o,e),n.contents=sr(o,o,n.contents,0),c.contents=0,r()}}}}function ii(e,r,n){ti();var t,a,i,u,o,c,s,f,l,v=ve(e.init,n),d=v[0],h=null==r?void 0:ue(r),p=ai(e.update,e.view,e.subscriptions,d,v[1],h);return t=d,a=p,i=e.shutdown,u={contents:t},c=ve(a,o={contents:{enqueue:function(e){console.log("INVALID enqueue CALL!")}}}),s={contents:void 0},l={enqueue:f=function(e){var r=s.contents;if(void 0===r){s.contents=0;var n=D(c.handleMsg,u.contents,e);u.contents=n;var t=s.contents;if(void 0!==t)return t?(s.contents=void 0,_e(f,be(t))):void(s.contents=void 0);throw[w,"INVALID message queue state, should never be None during message processing!"]}s.contents=[e,r]}},o.contents=l,ve(c.startup,void 0),{pushMsg:f,shutdown:function(e){o.contents={enqueue:function(e){console.log("INVALID message enqueued when shut down")}};var r=ve(i,u.contents);ve(c.shutdown,r)},getHtmlString:function(e){return ve(c.render_string,u.contents)}}}function ui(e){return{href:e.href,protocol:e.protocol,host:e.host,hostname:e.hostname,port:e.port,pathname:e.pathname,search:e.search,hash:e.hash,username:e.username,password:e.password,origin:e.origin}}var oi={contents:void 0};function ci(i){var r;return r=function(r){oi.contents=function(e){return ve(r.enqueue,ve(i,e))};function a(e){var r;void 0!==(r=oi.contents)&&ve(r,ui(document.location))}var e,n,t;return n=a,t=!(e="popstate"),window.addEventListener(e,n,t),function(e){return n=a,t=!(r="popstate"),window.removeEventListener(r,n,t);var r,n,t}},ee(1,["navigation",function(e){return ve(r,e.contents)},{contents:void 0}])}var si="button-bar",fi="delete";function li(e,r,n){var t=void 0===e||e;return nt(void 0,void 0,[mt(n),[wt.disabled(!t),0]],[Xn(r),0])}function vi(e){return Yn(void 0,void 0,[st(si),0],e)}var di="#48a9dc",hi="\n\n        ."+String(si)+(" {\n            padding-top: 5px; \n            padding-bottom: 5px;\n        }\n\n        button {\n            background-color: white;\n            color: #555;\n            box-shadow: 0 0 0 1px "+String(di)+(";\n            border: none;\n            border-radius: 4px;\n            padding: 6px;\n            margin-right: 8px;\n            font-size: 14px;\n        }\n\n        button."+String(fi)+(" {\n            background-color: #f00;\n            box-shadow: 0 0 2px 2px rgba(127,0,0,.5);\n            font-weight: bold;\n            color: #fff;\n            padding-left: 8px;\n            padding-right: 8px;\n            border-radius: 4px;\n            display: inline-block;\n        }\n\n        button:active {\n            background-color: "+String(di)+(";\n            color: white;\n        }\n\n        button:disabled {\n            background-color: #ddd;\n            color: #90adbd;\n        }\n\n        a, a:active, a:visited {\n            display: inline-block;\n            color: "+String(di)+("\n        }\n\n        a, a:active, a:visited {\n            display: inline-block;\n            color: "+String(di))))))+"\n        }\n    ",pi="panels",mi="panel",gi="panel-header",bi="panel-body";function wi(e,r){return Yn(void 0,void 0,[st(mi),0],[Yn(void 0,void 0,[st(gi),0],[Xn(e),0]),[Yn(void 0,void 0,[st(bi),0],r),0]])}var yi="\n        div."+String(pi)+(" {\n            height: 98%;\n        }\n\n        div."+String(gi)+(" {\n            background-color: #248;\n            color: white;\n            font-weight: bold;\n            padding: 4px;\n        }   \n\n        div."+String(mi)+(" {\n            overflow-y: auto;\n            background-color: white;\n            margin-top: 5px;\n        }     \n        \n\n        @media screen and (max-width: 1023px) {\n            div."+String(mi)+(" {\n                float: left;\n                width: 99%;\n                margin-top: 10px;\n                border: solid 1px #aaa;\n            }\n        }\n\n        @media screen and (min-width: 1024px) {\n            div."+String(mi)+(" {\n                float: left;\n                margin-left: 5px;\n                margin-right: 5px;\n                width: 48%;\n                height: 98%;\n                border: solid 1px #aaa;\n            }\n        }\n\n        div."+String(bi))))))+" {\n            padding: 6px;\n        }\n    ",_i="section";function Si(e,r){return Yn(void 0,void 0,[st(_i),0],[rt(void 0,void 0,0,[Xn(e),0]),[ct(void 0,void 0,0,0),[Yn(void 0,void 0,0,r),0]]])}var ki="variable",xi="fact",Ai="relation",Ni="punctuation",Oi="query-comment",Ri="rule-application-count",qi="rule-application-count-visible",Ti="relation",Li="rule-item",Fi="rule-used",Mi="rule-display",Ei="\n        ."+String(ki)+(" {\n            color: #ff0; \n            display: inline-block;\n        }\n\n        ."+String(Ti)+(" {\n            display: inline-block;\n        }\n\n        ."+String(xi)+(" {\n            color: #0f0;\n            display: inline-block;\n        }\n        \n        ."+String(Oi)+(" {\n            color: #ccc;\n            padding: 4px;\n            margin-bottom: 8px;\n        }\n\n        ."+String(Ai)+(" {\n            color: #6af;\n            font-weight: bold;\n            display: inline-block;\n        }\n\n        ."+String(Ni)+(" {\n            color: white;\n            font-weight: bold;\n        }\n\n        ."+String(Mi)+(" {\n            background-color: black;\n            font-family: Consolas, monospace;\n            padding: 4px;\n        }\n\n        ."+String(Li)+(" {\n            color: black;\n            background-color: black;\n\n            display: flex;\n            align-items: center;            \n\n            border-radius: 6px;\n            padding: 6px;\n            box-shadow: 0 0.5em 1em -0.125em rgba(10,10,10,.1), 0 0 0 1px rgba(10,10,10,.02);\n\n            margin-bottom: 12px;\n            font-size: 14px;\n        }\n\n        ."+String(Li)+("."+String(Fi)+(" {\n            box-shadow: 0 0 2px 4px #f44;\n        }\n\n        ."+String(Ri)+(" {\n            display: inline-block;\n            visibility: hidden;\n            padding-left: 6px;\n            padding-right: 6px;\n            padding-top: 2px;\n            padding-bottom: 2px;\n            border-radius: 9px;\n            border: solid 1px #884;\n            color: black;\n            background-color: #ff8;\n            font-weight: bold;\n            font-size: 16px;\n        }\n\n        ."+String(Ri)+("."+String(qi)))))))))))))+" {\n            visibility: visible;\n        }\n\n        ul {\n            list-style: none;\n            margin-block-start: 0;\n            margin-block-end: 0;\n        }\n    ";function Di(e){return Kn(void 0,void 0,[st(Ni),0],[Xn(e),0])}function Ci(e){if(!e.tag)return Kn(void 0,void 0,[st(ki),0],[Xn(ve(Zr([ee(12,[63,ee(2,[0,0])]),"?%s"]),e[0][0])),0]);var r=e[0],n=r.related_terms,t=r.relation_name[0];return n?Kn(void 0,void 0,[st(Ti),0],[Kn(void 0,void 0,[st(Ai),0],[Xn(t),0]),[Di("("),[Ci(n[0]),[Kn(void 0,void 0,0,ye(function(e){return Kn(void 0,void 0,0,[Di(", "),[Ci(e),0]])},n[1])),[Di(")"),0]]]]]):Kn(void 0,void 0,[st(xi),0],[Xn(t),0])}function Ii(e){switch(0|e.tag){case 0:return Ci(e[0]);case 1:return Kn(void 0,void 0,0,[Di("<"),[Ci(e[0]),[Di("="),[Ci(e[1]),[Di(">"),0]]]]]);case 2:return Kn(void 0,void 0,0,[Di("<"),[Ci(e[0]),[Di("/="),[Ci(e[1]),[Di(">"),0]]]]])}}function Pi(e){function r(e,r){return ut(void 0,void 0,0,[Di(e),[Ii(r),0]])}var n,t,a,i=e.antecedents;return a=i?(n=i[0],it(void 0,void 0,0,(t=be(i[1]))?xe([[r("when ",n),0],[ye(function(e){return r("and ",e)},be(t[1])),[[ut(void 0,void 0,0,[Di("and "),[Ii(t[0]),[Di("."),0]]]),0],0]]]):[ut(void 0,void 0,0,[Di(" when "),[Ii(n),[Di("."),0]]]),0])):Di("."),Yn(void 0,void 0,[st(Mi),0],[Ci(e.consequent),[a,0]])}function Wi(e,r){return Yn(void 0,void 0,[st(Mi),0],[0!==r.length?Yn(void 0,void 0,[st(Oi),0],[Xn(r),0]):yt,[it(void 0,void 0,0,e?[ut(void 0,void 0,0,[Ii(e[0]),0]),ye(function(e){return ut(void 0,void 0,0,[Di("and "),[Ii(e),0]])},e[1])]:0),0]])}function $i(e){var r,n,t,a,i=ve(xa.RuleDatabase.rule_from_entry,e);return Yn(void 0,void 0,[ft([[Li,!0],[[Fi,!1],0]]),0],[nt(void 0,void 0,[mt(ni.deleteRule(e)),[st(fi),0]],[Xn("X"),0]),[(n=r=void 0,t=[mt(ni.initiateEditRule(e)),0],a=[Pi(i),0],Ue("","a",void 0!==r?r:"",void 0!==n?n:"",t,a)),0]])}var Ji="language-editing",Zi="errors-container",Qi="editing-container",Bi="\n        input {\n            margin-left: 6px;\n        }          \n        \n        ."+String(Ji)+(" {\n            width: 96%;\n            min-height: 92px;\n            font-family: Consolas, monospace;\n            background-color: black;\n            color: white;\n        }\n\n        ."+String(Qi)+(" {\n            margin-bottom: 16px;\n        }\n\n        ."+String(Zi)+(" ul {\n            padding-left: 20px;\n            list-style: square;\n        }\n\n        ."+String(Zi)+(" {\n            margin-bottom: 16px;\n        }\n\n        ."+String(Zi)))))+" li {\n            color: #800;\n            font-size: 14px;\n        }\n    ";function Vi(e,r,n,t,a,i){var u,o=e.compilation_result;if(o.tag)return Yn(void 0,void 0,[st(Qi),0],[at(void 0,void 0,0,[Xn(r),0]),[tt(void 0,void 0,[ht(void 0,ni.updateText),[st(Ji),[lt(i),[vt(e.text),[_t,0]]]]],0),[yt,[vi([(u=o[0])?Yn(void 0,void 0,[st(Zi),0],[it(void 0,void 0,0,ye(function(e){return ut(void 0,void 0,0,[Xn(e),0])},u)),0]):yt,[li(void 0,"Cancel",a),0]]),0]]]]);var c=ve(t,o[0]);return Yn(void 0,void 0,[st(Qi),0],[at(void 0,void 0,0,[Xn(r),0]),[tt(void 0,void 0,[ht(void 0,ni.updateText),[st(Ji),[lt(i),[vt(e.text),[C(Lt.Keydown.keydown,e.text,c,function(e){return 13===e.keyCode&&e.ctrlKey}),0]]]]],0),[Yn(void 0,void 0,0,[Xn(ve(Zr([ee(11,["(ctrl+enter to ",ee(2,[0,ee(12,[41,0])])]),"(ctrl+enter to %s)"]),n)),0]),[vi([li(void 0,n,c),[li(void 0,"Cancel",a),0]]),0]]]])}function zi(n){function e(a){return Yn(void 0,void 0,0,ye(function(e){return r=a,n=e,t=Rt.count(function(e){return D(xa.RuleDatabase.is_same,e,n)},r),Yn(void 0,void 0,[ft([[Li,!0],[[Fi,0<t],0]]),0],[Kn(void 0,void 0,[ft([[Ri,!0],[[qi,0<t],0]]),0],[Xn(ve(Zr([ee(4,[0,0,0,0]),"%d"]),t)),0]),[Pi(ve(xa.RuleDatabase.rule_from_entry,n)),0]]);var r,n,t},u))}var r,t,a,i,u=ve(xa.RuleDatabase.all_rules,n.rule_database),o=n.interaction_mode;if("number"==typeof o)s=Yn(void 0,"viewing_rules",0,[vi([at(void 0,void 0,0,[Xn("Chapter:"),0]),[(a=[pt(t=r=void 0,function(r){return ni.chooseChapter(function(e,r){for(;;){var n=r;if(!n)return;var t=n[0];if(ve(e,t))return ue(t);r=n[1]}}(function(e){return e.name===r},n.available_chapters))}),0],i=[ot(void 0,void 0,[wt.selected(void 0===n.chapter_opt),0],[Xn("(select chapter)"),0]),ye(function(e){return ot(void 0,void 0,[wt.selected(m(n.chapter_opt,e)),0],[Xn(e.name),0])},n.available_chapters)],Ue("","select",void 0!==r?r:"",void 0!==t?t:"",a,i)),[li(void 0,"Add Rule / Fact",1),[u?li(void 0,"Query",ee(1,[0])):yt,0]]]]),[ct(void 0,void 0,0,0),[Yn(void 0,"editable_rules",0,[et(void 0,void 0,0,[Xn(u?"Click the rule text of any rule to edit/update that rule. Clicking X removes the rule from the database WITHOUT a prompt.":"Click <Add Rule/Fact> to start adding rules to the database."),0]),[Yn(void 0,void 0,0,ye($i,u)),0]]),0]]]);else switch(0|o.tag){case 0:s=Yn(void 0,"adding_rule",0,[Vi(o[0],"New Rule","Add Rule",ni.addRule,0,"New rule..."),[ct(void 0,void 0,0,0),[e(0),0]]]);break;case 1:var c=o[0],s=Yn(void 0,"editing_rule",0,[Vi(o[1],"Editing Rule","Update Rule",function(e){return ni.editRuleEntry(D(xa.RuleDatabase.update_rule_entry,c,e))},0,"Edit rule..."),[ct(void 0,void 0,0,0),[e([c,0]),0]]]);break;case 2:s=e(0);break;case 3:var f=o[0].solution_stream;s=e(f?f[0].rules_applied:0)}return wi("Rules and Facts",[s,0])}var Hi="solution-frame",Ui="no-solution",ji="example-query";function Gi(e){function r(e){return Si("Query",[Wi(c,""),0])}function n(e){function r(e,r){return Yn(void 0,void 0,[st(Hi),0],[rt(void 0,void 0,0,[Xn(e),0]),[it(void 0,void 0,0,ye(function(e){return ut(void 0,void 0,0,[Xn(e),0])},r)),0]])}var n=e.failed_at_depth;if(void 0!==n)return Yn(void 0,void 0,[st(Ui),0],[Xn(ve(Zr([ee(11,["Gave up search at depth of ",ee(4,[0,0,0,ee(11,[". You could be missing a terminating base case in a recursive definition OR you may have simply asked a question whose solution requires more searching than is allowed by LitLog.",0])])]),"Gave up search at depth of %d. You could be missing a terminating base case in a recursive definition OR you may have simply asked a question whose solution requires more searching than is allowed by LitLog."]),n)),0]);var t=D(xa.Frame.to_strings,c,e.frame);return t?r("Satisfied With Variable Substitution(s)",t):r("Satisfied Without Variable Sustitution",0)}var t,a,i,u=e.displayed_solutions,o=e.solution_stream,c=e.initiating_query;return a=o?(t=Si("Current Solution",[at(void 0,void 0,0,[Xn("OBSERVE: All rules and facts applied in the discovery of the current solution are highlighted in the Rules and Facts panel with a count of the number of times the Rule/Fact was applied in the discovery of the solution."),0]),[n(o[0]),0]]),Nt(o[1])?Yn(void 0,"solutions_remaining",0,[vi([li(void 0,"Next Solution",3),[li(void 0,"New Query",ee(1,[c])),[li(void 0,"Cancel Querying",0),[li(void 0,"Cancel Querying and Go to Next Chapter",2),0]]]]),[r(),[t,0]]]):Yn(void 0,"end_of_stream_with_current",0,[vi([li(void 0,"New Query",ee(1,[c])),[li(void 0,"Manage Rules",0),[li(void 0,"Go to Next Chapter",2),0]]]),[r(),[t,[Si("All Solutions Found",[at(void 0,void 0,0,[Xn("All of the solutions to the query have been found. Click New Query to keep experimenting in this chapter or <Next Chapter> to move on."),0]),0]),0]]]])):Yn(void 0,"end_of_stream",0,[vi([li(void 0,"New Query",ee(1,[c])),[li(void 0,"Manage Rules",0),[li(void 0,"Go to Next Chapter",2),0]]]),[r(),[u?yt:Yn(void 0,void 0,[st(Ui),0],[Xn("No Solution"),0]),[Si("All Solutions Found",[at(void 0,void 0,0,[Xn("All of the solutions to the query have been found. Click New Query to keep experimenting in this chapter or <Next Chapter> to move on."),0]),0]),0]]]]),Yn(void 0,"executing_query",0,[a,[u?(i=me(u),Si(ve(Zr([ee(11,["Prior Solutions (",ee(4,[0,0,0,ee(12,[41,0])])]),"Prior Solutions (%d)"]),i),[at(void 0,void 0,0,[Xn("OBSERVE: Some solutions may appear more than once because there can be multiple paths to reach the same solution. LitLog does not remove duplicate solutions from the display in order to illustrate the paths / search process."),0]),ye(n,u)])):yt,0]])}function Xi(e){return Yn(void 0,"instructions",0,ye(function(e){return et(void 0,void 0,0,[Xn(e),0])},e))}function Yi(e){function r(e,r){return wi(e,[r,0])}var n,t,a,i=e.chapter_opt,u=void 0!==i?i.rule_instructions:Xa,o=e.interaction_mode;if("number"==typeof o)return r("Instructions",Xi(u));switch(0|o.tag){case 2:return r("Query",(n=o[0],t=e.chapter_opt,a=void 0!==t?ja(t):0,Yn(void 0,"editing_query",0,[Vi(n,"Query","Execute Query",ni.executeQuery,0,"New query..."),[a?Yn(void 0,void 0,0,[at(void 0,void 0,0,[Xn("Example Queries. Click a query below to populate the query entry box with that query."),0]),[Yn(void 0,void 0,0,ye(function(e){var r=e[0];return Yn(void 0,void 0,[st(ji),[mt(ni.updateText(ve(xa.Query.to_string,r))),0]],[Wi(r,e[1][0]),0])},a)),0]]):yt,0]])));case 3:return r("Query",Gi(o[0]));default:return r("Instructions",Xi(u))}}var Ki=Pe(" ",["\n        html {\n            height: 100%\n        }\n\n        select {\n            font-size: 16px;\n            color: #444;\n            margin-left: 4px;\n            margin-right: 16px;\n        }\n\n        body {\n            height: 100%;\n            background-color: #eee;\n            display: flex;\n            flex-direction: column;\n            font-family: sans-serif;\n            padding: 0;\n            margin: 0;\n        }\n\n        p {\n            font-size: 14px;\n        }\n\n        h3 {\n            margin-bottom: 3px;\n        }\n    ",[hi,[yi,["\n\n    ",[Ei,[Bi,["",[" \n\n    div."+String(ji)+(" {\n        border-radius: 3px;\n        padding: 5px;\n        margin-bottom: 6px;\n        background-color: #444;\n    }\n\n    div."+String(Ui)+(" {\n        margin: 4px;\n        padding: 6px;\n        border-radius: 3px;\n        border-color: #aaa;\n        border-width: 1px;\n        border-style: solid;\n        background-color: #fcc;\n    }\n\n    div."+String(Hi)+(" {\n        margin: 4px;\n        padding: 4px;\n        border-radius: 3px;\n        border-color: #aaa;\n        border-width: 1px;\n        border-style: solid;\n        background-color: #cfc;\n    }\n\n    div."+String(Hi))))+" > h3 {\n        font-size: 16px;\n        font-weight: bold;\n        margin: 4px;\n    }\n    \n    ",0]]]]]]]]);var eu,ru,nu,tu=(eu=function(e){return ni.viewRules},nu={init:function(e){return D(ru.init,e,ui(document.location))},update:(ru={init:function(e,r){return[ri.init(void 0),0]},update:function(e,r){function n(e,r){var n=Va.rule_database_result_from_rule_strings(r.rules);return n.tag?(console.error(n[0]),e):n[0]}var t,a=e.interaction_mode,i=e.rule_database;if("number"==typeof r)switch(r){case 0:c={rule_database:e.rule_database,available_chapters:e.available_chapters,chapter_opt:e.chapter_opt,interaction_mode:0};break;case 1:c={rule_database:e.rule_database,available_chapters:e.available_chapters,chapter_opt:e.chapter_opt,interaction_mode:ee(0,[{text:"",compilation_result:ee(1,[0])}])};break;case 2:var u=e.chapter_opt,o=void 0!==u?(t=u,Rt.next_or_this_item(t,Ga)):function(e){if(e)return e[0];throw[w,"hd"]}(Ga),c={rule_database:n(i,o),available_chapters:e.available_chapters,chapter_opt:o,interaction_mode:0};break;case 3:c="number"==typeof a||3!==a.tag?e:{rule_database:e.rule_database,available_chapters:e.available_chapters,chapter_opt:e.chapter_opt,interaction_mode:ee(3,[ei(a[0])])}}else switch(0|r.tag){case 0:var s=r[0],f=ve(xa.RuleDatabase.rule_from_entry,s);c={rule_database:e.rule_database,available_chapters:e.available_chapters,chapter_opt:e.chapter_opt,interaction_mode:ee(1,[s,Ya(xa.Rule.to_string,f)])};break;case 1:c={rule_database:e.rule_database,available_chapters:e.available_chapters,chapter_opt:e.chapter_opt,interaction_mode:ee(2,[Ya(xa.Query.to_string,r[0])])};break;case 2:var l=r[0];c={rule_database:void 0!==l?n(i,l):xa.RuleDatabase.empty,available_chapters:e.available_chapters,chapter_opt:l,interaction_mode:0};break;case 3:var v=r[0],d=Ta.rule_database_snapshot(i);if("number"==typeof a)c=e;else switch(0|a.tag){case 0:c={rule_database:e.rule_database,available_chapters:e.available_chapters,chapter_opt:e.chapter_opt,interaction_mode:ee(0,[Ka(v,Va.rule_parser,function(e){return Ta.issues_in_new_rule(d,e)})])};break;case 1:var h=a[0];c={rule_database:e.rule_database,available_chapters:e.available_chapters,chapter_opt:e.chapter_opt,interaction_mode:ee(1,[h,Ka(v,Va.rule_parser,function(e){return Ta.issues_in_existing_rule(d,D(xa.RuleDatabase.update_rule_entry,h,e))})])};break;case 2:c={rule_database:e.rule_database,available_chapters:e.available_chapters,chapter_opt:e.chapter_opt,interaction_mode:ee(2,[Ka(v,Va.query_parser,function(e){return Ta.issues_in_query(d,e)})])};break;case 3:c=e}break;case 4:c={rule_database:D(xa.RuleDatabase.add_rule,i,r[0]),available_chapters:e.available_chapters,chapter_opt:e.chapter_opt,interaction_mode:ee(0,[{text:"",compilation_result:ee(1,[0])}])};break;case 5:c={rule_database:D(xa.RuleDatabase.update_rule,i,r[0]),available_chapters:e.available_chapters,chapter_opt:e.chapter_opt,interaction_mode:0};break;case 6:c={rule_database:D(xa.RuleDatabase.remove_rule,i,r[0]),available_chapters:e.available_chapters,chapter_opt:e.chapter_opt,interaction_mode:e.interaction_mode};break;case 7:var p=r[0],m=Ua.query(i,p);c={rule_database:e.rule_database,available_chapters:e.available_chapters,chapter_opt:e.chapter_opt,interaction_mode:ee(3,[{initiating_query:p,solution_stream:m,displayed_solutions:0}])}}return[c,0]},view:function(e){return r=[zi(e),[Yi(e),0]],Yn(void 0,void 0,[st(pi),0],r);var r},subscriptions:function(e){return 0},shutdown:function(e){return 0}}).update,view:ru.view,subscriptions:function(e){return ee(0,[[ci(eu),[ve(ru.subscriptions,e),0]]])},shutdown:ru.shutdown},function(e,r){return ii(nu,e,r)});return e.main=function(e,r){var n=document.createElement("style");return document.head.appendChild(n),n.innerHTML=Ki,D(tu,e,void 0)},e}({});
