var starter=function(r){"use strict";var e=["Failure",-2],n=["Invalid_argument",-3],t=["Division_by_zero",-5],a=["Not_found",-6],i=["Match_failure",-7],u=["Assert_failure",-10];function o(r,e,n){for(var t=new Array(n),a=0,i=e;a<n;)t[a]=r[i],a=a+1|0,i=i+1|0;return t}function c(r,e){if(e<0||e>=r.length)throw[n,"index out of bounds"];return r[e]}function s(r,e){for(;;){var n=e,t=r,a=t.length,i=0===a?1:a,u=i-n.length|0;if(0===u)return t.apply(null,n);if(u>=0)return function(r,e){return function(n){return s(r,e.concat([n]))}}(t,n);e=o(n,i,0|-u),r=t.apply(null,o(n,0,i))}}function f(r,e){var n=r.length;if(1===n)return r(e);switch(n){case 1:return r(e);case 2:return function(n){return r(e,n)};case 3:return function(n,t){return r(e,n,t)};case 4:return function(n,t,a){return r(e,n,t,a)};case 5:return function(n,t,a,i){return r(e,n,t,a,i)};case 6:return function(n,t,a,i,u){return r(e,n,t,a,i,u)};case 7:return function(n,t,a,i,u,o){return r(e,n,t,a,i,u,o)};default:return s(r,[e])}}function l(r,e,n){var t=r.length;if(2===t)return r(e,n);switch(t){case 1:return s(r(e),[n]);case 2:return r(e,n);case 3:return function(t){return r(e,n,t)};case 4:return function(t,a){return r(e,n,t,a)};case 5:return function(t,a,i){return r(e,n,t,a,i)};case 6:return function(t,a,i,u){return r(e,n,t,a,i,u)};case 7:return function(t,a,i,u,o){return r(e,n,t,a,i,u,o)};default:return s(r,[e,n])}}function v(r,e,n,t){var a=r.length;if(3===a)return r(e,n,t);switch(a){case 1:return s(r(e),[n,t]);case 2:return s(r(e,n),[t]);case 3:return r(e,n,t);case 4:return function(a){return r(e,n,t,a)};case 5:return function(a,i){return r(e,n,t,a,i)};case 6:return function(a,i,u){return r(e,n,t,a,i,u)};case 7:return function(a,i,u,o){return r(e,n,t,a,i,u,o)};default:return s(r,[e,n,t])}}function d(r,e,n,t,a){var i=r.length;if(4===i)return r(e,n,t,a);switch(i){case 1:return s(r(e),[n,t,a]);case 2:return s(r(e,n),[t,a]);case 3:return s(r(e,n,t),[a]);case 4:return r(e,n,t,a);case 5:return function(i){return r(e,n,t,a,i)};case 6:return function(i,u){return r(e,n,t,a,i,u)};case 7:return function(i,u,o){return r(e,n,t,a,i,u,o)};default:return s(r,[e,n,t,a])}}function h(r,e,n,t,a,i){var u=r.length;if(5===u)return r(e,n,t,a,i);switch(u){case 1:return s(r(e),[n,t,a,i]);case 2:return s(r(e,n),[t,a,i]);case 3:return s(r(e,n,t),[a,i]);case 4:return s(r(e,n,t,a),[i]);case 5:return r(e,n,t,a,i);case 6:return function(u){return r(e,n,t,a,i,u)};case 7:return function(u,o){return r(e,n,t,a,i,u,o)};default:return s(r,[e,n,t,a,i])}}function p(r,e,n,t,a,i,u){var o=r.length;if(6===o)return r(e,n,t,a,i,u);switch(o){case 1:return s(r(e),[n,t,a,i,u]);case 2:return s(r(e,n),[t,a,i,u]);case 3:return s(r(e,n,t),[a,i,u]);case 4:return s(r(e,n,t,a),[i,u]);case 5:return s(r(e,n,t,a,i),[u]);case 6:return r(e,n,t,a,i,u);case 7:return function(o){return r(e,n,t,a,i,u,o)};default:return s(r,[e,n,t,a,i,u])}}function m(r,e,n,t,a,i,u,o){var c=r.length;if(7===c)return r(e,n,t,a,i,u,o);switch(c){case 1:return s(r(e),[n,t,a,i,u,o]);case 2:return s(r(e,n),[t,a,i,u,o]);case 3:return s(r(e,n,t),[a,i,u,o]);case 4:return s(r(e,n,t,a),[i,u,o]);case 5:return s(r(e,n,t,a,i),[u,o]);case 6:return s(r(e,n,t,a,i,u),[o]);case 7:return r(e,n,t,a,i,u,o);default:return s(r,[e,n,t,a,i,u,o])}}function g(r,e,n,t,a,i,u,o,c){var f=r.length;if(8===f)return r(e,n,t,a,i,u,o,c);switch(f){case 1:return s(r(e),[n,t,a,i,u,o,c]);case 2:return s(r(e,n),[t,a,i,u,o,c]);case 3:return s(r(e,n,t),[a,i,u,o,c]);case 4:return s(r(e,n,t,a),[i,u,o,c]);case 5:return s(r(e,n,t,a,i),[u,o,c]);case 6:return s(r(e,n,t,a,i,u),[o,c]);case 7:return s(r(e,n,t,a,i,u,o),[c]);default:return s(r,[e,n,t,a,i,u,o,c])}}function b(r,e){return e.tag=r,e}function w(r,e){return r<e?-1:r===e?0:1}function y(r,e){return r===e?0:r<e?-1:1}e.tag=248,n.tag=248,t.tag=248,a.tag=248,i.tag=248,u.tag=248;var _=function(r,e){for(var n in r)e(n)};function k(r){var e=[r];return e.tag=246,e}function S(r,e){for(;;){var t=e,a=r;if(a===t)return!0;var i=typeof a;if("string"===i||"number"===i||"boolean"===i||"undefined"===i||null===a)return!1;var u=typeof t;if("function"===i||"function"===u)throw[n,"equal: functional value"];if("number"===u||"undefined"===u||null===t)return!1;var o=0|a.tag,c=0|t.tag;if(250!==o)if(250!==c){if(248===o)return a[1]===t[1];if(251===o)throw[n,"equal: abstract value"];if(o!==c)return!1;if(256===o)return a[1]===t[1];var s=0|a.length;if(s!==(0|t.length))return!1;if(!Array.isArray(a)){if(a instanceof Date&&t instanceof Date)return!(a>t||a<t);var f={contents:!0},l=function(r,e){return function(n){r.hasOwnProperty(n)||(e.contents=!1)}}(t,f),v=function(r,e,n){return function(t){r.hasOwnProperty(t)&&S(e[t],r[t])||(n.contents=!1)}}(a,t,f);return _(a,l),f.contents&&_(t,v),f.contents}for(var d=0;;){var h=d;if(h===s)return!0;if(!S(a[h],t[h]))return!1;d=h+1|0}}else e=t[0];else r=a[0]}}function x(r,e){return!S(r,e)}function N(r){if(r<0)throw[n,"String.create"];for(var e=new Array(r),t=0;t<r;++t)e[t]=0;return e}function A(r,e,n,t,a){if(!(a<=0))if(r!==n){var i=r.length-e|0;if(a<=i)for(var u=0;u<a;++u)n[t+u|0]=r[e+u|0];else{for(var o=0;o<i;++o)n[t+o|0]=r[e+o|0];for(var c=i;c<a;++c)n[t+c|0]=0}}else{if(e<t){for(var s=(r.length-t|0)-1|0,f=a-1|0,l=s>f?f:s;l>=0;--l)r[t+l|0]=r[e+l|0];return}if(e<=t)return;for(var v=(r.length-e|0)-1|0,d=a-1|0,h=v>d?d:v,p=0;p<=h;++p)r[t+p|0]=r[e+p|0]}}function O(r){var e=r.length,n="",t=e;if(e<=4096&&e===r.length)return String.fromCharCode.apply(null,r);for(var a=0;t>0;){var i=t<1024?t:1024,u=new Array(i);A(r,a,u,0,i),n+=String.fromCharCode.apply(null,u),t=t-i|0,a=a+i|0}return n}function q(r,e,n,t,a){if(!(a<=0)){var i=r.length-e|0;if(a<=i)for(var u=0;u<a;++u)n[t+u|0]=r.charCodeAt(e+u|0);else{for(var o=0;o<i;++o)n[t+o|0]=r.charCodeAt(e+o|0);for(var c=i;c<a;++c)n[t+c|0]=0}}}function R(r){for(var e=r.length,n=new Array(e),t=0;t<e;++t)n[t]=r.charCodeAt(t);return n}var F=Math.imul||function(r,e){return((r>>16)*(e|=0)<<16)+(65535&r)*e|0};function E(r,e){return[e,r>>>0]}var T=[-2147483648,0],C=[2147483647,4294967295],M=[0,1],L=[0,0],I=[-1,4294967295];function P(r){return 0!=(2147483648&r)}function D(r){return 0==(2147483648&r)}function $(r){var e=1+(-1^r[1])|0;return E(e,(-1^r[0])+(0===e?1:0)|0)}function B(r,e,n){var t=r[1],a=t+e|0,i=P(t)&&(P(e)||D(a))||P(e)&&D(a)?1:0;return E(a,r[0]+n+i|0)}function U(r,e){return B(r,e[1],e[0])}function V(r,e){return r[0]===e[0]&&r[1]===e[1]}function J(r,e,n){var t=1+(-1^e)>>>0;return B(r,t,(-1^n)+(0===t?1:0)|0)}function Q(r,e){return J(r,e[1],e[0])}function W(r,e){if(0===e)return r;var n=r[1];return e>=32?E(0,n<<(e-32|0)):E(n<<e,n>>>(32-e|0)|r[0]<<e)}function Z(r,e){if(0===e)return r;var n=r[0];return e<32?E(n<<(32-e|0)|r[1]>>>e,n>>e):E(n>>(e-32|0),n>=0?0:-1)}function j(r,e){for(;;){var n,t=e,a=r,i=0,u=0;if(0!==a[0])u=3;else{if(0===a[1])return L;u=3}if(3===u)if(0!==t[0])i=2;else{if(0===t[1])return L;i=2}if(2===i){var o=a[0],c=0;if(-2147483648!==o||0!==a[1]?c=3:n=t[1],3===c){var s=t[0],f=a[1],l=0;if(-2147483648!==s||0!==t[1]?l=4:n=f,4===l){var v=t[1];if(o<0){if(s>=0)return $(j($(a),t));e=$(t),r=$(a);continue}if(s<0)return $(j(a,$(t)));var d=65535&o,h=f>>>16,p=65535&f,m=65535&s,g=v>>>16,b=65535&v,w=0,y=0,_=0,k=p*b;return w=(y=(y=(_=(k>>>16)+h*b)>>>16)+((_=(65535&_)+p*g)>>>16)+d*b)>>>16,w+=(y=(65535&y)+h*g)>>>16,w+=(y=(65535&y)+p*m)>>>16,E(65535&k|(65535&_)<<16,(y&=65535)|(w=w+((o>>>16)*b+d*g+h*m+p*(s>>>16))&65535)<<16)}}}return 0==(1&n)?L:T}}function z(r,e){var n=e[0],t=r[0];return t>n||!(t<n)&&r[1]>=e[1]}function H(r,e){return!V(r,e)}function X(r,e){return!z(r,e)}function K(r,e){return r[0]>e[0]||!(r[0]<e[0])&&r[1]>e[1]}function G(r){return 4294967296*r[0]+r[1]}function Y(r){return isNaN(r)||!isFinite(r)?L:r<=-0x8000000000000000?T:r+1>=0x8000000000000000?C:r<0?$(Y(-r)):E(r%4294967296|0,r/4294967296|0)}function rr(r){if(function(r){var e=r[0],n=e>>21;return 0===n||-1===n&&!(0===r[1]&&-2097152===e)}(r))return String(G(r));if(r[0]<0)return V(r,T)?"-9223372036854775808":"-"+rr($(r));var e=Y(Math.floor(G(r)/10)),n=e[1],t=e[0],a=J(J(r,n<<3,n>>>29|t<<3),n<<1,n>>>31|t<<1),i=a[1],u=a[0];if(0===i&&0===u)return rr(e)+"0";if(u<0){var o=1+(-1^i)>>>0,c=Math.ceil(o/10),s=10*c-o;return rr(J(e,0|c,0))+String(0|s)}var f=i,l=Math.floor(f/10),v=f-10*l;return rr(B(e,0|l,0))+String(0|v)}function er(r,e){var n=function r(e,n){for(;;){var a=n,i=e,u=0;if(0===a[0]&&0===a[1])throw t;if(3===3){var o=i[0];if(-2147483648!==o)if(0!==o)u=2;else{if(0===i[1])return L;u=2}else if(0!==i[1])u=2;else{if(V(a,M)||V(a,I))return i;if(V(a,T))return M;var c=W(r(Z(i,1),a),1),s=0;if(0!==c[0])s=4;else{if(0===c[1])return a[0]<0?M:$(M);s=4}if(4===s)return U(c,r(Q(i,j(a,c)),a))}}if(2===u&&-2147483648===a[0]&&0===a[1])return L;var f=a[0];if(!(i[0]<0)){if(f<0)return $(r(i,$(a)));for(var l=L,v=i;z(v,a);){for(var d=(w=1,y=Math.floor(G(v)/G(a)),w>y?w:y),h=Math.ceil(Math.log(d)/Math.LN2),p=h<=48?1:Math.pow(2,h-48),m=Y(d),g=j(m,a);g[0]<0||K(g,v);)g=j(m=Y(d-=p),a);0===(b=m)[0]&&0===b[1]&&(m=M),l=U(l,m),v=Q(v,g)}return l}if(f>=0)return $(r($(i),a));n=$(a),e=$(i)}var b,w,y}(r,e);return[n,Q(r,j(n,e))]}function nr(r){return 0|r[1]}function tr(r){return[2147483647&r[0],r[1]]}function ar(r){return r>=65&&r<=90||r>=192&&r<=214||r>=216&&r<=222?r+32|0:r}function ir(r){var e=r.length;if(e>31)throw[n,"format_int: format too long"];for(var t={justify:"+",signstyle:"-",filter:" ",alternate:!1,base:2,signedconv:!1,width:0,uppercase:!1,sign:1,prec:-1,conv:"f"},a=0;;){var i=a;if(i>=e)return t;var u=r.charCodeAt(i),o=0;if(u>=69)if(u>=88)if(u>=121)o=1;else switch(u-88|0){case 0:t.base=1,t.uppercase=!0,a=i+1|0;continue;case 13:case 14:case 15:o=5;break;case 12:case 17:o=4;break;case 23:t.base=0,a=i+1|0;continue;case 29:t.base=2,a=i+1|0;continue;case 1:case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 16:case 18:case 19:case 20:case 21:case 22:case 24:case 25:case 26:case 27:case 28:case 30:case 31:o=1;break;case 32:t.base=1,a=i+1|0;continue}else{if(!(u>=72)){t.signedconv=!0,t.uppercase=!0,t.conv=String.fromCharCode(ar(u)),a=i+1|0;continue}o=1}else switch(u){case 35:t.alternate=!0,a=i+1|0;continue;case 32:case 43:o=2;break;case 45:t.justify="-",a=i+1|0;continue;case 46:t.prec=0;for(var c=i+1|0;function(e){return function(){var n=r.charCodeAt(e)-48|0;return n>=0&&n<=9}}(c)();)t.prec=(F(t.prec,10)+r.charCodeAt(c)|0)-48|0,c=c+1|0;a=c;continue;case 33:case 34:case 36:case 37:case 38:case 39:case 40:case 41:case 42:case 44:case 47:o=1;break;case 48:t.filter="0",a=i+1|0;continue;case 49:case 50:case 51:case 52:case 53:case 54:case 55:case 56:case 57:o=3;break;default:o=1}switch(o){case 1:a=i+1|0;continue;case 2:t.signstyle=String.fromCharCode(u),a=i+1|0;continue;case 3:t.width=0;for(var s=i;function(e){return function(){var n=r.charCodeAt(e)-48|0;return n>=0&&n<=9}}(s)();)t.width=(F(t.width,10)+r.charCodeAt(s)|0)-48|0,s=s+1|0;a=s;continue;case 4:t.signedconv=!0,t.base=2,a=i+1|0;continue;case 5:t.signedconv=!0,t.conv=String.fromCharCode(u),a=i+1|0;continue}}}function ur(r,e){var n=r.justify,t=r.signstyle,a=r.filter,i=r.alternate,u=r.base,o=r.signedconv,c=r.width,s=r.uppercase,f=r.sign,l=e.length;o&&(f<0||"-"!==t)&&(l=l+1|0),i&&(0===u?l=l+1|0:1===u&&(l=l+2|0));var v="";if("+"===n&&" "===a)for(var d=l;d<c;++d)v+=a;if(o&&(f<0?v+="-":"-"!==t&&(v+=t)),i&&0===u&&(v+="0"),i&&1===u&&(v+="0x"),"+"===n&&"0"===a)for(var h=l;h<c;++h)v+=a;if(v=s?v+e.toUpperCase():v+e,"-"===n)for(var p=l;p<c;++p)v+=" ";return v}function or(r,e){if("%d"===r)return String(e);var n=ir(r),t=(e<0?n.signedconv?(n.sign=-1,-e):e>>>0:e).toString(function(r){switch(r){case 0:return 8;case 1:return 16;case 2:return 10}}(n.base));if(n.prec>=0){n.filter=" ";var a=n.prec-t.length|0;a>0&&(t="0".repeat(a)+t)}return ur(n,t)}function cr(r,e){if("%d"===r)return rr(e);var n,t,a=ir(r),i=a.signedconv&&X(e,L)?(a.sign=-1,$(e)):e;switch(a.base){case 0:n=function(r){var e="",n=E(8,0),t="01234567";if(X(r,L)){var a=er(tr(r),n),i=U(E(0,268435456),a[0]),u=a[1];for(e=t[nr(u)]+e;H(i,L);){var o=er(i,n);i=o[0],e=t[nr(u=o[1])]+e}}else{var c=er(r,n),s=c[0],f=c[1];for(e=t[nr(f)]+e;H(s,L);){var l=er(s,n);s=l[0],e=t[nr(f=l[1])]+e}}return e}(i);break;case 1:n=function(r){var e=r[1],n=r[0],t=function(r){return(r>>>0).toString(16)};if(0===n&&0===e)return"0";if(0===e)return t(n)+"00000000";if(0===n)return t(e);var a=t(e),i=8-a.length|0;return i<=0?t(n)+a:t(n)+("0".repeat(i)+a)}(i);break;case 2:n=function(r){if(!X(r,L))return rr(r);var e=E(10,0),n=er(tr(r),e),t=er(U(E(8,0),n[1]),e);return rr(U(U(E(-858993460,214748364),n[0]),t[0]))+"0123456789"[nr(t[1])]}(i)}if(a.prec>=0){a.filter=" ";var u=a.prec-n.length|0;t=u>0?"0".repeat(u)+n:n}else t=n;return ur(a,t)}var sr=or,fr=or;function lr(r,e){if(e>=r.length||e<0)throw[n,"index out of bounds"];return r.charCodeAt(e)}var vr={contents:0};function dr(r){var e=[r,(vr.contents=vr.contents+1,vr.contents)];return e.tag=248,e}var hr=[];function pr(r){if(void 0===r){var e=[hr,0];return e.tag=256,e}if(null===r||r[0]!==hr)return r;var n=r[1]+1|0,t=[hr,n];return t.tag=256,t}function mr(r){if(null===r||r[0]!==hr)return r;var e=r[1];return 0===e?void 0:[hr,e-1|0]}var gr=dr("Caml_js_exceptions.Error");function br(r){return function(r){if(void 0===r)return!1;if(248===r.tag)return!0;var e=r[0];return void 0!==e&&248===e.tag}(r)?r:[gr,r]}function wr(r){if("number"==typeof r)return 0;switch(0|r.tag){case 0:return b(0,[wr(r[0])]);case 1:return b(1,[wr(r[0])]);case 2:return b(2,[wr(r[0])]);case 3:return b(3,[wr(r[0])]);case 4:return b(4,[wr(r[0])]);case 5:return b(5,[wr(r[0])]);case 6:return b(6,[wr(r[0])]);case 7:return b(7,[wr(r[0])]);case 8:return b(8,[r[0],wr(r[1])]);case 9:var e=r[0];return b(9,[e,e,wr(r[2])]);case 10:return b(10,[wr(r[0])]);case 11:return b(11,[wr(r[0])]);case 12:return b(12,[wr(r[0])]);case 13:return b(13,[wr(r[0])]);case 14:return b(14,[wr(r[0])])}}function yr(r,e){if("number"==typeof r)return e;switch(0|r.tag){case 0:return b(0,[yr(r[0],e)]);case 1:return b(1,[yr(r[0],e)]);case 2:return b(2,[r[0],yr(r[1],e)]);case 3:return b(3,[r[0],yr(r[1],e)]);case 4:return b(4,[r[0],r[1],r[2],yr(r[3],e)]);case 5:return b(5,[r[0],r[1],r[2],yr(r[3],e)]);case 6:return b(6,[r[0],r[1],r[2],yr(r[3],e)]);case 7:return b(7,[r[0],r[1],r[2],yr(r[3],e)]);case 8:return b(8,[r[0],r[1],r[2],yr(r[3],e)]);case 9:return b(9,[r[0],yr(r[1],e)]);case 10:return b(10,[yr(r[0],e)]);case 11:return b(11,[r[0],yr(r[1],e)]);case 12:return b(12,[r[0],yr(r[1],e)]);case 13:return b(13,[r[0],r[1],yr(r[2],e)]);case 14:return b(14,[r[0],r[1],yr(r[2],e)]);case 15:return b(15,[yr(r[0],e)]);case 16:return b(16,[yr(r[0],e)]);case 17:return b(17,[r[0],yr(r[1],e)]);case 18:return b(18,[r[0],yr(r[1],e)]);case 19:return b(19,[yr(r[0],e)]);case 20:return b(20,[r[0],r[1],yr(r[2],e)]);case 21:return b(21,[r[0],yr(r[1],e)]);case 22:return b(22,[yr(r[0],e)]);case 23:return b(23,[r[0],yr(r[1],e)]);case 24:return b(24,[r[0],r[1],yr(r[2],e)])}}dr("Pervasives.Exit");function _r(r){return r>=0?r:0|-r}function kr(r){return r?"true":"false"}function Sr(r){for(var e=0,n=r;;){var t=e;if(!n)return t;n=n[1],e=t+1|0}}function xr(r,e){for(;;){var n=e,t=r;if(!t)return n;e=[t[0],n],r=t[1]}}function Nr(r){return xr(r,0)}function Ar(r){return r?function r(e,n){return e?[e[0],r(e[1],n)]:n}(r[0],Ar(r[1])):0}function Or(r,e){return e?[f(r,e[0]),Or(r,e[1])]:0}function qr(r,e){for(;;){var n=e;if(!n)return;f(r,n[0]),e=n[1]}}function Rr(r,e,n){for(;;){var t=n,a=e;if(!t)return a;n=t[1],e=l(r,a,t[0])}}function Fr(r,e){for(;;){var n=e;if(!n)return!1;if(f(r,n[0]))return!0;e=n[1]}}function Er(r,e){if(r){if(e)return[[r[0],e[0]],Er(r[1],e[1])];throw[n,"List.combine"]}if(!e)return 0;throw[n,"List.combine"]}function Tr(r,e){for(;;){var n=r;if(0===n)return e;if(!e)throw[u,["list.ml",262,11]];e=e[1],r=n-1|0}}var Cr=Ar,Mr=function(r){return function(e){for(var n=0,t=e;;){var a=t,i=n;if(!a)return xr(i,0);var u=a[1],o=a[0];f(r,o)?(t=u,n=[o,i]):t=u}}},Lr=function(r,e){var n=function(e,n){if(2!==e){if(3===e&&n){var a=n[1];if(a){var i=a[1];if(i){var u=i[0],o=a[0],c=n[0];return l(r,c,o)<=0?l(r,o,u)<=0?[c,[o,[u,0]]]:l(r,c,u)<=0?[c,[u,[o,0]]]:[u,[c,[o,0]]]:l(r,c,u)<=0?[o,[c,[u,0]]]:l(r,o,u)<=0?[o,[u,[c,0]]]:[u,[o,[c,0]]]}}}}else if(n){var s=n[1];if(s){var f=s[0],v=n[0];return l(r,v,f)<=0?[v,[f,0]]:[f,[v,0]]}}for(var d=e>>1,h=e-d|0,p=Tr(d,n),m=t(d,n),g=t(h,p),b=0;;){var w=b,y=g,_=m;if(!_)return xr(y,w);if(!y)return xr(_,w);var k=y[0],S=_[0];l(r,S,k)>0?(b=[S,w],m=_[1]):(b=[k,w],g=y[1])}},t=function(e,t){if(2!==e){if(3===e&&t){var a=t[1];if(a){var i=a[1];if(i){var u=i[0],o=a[0],c=t[0];return l(r,c,o)>0?l(r,o,u)>0?[c,[o,[u,0]]]:l(r,c,u)>0?[c,[u,[o,0]]]:[u,[c,[o,0]]]:l(r,c,u)>0?[o,[c,[u,0]]]:l(r,o,u)>0?[o,[u,[c,0]]]:[u,[o,[c,0]]]}}}}else if(t){var s=t[1];if(s){var f=s[0],v=t[0];return l(r,v,f)>0?[v,[f,0]]:[f,[v,0]]}}for(var d=e>>1,h=e-d|0,p=Tr(d,t),m=n(d,t),g=n(h,p),b=0;;){var w=b,y=g,_=m;if(!_)return xr(y,w);if(!y)return xr(_,w);var k=y[0],S=_[0];l(r,S,k)<=0?(b=[S,w],m=_[1]):(b=[k,w],g=y[1])}},a=Sr(e);return a<2?e:n(a,e)};function Ir(r){return r>=97&&r<=122?r-32|0:r}function Pr(r,e){var n=N(r);return function(r,e,n,t){if(!(n<=0))for(var a=e,i=n+e|0;a<i;++a)r[a]=t}(n,0,r,e),n}var Dr=[];function $r(r,e,t){if(e<0||t<0||e>(r.length-t|0))throw[n,"String.sub / Bytes.sub"];var a=N(t);return A(r,e,a,0,t),a}function Br(r,e,n){return O($r(r,e,n))}function Ur(r,e,t,a,i){if(i<0||e<0||e>(r.length-i|0)||a<0||a>(t.length-i|0))throw[n,"Bytes.blit"];return A(r,e,t,a,i)}function Vr(r,e,t,a,i){if(i<0||e<0||e>(r.length-i|0)||a<0||a>(t.length-i|0))throw[n,"String.blit / Bytes.blit_string"];return q(r,e,t,a,i)}function Jr(r){var e=r-9|0;return e>4||e<0?23===e:2!==e}function Qr(r){for(var e=0,n=0,t=r.length;n<t;++n){var a,i=r[n];if(i>=32){var u=i-34|0;a=u>58||u<0?u>=93?4:1:u>57||u<1?2:1}else a=i>=11?13!==i?4:2:i>=8?2:4;e=e+a|0}if(e===r.length)return function(r){var e=r.length,n=N(e);return A(r,0,n,0,e),n}(r);var o=N(e);e=0;for(var c=0,s=r.length;c<s;++c){var f=r[c],l=0;if(f>=35)92!==f?f>=127?l=1:o[e]=f:l=2;else if(f>=32)f>=34?l=2:o[e]=f;else if(f>=14)l=1;else switch(f){case 8:o[e]=92,o[e=e+1|0]=98;break;case 9:o[e]=92,o[e=e+1|0]=116;break;case 10:o[e]=92,o[e=e+1|0]=110;break;case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:case 11:case 12:l=1;break;case 13:o[e]=92,o[e=e+1|0]=114}switch(l){case 1:o[e]=92,o[e=e+1|0]=48+(f/100|0)|0,o[e=e+1|0]=48+(f/10|0)%10|0,o[e=e+1|0]=48+f%10|0;break;case 2:o[e]=92,o[e=e+1|0]=f}e=e+1|0}return o}function Wr(r){return function(r,e){var n=e.length;if(0===n)return e;for(var t=N(n),a=0;a<n;++a)t[a]=f(r,e[a]);return t}(Ir,r)}function Zr(r,e){return O(Pr(r,e))}function jr(r,e){if(r>=e)return r;throw[n,"String.concat"]}function zr(r,e){if(!e)return"";var n=r.length;return O(function(r,e,n,t,a){for(;;){var i=a,u=e;if(!i)return r;var o=i[1],c=i[0];if(!o)return q(c,0,r,u,c.length),r;q(c,0,r,u,c.length),q(n,0,r,u+c.length|0,t),a=o,e=(u+c.length|0)+t|0}}(N(function(r,e,n){for(;;){var t=n,a=r;if(!t)return a;var i=t[1],u=t[0];if(!i)return u.length+a|0;n=i,r=jr((u.length+e|0)+a|0,a)}}(0,n,e)),0,r,n,e))}function Hr(r){var e=r-9|0;return e>4||e<0?23===e:2!==e}function Xr(r){return""===r||!Hr(r.charCodeAt(0))&&!Hr(r.charCodeAt(r.length-1|0))?r:O(function(r){for(var e=r.length,n=0;n<e&&Jr(r[n]);)n=n+1|0;for(var t=e-1|0;t>=n&&Jr(r[t]);)t=t-1|0;return t>=n?$r(r,n,1+(t-n|0)|0):Dr}(R(r)))}var Kr=y,Gr=Vr;function Yr(r,e,n,t){var a=void 0!==e&&e,i=r.style;return void 0!==i.setProperty?i.setProperty(n,t,a?"important":null):function(r,e,n){r.style[e]=n}(r,n,t)}function re(r,e,n){return r.insertBefore(e,n)}function ee(r,e,n,t){return""===e?r.setAttribute(n,t):r.setAttributeNS(e,n,t)}function ne(r,e){return""===r?document.createElement(e):document.createElementNS(r,e)}var te=b(0,[""]);function ae(r,e,n,t,a,i){return b(2,[r,e,n,t,a,i])}function ie(r,e,n){return b(3,[r,b(0,[e,n]),{contents:void 0}])}function ue(r){for(;;){var e=r;switch(0|e.tag){case 0:return"\x3c!-- "+e[0]+" --\x3e";case 1:return e[0];case 2:var n=e[1],t=e[0];return zr("",["<",[t,[""===t?"":":",[n,[zr("",Or((function(r){if("number"==typeof r)return"";switch(0|r.tag){case 0:return zr("",[" ",[r[0],['="',[r[1],['"',0]]]]]);case 1:return zr("",[" ",[r[1],['="',[r[2],['"',0]]]]]);case 2:return zr("",[" data-",[r[0],['="',[r[1],['"',0]]]]]);case 3:return"";case 4:return zr("",[' style="',[zr(";",Or((function(r){return zr("",[r[0],[":",[r[1],[";",0]]]])}),r[0])),['"',0]]])}}),e[4])),[">",[zr("",Or(ue,e[5])),["</",[n,[">",0]]]]]]]]]]);case 3:r=f(e[1],void 0);continue;case 4:r=e[1];continue}}}function oe(r){if(!r.tag)return r[1];var e=r[0];return function(r){return pr(e)}}function ce(r,e,n,t){var a,i,u,o={contents:oe(t)},c=function(r,e){return function(n){var t=f(e.contents,n);if(void 0!==t)return f(r.contents.enqueue,mr(t))}}(r,o);return a=n,i=c,u=!1,e.addEventListener(a,i,u),{handler:c,cb:o}}function se(r,e,n){if(void 0!==n)return t=r,a=e,i=n.handler,u=!1,void t.removeEventListener(a,i,u);var t,a,i,u}function fe(r,e,n,t,a,i,u,o){var c=u.contents;if(void 0!==c)if(n!==t)u.contents=se(e,n,u.contents),o.contents=ce(r,e,t,i);else{if(o.contents=u.contents,function(r,e){return e.tag?!(!r.tag||!S(e[0],r[0])):!r.tag&&e[0]===r[0]}(a,i))return;var s=oe(i);c.cb.contents=s}else o.contents=ce(r,e,t,i)}function le(r,n,t,a,i){!function(r,n,t,a){var i,u,o;if("number"!=typeof a)switch(0|a.tag){case 0:return void(n[a[0]]=void 0);case 1:return i=n,u=a[0],o=a[1],""===u?i.removeAttribute(o):i.removeAttributeNS(u,o);case 2:throw console.log(["TODO:  Remove Data Unhandled",a[0],a[1]]),[e,"TODO:  Remove Data Unhandled"];case 3:var c=a[2];return void(c.contents=se(n,a[0],c.contents));case 4:Rr((function(r,e){return Yr(n,void 0,e[0],null)}),void 0,a[0])}}(0,n,0,a),function(r,n,t,a){if("number"!=typeof a)switch(0|a.tag){case 0:return void(n[a[0]]=a[1]);case 1:return ee(n,a[0],a[1],a[2]);case 2:throw console.log(["TODO:  Add Data Unhandled",a[0],a[1]]),[e,"TODO:  Add Data Unhandled"];case 3:return void(a[2].contents=ce(r,n,a[0],a[1]));case 4:Rr((function(r,e){return Yr(n,void 0,e[0],e[1])}),void 0,a[0])}}(r,n,0,i)}function ve(r,t,a,i,u){if("number"==typeof u)throw[e,"This should never be called as all entries through NoProp are gated."];switch(0|u.tag){case 0:return void(t[u[0]]=u[1]);case 1:return ee(t,u[0],u[1],u[2]);case 2:throw console.log(["TODO:  Mutate Data Unhandled",u[0],u[1]]),[e,"TODO:  Mutate Data Unhandled"];case 3:throw[e,"This will never be called because it is gated"];case 4:if("number"==typeof i)throw[e,"Passed a non-Style to a new Style as a Mutations while the old Style is not actually a style!"];if(4===i.tag)return function(r,e,t,a){for(;;){var i=a,u=t,o=e;if(u){if(i){a=i[1],t=u[1],e=v(r,o,u[0],i[0]);continue}throw[n,"List.fold_left2"]}if(i)throw[n,"List.fold_left2"];return o}}((function(r,e,n){var a=n[1],i=n[0],u=e[0];return u===i?e[1]===a?void 0:Yr(t,void 0,i,a):(Yr(t,void 0,u,null),Yr(t,void 0,i,a))}),void 0,i[0],u[0]);throw[e,"Passed a non-Style to a new Style as a Mutations while the old Style is not actually a style!"]}}function de(r,e,n,t){return function(r,e,n,t,a){for(;;){var i=a,u=t,o=n;if(!u)return!i;var c=u[0];if(!i)return!1;if("number"==typeof c){if("number"==typeof i[0]){a=i[1],t=u[1],n=o+1|0;continue}}else switch(0|c.tag){case 0:var s=i[0];if("number"!=typeof s&&!s.tag){c[0]===s[0]&&c[1]===s[1]||ve(0,e,0,c,s),a=i[1],t=u[1],n=o+1|0;continue}break;case 1:var f=i[0];if("number"!=typeof f&&1===f.tag){c[0]===f[0]&&c[1]===f[1]&&c[2]===f[2]||ve(0,e,0,c,f),a=i[1],t=u[1],n=o+1|0;continue}break;case 2:var l=i[0];if("number"!=typeof l&&2===l.tag){c[0]===l[0]&&c[1]===l[1]||ve(0,e,0,c,l),a=i[1],t=u[1],n=o+1|0;continue}break;case 3:var v=i[0];if("number"!=typeof v&&3===v.tag){fe(r,e,c[0],v[0],c[1],v[1],c[2],v[2]),a=i[1],t=u[1],n=o+1|0;continue}break;case 4:var d=i[0];if("number"!=typeof d&&4===d.tag){S(c[0],d[0])||ve(0,e,0,c,d),a=i[1],t=u[1],n=o+1|0;continue}}le(r,e,0,c,i[0]),a=i[1],t=u[1],n=o+1|0}}(r,e,0,n,t)}function he(r,n,t,a,u){if(2===u.tag){var o=u[4],s=c(t,a),f=ne(u[0],u[1]);if(de(r,f,Or((function(r){return 0}),o),o))return ge(r,f,f.childNodes,0,0,u[5]),re(n,f,s),void n.removeChild(s);throw[i,["vdom.ml",319,30]]}throw[e,"Node replacement should never be passed anything but a node itself"]}function pe(r,e){for(;;){var n=e,t=r;switch(0|n.tag){case 0:var a=n[0];return document.createComment(a);case 1:var u=n[0];return document.createTextNode(u);case 2:var o=n[4],c=ne(n[0],n[1]);if(de(t,c,Or((function(r){return 0}),o),o))return ge(t,c,c.childNodes,0,0,n[5]),c;throw[i,["vdom.ml",333,30]];case 3:var s=f(n[1],void 0);n[2].contents=s,e=s;continue;case 4:e=n[1],r=f(n[0],t);continue}}}function me(r,n,t,a,i,u){if(2===i.tag){if(2===u.tag){if(i[3]!==u[3]||i[1]!==u[1])return he(r,n,t,a,u);var o=c(t,a),s=o.childNodes;return de(r,o,i[4],u[4])||(console.log("VDom:  Failed swapping properties because the property list length changed, use `noProp` to swap properties instead, not by altering the list structure.  This is a massive inefficiency until this issue is resolved."),he(r,n,t,a,u)),ge(r,o,s,0,i[5],u[5])}throw[e,"Non-node passed to patchVNodesOnElems_MutateNode"]}throw[e,"Non-node passed to patchVNodesOnElems_MutateNode"]}function ge(r,e,n,t,a,i){for(;;){var u=i,o=a,s=t;if(o){var l=o[0];switch(0|l.tag){case 0:if(u){var v=u[0];if(!v.tag&&l[0]===v[0]){i=u[1],a=o[1],t=s+1|0;continue}}break;case 1:if(u){var d=u[0];if(1===d.tag){var h=d[0];if(l[0]!==h)c(n,s).nodeValue=h;i=u[1],a=o[1],t=s+1|0;continue}}break;case 2:if(u){var p=u[0];if(2===p.tag){var m=u[1],g=p[2],b=p[1],w=p[0],y=o[1],_=l[2],k=l[1],S=l[0];if(_===g&&""!==_){i=m,a=y,t=s+1|0;continue}if(""===_||""===g){me(r,e,n,s,l,p),i=m,a=y,t=s+1|0;continue}var x=0,N=0;if(y){var A=y[0];if(2===A.tag){var O=y[1],q=A[2],R=A[1],F=A[0],E=0;if(m){var T=m[0];if(2===T.tag){if(F===w&&R===b&&q===g&&S===T[0]&&k===T[1]&&_===T[2]){var C=c(n,s),M=c(n,s+1|0);e.removeChild(M),re(e,M,C),i=m[1],a=O,t=s+2|0;continue}E=4}else E=4}else E=4;if(4===E){if(F===w&&R===b&&q===g){var L=c(n,s);e.removeChild(L),i=m,a=O,t=s+1|0;continue}N=3}}else N=3}else N=3;if(3===N)if(m){var I=m[0];if(2===I.tag){if(S===I[0]&&k===I[1]&&_===I[2]){var P=c(n,s);re(e,pe(r,p),P),i=m,t=s+1|0;continue}x=2}else x=2}else x=2;if(2===x){me(r,e,n,s,l,p),i=m,a=y,t=s+1|0;continue}}}break;case 3:if(u){var D=u[0];if(3===D.tag){var $=u[1],B=D[2],U=D[1],V=D[0],J=o[1],Q=l[2],W=l[0];if(W===V){B.contents=Q.contents,i=$,a=J,t=s+1|0;continue}var Z=0,j=0;if(J){var z=J[0];if(3===z.tag){var H=J[1],X=z[0],K=0;if($){var G=$[0];if(3===G.tag){if(X===V&&W===G[0]){var Y=c(n,s),rr=c(n,s+1|0);e.removeChild(rr),re(e,rr,Y),i=$[1],a=H,t=s+2|0;continue}K=4}else K=4}else K=4;if(4===K){if(X===V){var er=c(n,s);e.removeChild(er);var nr=z[2].contents;B.contents=nr,i=$,a=H,t=s+1|0;continue}j=3}}else j=3}else j=3;if(3===j)if($){var tr=$[0];if(3===tr.tag){if(tr[0]===W){var ar=c(n,s),ir=f(U,void 0);B.contents=ir,re(e,pe(r,ir),ar),i=$,t=s+1|0;continue}Z=2}else Z=2}else Z=2;if(2===Z){var ur=Q.contents,or=f(U,void 0);B.contents=or,i=[or,$],a=[ur,J];continue}}}break;case 4:a=[l[1],o[1]];continue}var cr=o[1];if(u){var sr=u[0];if(4===sr.tag){ge(f(sr[0],r),e,n,s,[l,0],[sr[1],0]),i=u[1],a=cr,t=s+1|0;continue}var fr=c(n,s);re(e,pe(r,sr),fr),e.removeChild(fr),i=u[1],a=cr,t=s+1|0;continue}var lr=c(n,s);e.removeChild(lr),i=0,a=cr}else{if(!u)return;var vr=pe(r,u[0]);e.appendChild(vr),i=u[1],a=0,t=s+1|0}}}function be(r,e){if("number"!=typeof e)switch(0|e.tag){case 1:return Rr((function(e,n){return be(r,n)}),void 0,e[0]);case 0:case 2:return f(e[0],r)}}function we(r,e,n,t){var a=function(r,e){for(;;){var n=e,t=r;if("number"==typeof n)return;switch(0|n.tag){case 0:var i=n[0];return i?qr(function(r){return function(e){return a(r,e)}}(t),i):void 0;case 1:return void(n[2].contents=f(n[1],t));case 2:var u=f(n[0],t);e=n[1],r=u;continue}}},i=function(r,e){for(;;){var n=e,t=r;if("number"==typeof n)return;switch(0|n.tag){case 0:var a=n[0];return a?qr(function(r){return function(e){return i(r,e)}}(t),a):void 0;case 1:var u=n[2],o=u.contents;return void 0!==o?(u.contents=void 0,f(o,void 0)):void 0;case 2:var c=f(n[0],t);e=n[1],r=c;continue}}};if("number"==typeof n){if("number"==typeof t)return t}else switch(0|n.tag){case 0:if("number"!=typeof t&&!t.tag){return function(n,t){for(;;){var u=t,o=n;if(o){var c=o[1],s=o[0];if(u){we(r,e,s,u[0]),t=u[1],n=c;continue}i(r,s),t=0,n=c}else{if(!u)return;a(e,u[0]),t=u[1],n=0}}}(n[0],t[0]),t}break;case 1:if("number"!=typeof t&&1===t.tag&&n[0]===t[0])return t[2].contents=n[2].contents,t;break;case 2:if("number"!=typeof t&&2===t.tag)return we(f(n[0],r),f(t[0],e),n[1],t[1]),t}return i(r,n),a(e,t),t}function ye(r,e){for(var n=r.length;(r.position+e|0)>n;)n<<=1;var t=N(n);Ur(r.buffer,0,t,0,r.position),r.buffer=t,r.length=n}function _e(r,e){var n=r.position;n>=r.length&&ye(r,1),r.buffer[n]=e,r.position=n+1|0}function ke(r,e){var n=e.length,t=r.position+n|0;t>r.length&&ye(r,n),Vr(e,0,r.buffer,r.position,n),r.position=t}function Se(r,e){var n=r.bytes.length,t=r.ind+e|0;if(!(t<=n)){var a,i,u=N((a=n<<1)>(i=t)?a:i);Ur(r.bytes,0,u,0,n),r.bytes=u}}function xe(r,e){Se(r,1),r.bytes[r.ind]=e,r.ind=r.ind+1|0}function Ne(r,e){var n=e.length;Se(r,n),Gr(e,0,r.bytes,r.ind,n),r.ind=r.ind+n|0}function Ae(r){return Br(r.bytes,0,r.ind)}function Oe(r){if("number"==typeof r)switch(r){case 0:return"@]";case 1:return"@}";case 2:return"@?";case 3:return"@\n";case 4:return"@.";case 5:return"@@";case 6:return"@%"}else switch(0|r.tag){case 0:case 1:return r[0];case 2:return"@"+O(Pr(1,r[0]))}}function qe(r){if("number"==typeof r)return 0;switch(0|r.tag){case 0:return b(0,[qe(r[0])]);case 1:return b(1,[qe(r[0])]);case 2:return b(2,[qe(r[0])]);case 3:return b(3,[qe(r[0])]);case 4:return b(4,[qe(r[0])]);case 5:return b(5,[qe(r[0])]);case 6:return b(6,[qe(r[0])]);case 7:return b(7,[qe(r[0])]);case 8:return b(8,[r[0],qe(r[1])]);case 9:return b(9,[r[1],r[0],qe(r[2])]);case 10:return b(10,[qe(r[0])]);case 11:return b(11,[qe(r[0])]);case 12:return b(12,[qe(r[0])]);case 13:return b(13,[qe(r[0])]);case 14:return b(14,[qe(r[0])])}}function Re(r){if("number"==typeof r)return[function(r){return 0},function(r){return 0},function(r){return 0},function(r){return 0}];switch(0|r.tag){case 0:var e=Re(r[0]),n=e[1],t=e[0];return[function(r){return f(t,0),0},function(r){return f(n,0),0},e[2],e[3]];case 1:var a=Re(r[0]),i=a[1],u=a[0];return[function(r){return f(u,0),0},function(r){return f(i,0),0},a[2],a[3]];case 2:var o=Re(r[0]),c=o[1],s=o[0];return[function(r){return f(s,0),0},function(r){return f(c,0),0},o[2],o[3]];case 3:var l=Re(r[0]),v=l[1],d=l[0];return[function(r){return f(d,0),0},function(r){return f(v,0),0},l[2],l[3]];case 4:var h=Re(r[0]),p=h[1],m=h[0];return[function(r){return f(m,0),0},function(r){return f(p,0),0},h[2],h[3]];case 5:var g=Re(r[0]),b=g[1],w=g[0];return[function(r){return f(w,0),0},function(r){return f(b,0),0},g[2],g[3]];case 6:var y=Re(r[0]),_=y[1],k=y[0];return[function(r){return f(k,0),0},function(r){return f(_,0),0},y[2],y[3]];case 7:var S=Re(r[0]),x=S[1],N=S[0];return[function(r){return f(N,0),0},function(r){return f(x,0),0},S[2],S[3]];case 8:var A=Re(r[1]),O=A[1],q=A[0];return[function(r){return f(q,0),0},function(r){return f(O,0),0},A[2],A[3]];case 9:var R=Re(r[2]),F=R[3],E=R[2],T=R[1],C=R[0],M=Re(Fe(qe(r[0]),r[1])),L=M[3],I=M[2],P=M[1],D=M[0];return[function(r){return f(C,0),f(D,0),0},function(r){return f(P,0),f(T,0),0},function(r){return f(E,0),f(I,0),0},function(r){return f(L,0),f(F,0),0}];case 10:var $=Re(r[0]),B=$[1],U=$[0];return[function(r){return f(U,0),0},function(r){return f(B,0),0},$[2],$[3]];case 11:var V=Re(r[0]),J=V[1],Q=V[0];return[function(r){return f(Q,0),0},function(r){return f(J,0),0},V[2],V[3]];case 12:var W=Re(r[0]),Z=W[1],j=W[0];return[function(r){return f(j,0),0},function(r){return f(Z,0),0},W[2],W[3]];case 13:var z=Re(r[0]),H=z[3],X=z[2],K=z[1],G=z[0];return[function(r){return f(G,0),0},function(r){return f(K,0),0},function(r){return f(X,0),0},function(r){return f(H,0),0}];case 14:var Y=Re(r[0]),rr=Y[3],er=Y[2],nr=Y[1],tr=Y[0];return[function(r){return f(tr,0),0},function(r){return f(nr,0),0},function(r){return f(er,0),0},function(r){return f(rr,0),0}]}}function Fe(r,e){var n=0;if("number"==typeof r){if("number"==typeof e)return 0;switch(0|e.tag){case 8:n=6;break;case 9:n=7;break;case 10:n=1;break;case 11:n=2;break;case 12:n=3;break;case 13:n=4;break;case 14:n=5;break;default:throw[u,["camlinternalFormat.ml",846,23]]}}else switch(0|r.tag){case 0:if("number"==typeof e)n=8;else switch(0|e.tag){case 0:return b(0,[Fe(r[0],e[0])]);case 8:n=6;break;case 9:n=7;break;case 10:n=1;break;case 11:n=2;break;case 12:n=3;break;case 13:n=4;break;case 14:n=5}break;case 1:if("number"==typeof e)n=8;else switch(0|e.tag){case 1:return b(1,[Fe(r[0],e[0])]);case 8:n=6;break;case 9:n=7;break;case 10:n=1;break;case 11:n=2;break;case 12:n=3;break;case 13:n=4;break;case 14:n=5}break;case 2:if("number"==typeof e)n=8;else switch(0|e.tag){case 2:return b(2,[Fe(r[0],e[0])]);case 8:n=6;break;case 9:n=7;break;case 10:n=1;break;case 11:n=2;break;case 12:n=3;break;case 13:n=4;break;case 14:n=5}break;case 3:if("number"==typeof e)n=8;else switch(0|e.tag){case 3:return b(3,[Fe(r[0],e[0])]);case 8:n=6;break;case 9:n=7;break;case 10:n=1;break;case 11:n=2;break;case 12:n=3;break;case 13:n=4;break;case 14:n=5}break;case 4:if("number"==typeof e)n=8;else switch(0|e.tag){case 4:return b(4,[Fe(r[0],e[0])]);case 8:n=6;break;case 9:n=7;break;case 10:n=1;break;case 11:n=2;break;case 12:n=3;break;case 13:n=4;break;case 14:n=5}break;case 5:if("number"==typeof e)n=8;else switch(0|e.tag){case 5:return b(5,[Fe(r[0],e[0])]);case 8:n=6;break;case 9:n=7;break;case 10:n=1;break;case 11:n=2;break;case 12:n=3;break;case 13:n=4;break;case 14:n=5}break;case 6:if("number"==typeof e)n=8;else switch(0|e.tag){case 6:return b(6,[Fe(r[0],e[0])]);case 8:n=6;break;case 9:n=7;break;case 10:n=1;break;case 11:n=2;break;case 12:n=3;break;case 13:n=4;break;case 14:n=5}break;case 7:if("number"==typeof e)n=8;else switch(0|e.tag){case 7:return b(7,[Fe(r[0],e[0])]);case 8:n=6;break;case 9:n=7;break;case 10:n=1;break;case 11:n=2;break;case 12:n=3;break;case 13:n=4;break;case 14:n=5}break;case 8:if("number"==typeof e)throw[u,["camlinternalFormat.ml",832,26]];switch(0|e.tag){case 8:return b(8,[Fe(r[0],e[0]),Fe(r[1],e[1])]);case 10:n=1;break;case 11:n=2;break;case 12:n=3;break;case 13:n=4;break;case 14:n=5;break;default:throw[u,["camlinternalFormat.ml",832,26]]}break;case 9:if("number"==typeof e)throw[u,["camlinternalFormat.ml",842,28]];switch(0|e.tag){case 8:n=6;break;case 9:var t=Re(Fe(qe(r[1]),e[0]));return f(t[1],0),f(t[3],0),b(9,[r[0],e[1],Fe(r[2],e[2])]);case 10:n=1;break;case 11:n=2;break;case 12:n=3;break;case 13:n=4;break;case 14:n=5;break;default:throw[u,["camlinternalFormat.ml",842,28]]}break;case 10:if("number"==typeof e)throw[u,["camlinternalFormat.ml",810,21]];if(10===e.tag)return b(10,[Fe(r[0],e[0])]);throw[u,["camlinternalFormat.ml",810,21]];case 11:if("number"==typeof e)throw[u,["camlinternalFormat.ml",814,21]];switch(0|e.tag){case 10:n=1;break;case 11:return b(11,[Fe(r[0],e[0])]);default:throw[u,["camlinternalFormat.ml",814,21]]}break;case 12:if("number"==typeof e)throw[u,["camlinternalFormat.ml",818,19]];switch(0|e.tag){case 10:n=1;break;case 11:n=2;break;case 12:return b(12,[Fe(r[0],e[0])]);default:throw[u,["camlinternalFormat.ml",818,19]]}break;case 13:if("number"==typeof e)throw[u,["camlinternalFormat.ml",822,22]];switch(0|e.tag){case 10:n=1;break;case 11:n=2;break;case 12:n=3;break;case 13:return b(13,[Fe(r[0],e[0])]);default:throw[u,["camlinternalFormat.ml",822,22]]}break;case 14:if("number"==typeof e)throw[u,["camlinternalFormat.ml",827,30]];switch(0|e.tag){case 10:n=1;break;case 11:n=2;break;case 12:n=3;break;case 13:n=4;break;case 14:return b(14,[Fe(r[0],e[0])]);default:throw[u,["camlinternalFormat.ml",827,30]]}}switch(n){case 1:throw[u,["camlinternalFormat.ml",811,21]];case 2:throw[u,["camlinternalFormat.ml",815,21]];case 3:throw[u,["camlinternalFormat.ml",819,19]];case 4:throw[u,["camlinternalFormat.ml",823,22]];case 5:throw[u,["camlinternalFormat.ml",828,30]];case 6:throw[u,["camlinternalFormat.ml",833,26]];case 7:throw[u,["camlinternalFormat.ml",843,28]];case 8:throw[u,["camlinternalFormat.ml",847,23]]}}var Ee=dr("CamlinternalFormat.Type_mismatch");function Te(r,e){if("number"==typeof r)return[0,e];if(!r.tag)return[b(0,[r[0],r[1]]),e];if("number"==typeof e)throw Ee;if(2===e.tag)return[b(1,[r[0]]),e[0]];throw Ee}function Ce(r,e,n){var t=Te(r,n);if("number"!=typeof e)return[t[0],[e[0]],t[1]];if(0===e)return[t[0],0,t[1]];var a=t[1];if("number"==typeof a)throw Ee;if(2===a.tag)return[t[0],1,a[0]];throw Ee}function Me(r,e){if("number"==typeof r)return[0,e];switch(0|r.tag){case 0:if("number"==typeof e)throw Ee;if(e.tag)throw Ee;var n=Me(r[0],e[0]);return[b(0,[n[0]]),n[1]];case 1:if("number"==typeof e)throw Ee;if(e.tag)throw Ee;var t=Me(r[0],e[0]);return[b(1,[t[0]]),t[1]];case 2:var a=Te(r[0],e),i=a[1];if("number"==typeof i)throw Ee;if(1===i.tag){var u=Me(r[1],i[0]);return[b(2,[a[0],u[0]]),u[1]]}throw Ee;case 3:var o=Te(r[0],e),c=o[1];if("number"==typeof c)throw Ee;if(1===c.tag){var s=Me(r[1],c[0]);return[b(3,[o[0],s[0]]),s[1]]}throw Ee;case 4:var l=Ce(r[1],r[2],e),v=l[2];if("number"==typeof v)throw Ee;if(2===v.tag){var d=Me(r[3],v[0]);return[b(4,[r[0],l[0],l[1],d[0]]),d[1]]}throw Ee;case 5:var h=Ce(r[1],r[2],e),p=h[2];if("number"==typeof p)throw Ee;if(3===p.tag){var m=Me(r[3],p[0]);return[b(5,[r[0],h[0],h[1],m[0]]),m[1]]}throw Ee;case 6:var g=Ce(r[1],r[2],e),w=g[2];if("number"==typeof w)throw Ee;if(4===w.tag){var y=Me(r[3],w[0]);return[b(6,[r[0],g[0],g[1],y[0]]),y[1]]}throw Ee;case 7:var _=Ce(r[1],r[2],e),k=_[2];if("number"==typeof k)throw Ee;if(5===k.tag){var S=Me(r[3],k[0]);return[b(7,[r[0],_[0],_[1],S[0]]),S[1]]}throw Ee;case 8:var N=Ce(r[1],r[2],e),A=N[2];if("number"==typeof A)throw Ee;if(6===A.tag){var O=Me(r[3],A[0]);return[b(8,[r[0],N[0],N[1],O[0]]),O[1]]}throw Ee;case 9:var q=Te(r[0],e),R=q[1];if("number"==typeof R)throw Ee;if(7===R.tag){var F=Me(r[1],R[0]);return[b(9,[q[0],F[0]]),F[1]]}throw Ee;case 10:var E=Me(r[0],e);return[b(10,[E[0]]),E[1]];case 11:var T=Me(r[1],e);return[b(11,[r[0],T[0]]),T[1]];case 12:var C=Me(r[1],e);return[b(12,[r[0],C[0]]),C[1]];case 13:if("number"==typeof e)throw Ee;if(8===e.tag){var M=e[0];if(x([r[1]],[M]))throw Ee;var L=Me(r[2],e[1]);return[b(13,[r[0],M,L[0]]),L[1]]}throw Ee;case 14:if("number"==typeof e)throw Ee;if(9===e.tag){var I=e[0];if(x([wr(r[1])],[wr(I)]))throw Ee;var P=Me(r[2],wr(e[2]));return[b(14,[r[0],I,P[0]]),P[1]]}throw Ee;case 15:if("number"==typeof e)throw Ee;if(10===e.tag){var D=Me(r[0],e[0]);return[b(15,[D[0]]),D[1]]}throw Ee;case 16:if("number"==typeof e)throw Ee;if(11===e.tag){var $=Me(r[0],e[0]);return[b(16,[$[0]]),$[1]]}throw Ee;case 17:var B=Me(r[1],e);return[b(17,[r[0],B[0]]),B[1]];case 18:var U=r[0],V=r[1];if(U.tag){var J=U[0],Q=Me(J[0],e),W=Me(V,Q[1]);return[b(18,[b(1,[[Q[0],J[1]]]),W[0]]),W[1]]}var Z=U[0],j=Me(Z[0],e),z=Me(V,j[1]);return[b(18,[b(0,[[j[0],Z[1]]]),z[0]]),z[1]];case 19:if("number"==typeof e)throw Ee;if(13===e.tag){var H=Me(r[0],e[0]);return[b(19,[H[0]]),H[1]]}throw Ee;case 20:if("number"==typeof e)throw Ee;if(1===e.tag){var X=Me(r[2],e[0]);return[b(20,[r[0],r[1],X[0]]),X[1]]}throw Ee;case 21:if("number"==typeof e)throw Ee;if(2===e.tag){var K=Me(r[1],e[0]);return[b(21,[r[0],K[0]]),K[1]]}throw Ee;case 23:var G=r[0],Y=r[1];if("number"==typeof G){if(2!==G)return Le(G,Y,e);if("number"==typeof e)throw Ee;if(14===e.tag){var rr=Me(Y,e[0]);return[b(23,[2,rr[0]]),rr[1]]}throw Ee}switch(0|G.tag){case 8:return Le(b(8,[G[0],G[1]]),Y,e);case 9:var er=function r(e,n,t){if("number"==typeof e)return[0,Me(n,t)];switch(0|e.tag){case 0:if("number"==typeof t)throw Ee;if(t.tag)throw Ee;var a=r(e[0],n,t[0]);return[b(0,[a[0]]),a[1]];case 1:if("number"==typeof t)throw Ee;if(1===t.tag){var i=r(e[0],n,t[0]);return[b(1,[i[0]]),i[1]]}throw Ee;case 2:if("number"==typeof t)throw Ee;if(2===t.tag){var u=r(e[0],n,t[0]);return[b(2,[u[0]]),u[1]]}throw Ee;case 3:if("number"==typeof t)throw Ee;if(3===t.tag){var o=r(e[0],n,t[0]);return[b(3,[o[0]]),o[1]]}throw Ee;case 4:if("number"==typeof t)throw Ee;if(4===t.tag){var c=r(e[0],n,t[0]);return[b(4,[c[0]]),c[1]]}throw Ee;case 5:if("number"==typeof t)throw Ee;if(5===t.tag){var s=r(e[0],n,t[0]);return[b(5,[s[0]]),s[1]]}throw Ee;case 6:if("number"==typeof t)throw Ee;if(6===t.tag){var l=r(e[0],n,t[0]);return[b(6,[l[0]]),l[1]]}throw Ee;case 7:if("number"==typeof t)throw Ee;if(7===t.tag){var v=r(e[0],n,t[0]);return[b(7,[v[0]]),v[1]]}throw Ee;case 8:if("number"==typeof t)throw Ee;if(8===t.tag){var d=t[0];if(x([e[0]],[d]))throw Ee;var h=r(e[1],n,t[1]);return[b(8,[d,h[0]]),h[1]]}throw Ee;case 9:if("number"==typeof t)throw Ee;if(9===t.tag){var p=t[1],m=t[0];if(x([wr(e[0])],[wr(m)]))throw Ee;if(x([wr(e[1])],[wr(p)]))throw Ee;var g=Re(Fe(qe(m),p));f(g[1],0),f(g[3],0);var w=r(wr(e[2]),n,t[2]);return[b(9,[m,p,qe(w[0])]),w[1]]}throw Ee;case 10:if("number"==typeof t)throw Ee;if(10===t.tag){var y=r(e[0],n,t[0]);return[b(10,[y[0]]),y[1]]}throw Ee;case 11:if("number"==typeof t)throw Ee;if(11===t.tag){var _=r(e[0],n,t[0]);return[b(11,[_[0]]),_[1]]}throw Ee;case 12:throw Ee;case 13:if("number"==typeof t)throw Ee;if(13===t.tag){var k=r(e[0],n,t[0]);return[b(13,[k[0]]),k[1]]}throw Ee;case 14:if("number"==typeof t)throw Ee;if(14===t.tag){var S=r(e[0],n,t[0]);return[b(14,[S[0]]),S[1]]}throw Ee}}(G[1],Y,e),nr=er[1];return[b(23,[b(9,[G[0],er[0]]),nr[0]]),nr[1]];default:return Le(G,Y,e)}case 22:case 24:throw Ee}}function Le(r,e,n){var t=Me(e,n);return[b(23,[r,t[0]]),t[1]]}function Ie(r,e){return function(r,e){var n=Me(r,e);if("number"==typeof n[1])return n[0];throw Ee}(r,wr(qe(e)))}function Pe(r,e,n){var t=n.length,a=_r(e),i=e<0?0:r;if(a<=t)return n;var u=Pr(a,2===i?48:32);switch(i){case 0:Gr(n,0,u,0,t);break;case 1:Gr(n,0,u,a-t|0,t);break;case 2:t>0&&(43===lr(n,0)||45===lr(n,0)||32===lr(n,0))?(u[0]=lr(n,0),Gr(n,1,u,1+(a-t|0)|0,t-1|0)):t>1&&48===lr(n,0)&&(120===lr(n,1)||88===lr(n,1))?(u[1]=lr(n,1),Gr(n,2,u,2+(a-t|0)|0,t-2|0)):Gr(n,0,u,a-t|0,t)}return O(u)}function De(r,e){var n=_r(r),t=e.length,a=lr(e,0),i=0;if(a>=58)if(a>=71){if(a>102||a<97)return e;i=2}else{if(a<65)return e;i=2}else if(32!==a){if(a<43)return e;switch(a-43|0){case 0:case 2:i=1;break;case 1:case 3:case 4:return e;case 5:if((n+2|0)>t&&t>1&&(120===lr(e,1)||88===lr(e,1))){var u=Pr(n+2|0,48);return u[1]=lr(e,1),Gr(e,2,u,4+(n-t|0)|0,t-2|0),O(u)}i=2;break;case 6:case 7:case 8:case 9:case 10:case 11:case 12:case 13:case 14:i=2}}else i=1;switch(i){case 1:if((n+1|0)<=t)return e;var o=Pr(n+1|0,48);return o[0]=a,Gr(e,1,o,2+(n-t|0)|0,t-1|0),O(o);case 2:if(n<=t)return e;var c=Pr(n,48);return Gr(e,0,c,n-t|0,t),O(c)}}function $e(r){var e,n=(e=r,function(r){for(;;){var n=r;if(n>=e.length)return!1;var t=e.charCodeAt(n);if(t<32)return!0;var a=t-34|0;if(a>58||a<0){if(a>=93)return!0;r=n+1|0}else{if(a>57||a<1)return!0;r=n+1|0}}}(0)?O(Qr(R(e))):e),t=n.length,a=Pr(t+2|0,34);return q(n,0,a,1,t),O(a)}function Be(r,e){if(15===r)return"%.12g";var n=_r(e),t=function(r){switch(r){case 0:case 1:case 2:return 102;case 3:case 4:case 5:return 101;case 6:case 7:case 8:return 69;case 9:case 10:case 11:return 103;case 12:case 13:case 14:return 71;case 15:return 70;case 16:case 17:case 18:return 104;case 19:case 20:case 21:return 72}}(r),a={ind:0,bytes:N(16)};return xe(a,37),function(r,e){switch(e){case 0:case 3:case 6:case 9:case 12:case 15:case 16:case 19:return;case 1:case 4:case 7:case 10:case 13:case 17:case 20:return xe(r,43);case 2:case 5:case 8:case 11:case 14:case 18:case 21:xe(r,32)}}(a,r),xe(a,46),Ne(a,String(n)),xe(a,t),Ae(a)}function Ue(r,e){return or(function(r){switch(r){case 0:return"%d";case 1:return"%+d";case 2:return"% d";case 3:return"%i";case 4:return"%+i";case 5:return"% i";case 6:return"%x";case 7:return"%#x";case 8:return"%X";case 9:return"%#X";case 10:return"%o";case 11:return"%#o";case 12:return"%u"}}(r),e)}function Ve(r,e){return fr(function(r){switch(r){case 0:return"%ld";case 1:return"%+ld";case 2:return"% ld";case 3:return"%li";case 4:return"%+li";case 5:return"% li";case 6:return"%lx";case 7:return"%#lx";case 8:return"%lX";case 9:return"%#lX";case 10:return"%lo";case 11:return"%#lo";case 12:return"%lu"}}(r),e)}function Je(r,e){return sr(function(r){switch(r){case 0:return"%nd";case 1:return"%+nd";case 2:return"% nd";case 3:return"%ni";case 4:return"%+ni";case 5:return"% ni";case 6:return"%nx";case 7:return"%#nx";case 8:return"%nX";case 9:return"%#nX";case 10:return"%no";case 11:return"%#no";case 12:return"%nu"}}(r),e)}function Qe(r,e){return cr(function(r){switch(r){case 0:return"%Ld";case 1:return"%+Ld";case 2:return"% Ld";case 3:return"%Li";case 4:return"%+Li";case 5:return"% Li";case 6:return"%Lx";case 7:return"%#Lx";case 8:return"%LX";case 9:return"%#LX";case 10:return"%Lo";case 11:return"%#Lo";case 12:return"%Lu"}}(r),e)}function We(r,e,n){if(r>=16){var t;if(r>=17)switch(r-17|0){case 2:t=45;break;case 0:case 3:t=43;break;case 1:case 4:t=32}else t=45;var a=function(r,e,n){if(!isFinite(r))return isNaN(r)?"nan":r>0?"infinity":"-infinity";var t=0==r&&1/r==-1/0?1:r>=0?0:1;t&&(r=-r);var a=0;if(0==r);else if(r<1)for(;r<1&&a>-1022;)r*=2,a--;else for(;r>=2;)r/=2,a++;var i=a<0?"":"+",u="";if(t)u="-";else switch(n){case 43:u="+";break;case 32:u=" "}if(e>=0&&e<13){var o=Math.pow(2,4*e);r=Math.round(r*o)/o}var c=r.toString(16);if(e>=0){var s=c.indexOf(".");if(s<0)c+="."+"0".repeat(e);else{var f=s+1+e;c.length<f?c+="0".repeat(f-c.length):c=c.substr(0,f)}}return u+"0x"+c+"p"+i+a.toString(10)}(n,e,t);return r>=19?O(Wr(R(a))):a}var i=function(r,e){var n=ir(r),t=n.prec<0?6:n.prec,a=e<0?(n.sign=-1,-e):e,i="";if(isNaN(a))i="nan",n.filter=" ";else if(isFinite(a)){switch(n.conv){case"e":var u=(i=a.toExponential(t)).length;"e"===i[u-3|0]&&(i=i.slice(0,u-1|0)+"0"+i.slice(u-1|0));break;case"f":i=a.toFixed(t);break;case"g":var o=0!==t?t:1,c=(i=a.toExponential(o-1|0)).indexOf("e"),s=0|Number(i.slice(c+1|0));if(s<-4||a>=1e21||a.toFixed().length>o){for(var f=c-1|0;"0"===i[f];)f=f-1|0;"."===i[f]&&(f=f-1|0);var l=(i=i.slice(0,f+1|0)+i.slice(c)).length;"e"===i[l-3|0]&&(i=i.slice(0,l-1|0)+"0"+i.slice(l-1|0))}else{var v=o;if(s<0)v=v-(s+1|0)|0,i=a.toFixed(v);else for(;(i=a.toFixed(v)).length>(o+1|0);)v=v-1|0;if(0!==v){for(var d=i.length-1|0;"0"===i[d];)d=d-1|0;"."===i[d]&&(d=d-1|0),i=i.slice(0,d+1|0)}}}}else i="inf",n.filter=" ";return ur(n,i)}(Be(r,e),n);if(15!==r)return i;var u=i.length,o=function(r){return isFinite(r)?Math.abs(r)>=22250738585072014e-324?0:0!==r?1:2:isNaN(r)?4:3}(n);return 3!==o?o>=4?"nan":function(r){for(;;){var e=r;if(e===u)return!1;var n=lr(i,e)-46|0;if(n>23||n<0){if(55===n)return!0;r=e+1|0}else{if(n>22||n<1)return!0;r=e+1|0}}}(0)?i:i+".":n<0?"neg_infinity":"infinity"}function Ze(r){var e=function(r){var e=0;if(r>=40){if(92===r)return"\\\\";e=r>=127?1:2}else if(r>=32){if(r>=39)return"\\'";e=2}else if(r>=14)e=1;else switch(r){case 8:return"\\b";case 9:return"\\t";case 10:return"\\n";case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:case 11:case 12:e=1;break;case 13:return"\\r"}switch(e){case 1:var n=[0,0,0,0];return n[0]=92,n[1]=48+(r/100|0)|0,n[2]=48+(r/10|0)%10|0,n[3]=48+r%10|0,O(n);case 2:var t=[0];return t[0]=r,O(t)}}(r),n=e.length,t=Pr(n+2|0,39);return q(e,0,t,1,n),O(t)}function je(r){var e={ind:0,bytes:N(16)};return function r(e,n){for(;;){var t=n;if("number"==typeof t)return;switch(0|t.tag){case 0:Ne(e,"%c"),n=t[0];continue;case 1:Ne(e,"%s"),n=t[0];continue;case 2:Ne(e,"%i"),n=t[0];continue;case 3:Ne(e,"%li"),n=t[0];continue;case 4:Ne(e,"%ni"),n=t[0];continue;case 5:Ne(e,"%Li"),n=t[0];continue;case 6:Ne(e,"%f"),n=t[0];continue;case 7:Ne(e,"%B"),n=t[0];continue;case 8:Ne(e,"%{"),r(e,t[0]),Ne(e,"%}"),n=t[1];continue;case 9:Ne(e,"%("),r(e,t[0]),Ne(e,"%)"),n=t[2];continue;case 10:Ne(e,"%a"),n=t[0];continue;case 11:Ne(e,"%t"),n=t[0];continue;case 12:Ne(e,"%?"),n=t[0];continue;case 13:Ne(e,"%r"),n=t[0];continue;case 14:Ne(e,"%_r"),n=t[0];continue}}}(e,r),Ae(e)}function ze(r,e,n,t){for(;;){var a=t,i=n,o=r;if("number"==typeof a)return l(o,e,i);switch(0|a.tag){case 0:return function(r,n,t){return function(a){var i=b(5,[n,a]);return ze(r,e,i,t)}}(o,i,a[0]);case 1:return function(r,n,t){return function(a){var i=Ze(a),u=b(4,[n,i]);return ze(r,e,u,t)}}(o,i,a[0]);case 2:return Ke(o,e,i,a[1],a[0],(function(r){return r}));case 3:return Ke(o,e,i,a[1],a[0],$e);case 4:return Ge(o,e,i,a[3],a[1],a[2],Ue,a[0]);case 5:return Ge(o,e,i,a[3],a[1],a[2],Ve,a[0]);case 6:return Ge(o,e,i,a[3],a[1],a[2],Je,a[0]);case 7:return Ge(o,e,i,a[3],a[1],a[2],Qe,a[0]);case 8:var c=a[3],s=a[1],v=a[2],d=a[0];if("number"==typeof s)return"number"==typeof v?0!==v?function(r,n,t,a){return function(i,u){var o=We(a,i,u);return ze(r,e,b(4,[n,o]),t)}}(o,i,c,d):function(r,n,t,a){return function(i){var u=We(a,-6,i);return ze(r,e,b(4,[n,u]),t)}}(o,i,c,d):function(r,n,t,a,i){return function(u){var o=We(a,i,u);return ze(r,e,b(4,[n,o]),t)}}(o,i,c,d,v[0]);if(s.tag){var h=s[0];return"number"==typeof v?0!==v?function(r,n,t,a,i){return function(u,o,c){var s=Pe(i,u,We(a,o,c));return ze(r,e,b(4,[n,s]),t)}}(o,i,c,d,h):function(r,n,t,a,i){return function(u,o){var c=We(a,-6,o),s=Pe(i,u,c);return ze(r,e,b(4,[n,s]),t)}}(o,i,c,d,h):function(r,n,t,a,i,u){return function(o,c){var s=Pe(i,o,We(a,u,c));return ze(r,e,b(4,[n,s]),t)}}(o,i,c,d,h,v[0])}var p=s[1],m=s[0];return"number"==typeof v?0!==v?function(r,n,t,a,i,u){return function(o,c){var s=Pe(i,u,We(a,o,c));return ze(r,e,b(4,[n,s]),t)}}(o,i,c,d,m,p):function(r,n,t,a,i,u){return function(o){var c=We(a,-6,o),s=Pe(i,u,c);return ze(r,e,b(4,[n,s]),t)}}(o,i,c,d,m,p):function(r,n,t,a,i,u,o){return function(c){var s=Pe(i,u,We(a,o,c));return ze(r,e,b(4,[n,s]),t)}}(o,i,c,d,m,p,v[0]);case 9:return Ke(o,e,i,a[1],a[0],kr);case 10:t=a[0],n=b(7,[i]);continue;case 11:t=a[1],n=b(2,[i,a[0]]);continue;case 12:t=a[1],n=b(3,[i,a[0]]);continue;case 13:return function(r,n,t,a){return function(i){return ze(r,e,b(4,[n,a]),t)}}(o,i,a[2],je(a[1]));case 14:var g=a[2];return function(r,n,t,a){return function(i){return ze(r,e,n,yr(Ie(i[0],t),a))}}(o,i,a[1],g);case 15:return function(r,n,t){return function(a,i){return ze(r,e,b(6,[n,function(r){return l(a,r,i)}]),t)}}(o,i,a[0]);case 16:return function(r,n,t){return function(a){return ze(r,e,b(6,[n,a]),t)}}(o,i,a[0]);case 17:t=a[1],n=b(0,[i,a[0]]);continue;case 18:var w=a[0];if(w.tag){var y=function(r,e,n){return function(t,a){return ze(r,t,b(1,[e,b(1,[a])]),n)}}(o,i,a[1]);t=w[0][0],n=0,r=y;continue}var _=function(r,e,n){return function(t,a){return ze(r,t,b(1,[e,b(0,[a])]),n)}}(o,i,a[1]);t=w[0][0],n=0,r=_;continue;case 19:throw[u,["camlinternalFormat.ml",1525,4]];case 20:return function(r,n,t){return function(a){return ze(r,e,t,n)}}(o,a[2],b(8,[i,"Printf: bad conversion %["]));case 21:return function(r,n,t){return function(a){var i=or("%u",a),u=b(4,[n,i]);return ze(r,e,u,t)}}(o,i,a[1]);case 22:return function(r,n,t){return function(a){var i=b(5,[n,a]);return ze(r,e,i,t)}}(o,i,a[0]);case 23:return He(o,e,i,a[0],a[1]);case 24:return Ye(o,e,i,a[2],a[0],f(a[1],void 0))}}}function He(r,e,n,t,a){if("number"!=typeof t)return 9===t.tag?function r(e,n,t,a,i){if("number"==typeof a)return Xe(e,n,t,i);switch(0|a.tag){case 0:var o=a[0];return function(a){return r(e,n,t,o,i)};case 1:var c=a[0];return function(a){return r(e,n,t,c,i)};case 2:var s=a[0];return function(a){return r(e,n,t,s,i)};case 3:var f=a[0];return function(a){return r(e,n,t,f,i)};case 4:var l=a[0];return function(a){return r(e,n,t,l,i)};case 5:var v=a[0];return function(a){return r(e,n,t,v,i)};case 6:var d=a[0];return function(a){return r(e,n,t,d,i)};case 7:var h=a[0];return function(a){return r(e,n,t,h,i)};case 8:var p=a[1];return function(a){return r(e,n,t,p,i)};case 9:var m=a[2],g=Fe(qe(a[0]),a[1]);return function(a){return r(e,n,t,function r(e,n){if("number"==typeof e)return n;switch(0|e.tag){case 0:return b(0,[r(e[0],n)]);case 1:return b(1,[r(e[0],n)]);case 2:return b(2,[r(e[0],n)]);case 3:return b(3,[r(e[0],n)]);case 4:return b(4,[r(e[0],n)]);case 5:return b(5,[r(e[0],n)]);case 6:return b(6,[r(e[0],n)]);case 7:return b(7,[r(e[0],n)]);case 8:return b(8,[e[0],r(e[1],n)]);case 9:return b(9,[e[0],e[1],r(e[2],n)]);case 10:return b(10,[r(e[0],n)]);case 11:return b(11,[r(e[0],n)]);case 12:return b(12,[r(e[0],n)]);case 13:return b(13,[r(e[0],n)]);case 14:return b(14,[r(e[0],n)])}}(g,m),i)};case 10:var w=a[0];return function(a,u){return r(e,n,t,w,i)};case 11:var y=a[0];return function(a){return r(e,n,t,y,i)};case 12:var _=a[0];return function(a){return r(e,n,t,_,i)};case 13:throw[u,["camlinternalFormat.ml",1616,31]];case 14:throw[u,["camlinternalFormat.ml",1617,31]]}}(r,e,n,t[1],a):Xe(r,e,n,a);if(2!==t)return Xe(r,e,n,a);throw[u,["camlinternalFormat.ml",1593,39]]}function Xe(r,e,n,t){return ze(r,e,b(8,[n,"Printf: bad conversion %_"]),t)}function Ke(r,e,n,t,a,i){if("number"==typeof a)return function(a){var u=f(i,a),o=b(4,[n,u]);return ze(r,e,o,t)};if(a.tag){var u=a[0];return function(a,o){var c=Pe(u,a,f(i,o)),s=b(4,[n,c]);return ze(r,e,s,t)}}var o=a[1],c=a[0];return function(a){var u=Pe(c,o,f(i,a)),s=b(4,[n,u]);return ze(r,e,s,t)}}function Ge(r,e,n,t,a,i,u,o){if("number"==typeof a){if("number"==typeof i)return 0!==i?function(a,i){var c=De(a,l(u,o,i));return ze(r,e,b(4,[n,c]),t)}:function(a){var i=l(u,o,a);return ze(r,e,b(4,[n,i]),t)};var c=i[0];return function(a){var i=De(c,l(u,o,a));return ze(r,e,b(4,[n,i]),t)}}if(a.tag){var s=a[0];if("number"==typeof i)return 0!==i?function(a,i,c){var f=Pe(s,a,De(i,l(u,o,c)));return ze(r,e,b(4,[n,f]),t)}:function(a,i){var c=Pe(s,a,l(u,o,i));return ze(r,e,b(4,[n,c]),t)};var f=i[0];return function(a,i){var c=Pe(s,a,De(f,l(u,o,i)));return ze(r,e,b(4,[n,c]),t)}}var v=a[1],d=a[0];if("number"==typeof i)return 0!==i?function(a,i){var c=Pe(d,v,De(a,l(u,o,i)));return ze(r,e,b(4,[n,c]),t)}:function(a){var i=Pe(d,v,l(u,o,a));return ze(r,e,b(4,[n,i]),t)};var h=i[0];return function(a){var i=Pe(d,v,De(h,l(u,o,a)));return ze(r,e,b(4,[n,i]),t)}}function Ye(r,e,n,t,a,i){if(!a)return ze(r,e,b(4,[n,i]),t);var u=a[0];return function(a){return Ye(r,e,n,t,u,f(i,a))}}function rn(r,e){return ze((function(e,t){var a,i,u,o,c={buffer:u=N(i=(a=64)<1?1:a),position:0,length:i,initial_buffer:u};return function r(e,t){for(;;){var a=t,i=0;if("number"==typeof a)return;switch(0|a.tag){case 0:var u=Oe(a[1]);return r(e,a[0]),ke(e,u);case 1:var o=a[1],c=a[0];if(o.tag){r(e,c),ke(e,"@["),t=o[0];continue}r(e,c),ke(e,"@{"),t=o[0];continue;case 2:case 4:i=1;break;case 3:case 5:i=2;break;case 6:return r(e,a[0]),ke(e,f(a[1],void 0));case 7:t=a[0];continue;case 8:throw r(e,a[0]),[n,a[1]]}switch(i){case 1:return r(e,a[0]),ke(e,a[1]);case 2:return r(e,a[0]),_e(e,a[1])}}}(c,t),f(r,Br((o=c).buffer,0,o.position))}),void 0,0,e[0])}function en(r){return rn((function(r){return r}),r)}function nn(r){var e=r.length;return Nr(function(n,t){for(;;){var a=t,i=n;if(a===e)return i;t=a+1|0,n=[lr(r,a),i]}}(0,0))}function tn(r,e){return function(r,e){return r.line===e.line?w(e.column,r.column):w(e.line,r.line)}(r.location,e.location)}function an(r){return v(en([b(11,["At ",b(2,[0,b(11,["; Expecting ",b(2,[0,b(11,[" but actual ",b(2,[0,0])])])])])]),"At %s; Expecting %s but actual %s"]),function(r){return l(en([b(11,["Ln ",b(4,[0,0,0,b(11,[", Col ",b(4,[0,0,0,0])])])]),"Ln %d, Col %d"]),r.line,r.column)}(r.location),r.expecting,r.actual)}function un(r){return r.result}function on(r,e,n){var t=f(r,n);if(t.tag)return b(1,[t[0]]);var a=t[0];return l(e,a.result,{location:a.location,input_chars:a.remaining_chars})}function cn(r,e,n,t){var a=f(r,t);if(a.tag)return b(0,[{result:n,location:t.location,remaining_chars:t.input_chars}]);var i=a[0];return l(e,i.result,{location:i.location,input_chars:i.remaining_chars})}function sn(r,e){return b(0,[{result:r,location:e.location,remaining_chars:e.input_chars}])}function fn(r,e,n){var t=f(e,n);if(!t.tag)return t;var a=t[0];return b(1,a?[[{expecting:f(r,zr(" OR ",Or((function(r){return r.expecting}),a))),actual:a[0].actual,location:n.location},0]]:[[{expecting:f(r,""),actual:"No input",location:n.location},0]])}function ln(r,e,n){var t=f(e,n);if(!t.tag)return t;var a=t[0];return b(1,a?[[{expecting:r,actual:a[0].actual,location:n.location},a[1]]]:[[{expecting:r,actual:"",location:n.location},0]])}function vn(r,e){return function(n){return on(e,(function(e){var n=f(r,e);return function(r){return sn(n,r)}}),n)}}function dn(r,e,n){var t=f(r,n);if(!t.tag)return t;var a=f(e,n);return a.tag?b(1,[Cr([t[0],[a[0],0]])]):a}function hn(r){if(!r)return function(r){return b(1,[0])};var e=r[0],n=hn(r[1]);return function(r){return dn(e,n,r)}}function pn(r,e){return n=r,t=function(r,e){var n=function(t){var a=Nr(t);return function(i){return cn(r,(function(r){return function(r){return on(e,(function(r){return n([r,t])}),r)}}),a,i)}};return n(0)}(e,r),function(r){return on(n,(function(r){return function(e){return on(t,(function(e){var n=[r,e];return function(r){return sn(n,r)}}),e)}}),r)};var n,t}function mn(r,e,n){var t=n.input_chars;if(!t)return b(1,[[{expecting:e,actual:"Ran out of characters",location:n.location},0]]);var a,i,u,o=t[0];return f(r,o)?b(0,[{result:o,location:(a=n.location,i=o,u=a.line,10!==i&&13!==i?{column:a.column+1|0,line:u}:{column:1,line:u+1|0}),remaining_chars:t[1]}]):b(1,[[{expecting:e,actual:f(en([b(12,[39,b(0,[b(12,[39,0])])]),"'%c'"]),o),location:n.location},0]])}function gn(r){var e=f(en([b(0,[0]),"%c"]),r);return function(n){return mn((function(e){return r===e}),e,n)}}function bn(r,e){var n=l(en([b(11,["A character between ",b(0,[b(11,[" and ",b(0,[0])])])]),"A character between %c and %c"]),r,e);return function(t){return mn((function(n){return n>=r&&n<=e}),n,t)}}var wn=function(r){var e=f(en([b(11,["One of: ",b(2,[0,0])]),"One of: %s"]),zr(", ",Or((function(r){return Zr(1,r)}),r)));return function(n){return mn((function(e){return function(r,e){for(;;){var n=e;if(!n)return!1;if(S(n[0],r))return!0;e=n[1]}}(e,r)}),e,n)}}([32,[9,[13,[10,0]]]]),yn=(gn(10),gn(9),bn(65,90)),_n=bn(97,122),kn=bn(48,57),Sn=en([b(2,[0,0]),"%s"]);function xn(r){return fn(Sn,(function(r){return dn(_n,yn,r)}),r)}hn([bn(97,102),[bn(65,70),[kn,0]]]);var Nn=function r(e){var n=function(n){return on(e,(function(n){return r(e)}),n)};return function(r){return dn(n,(function(r){return sn(void 0,r)}),r)}}(wn);bn(48,55);function An(r){var n=r.length,t=function(e){if(e>=n)return function(e){return sn(r,e)};var a=t(e+1|0),i=gn(lr(r,e));return function(r){return on(i,(function(r){return a}),r)}};if(n<=0)return function(r){throw[e,r]}("token must be a non-empty string");var a=t(0),i=function(r){return on(Nn,(function(r){return a}),r)};return function(e){return ln(r,i,e)}}function On(r,e){var n=function(r,e){return f(r,{location:{column:1,line:1},input_chars:nn(Xr(e))})}(r,e);if(n.tag)return b(1,[n[0]]);var t=n[0],a=t.remaining_chars,i=t.location;return a?b(1,[[{expecting:"End of input",actual:f(en([b(11,["Characters remaining: ",b(2,[0,0])]),"Characters remaining: %s"]),zr("",Or((function(r){return Zr(1,r)}),a))),location:i},0]]):b(0,[{result:t.result,location:i,remaining_chars:a}])}var qn=on,Rn=dn,Fn=function(r,e){return function(n){return on(r,(function(r){return e}),n)}},En=function(r,e){return function(n){return on(r,(function(r){return function(n){return on(e,(function(e){return function(e){return sn(r,e)}}),n)}}),n)}};function Tn(r){var e=function(r){return r?r[4]:0},t=function(r,n,t,a){var i=e(r),u=e(a);return[r,n,t,a,i>=u?i+1|0:u+1|0]},i=function(r,e){return[0,r,e,0,1]},o=function(r,a,i,u){var o=r?r[4]:0,c=u?u[4]:0;if(o>(c+2|0)){if(r){var s=r[3],f=r[2],l=r[1],v=r[0];if(e(v)>=e(s))return t(v,l,f,t(s,a,i,u));if(s)return t(t(v,l,f,s[0]),s[1],s[2],t(s[3],a,i,u));throw[n,"Map.bal"]}throw[n,"Map.bal"]}if(c<=(o+2|0))return[r,a,i,u,o>=c?o+1|0:c+1|0];if(u){var d=u[3],h=u[2],p=u[1],m=u[0];if(e(d)>=e(m))return t(t(r,a,i,m),p,h,d);if(m)return t(t(r,a,i,m[0]),m[1],m[2],t(m[3],p,h,d));throw[n,"Map.bal"]}throw[n,"Map.bal"]},c=function(e,n,t){if(!t)return[0,e,n,0,1];var a=t[3],i=t[2],u=t[1],s=t[0],f=l(r.compare,e,u);if(0===f)return i===n?t:[s,e,n,a,t[4]];if(f<0){var v=c(e,n,s);return s===v?t:o(v,u,i,a)}var d=c(e,n,a);return a===d?t:o(s,u,i,d)},s=function(r){for(;;){var e=r;if(!e)throw a;var n=e[0];if(!n)return[e[1],e[2]];r=n}},d=function(r){for(;;){var e=r;if(!e)return;var n=e[0];if(!n)return[e[1],e[2]];r=n}},h=function(r){if(r){var e=r[0];return e?o(h(e),r[1],r[2],r[3]):r[3]}throw[n,"Map.remove_min_elt"]},p=function(r,e){if(!r)return e;if(!e)return r;var n=s(e);return o(r,n[0],n[1],h(e))},m=function(e,n){if(!n)return 0;var t=n[3],a=n[2],i=n[1],u=n[0],c=l(r.compare,e,i);if(0===c)return p(u,t);if(c<0){var s=m(e,u);return u===s?n:o(s,i,a,t)}var f=m(e,t);return t===f?n:o(u,i,a,f)},g=function(e,n,t){if(t){var a=t[3],i=t[2],u=t[1],c=t[0],s=l(r.compare,e,u);if(0===s){var v=f(n,pr(i));if(void 0===v)return p(c,a);var d=mr(v);return i===d?t:[c,e,d,a,t[4]]}if(s<0){var h=g(e,n,c);return c===h?t:o(h,u,i,a)}var m=g(e,n,a);return a===m?t:o(c,u,i,m)}var b=f(n,void 0);return void 0!==b?[0,e,mr(b),0,1]:0},b=function(r,e){for(;;){var n=e;if(!n)return;b(r,n[0]),l(r,n[1],n[2]),e=n[3]}},w=function(r,e){if(!e)return 0;var n=w(r,e[0]),t=f(r,e[2]),a=w(r,e[3]);return[n,e[1],t,a,e[4]]},y=function(r,e){if(!e)return 0;var n=e[1];return[y(r,e[0]),n,l(r,n,e[2]),y(r,e[3]),e[4]]},_=function(r,e,n){for(;;){var t=n,a=e;if(!a)return t;n=v(r,a[1],a[2],_(r,a[0],t)),e=a[3]}},k=function(r,e){for(;;){var n=e;if(!n)return!0;if(!l(r,n[1],n[2]))return!1;if(!k(r,n[0]))return!1;e=n[3]}},S=function(r,e){for(;;){var n=e;if(!n)return!1;if(l(r,n[1],n[2]))return!0;if(S(r,n[0]))return!0;e=n[3]}},x=function(r,e,n){return n?o(x(r,e,n[0]),n[1],n[2],n[3]):i(r,e)},N=function(r,e,n){return n?o(n[0],n[1],n[2],N(r,e,n[3])):i(r,e)},A=function(r,e,n,a){if(!r)return x(e,n,a);if(!a)return N(e,n,r);var i=a[4],u=r[4];return u>(i+2|0)?o(r[0],r[1],r[2],A(r[3],e,n,a)):i>(u+2|0)?o(A(r,e,n,a[0]),a[1],a[2],a[3]):t(r,e,n,a)},O=function(r,e){if(!r)return e;if(!e)return r;var n=s(e);return A(r,n[0],n[1],h(e))},q=function(r,e,n,t){return void 0!==n?A(r,e,mr(n),t):O(r,t)},R=function(e,n){if(!n)return[0,void 0,0];var t=n[3],a=n[2],i=n[1],u=n[0],o=l(r.compare,e,i);if(0===o)return[u,pr(a),t];if(o<0){var c=R(e,u);return[c[0],c[1],A(c[2],i,a,t)]}var s=R(e,t);return[A(u,i,a,s[0]),s[1],s[2]]},F=function(r,n,t){if(n){var a=n[1];if(n[4]>=e(t)){var i=R(a,t);return q(F(r,n[0],i[0]),a,v(r,a,pr(n[2]),i[1]),F(r,n[3],i[2]))}}else if(!t)return 0;if(t){var o=t[1],c=R(o,n);return q(F(r,c[0],t[0]),o,v(r,o,c[1],pr(t[2])),F(r,c[2],t[3]))}throw[u,["map.ml",393,10]]},E=function(r,e,n){if(!e)return n;if(!n)return e;var t=n[2],a=n[1],i=e[2],u=e[1];if(e[4]>=n[4]){var o=R(u,n),c=o[1],s=E(r,e[0],o[0]),f=E(r,e[3],o[2]);return void 0!==c?q(s,u,v(r,u,i,mr(c)),f):A(s,u,i,f)}var l=R(a,e),d=l[1],h=E(r,l[0],n[0]),p=E(r,l[2],n[3]);return void 0!==d?q(h,a,v(r,a,mr(d),t),p):A(h,a,t,p)},T=function(r,e){if(!e)return 0;var n=e[3],t=e[2],a=e[1],i=e[0],u=T(r,i),o=l(r,a,t),c=T(r,n);return o?i===u&&n===c?e:A(u,a,t,c):O(u,c)},C=function(r,e){if(!e)return[0,0];var n=e[2],t=e[1],a=C(r,e[0]),i=a[1],u=a[0],o=l(r,t,n),c=C(r,e[3]),s=c[1],f=c[0];return o?[A(u,t,n,f),O(i,s)]:[O(u,f),A(i,t,n,s)]},M=function(r,e){for(;;){var n=e,t=r;if(!t)return n;e=[t[1],t[2],t[3],n],r=t[0]}},L=function(r){return r?(L(r[0])+1|0)+L(r[3])|0:0},I=function(r,e){for(;;){var n=e,t=r;if(!n)return t;e=n[0],r=[[n[1],n[2]],I(t,n[3])]}};return{empty:0,is_empty:function(r){return!r},mem:function(e,n){for(;;){var t=n;if(!t)return!1;var a=l(r.compare,e,t[1]);if(0===a)return!0;n=a<0?t[0]:t[3]}},add:c,update:g,singleton:i,remove:m,merge:F,union:E,compare:function(e,n,t){for(var a=M(n,0),i=M(t,0);;){var u=i,o=a;if(!o)return u?-1:0;if(!u)return 1;var c=l(r.compare,o[0],u[0]);if(0!==c)return c;var s=l(e,o[1],u[1]);if(0!==s)return s;i=M(u[2],u[3]),a=M(o[2],o[3])}},equal:function(e,n,t){for(var a=M(n,0),i=M(t,0);;){var u=i,o=a;if(!o)return!u;if(!u)return!1;if(0!==l(r.compare,o[0],u[0]))return!1;if(!l(e,o[1],u[1]))return!1;i=M(u[2],u[3]),a=M(o[2],o[3])}},iter:b,fold:_,for_all:k,exists:S,filter:T,partition:C,cardinal:L,bindings:function(r){return I(0,r)},min_binding:s,min_binding_opt:d,max_binding:function(r){for(;;){var e=r;if(!e)throw a;var n=e[3];if(!n)return[e[1],e[2]];r=n}},max_binding_opt:function(r){for(;;){var e=r;if(!e)return;var n=e[3];if(!n)return[e[1],e[2]];r=n}},choose:s,choose_opt:d,split:R,find:function(e,n){for(;;){var t=n;if(!t)throw a;var i=l(r.compare,e,t[1]);if(0===i)return t[2];n=i<0?t[0]:t[3]}},find_opt:function(e,n){for(;;){var t=n;if(!t)return;var a=l(r.compare,e,t[1]);if(0===a)return pr(t[2]);n=a<0?t[0]:t[3]}},find_first:function(r,e){for(;;){var n=e;if(!n)throw a;var t=n[1];if(f(r,t))for(var i=t,u=n[2],o=n[0];;){var c=o;if(!c)return[i,u];var s=c[1];f(r,s)?(o=c[0],u=c[2],i=s):o=c[3]}e=n[3]}},find_first_opt:function(r,e){for(;;){var n=e;if(!n)return;var t=n[1];if(f(r,t))for(var a=t,i=n[2],u=n[0];;){var o=u;if(!o)return[a,i];var c=o[1];f(r,c)?(u=o[0],i=o[2],a=c):u=o[3]}e=n[3]}},find_last:function(r,e){for(;;){var n=e;if(!n)throw a;var t=n[1];if(f(r,t))for(var i=t,u=n[2],o=n[3];;){var c=o;if(!c)return[i,u];var s=c[1];f(r,s)?(o=c[3],u=c[2],i=s):o=c[0]}e=n[0]}},find_last_opt:function(r,e){for(;;){var n=e;if(!n)return;var t=n[1];if(f(r,t))for(var a=t,i=n[2],u=n[3];;){var o=u;if(!o)return[a,i];var c=o[1];f(r,c)?(u=o[3],i=o[2],a=c):u=o[0]}e=n[0]}},map:w,mapi:y}}function Cn(r,e){var n=e.length;if(0===n)return[];for(var t=function(r,e){for(var n=new Array(r),t=0;t<r;++t)n[t]=e;return n}(n,f(r,e[0])),a=1;a<n;++a)t[a]=f(r,e[a]);return t}function Mn(r){for(var e=r.length-1|0,n=0;;){var t=n,a=e;if(a<0)return t;n=[r[a],t],e=a-1|0}}function Ln(r,e,n){for(var t=n,a=e.length-1|0;a>=0;--a)t=l(r,e[a],t);return t}dr("Array.Bottom");function In(r,e){if(e in r)return pr(r[e])}var Pn=function(r){var e=typeof r;return"string"===e?b(0,[r]):"number"===e?b(1,[r]):"boolean"===e?!0===r?1:0:null===r?2:Array.isArray(r)?b(3,[r]):b(2,[r])};function Dn(r,e){return e.tag?e:r}function $n(r,e){return e.tag?pr(e[0]):function(r){if(r.tag)return pr(r[0])}(r)}function Bn(r){return r?r[4]:0}function Un(r,e,n,t){var a=Bn(r),i=Bn(t);return[r,e,n,t,a>=i?a+1|0:i+1|0]}function Vn(r,e){return[0,r,e,0,1]}function Jn(r,e,t,a){var i=r?r[4]:0,u=a?a[4]:0;if(i>(u+2|0)){if(r){var o=r[3],c=r[2],s=r[1],f=r[0];if(Bn(f)>=Bn(o))return Un(f,s,c,Un(o,e,t,a));if(o)return Un(Un(f,s,c,o[0]),o[1],o[2],Un(o[3],e,t,a));throw[n,"Map.bal"]}throw[n,"Map.bal"]}if(u<=(i+2|0))return[r,e,t,a,i>=u?i+1|0:u+1|0];if(a){var l=a[3],v=a[2],d=a[1],h=a[0];if(Bn(l)>=Bn(h))return Un(Un(r,e,t,h),d,v,l);if(h)return Un(Un(r,e,t,h[0]),h[1],h[2],Un(h[3],d,v,l));throw[n,"Map.bal"]}throw[n,"Map.bal"]}function Qn(r,e,n){if(!n)return[0,r,e,0,1];var t=n[3],a=n[2],i=n[1],u=n[0],o=y(r,i);if(0===o)return a===e?n:[u,r,e,t,n[4]];if(o<0){var c=Qn(r,e,u);return u===c?n:Jn(c,i,a,t)}var s=Qn(r,e,t);return t===s?n:Jn(u,i,a,s)}function Wn(r){for(;;){var e=r;if(!e)throw a;var n=e[0];if(!n)return[e[1],e[2]];r=n}}function Zn(r){for(;;){var e=r;if(!e)return;var n=e[0];if(!n)return[e[1],e[2]];r=n}}function jn(r){if(r){var e=r[0];return e?Jn(jn(e),r[1],r[2],r[3]):r[3]}throw[n,"Map.remove_min_elt"]}function zn(r,e){if(!r)return e;if(!e)return r;var n=Wn(e);return Jn(r,n[0],n[1],jn(e))}function Hn(r,e,n,t){if(!r)return function r(e,n,t){return t?Jn(r(e,n,t[0]),t[1],t[2],t[3]):Vn(e,n)}(e,n,t);if(!t)return function r(e,n,t){return t?Jn(t[0],t[1],t[2],r(e,n,t[3])):Vn(e,n)}(e,n,r);var a=t[4],i=r[4];return i>(a+2|0)?Jn(r[0],r[1],r[2],Hn(r[3],e,n,t)):a>(i+2|0)?Jn(Hn(r,e,n,t[0]),t[1],t[2],t[3]):Un(r,e,n,t)}function Xn(r,e){if(!r)return e;if(!e)return r;var n=Wn(e);return Hn(r,n[0],n[1],jn(e))}function Kn(r,e,n,t){return void 0!==n?Hn(r,e,mr(n),t):Xn(r,t)}function Gn(r,e){if(!e)return[0,void 0,0];var n=e[3],t=e[2],a=e[1],i=e[0],u=y(r,a);if(0===u)return[i,pr(t),n];if(u<0){var o=Gn(r,i);return[o[0],o[1],Hn(o[2],a,t,n)]}var c=Gn(r,n);return[Hn(i,a,t,c[0]),c[1],c[2]]}function Yn(r,e){for(;;){var n=e,t=r;if(!t)return n;e=[t[1],t[2],t[3],n],r=t[0]}}var rt={empty:0,is_empty:function(r){return!r},mem:function(r,e){for(;;){var n=e;if(!n)return!1;var t=y(r,n[1]);if(0===t)return!0;e=t<0?n[0]:n[3]}},add:Qn,update:function r(e,n,t){if(t){var a=t[3],i=t[2],u=t[1],o=t[0],c=y(e,u);if(0===c){var s=f(n,pr(i));if(void 0===s)return zn(o,a);var l=mr(s);return i===l?t:[o,e,l,a,t[4]]}if(c<0){var v=r(e,n,o);return o===v?t:Jn(v,u,i,a)}var d=r(e,n,a);return a===d?t:Jn(o,u,i,d)}var h=f(n,void 0);return void 0!==h?[0,e,mr(h),0,1]:0},singleton:Vn,remove:function r(e,n){if(!n)return 0;var t=n[3],a=n[2],i=n[1],u=n[0],o=y(e,i);if(0===o)return zn(u,t);if(o<0){var c=r(e,u);return u===c?n:Jn(c,i,a,t)}var s=r(e,t);return t===s?n:Jn(u,i,a,s)},merge:function r(e,n,t){if(n){var a=n[1];if(n[4]>=Bn(t)){var i=Gn(a,t);return Kn(r(e,n[0],i[0]),a,v(e,a,pr(n[2]),i[1]),r(e,n[3],i[2]))}}else if(!t)return 0;if(t){var o=t[1],c=Gn(o,n);return Kn(r(e,c[0],t[0]),o,v(e,o,c[1],pr(t[2])),r(e,c[2],t[3]))}throw[u,["map.ml",393,10]]},union:function r(e,n,t){if(!n)return t;if(!t)return n;var a=t[2],i=t[1],u=n[2],o=n[1];if(n[4]>=t[4]){var c=Gn(o,t),s=c[1],f=r(e,n[0],c[0]),l=r(e,n[3],c[2]);return void 0!==s?Kn(f,o,v(e,o,u,mr(s)),l):Hn(f,o,u,l)}var d=Gn(i,n),h=d[1],p=r(e,d[0],t[0]),m=r(e,d[2],t[3]);return void 0!==h?Kn(p,i,v(e,i,mr(h),a),m):Hn(p,i,a,m)},compare:function(r,e,n){for(var t=Yn(e,0),a=Yn(n,0);;){var i=a,u=t;if(!u)return i?-1:0;if(!i)return 1;var o=y(u[0],i[0]);if(0!==o)return o;var c=l(r,u[1],i[1]);if(0!==c)return c;a=Yn(i[2],i[3]),t=Yn(u[2],u[3])}},equal:function(r,e,n){for(var t=Yn(e,0),a=Yn(n,0);;){var i=a,u=t;if(!u)return!i;if(!i)return!1;if(0!==y(u[0],i[0]))return!1;if(!l(r,u[1],i[1]))return!1;a=Yn(i[2],i[3]),t=Yn(u[2],u[3])}},iter:function r(e,n){for(;;){var t=n;if(!t)return;r(e,t[0]),l(e,t[1],t[2]),n=t[3]}},fold:function r(e,n,t){for(;;){var a=t,i=n;if(!i)return a;t=v(e,i[1],i[2],r(e,i[0],a)),n=i[3]}},for_all:function r(e,n){for(;;){var t=n;if(!t)return!0;if(!l(e,t[1],t[2]))return!1;if(!r(e,t[0]))return!1;n=t[3]}},exists:function r(e,n){for(;;){var t=n;if(!t)return!1;if(l(e,t[1],t[2]))return!0;if(r(e,t[0]))return!0;n=t[3]}},filter:function r(e,n){if(!n)return 0;var t=n[3],a=n[2],i=n[1],u=n[0],o=r(e,u),c=l(e,i,a),s=r(e,t);return c?u===o&&t===s?n:Hn(o,i,a,s):Xn(o,s)},partition:function r(e,n){if(!n)return[0,0];var t=n[2],a=n[1],i=r(e,n[0]),u=i[1],o=i[0],c=l(e,a,t),s=r(e,n[3]),f=s[1],v=s[0];return c?[Hn(o,a,t,v),Xn(u,f)]:[Xn(o,v),Hn(u,a,t,f)]},cardinal:function r(e){return e?(r(e[0])+1|0)+r(e[3])|0:0},bindings:function(r){return function r(e,n){for(;;){var t=n,a=e;if(!t)return a;n=t[0],e=[[t[1],t[2]],r(a,t[3])]}}(0,r)},min_binding:Wn,min_binding_opt:Zn,max_binding:function(r){for(;;){var e=r;if(!e)throw a;var n=e[3];if(!n)return[e[1],e[2]];r=n}},max_binding_opt:function(r){for(;;){var e=r;if(!e)return;var n=e[3];if(!n)return[e[1],e[2]];r=n}},choose:Wn,choose_opt:Zn,split:Gn,find:function(r,e){for(;;){var n=e;if(!n)throw a;var t=y(r,n[1]);if(0===t)return n[2];e=t<0?n[0]:n[3]}},find_opt:function(r,e){for(;;){var n=e;if(!n)return;var t=y(r,n[1]);if(0===t)return pr(n[2]);e=t<0?n[0]:n[3]}},find_first:function(r,e){for(;;){var n=e;if(!n)throw a;var t=n[1];if(f(r,t))for(var i=t,u=n[2],o=n[0];;){var c=o;if(!c)return[i,u];var s=c[1];f(r,s)?(o=c[0],u=c[2],i=s):o=c[3]}e=n[3]}},find_first_opt:function(r,e){for(;;){var n=e;if(!n)return;var t=n[1];if(f(r,t))for(var a=t,i=n[2],u=n[0];;){var o=u;if(!o)return[a,i];var c=o[1];f(r,c)?(u=o[0],i=o[2],a=c):u=o[3]}e=n[3]}},find_last:function(r,e){for(;;){var n=e;if(!n)throw a;var t=n[1];if(f(r,t))for(var i=t,u=n[2],o=n[3];;){var c=o;if(!c)return[i,u];var s=c[1];f(r,s)?(o=c[3],u=c[2],i=s):o=c[0]}e=n[0]}},find_last_opt:function(r,e){for(;;){var n=e;if(!n)return;var t=n[1];if(f(r,t))for(var a=t,i=n[2],u=n[3];;){var o=u;if(!o)return[a,i];var c=o[1];f(r,c)?(u=o[3],i=o[2],a=c):u=o[0]}e=n[0]}},map:function r(e,n){if(!n)return 0;var t=r(e,n[0]),a=f(e,n[2]),i=r(e,n[3]);return[t,n[1],a,i,n[4]]},mapi:function r(e,n){if(!n)return 0;var t=n[1];return[r(e,n[0]),t,l(e,t,n[2]),r(e,n[3]),n[4]]}},et=dr("Tea_json.Decoder.ParseFail");function nt(r){return[function(e){var n=Pn(e);return"number"==typeof n&&n>=2?b(0,[r]):b(1,["Non-null value"])}]}function tt(r,e){var n=e[0];return[function(e){var t=Pn(e);if("number"==typeof t)return b(1,["Non-fieldable value"]);if(2!==t.tag)return b(1,["Non-fieldable value"]);var a=In(t[0],r);if(void 0===a)return b(1,["Field Value is undefined: "+r]);var i=f(n,mr(a));return i.tag?b(1,["field `"+r+"` -> "+i[0]]):i}]}function at(r){return[function(e){var n=function(r,e){for(;;){var t=e;if(!t)return b(1,["No one-of's matched"]);var a=t[1];try{var i=f(t[0][0],r);return i.tag?n(r,a):i}catch(r){e=a;continue}}};return n(e,r)}]}function it(r,e){var n=e[0];return[function(e){var t=f(n,e);return t.tag?b(1,["map "+t[0]]):b(0,[f(r,t[0])])}]}function ut(r,e){var n=e[0];return[function(e){var t=f(n,e);if(t.tag)return t;var a=f(r,t[0]);return f(a[0],e)}]}function ot(r,e){try{return f(r[0],e)}catch(r){var n=br(r);return n[0]===et?b(1,[n[1]]):b(1,["Unknown JSON parsing error"])}}var ct={ObjectDict:rt,ParseFail:et,string:[function(r){var e=Pn(r);return"number"==typeof e||e.tag?b(1,["Non-string value"]):b(0,[e[0]])}],$$int:[function(r){var e=Pn(r);if("number"==typeof e)return b(1,["Non-int value"]);if(1!==e.tag)return b(1,["Non-int value"]);var n=e[0];return n>-2147483648&&n<2147483647?b(0,[0|n]):b(1,["number out of int range"])}],$$float:[function(r){var e=Pn(r);return"number"==typeof e||1!==e.tag?b(1,["Non-float-value"]):b(0,[e[0]])}],bool:[function(r){var e=Pn(r);if("number"!=typeof e)return b(1,["Non-boolean value"]);switch(e){case 0:return b(0,[!1]);case 1:return b(0,[!0]);case 2:return b(1,["Non-boolean value"])}}],$$null:nt,list:function(r){var e=r[0];return[function(r){var n=Pn(r);if("number"==typeof n)return b(1,["Non-list value"]);if(3!==n.tag)return b(1,["Non-list value"]);try{return b(0,[Or((function(r){var n=f(e,r);if(!n.tag)return n[0];throw[et,n[0]]}),Mn(n[0]))])}catch(r){var t=br(r);if(t[0]===et)return b(1,["list -> "+t[1]]);throw t}}]},array:function(r){var e=r[0];return[function(r){var n=Pn(r);if("number"==typeof n)return b(1,["Non-array value"]);if(3!==n.tag)return b(1,["Non-array value"]);try{return b(0,[Cn((function(r){var n=f(e,r);if(!n.tag)return n[0];throw[et,n[0]]}),n[0])])}catch(r){var t=br(r);if(t[0]===et)return b(1,["array -> "+t[1]]);throw t}}]},keyValuePairs:function(r){var e=r[0];return[function(r){var n=Pn(r);if("number"==typeof n)return b(1,["Non-keyValuePair value"]);if(2!==n.tag)return b(1,["Non-keyValuePair value"]);var t=n[0],a=Object.keys(t);try{return b(0,[Ln((function(r,n){var a=In(t,r);if(void 0!==a){var i=f(e,mr(a));if(!i.tag)return[[r,i[0]],n];throw[et,i[0]]}throw[et,"Key is undefined: "+r]}),a,0)])}catch(r){var i=br(r);if(i[0]===et)return b(1,["Invalid keyValuePair parsing: "+i[1]]);throw i}}]},dict:function(r){var e=r[0];return[function(r){var n=Pn(r);if("number"==typeof n)return b(1,["Non-dict value"]);if(2!==n.tag)return b(1,["Non-dict value"]);var t=n[0],a=Object.keys(t);try{return b(0,[Ln((function(r,n){var a=In(t,r);if(void 0!==a){var i=f(e,mr(a));if(!i.tag)return Qn(r,i[0],n);throw[et,i[0]]}throw[et,"Key is undefined: "+r]}),a,0)])}catch(r){var i=br(r);if(i[0]===et)return b(1,["Invalid dict parsing: "+i[1]]);throw i}}]},field:tt,at:function(r,e){return function r(e,n,t){return n?l(e,n[0],r(e,n[1],t)):t}(tt,r,e)},index:function(r,e){var n=e[0];return[function(e){var t=Pn(e);if("number"==typeof t)return b(1,["Non-array value"]);if(3!==t.tag)return b(1,["Non-array value"]);var a=t[0];return r<0||r>a.length?b(1,["Array index out of range: "+String(r)]):f(n,c(a,r))}]},maybe:function(r){var e=r[0];return[function(r){var n=f(e,r);return n.tag?b(0,[void 0]):b(0,[pr(n[0])])}]},oneOf:at,map:it,map2:function(r,n,t){var a=t[0],i=n[0];return[function(n){var t=f(i,n),u=f(a,n);if(!t.tag&&!u.tag)return b(0,[l(r,t[0],u[0])]);var o=$n(t,u);if(void 0!==o)return b(1,["map2 -> "+o]);throw[e,"Impossible case"]}]},map3:function(r,n,t,a){var i=a[0],u=t[0],o=n[0];return[function(n){var t=f(o,n),a=f(u,n),c=f(i,n);if(!t.tag&&!a.tag&&!c.tag)return b(0,[v(r,t[0],a[0],c[0])]);var s=Dn(c,Dn(a,t));if(s.tag)return b(1,["map3 -> "+s[0]]);throw[e,"Impossible case"]}]},map4:function(r,n,t,a,i){var u=i[0],o=a[0],c=t[0],s=n[0];return[function(n){var t=f(s,n),a=f(c,n),i=f(o,n),l=f(u,n);if(!(t.tag||a.tag||i.tag||l.tag))return b(0,[d(r,t[0],a[0],i[0],l[0])]);var v=Dn(l,Dn(i,Dn(a,t)));if(v.tag)return b(1,["map4 -> "+v[0]]);throw[e,"Impossible case"]}]},map5:function(r,n,t,a,i,u){var o=u[0],c=i[0],s=a[0],l=t[0],v=n[0];return[function(n){var t=f(v,n),a=f(l,n),i=f(s,n),u=f(c,n),d=f(o,n);if(!(t.tag||a.tag||i.tag||u.tag||d.tag))return b(0,[h(r,t[0],a[0],i[0],u[0],d[0])]);var p=Dn(d,Dn(u,Dn(i,Dn(a,t))));if(p.tag)return b(1,["map5 -> "+p[0]]);throw[e,"Impossible case"]}]},map6:function(r,n,t,a,i,u,o){var c=o[0],s=u[0],l=i[0],v=a[0],d=t[0],h=n[0];return[function(n){var t=f(h,n),a=f(d,n),i=f(v,n),u=f(l,n),o=f(s,n),m=f(c,n);if(!(t.tag||a.tag||i.tag||u.tag||o.tag||m.tag))return b(0,[p(r,t[0],a[0],i[0],u[0],o[0],m[0])]);var g=Dn(m,Dn(o,Dn(u,Dn(i,Dn(a,t)))));if(g.tag)return b(1,["map6 -> "+g[0]]);throw[e,"Impossible case"]}]},map7:function(r,n,t,a,i,u,o,c){var s=c[0],l=o[0],v=u[0],d=i[0],h=a[0],p=t[0],g=n[0];return[function(n){var t=f(g,n),a=f(p,n),i=f(h,n),u=f(d,n),o=f(v,n),c=f(l,n),w=f(s,n);if(!(t.tag||a.tag||i.tag||u.tag||o.tag||c.tag||w.tag))return b(0,[m(r,t[0],a[0],i[0],u[0],o[0],c[0],w[0])]);var y=Dn(w,Dn(c,Dn(o,Dn(u,Dn(i,Dn(a,t))))));if(y.tag)return b(1,["map7 -> "+y[0]]);throw[e,"Impossible case"]}]},map8:function(r,n,t,a,i,u,o,c,s){var l=s[0],v=c[0],d=o[0],h=u[0],p=i[0],m=a[0],w=t[0],y=n[0];return[function(n){var t=f(y,n),a=f(w,n),i=f(m,n),u=f(p,n),o=f(h,n),c=f(d,n),s=f(v,n),_=f(l,n);if(!(t.tag||a.tag||i.tag||u.tag||o.tag||c.tag||s.tag||_.tag))return b(0,[g(r,t[0],a[0],i[0],u[0],o[0],c[0],s[0],_[0])]);var k=Dn(_,Dn(s,Dn(c,Dn(o,Dn(u,Dn(i,Dn(a,t)))))));if(k.tag)return b(1,["map8 -> "+k[0]]);throw[e,"Impossible case"]}]},succeed:function(r){return[function(e){return b(0,[r])}]},fail:function(r){return[function(e){return b(1,[r])}]},value:[function(r){return b(0,[r])}],andThen:ut,lazy_:function(r){return ut(r,[function(r){return b(0,[void 0])}])},nullable:function(r){return at([nt(void 0),[it((function(r){return pr(r)}),r),0]])},decodeValue:ot,decodeEvent:function(r,e){try{return f(r[0],e)}catch(r){var n=br(r);return n[0]===et?b(1,[n[1]]):b(1,["Unknown JSON parsing error"])}},decodeString:function(r,e){try{return ot(r,JSON.parse(e))}catch(r){return b(1,["Invalid JSON string"])}}};function st(r){return b(1,[r])}function ft(r,e,n,t){return ae("","div",void 0!==r?r:"",void 0!==e?e:"",n,t)}function lt(r,e,n,t){return ae("","span",void 0!==r?r:"",void 0!==e?e:"",n,t)}function vt(r,e,n,t){return ae("","p",void 0!==r?r:"",void 0!==e?e:"",n,t)}function dt(r,e,n,t){return ae("","h3",void 0!==r?r:"",void 0!==e?e:"",n,t)}function ht(r,e,n,t){return ae("","button",void 0!==r?r:"",void 0!==e?e:"",n,t)}function pt(r,e,n,t){return ae("","textarea",void 0!==r?r:"",void 0!==e?e:"",n,t)}function mt(r,e,n,t){return ae("","label",void 0!==r?r:"",void 0!==e?e:"",n,t)}function gt(r,e,n,t){return ae("","ul",void 0!==r?r:"",void 0!==e?e:"",n,t)}function bt(r,e,n,t){return ae("","li",void 0!==r?r:"",void 0!==e?e:"",n,t)}function wt(r,e,n,t){return ae("","option",void 0!==r?r:"",void 0!==e?e:"",n,t)}function yt(r,e,n,t){return ae("","hr",void 0!==r?r:"",void 0!==e?e:"",n,t)}function _t(r){return b(0,["className",r])}function kt(r){return b(0,["className",zr(" ",Or((function(r){return r[0]}),Mr((function(r){return r[1]}))(r)))])}function St(r){return b(0,["placeholder",r])}function xt(r){return b(0,["value",r])}var Nt=ie;function At(r,e){return function(r,e){return ie("input",void 0!==r?r:"",(function(r){var n=r.target;if(void 0!==n){var t=n.value;return void 0!==t?f(e,t):void 0}}))}(void 0!==r?r:"",(function(r){return pr(f(e,r))}))}function Ot(r,e){return function(r,e){return ie("change",void 0!==r?r:"",(function(r){var n=r.target;if(void 0!==n){var t=n.value;return void 0!==t?f(e,t):void 0}}))}(void 0!==r?r:"",(function(r){return pr(f(e,r))}))}function qt(r){return function(r,e){return b(3,[r,b(1,[e]),{contents:void 0}])}("click",r)}var Rt=!1,Ft=!1,Et=(ct.at(["target",["value",0]],ct.string),ct.at(["target",["checked",0]],ct.bool),ct.field("keyCode",ct.$$int));var Tt={max:function(r){return b(1,["","max",r])},min:function(r){return b(1,["","min",r])},step:function(r){return b(1,["","step",r])},disabled:function(r){return r?b(1,["","disabled","true"]):0},selected:function(r){return r?b(1,["","selected","true"]):0},acceptCharset:function(r){return b(1,["","accept-charset",r])},rel:function(r){return b(1,["","rel",r])}},Ct=te,Mt=dr("CamlinternalLazy.Undefined");function Lt(r){throw Mt}function It(r){var e=0|r.tag;return 250===e?r[0]:246!==e?r:function(r){var e,n=r[0];r[0]=Lt;try{var t=f(n,void 0);return r[0]=t,e=250,r.tag=e,t}catch(e){throw r[0]=function(r){throw e},e}}(r)}function Pt(r,e){return Cr(Or(e,r))}var Dt={take:function(r,e){var n=function(r,e,n){for(;;){var t=e,a=r;if(0===n)return[a,t];if(!t)return[a,0];n=n-1|0,e=t[1],r=[t[0],a]}}(0,e,r);return[Nr(n[0]),n[1]]},apply:function(r,e){return f(e,r)},bind:Pt,concat_map:function(r,e){return Cr(Or(r,e))},$great$great$eq:Pt,next_or_this_item:function(r,e){for(var n=e;;){var t=n;if(!t)return r;var a=t[1];if(S(r,t[0]))return a?a[0]:r;n=a}},count:function(r,e){for(var n=0,t=e;;){var a=t,i=n;if(!a)return i;var u=a[1];f(r,a[0])?(t=u,n=i+1|0):t=u}},list_from_option:function(r){return void 0!==r?[mr(r),0]:0},first_inconsistent_opt:function(r,e){if(r)for(var n=f(e,r[0]),t=r[1];;){var a=t,i=n;if(!a)return;var u=f(e,a[0]);if(!S(u,i))return[i,u];t=a[1],n=u}}};function $t(r,e,n){return Nt(r,e,(function(r){return Rt&&r.stopPropagation(),Ft&&r.preventDefault(),function(r){return r.tag?void 0:pr(r[0])}(ct.decodeEvent(n,r))}))}var Bt={keydown:function(r,e,n){var t=ct.field("ctrlKey",ct.bool),a=ct.map2((function(r,e){return{ctrlKey:e,keyCode:r}}),Et,t);return $t("keydown",r,ct.andThen((function(r){return f(n,r)?ct.succeed(e):ct.fail("Incorrect keys")}),a))}},Ut=Bt;function Vt(r,e){return e.tag?e:b(0,[f(r,e[0])])}function Jt(r){return r.tag?r:r[0]}function Qt(r,e){return Jt(Vt(e,r))}var Wt={map:Vt,map_error:function(r,e){return e.tag?b(1,[f(r,e[0])]):e},flatten:Jt,flat_map:function(r,e){return Jt(Vt(r,e))},bind:Qt,$great$great$eq:Qt};function Zt(r){return[r,0]}function jt(r,e){if(!e)return 0;var n=e[1];return[f(r,e[0]),k((function(e){return jt(r,It(n))}))]}function zt(r,e){if(!r)return It(e);var n=r[1];return[r[0],k((function(r){return zt(It(e),n)}))]}function Ht(r){if(!r)return 0;var e=r[1];return zt(r[0],k((function(r){return Ht(It(e))})))}function Xt(r,e){return Ht(jt(e,r))}var Kt={$$return:Zt,unit:Zt,push:function(r,e){return[r,e]},map:jt,filter:function r(e,n){for(;;){var t=n;if(!t)return 0;var a=t[1],i=t[0];if(f(e,i))return[i,k(function(n){return function(t){return r(e,It(n))}}(a))];n=It(a)}},interleave_delayed:zt,append_delayed:function r(e,n){if(!e)return It(n);var t=e[1];return[e[0],k((function(e){return r(It(t),n)}))]},flatten:Ht,bind:Xt,$great$great$eq:Xt,from_list:function r(e){if(!e)return 0;var n=e[1];return[e[0],k((function(e){return r(n)}))]},from_option:function(r){return void 0!==r?[mr(r),0]:0}};function Gt(r,e){return[l(en([b(2,[0,b(4,[0,0,0,0])]),"%s%d"]),r[0],e)]}function Yt(r){return f(en([b(12,[63,b(2,[0,0])]),"?%s"]),r[0])}var ra={compare:function(r,e){return y(r[0],e[0])},make:function(r){return[r]},make_numbered:Gt,to_string:Yt};function ea(r,e){return y(r[0],e[0])}function na(r,e){return r[0]===e[0]}var ta={make:function(r){return[r]},compare:ea,equals:na,to_string:function(r){return r[0]}};function aa(r){if(!r.tag)return Yt(r[0]);var e=r[0],n=e.related_terms,t=e.relation_name[0];return n?l(en([b(2,[0,b(12,[40,b(2,[0,b(12,[41,0])])])]),"%s(%s)"]),t,zr(", ",Or(aa,n))):t}function ia(r){if(!r.tag)return 0;var e=r[0],n=e.related_terms;return[[e.relation_name,Sr(n)],Dt.concat_map(ia,n)]}var ua={make_relation:function(r,e){return b(1,[{relation_name:[r],related_terms:e}])},make_variable:function(r){return b(0,[[r]])},to_string:aa,relation_arities:ia};function oa(r){switch(0|r.tag){case 0:return aa(r[0]);case 1:return l(en([b(12,[60,b(2,[0,b(11,[" = ",b(2,[0,b(12,[62,0])])])])]),"<%s = %s>"]),aa(r[0]),aa(r[1]));case 2:return l(en([b(12,[60,b(2,[0,b(11,[" /= ",b(2,[0,b(12,[62,0])])])])]),"<%s /= %s>"]),aa(r[0]),aa(r[1]))}}function ca(r){switch(0|r.tag){case 0:return ia(r[0])}return Cr([ia(r[0]),[ia(r[1]),0]])}var sa={to_string:oa,relation_arities:ca};function fa(r){return zr(" and ",Or(oa,r))}var la={empty:0,to_string:fa},va=Tn(ra),da=va.empty;function ha(r,e){return v(va.add,r[0],r[1],e)}function pa(r,e){var n=l(va.find_opt,r,e);if(void 0!==n){if(n.tag)return n;var t=pa(n[0],e);return void 0!==t?t:n}}function ma(r,e){var n=function(r){var n=pa(r,e);return void 0!==n?a(n):b(0,[["?"]])},t=function(r,e){if(e.tag)return Rr(t,r,e[0].related_terms);var a=e[0];return ha([a,n(a)],r)},a=function(r){if(!r.tag)return n(r[0]);var e=r[0];return b(1,[{relation_name:e.relation_name,related_terms:Or(a,e.related_terms)}])};return f(va.bindings,Rr((function(r,e){switch(0|e.tag){case 0:return t(r,e[0])}return t(t(r,e[0]),e[1])}),da,r))}function ga(r,e,n){var t=function(r){for(;;){var a=r;if(a.tag)return Fr(t,a[0].related_terms);var i=a[0];if(S(i,e))return!0;var u=pa(i,n);if(void 0===u)return!1;r=u}};return t(r)}var ba={FrameMap:va,empty:da,extend:ha,lookup:pa,instantiate:function(r){var e=function(n){if(!n.tag){var t=pa(n[0],r);return void 0!==t?e(t):b(0,[["?"]])}var a=n[0];return b(1,[{relation_name:a.relation_name,related_terms:Or(e,a.related_terms)}])};return e},variable_bindings_in_query:ma,to_strings:function(r,e){var n=ma(r,e);return n?Or((function(r){return l(en([b(2,[0,b(11,[" := ",b(2,[0,0])])]),"%s := %s"]),Yt(r[0]),aa(r[1]))}),n):0},term_depends_on_variable:ga};function wa(r){var e,n=r.antecedents,t=aa(r.consequent);if(n){var a=fa(n);e=l(en([b(2,[0,b(11,[" when ",b(2,[0,0])])]),"%s when %s"]),t,a)}else e=t;return f(en([b(2,[0,b(12,[46,0])]),"%s."]),e)}function ya(r){return Cr([Ar(Or(ca,r.antecedents)),[ia(r.consequent),0]])}var _a={contents:0};function ka(r){if(!r.tag)return b(0,[Gt(r[0],_a.contents)]);var e=r[0],n=Or(ka,e.related_terms);return b(1,[{relation_name:e.relation_name,related_terms:n}])}function Sa(r){switch(0|r.tag){case 0:return b(0,[ka(r[0])]);case 1:return b(1,[ka(r[0]),ka(r[1])]);case 2:return b(2,[ka(r[0]),ka(r[1])])}}function xa(r){return _a.contents=_a.contents+1|0,{antecedents:Or(Sa,r.antecedents),consequent:ka(r.consequent)}}var Na={to_string:wa,relation_arities:ya,rename_rule_variables:xa},Aa=Tn({compare:Kr});function Oa(r){return r.rule}function qa(r,e){return r.id===e.id}var Ra={all_rules:0,indexed_by_consequent_relation:Aa.empty};function Fa(r,e){var n;if(e.tag){var t=l(Aa.find_opt,e[0].relation_name[0],r.indexed_by_consequent_relation);n=void 0!==t?t:0}else n=r.all_rules;return Kt.from_list(Nr(n))}function Ea(r){return Nr(r.all_rules)}var Ta={contents:1};function Ca(r,e){var n={id:(Ta.contents=Ta.contents+1|0,Ta.contents),rule:e},t=e.consequent;return t.tag?{all_rules:[n,r.all_rules],indexed_by_consequent_relation:v(Aa.update,t[0].relation_name[0],(function(r){return void 0!==r?[n,r]:[n,0]}),r.indexed_by_consequent_relation)}:{all_rules:[n,r.all_rules],indexed_by_consequent_relation:r.indexed_by_consequent_relation}}var Ma,La={VariableName:ra,RelationName:ta,Term:ua,ComplexTerm:sa,Query:la,Frame:ba,Rule:Na,RuleDatabase:{empty:Ra,rule_from_entry:Oa,identifier_of_rule_entry:function(r){return f(en([b(4,[0,0,0,0]),"%d"]),r.id)},update_rule_entry:function(r,e){return console.log(f(en([b(11,["Update rule entry: ",b(2,[0,0])]),"Update rule entry: %s"]),wa(e))),{id:r.id,rule:e}},is_same:qa,remove_rule:function(r,e){var n=e.id,t=Mr((function(r){return r.id!==n})),a=f(t,r.all_rules),i=e.rule.consequent;return i.tag?{all_rules:a,indexed_by_consequent_relation:v(Aa.update,i[0].relation_name[0],(function(r){return void 0!==r?f(t,r):0}),r.indexed_by_consequent_relation)}:{all_rules:a,indexed_by_consequent_relation:r.indexed_by_consequent_relation}},add_rule:Ca,update_rule:function(r,e){var n=function(r){return Or((function(r){return r.id===e.id?e:r}),r)},t=n(r.all_rules);console.log(f(en([b(11,["Updating rule in database: ",b(2,[0,0])]),"Updating rule in database: %s"]),wa(e.rule)));var a=e.rule.consequent;return a.tag?{all_rules:t,indexed_by_consequent_relation:v(Aa.update,a[0].relation_name[0],(function(r){return void 0!==r?n(r):[e,0]}),r.indexed_by_consequent_relation)}:{all_rules:t,indexed_by_consequent_relation:r.indexed_by_consequent_relation}},fetch_for_query:Fa,all_rules:Ea}},Ia={$$Map:Ma=Tn({compare:ea}),make:function(r,e){return Rr((function(e,n){return v(Ma.update,f(r,n),(function(r){return void 0!==r?[n,r]:[n,0]}),e)}),Ma.empty,e)},keys:function(r){return Or((function(r){return r[0]}),f(Ma.bindings,r))},find_opt:function(r,e){return l(Ma.find_opt,r,e)}};function Pa(r,e){return Rr((function(e,n){var t=f(r,n);if(void 0===t)return e;var a=Dt.first_inconsistent_opt(t,(function(r){return r[1]}));return void 0!==a?[v(en([b(11,["Relation '",b(2,[0,b(11,["' has inconsistent number of terms applied of ",b(4,[0,0,0,b(11,[" and ",b(4,[0,0,0,0])])])])])]),"Relation '%s' has inconsistent number of terms applied of %d and %d"]),n[0],a[0],a[1]),e]:e}),0,e)}function Da(r){return l(Ia.make,(function(r){return r[0]}),Dt.concat_map(ya,r))}function $a(r){return f(Ia.keys,l(Ia.make,(function(r){return r[0]}),ya(r)))}function Ba(r,e){var n=Da([e,Or(Oa,r)]);return Pa((function(r){return l(Ia.find_opt,r,n)}),$a(e))}var Ua={rule_database_snapshot:Ea,issues_in_existing_rule:function(r,e){var n=Da(Or(Oa,[e,Mr((function(r){return!qa(r,e)}))(r)]));return Pa((function(r){return l(Ia.find_opt,r,n)}),$a(Oa(e)))},issues_in_new_rule:Ba,issues_in_query:function(r,e){var n=Dt.concat_map(ca,e),t=l(Ia.make,(function(r){return r[0]}),Cr([n,[Dt.concat_map(ya,Or(Oa,r)),0]]));return Pa((function(r){return l(Ia.find_opt,r,t)}),f(Ia.keys,l(Ia.make,(function(r){return r[0]}),n)))}};function Va(r){var e=gn(95),n=function(r){return Rn(xn,e,r)},t=f(en([b(2,[0,b(11,[" requires ",b(2,[0,0])])]),"%s requires %s"]),r),a=function(r){return fn(t,n,r)};return function(r){return qn(a,(function(r){return vn((function(e){return zr("",Or((function(r){return Zr(1,r)}),[r,e]))}),function r(e){var n=function(n){return on(e,(function(n){var t=r(e);return function(r){return on(t,(function(r){var e=[n,r];return function(r){return sn(e,r)}}),r)}}),n)};return function(r){return dn(n,(function(r){return sn(0,r)}),r)}}(hn([xn,[kn,[gn(95),[gn(45),0]]]])))}),r)}}var Ja=Fn(gn(63),vn((function(r){return b(0,[[r]])}),Va("Variable")));function Qa(r){return ln("Variable starting with ?",Ja,r)}var Wa=Fn(An("= "),(function(r){return sn(!0,r)})),Za=Fn(An("/= "),(function(r){return sn(!1,r)}));function ja(r){return Rn(Wa,Za,r)}function za(r){return pn(r,Fn(Fn(Nn,An("and")),Nn))}function Ha(r){return Rn(Qa,Ka,r)}function Xa(r){return qn(Fn(gn(60),Ha),(function(r){return function(e){return qn(ja,(function(e){var n=En(Ha,gn(62));return function(t){return qn(n,(function(n){var t=b(e?1:2,[r,n]);return function(r){return sn(t,r)}}),t)}}),e)}}),r)}function Ka(r){return qn(En(Va("Relation"),Nn),(function(r){var e=[r],n=b(1,[{relation_name:e,related_terms:0}]),t=En(gn(40),Nn);return function(r){return cn(t,(function(r){return vn((function(r){return b(1,[{relation_name:e,related_terms:r}])}),En(En(Ga,Nn),gn(41)))}),n,r)}}),r)}function Ga(r){return pn(En(Ha,Nn),Fn(gn(44),Nn))(r)}function Ya(r){return Rn(vn((function(r){return b(0,[r])}),Ha),Xa,r)}function ri(r){return za(Ya)(r)}function ei(r){return En((function(r){return qn(Ha,(function(r){var e={antecedents:0,consequent:r},n=function(r){return sn(e,r)},t=vn((function(e){return{antecedents:e,consequent:r}}),Fn(Fn(Fn(Nn,An("when")),Nn),ri));return function(r){return Rn(t,n,r)}}),r)}),gn(46))(r)}var ni={rule_parser:ei,query_parser:function(r){return za(Ya)(r)},rule_database_result_from_rule_strings:function(r){return Rr((function(r,e){return Wt.flat_map((function(r){return Wt.flat_map((function(e){var n=e.result,t=Ba(Ea(r),n);return Sr(t)>0?b(1,[t]):b(0,[Ca(r,n)])}),Wt.map_error((function(r){return Or(an,r)}),On(ei,e)))}),r)}),b(0,[Ra]),r)}};function ti(r){var e=function(r,e){for(var n=0,t=0,a=e;;){var i=a,u=t,o=n;if(!i)return[xr(o,0),xr(u,0)];var c=i[1],s=i[0];f(r,s)?(a=c,n=[s,o]):(a=c,t=[s,u])}}((function(r){switch(0|r.tag){case 0:case 1:return!1;case 2:return!0}}),r);return Cr([e[1],[e[0],0]])}var ai={query:function(r,e){return function(r,e){var n=function(r,e){for(;;){var n=e,a=r;if(!a)return n;e=t(a[0],n),r=a[1]}},t=function(e,t){switch(0|e.tag){case 0:var i=e[0];return Kt.$great$great$eq(t,(function(e){return Kt.$great$great$eq(Fa(r,i),(function(r){var t=xa(Oa(r)),u=a(i,t.consequent,e);return void 0!==u?n(t.antecedents,Kt.$$return({frame:u.frame,rules_applied:[r,u.rules_applied]})):0}))}));case 1:var u=e[1],o=e[0];return Kt.$great$great$eq(t,(function(r){return Kt.from_option(a(o,u,r))}));case 2:var c=e[1],s=e[0];return Kt.$great$great$eq(t,(function(r){return void 0!==a(s,c,r)?0:Kt.$$return(r)}))}},a=function(r,e,n){if(S(r,e))return n;if(!r.tag)return i(r[0],e,n);var t=r[0];if(!e.tag)return i(e[0],r,n);var u=e[0];return na(t.relation_name,u.relation_name)?Rr((function(r,e){if(void 0!==r)return a(e[0],e[1],r)}),n,Er(t.related_terms,u.related_terms)):void 0},i=function(r,e,n){var t=pa(r,n.frame);if(void 0!==t)return a(t,e,n);if(e.tag)return ga(e,r,n.frame)?void 0:{frame:ha([r,e],n.frame),rules_applied:n.rules_applied};var i=pa(e[0],n.frame);return void 0!==i?a(b(0,[r]),i,n):{frame:ha([r,e],n.frame),rules_applied:n.rules_applied}},u=ti(e);return function(r){return n(u,r)}}(r,e)(Kt.$$return({frame:da,rules_applied:0}))}};function ii(r){var e=function r(e){if(!e)return b(0,[0]);var n=e[1],t=e[0];if(!n)return t.tag?t:b(0,[[t[0],0]]);if(t.tag)return t;var a=r(n);return a.tag?a:b(0,[[t[0],a[0]]])}(Or((function(r){return On(ni.query_parser,r)}),Or((function(r){return r[0]}),r.queries)));return e.tag?(console.error(e[0]),0):Er(Or(un,e[0]),Or((function(r){return r[1]}),r.queries))}var ui=[{name:"Simple Facts",rule_instructions:["FACTs are unconditionally true statements. As soon as a fact is entered into the database it is known to be true. \n        A Fact can relate other terms together or it can stand on its own. In this chapter we show just simple facts that stand on their own.",["A Fact is represented as an identifier written in any case. Spaces cannot be used inside Fact names but underscores can be.",["Click the <Query> button to explore the queries that can be written against this simple database.",0]]],rules:["OrangesAreSpherical.",["oranges_are_spherical.",["SoccerBallsAreSpherical.",["soccerBalls_ARE_spherical.",0]]]],queries:[["SoccerBallsAreSpherical",["This query just asks whether the fact is found in the database. Execute this query to reveal that this fact is found in the database."]],[["FootballsAreSpherical",["Try this query. Observe that no solution was found because the fact is not in the database."]],0]]},[{name:"Facts as Predicates",rule_instructions:["Facts can also express the truth of a _relationship_ between things. A Fact that expresses a relationship with a single term can be viewed as a declaration of \n            inclusion in a Set (a Predicate). For example, the facts from the previous chapter about spherical items can be more usefully represented as predicates.",0],rules:["Spherical(Oranges).",["Spherical(SoccerBalls).",["Spherical(BasketBalls).",["Spherical(Sun).",0]]]],queries:[["Spherical(Oranges)",["This query just asks if this specific fact is in the database. It is."]],[["Spherical(FootBalls)",["Observe that this query fails to find a solution."]],0]]},[{name:"Querying with Variables",rule_instructions:["The queries in the prior chapters were pretty lame because they could only ask if very _specific_ facts were present in the database.",["To introduce a little abstraction we need variables which act as kind of wildcard placeholders for any value. Variables are written with a ? prefix.",["When a query includes a variable, the solution to the query will display the variable binding which satisfies the query.",0]]],rules:["Spherical(Oranges).",["Spherical(SoccerBalls).",["Spherical(BasketBalls).",["Spherical(Sun).",0]]]],queries:[["Spherical(?sphericalThing)",["When you execute this query you will observe multiple things: 1) the solution now includes the value of the binding and \n            2) there are now multiple solutions which can be requested with Next Solution. Logic programming environments\n            require user to explicitly ask for the Next Solution because logic programming supports INFINITE solution spaces!!!"]],0]},[{name:"Relationships",rule_instructions:["Facts can express relationships between multiple things. This child demonstrates declaration of mother-child relationships.",0],rules:["MotherOf(Sally, Bob).",["MotherOf(Sally, Janice).",["MotherOf(Sally, Debrah).",["MotherOf(Janice, Malcom).",0]]]],queries:[["MotherOf(Sally, ?childOfSally)",["This query will find all children of Sally in the database."]],[["MotherOf(?motherOfBob, Bob)",["This query will find the mother (or mothers) of Bob. NOTE: We have now seen that variables can be put in any place. That is a powerful concept we will explore later."]],[["MotherOf(?mother, ?child)",["In fact, we can use variables for both locations to get all mother-child solutions in the database."]],0]]]},[{name:"Implication (Rules)",rule_instructions:["While Facts are uncondtionally true, a RULE specifies a _conclusion_ whose truth is dependent upon one or more conditions. For example, someone is a parent of someone else if \n        we can prove that they are the mother or father. Parenthood follows from motherhood and fatherhood.",0],rules:["ParentOf(?parent, ?child) when MotherOf(?parent, ?child).",["ParentOf(?parent, ?child) when FatherOf(?parent, ?child).",["MotherOf(Sally, Janice).",["MotherOf(Sally, Debrah).",["MotherOf(Janice, Malcom).",["FatherOf(Roberto, Janice).",0]]]]]],queries:[["ParentOf(Sally, Janice)",["Here we will simply ask the database if it can prove that Sally is the parent of Janice. NOTE: The database does not explicitly declare Sally is the parent of Janice. The logic system deduced the fact from the rules given."]],[["ParentOf(?parent, Janice)",["We can also use variables in the query to find all parents of Janice."]],[["ParentOf(Sally, ?child)",["Or find all the children of Sally."]],0]]]},[{name:"Unification: Part 1",rule_instructions:["In this next example consider the definition of Siblings. Note that the variable ?parent is found in two sub-queries of ParentOf. \n        This means that the Siblings rule can only be proven true when a ParentOf can be proven for the first sibling and for the second and\n        that the parent must be able to be unified (in this case the same). This is an example of unification and it is one of most interesting powers \n        in logic programming because it can accomplish a lot work in a very subtle and succinct way.",0],rules:["ParentOf(?parent, ?child) when MotherOf(?parent, ?child).",["Siblings(?firstSibling, ?secondSibling) when ParentOf(?parent, ?firstSibling) and ParentOf(?parent, ?secondSibling).",["MotherOf(Sally, Janice).",["MotherOf(Sally, Debrah).",["MotherOf(Sally, Malcom).",0]]]]],queries:[["Siblings(Janice, Debrah)",["A yes/no style query that just asks the system to deduce whether Janice and Debrah are siblings."]],[["Siblings(?sibling, Debrah)",["Here we ask about the siblings of Debrah. OBSERVE: Debrah is her own sibling! Weird. We will explain and fix this behavior in the next Chapter."]],0]]},[{name:"Unification: Part 2",rule_instructions:["In the last chapter we saw that our definition of sibling was such that it would report that a person was their own sibling. This was because\n        we defined sibling as ANY other term in the database that has the same parent. We did not explicitly ask not to be informed when both terms were the same.",0],rules:["ParentOf(?parent, ?child) when MotherOf(?parent, ?child).",["Siblings(?firstSibling, ?secondSibling) when ParentOf(?parent, ?firstSibling) and ParentOf(?parent, ?secondSibling) and <?firstSibling /= ?secondSibling>.",["MotherOf(Sally, Janice).",["MotherOf(Sally, Debrah).",["MotherOf(Sally, Malcom).",0]]]]],queries:[["Siblings(?sibling, Debrah)",["Now we should only get other terms that have the same parent but which are not Debrah herself."]],0]},[{name:"Recursion (Genealogy)",rule_instructions:["A rule can depend upon itself recursively! This chapter demonstrates a recursive declaration for proving that something is an ancestor of another.",["As is always the case with recursion, BEWARE to always have a terminating base case. Observe that the recursive specification of AncestorOf has a ParentOf \n        sub-query which is not a reference to AncestorOf. When the ParentOf sub-query in the body of the AncestorOf rule fails the recursion terminates.",0]],rules:["ParentOf(?Mother, ?Child) when MotherOf(?Mother, ?Child).",["AncestorOf(?Ancestor, ?Descendant) when ParentOf(?Ancestor, ?Descendant).",["AncestorOf(?Ancestor, ?Descendant) when ParentOf(?ParentOfDescendant, ?Descendant) and AncestorOf(?Ancestor, ?ParentOfDescendant).",["MotherOf(Erica, Sally).",["MotherOf(Sally, Jane).",["MotherOf(Jane, Maria).",["MotherOf(Maria, Roberta).",0]]]]]]],queries:[["AncestorOf(Erica, Sally)",["Here Erica is just Sally's mother so we don't even need to use recursion"]],[["AncestorOf(Erica, Jane)",["Note that there is ONE application of the recursive rule."]],[["AncestorOf(Erica, Roberta)",["Observe that there are THREE applications of the recursive rule."]],[["AncestorOf(?ancestor, Roberta)",["Demonstrating a variable to ask for ALL ancestors of Roberta."]],[["AncestorOf(Erica, ?descendant)",["Demonstrating a variable to ask for ALL descendants of Erica."]],0]]]]]},[{name:"Linked List: Append",rule_instructions:["So far we have covered use cases that probably seem relatively natural to a database system. We are now going to\n          explore patterns that approximate general purpose programming but using an entirely declarative information based approach.",["We begin with appending two linked lists together. In this example, the N relation defines a linked-list node (abbreviated to N for reasons that become quickly apparent.)",["A node in a linked list has a value and a pointer to the next item in the list. The last node in the list typically has a null pointer in most imperative programming languages.",["Here we represent the terminating value as Empty. So an empty list is just Empty.",["A list of a single item would be N(FirstItem, Empty).",["A list of two items N(FirstItem, N(SecondItem, Empty))",["...and so on. Obviously this is a tedious way to write lists but it is still pretty amazing to consider it is possible to define list behavior with two rules.",["The AMAZING property is that this append operation can be queried from any direction just like every other query we have seen. In other languages the \n          append operation takes two INPUTs and yields an OUTPUT. In a logic programming language there are NO inputs or outputs in the specification of rules and facts. The author\n          of the query determines what is given and what is requested.",0]]]]]]]],rules:["Append(Empty, ?List, ?List).",["Append(N(?Head, ?Tail), ?RightList, N(?Head, ?Result)) when Append(?Tail, ?RightList, ?Result).",0]],queries:[["Append(N(a, N(b, N(c, Empty))), N(one, N(two, N(three, Empty))), ?Result)",["Appends a list of [a, b, c] and a list of [one, two, three]."]],[["Append(N(a, N(b, Empty)), ?right, N(a, N(b, N(c, N(d, Empty)))))",["AMAZING!!! We are asking what list would we have to add to [a, b] to get [a, b, c, d]."]],[["Append(?left, ?right, N(a, N(b, N(c, N(d, Empty)))))",["This is even crazier. We are now asking for all combinations of input that might produce the output."]],0]]]},[{name:"Linked List: Remove",rule_instructions:["This chapter illustrates how one might implement removal of all instances of an element from a list.",["The technique involves complex pattern matching, unification, recursion, and not-unifies.",["It is entirely OK if this seems hard. This example is included only to demonstrate the extent to which the declarative paradigm \n          can be stretched to implement ",0]]],rules:["Remove(?Item, Empty, Empty).",["Remove(?Item, N(?Item, ?Tail), ?RecursiveTail) when Remove(?Item, ?Tail, ?RecursiveTail).",["Remove(?Item, N(?Head, ?Tail), N(?Head, ?RecursiveTail)) when <?Item /= ?Head> and Remove(?Item, ?Tail, ?RecursiveTail).",0]]],queries:[["Remove(a, Empty, ?result)",[""]],[["Remove(a, N(a, Empty), ?result)",[""]],[["Remove(a, N(b, Empty), ?result)",[""]],[["Remove(b, N(a, N(b, N(a, Empty))), ?result)",[""]],[["Remove(cherry, N(apple, N(banana, N(cherry, N(date, N(elderberry, Empty))))), ?result)",[""]],[["Remove(x, N(x, N(o, N(x, N(o, N(x, Empty))))), ?result)",[""]],[["Remove(?whatWouldIRemove, N(x, N(o, N(x, N(o, N(x, Empty))))), N(o, N(o, Empty)))",[""]],0]]]]]]]},[{name:"Numbers: Summation",rule_instructions:["Peano numbers",0],rules:["SumOf(Zero, ?Number, ?Number).",["SumOf(Succ(?InnerLeft), ?Right, Succ(?SumOfRightAndInnerLeft)) when SumOf(?InnerLeft, ?Right, ?SumOfRightAndInnerLeft).",0]],queries:[["SumOf(Zero, Zero, ?sum)",[""]],[["SumOf(Zero, Succ(Succ(Zero)), ?sum)",[""]],[["SumOf(Succ(Zero), Succ(Succ(Zero)), ?sum)",[""]],[["SumOf(Succ(Succ(Zero)), Succ(Succ(Zero)), ?sum)",[""]],[["SumOf(Succ(Succ(Succ(Zero))), Succ(Succ(Zero)), ?sum)",[""]],0]]]]]},[{name:"Numbers: Pretty Summation",rule_instructions:["Using aliasing to clean up summation.",0],rules:["SumOf(Zero, ?Number, ?Number).",["SumOf(Succ(?InnerLeft), ?Right, Succ(?SumOfRightAndInnerLeft)) when SumOf(?InnerLeft, ?Right, ?SumOfRightAndInnerLeft).",["PrettySum(?leftAlias, ?rightAlias, ?prettySum) when Alias(?leftAlias, ?leftStructure) and Alias(?rightAlias, ?rightStructure) and SumOf(?leftStructure, ?rightStructure, ?sumStructure) and Alias(?prettySum, ?sumStructure).",["Alias(Zero, Zero).",["Alias(One, Succ(Zero)).",["Alias(Two, Succ(Succ(Zero))).",["Alias(Three, Succ(?twoStructure)) when Alias(Two, ?twoStructure).",["Alias(Four, Succ(?threeStructure)) when Alias(Three, ?threeStructure).",["Alias(Five, Succ(?fourStructure)) when Alias(Four, ?fourStructure).",["Alias(Six, Succ(?fiveStructure)) when Alias(Five, ?fiveStructure).",["Alias(Seven, Succ(?sixStructure)) when Alias(Six, ?sixStructure).",["Alias(Eight, Succ(?sevenStructure)) when Alias(Seven, ?sevenStructure).",["Alias(Nine, Succ(?eightStructure)) when Alias(Eight, ?eightStructure).",0]]]]]]]]]]]]],queries:[["PrettySum(Two, Three, ?prettySum)",[""]],[["PrettySum(Three, Five, ?prettySum)",[""]],[["PrettySum(One, Seven, ?prettySum)",[""]],[["PrettySum(Four, Five, ?prettySum)",[""]],0]]]]},0]]]]]]]]]]]];var oi=["LitLog, short for Literate Logic programming, is a subset of Prolog with a simpler syntax and an on-line editor. \n    The goal of LitLog is to offer a path to quickly learning the basics of declarative logic programming in three lunch breaks or less.",["When Logic Programming fits the problem space, it beats other programming paradigms by orders of magnitude so it is a helpful tool to\n    have in your mental toolbox (even if an applicable problem may only arise once in a decade). It is also just neat and that alone is worth a few lunch periods.",["The act of declarative logic programming is building a knowledge database that can be queried. It is the query powers that are surprising and interesting.",["Rules & Facts are the two forms of knowledge representation. Get started by choosing the first chapter.",0]]]];function ci(r,e){return{text:f(r,e),compilation_result:b(0,[e])}}function si(r,e,n){var t,a=On(e,r);if(a.tag){var i=Lr(tn,a[0]);if(i){var u=i[0],o=Mr((function(r){return tn(r,u)<=0}))(i[1]);t=b(1,[Or(an,[u,o])])}else t=b(1,[0])}else{var c=a[0].result,s=f(n,c);t=s?b(1,[s]):b(0,[c])}return{text:r,compilation_result:t}}function fi(r){var e=r.solution_stream;return e?{initiating_query:r.initiating_query,solution_stream:It(e[1]),displayed_solutions:[e[0],r.displayed_solutions]}:r}var li={CompiledTextEditing:{empty:function(r){return{text:"",compilation_result:b(1,[0])}},edit:ci,make:si},ExecutingQueryInfo:{next_solution:fi},init:function(r){return{rule_database:La.RuleDatabase.empty,available_chapters:ui,chapter_opt:void 0,interaction_mode:0}}};var vi={viewRules:0,initiateAddRule:1,initiateEditRule:function(r){return b(0,[r])},initiateEditQuery:function(r){return b(1,[r])},chooseChapter:function(r){return b(2,[r])},nextChapter:2,updateText:function(r){return b(3,[r])},addRule:function(r){return b(4,[r])},editRuleEntry:function(r){return b(5,[r])},deleteRule:function(r){return b(6,[r])},executeQuery:function(r){return b(7,[r])},nextFrame:3};function di(r){"remove"in Element.prototype||(Element.prototype.remove=function(){this.parentNode&&this.parentNode.removeChild(this)}),function(){for(var r=0,e=["ms","moz","webkit","o"],n=0;n<e.length&&!window.requestAnimationFrame;++n)window.requestAnimationFrame=window[e[n]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[e[n]+"CancelAnimationFrame"]||window[e[n]+"CancelRequestAnimationFrame"];window.requestAnimationFrame||(window.requestAnimationFrame=function(e,n){var t=(new Date).getTime(),a=Math.max(0,16-(t-r)),i=window.setTimeout((function(){e(t+a)}),a);return r=t+a,i}),window.cancelAnimationFrame||(window.cancelAnimationFrame=function(r){clearTimeout(r)})}()}function hi(r,e,n,t,a,i){if(void 0===i)return function(i){var u={contents:0},o=function(r){var e=f(n,r);u.contents=we(i,i,u.contents,e)};return{startup:function(r){be(i,a),o(t)},render_string:function(r){return ue(f(e,r))},handleMsg:function(e,n){var t=l(r,e,n),a=t[0];return be(i,t[1]),o(a),a},shutdown:function(r){be(i,r),u.contents=we(i,i,u.contents,0)}}};var u=mr(i);return function(i){var o={contents:0},c={contents:t},s={contents:void 0},v=function(r){if(void 0!==s.contents){var n=[f(e,c.contents),0],t=function(r,e,n,t){return ge(r,e,e.childNodes,0,n,t),t}(i,u,o.contents,n);o.contents=t,s.contents=void 0}},d=function(r){for(;u.childNodes.length>0;){var e=u.firstChild;null!==e&&u.removeChild(e)}},h={contents:0},p=function(r){var e=f(n,r);h.contents=we(i,i,h.contents,e)};return{startup:function(r){d(),be(i,a),p(c.contents),s.contents=-1,v()},render_string:function(r){return ue(f(e,r))},handleMsg:function(e,n){var t=l(r,e,n),a=t[0];return c.contents=a,be(i,t[1]),void 0!==s.contents||(s.contents=-1,v()),p(a),a},shutdown:function(r){s.contents=void 0,be(i,r),h.contents=we(i,i,h.contents,0),o.contents=0,d()}}}}function pi(r,n,t){di();var a=f(r.init,t),i=a[0],u=null==n?void 0:pr(n);return function(r,n,t){var a={contents:r},i={contents:{enqueue:function(r){console.log("INVALID enqueue CALL!")}}},u=f(n,i),o={contents:void 0},c=function(r){var n=o.contents;if(void 0===n){o.contents=0;var t=l(u.handleMsg,a.contents,r);a.contents=t;var i=o.contents;if(void 0!==i)return i?(o.contents=void 0,qr(c,Nr(i))):void(o.contents=void 0);throw[e,"INVALID message queue state, should never be None during message processing!"]}o.contents=[r,n]},s={enqueue:c};return i.contents=s,f(u.startup,void 0),{pushMsg:c,shutdown:function(r){i.contents={enqueue:function(r){console.log("INVALID message enqueued when shut down")}};var e=f(t,a.contents);f(u.shutdown,e)},getHtmlString:function(r){return f(u.render_string,a.contents)}}}(i,hi(r.update,r.view,r.subscriptions,i,a[1],u),r.shutdown)}function mi(r){return{href:r.href,protocol:r.protocol,host:r.host,hostname:r.hostname,port:r.port,pathname:r.pathname,search:r.search,hash:r.hash,username:r.username,password:r.password,origin:r.origin}}var gi={contents:void 0};function bi(r){return function(r,e){return b(1,[r,function(r){return f(e,r.contents)},{contents:void 0}])}("navigation",(function(e){gi.contents=function(n){return f(e.enqueue,f(r,n))};var n,t,a,i=function(r){var e;void 0!==(e=gi.contents)&&f(e,mi(document.location))};return n="popstate",t=i,a=!1,window.addEventListener(n,t,a),function(r){return function(r,e,n){return window.removeEventListener(r,e,n)}("popstate",i,!1)}}))}function wi(r,e,n){var t=void 0===r||r;return ht(void 0,void 0,[qt(n),[Tt.disabled(!t),0]],[st(e),0])}function yi(r){return ft(void 0,void 0,[_t("button-bar"),0],r)}var _i="\n\n        ."+String("button-bar")+" {\n            padding-top: 5px; \n            padding-bottom: 5px;\n        }\n\n        button {\n            background-color: white;\n            color: #555;\n            box-shadow: 0 0 0 1px "+String("#48a9dc")+";\n            border: none;\n            border-radius: 4px;\n            padding: 6px;\n            margin-right: 8px;\n            font-size: 14px;\n        }\n\n        button."+String("delete")+" {\n            background-color: #f00;\n            box-shadow: 0 0 2px 2px rgba(127,0,0,.5);\n            font-weight: bold;\n            color: #fff;\n            padding-left: 8px;\n            padding-right: 8px;\n            border-radius: 4px;\n            display: inline-block;\n        }\n\n        button:active {\n            background-color: "+String("#48a9dc")+";\n            color: white;\n        }\n\n        button:disabled {\n            background-color: #ddd;\n            color: #90adbd;\n        }\n\n        a, a:active, a:visited {\n            display: inline-block;\n            color: "+String("#48a9dc")+"\n        }\n\n        a, a:active, a:visited {\n            display: inline-block;\n            color: "+String("#48a9dc")+"\n        }\n    ";function ki(r,e){return ft(void 0,void 0,[_t("panel"),0],[ft(void 0,void 0,[_t("panel-header"),0],[st(r),0]),[ft(void 0,void 0,[_t("panel-body"),0],e),0]])}var Si="\n        div."+String("panels")+" {\n            height: 98%;\n        }\n\n        div."+String("panel-header")+" {\n            background-color: #248;\n            color: white;\n            font-weight: bold;\n            padding: 4px;\n        }   \n\n        div."+String("panel")+" {\n            overflow-y: auto;\n            background-color: white;\n            margin-top: 5px;\n        }     \n        \n\n        @media screen and (max-width: 1023px) {\n            div."+String("panel")+" {\n                float: left;\n                width: 99%;\n                margin-top: 10px;\n                border: solid 1px #aaa;\n            }\n        }\n\n        @media screen and (min-width: 1024px) {\n            div."+String("panel")+" {\n                float: left;\n                margin-left: 5px;\n                margin-right: 5px;\n                width: 48%;\n                height: 98%;\n                border: solid 1px #aaa;\n            }\n        }\n\n        div."+String("panel-body")+" {\n            padding: 6px;\n        }\n    ";function xi(r,e){return ft(void 0,void 0,[_t("section"),0],[dt(void 0,void 0,0,[st(r),0]),[yt(void 0,void 0,0,0),[ft(void 0,void 0,0,e),0]]])}var Ni="\n        ."+String("variable")+" {\n            color: #ff0; \n            display: inline-block;\n        }\n\n        ."+String("relation")+" {\n            display: inline-block;\n        }\n\n        ."+String("fact")+" {\n            color: #0f0;\n            display: inline-block;\n        }\n        \n        ."+String("query-comment")+" {\n            color: #ccc;\n            padding: 4px;\n            margin-bottom: 8px;\n        }\n\n        ."+String("relation")+" {\n            color: #6af;\n            font-weight: bold;\n            display: inline-block;\n        }\n\n        ."+String("punctuation")+" {\n            color: white;\n            font-weight: bold;\n        }\n\n        ."+String("rule-display")+" {\n            background-color: black;\n            font-family: Consolas, monospace;\n            padding: 4px;\n        }\n\n        ."+String("rule-item")+" {\n            color: black;\n            background-color: black;\n\n            display: flex;\n            align-items: center;            \n\n            border-radius: 6px;\n            padding: 6px;\n            box-shadow: 0 0.5em 1em -0.125em rgba(10,10,10,.1), 0 0 0 1px rgba(10,10,10,.02);\n\n            margin-bottom: 12px;\n            font-size: 14px;\n        }\n\n        ."+String("rule-item")+"."+String("rule-used")+" {\n            box-shadow: 0 0 2px 4px #f44;\n        }\n\n        ."+String("rule-application-count")+" {\n            display: inline-block;\n            visibility: hidden;\n            padding-left: 6px;\n            padding-right: 6px;\n            padding-top: 2px;\n            padding-bottom: 2px;\n            border-radius: 9px;\n            border: solid 1px #884;\n            color: black;\n            background-color: #ff8;\n            font-weight: bold;\n            font-size: 16px;\n        }\n\n        ."+String("rule-application-count")+"."+String("rule-application-count-visible")+" {\n            visibility: visible;\n        }\n\n        ul {\n            list-style: none;\n            margin-block-start: 0;\n            margin-block-end: 0;\n        }\n    ";function Ai(r){return lt(void 0,void 0,[_t("punctuation"),0],[st(r),0])}function Oi(r){if(!r.tag)return lt(void 0,void 0,[_t("variable"),0],[st(f(en([b(12,[63,b(2,[0,0])]),"?%s"]),r[0][0])),0]);var e=r[0],n=e.related_terms,t=e.relation_name[0];return n?lt(void 0,void 0,[_t("relation"),0],[lt(void 0,void 0,[_t("relation"),0],[st(t),0]),[Ai("("),[Oi(n[0]),[lt(void 0,void 0,0,Or((function(r){return lt(void 0,void 0,0,[Ai(", "),[Oi(r),0]])}),n[1])),[Ai(")"),0]]]]]):lt(void 0,void 0,[_t("fact"),0],[st(t),0])}function qi(r){switch(0|r.tag){case 0:return Oi(r[0]);case 1:return lt(void 0,void 0,0,[Oi(r[0]),[Ai("="),[Oi(r[1]),0]]]);case 2:return lt(void 0,void 0,0,[Oi(r[0]),[Ai("/="),[Oi(r[1]),0]]])}}function Ri(r){var e,n=r.antecedents,t=function(r,e){return bt(void 0,void 0,0,[Ai(r),[qi(e),0]])};if(n){var a=n[0],i=Nr(n[1]);e=gt(void 0,void 0,0,i?Cr([[t("when ",a),0],[Or((function(r){return t("and ",r)}),Nr(i[1])),[[bt(void 0,void 0,0,[Ai("and "),[qi(i[0]),[Ai("."),0]]]),0],0]]]):[bt(void 0,void 0,0,[Ai(" when "),[qi(a),[Ai("."),0]]]),0])}else e=Ai(".");return ft(void 0,void 0,[_t("rule-display"),0],[Oi(r.consequent),[e,0]])}function Fi(r,e){return ft(void 0,void 0,[_t("rule-display"),0],[0!==e.length?ft(void 0,void 0,[_t("query-comment"),0],[st(e),0]):Ct,[gt(void 0,void 0,0,Or((function(r){return bt(void 0,void 0,0,[qi(r),0])}),r)),0]])}function Ei(r){var e,n,t,a,i,u=f(La.RuleDatabase.rule_from_entry,r);return ft(void 0,void 0,[kt([["rule-item",!0],[["rule-used",!1],0]]),0],[(i=vi.deleteRule(r),ht(void 0,void 0,[qt(i),[_t("delete"),0]],[st("X"),0])),[(e=void 0,n=void 0,t=[qt(vi.initiateEditRule(r)),0],a=[Ri(u),0],ae("","a",void 0!==e?e:"",void 0!==n?n:"",t,a)),0]])}var Ti="\n        input {\n            margin-left: 6px;\n        }          \n        \n        ."+String("language-editing")+" {\n            width: 96%;\n            font-family: Consolas, monospace;\n            background-color: black;\n            color: white;\n        }\n\n        ."+String("errors-container")+" ul {\n            padding-left: 20px;\n            list-style: square;\n        }\n\n        ."+String("editing-container")+" {\n            margin-bottom: 16px;\n        }\n\n        ."+String("errors-container")+" li {\n            color: #800;\n            font-size: 14px;\n        }\n    ";function Ci(r,e,n,t,a,i){var u,o=r.compilation_result;if(o.tag)return ft(void 0,void 0,[_t("editing-container"),0],[mt(void 0,void 0,0,[st(e),0]),[pt(void 0,void 0,[At(void 0,vi.updateText),[_t("language-editing"),[St(i),[xt(r.text),[0,0]]]]],0),[Ct,[yi([(u=o[0],u?ft(void 0,void 0,[_t("errors-container"),0],[gt(void 0,void 0,0,Or((function(r){return bt(void 0,void 0,0,[st(r),0])}),u)),0]):Ct),[wi(void 0,"Cancel",a),0]]),0]]]]);var c=f(t,o[0]);return ft(void 0,void 0,[_t("editing-container"),0],[mt(void 0,void 0,0,[st(e),0]),[pt(void 0,void 0,[At(void 0,vi.updateText),[_t("language-editing"),[St(i),[xt(r.text),[v(Ut.keydown,r.text,c,(function(r){return 13===r.keyCode&&r.ctrlKey})),0]]]]],0),[ft(void 0,void 0,0,[st(f(en([b(11,["(ctrl+enter to ",b(2,[0,b(12,[41,0])])]),"(ctrl+enter to %s)"]),n)),0]),[yi([wi(void 0,n,c),[wi(void 0,"Cancel",a),0]]),0]]]])}function Mi(r){var e,n,t,a,i,u=f(La.RuleDatabase.all_rules,r.rule_database),o=function(r){return ft(void 0,void 0,0,Or((function(e){return function(r,e){var n=Dt.count((function(r){return l(La.RuleDatabase.is_same,r,e)}),r);return ft(void 0,void 0,[kt([["rule-item",!0],[["rule-used",n>0],0]]),0],[lt(void 0,void 0,[kt([["rule-application-count",!0],[["rule-application-count-visible",n>0],0]]),0],[st(f(en([b(4,[0,0,0,0]),"%d"]),n)),0]),[Ri(f(La.RuleDatabase.rule_from_entry,e)),0]])}(r,e)}),u))},c=r.interaction_mode;if("number"==typeof c)e=ft(void 0,"viewing_rules",0,[yi([mt(void 0,void 0,0,[st("Chapter:"),0]),[(n=void 0,t=void 0,a=[Ot(void 0,(function(e){return vi.chooseChapter(function(r,e){for(;;){var n=e;if(!n)return;var t=n[0];if(f(r,t))return pr(t);e=n[1]}}((function(r){return r.name===e}),r.available_chapters))})),0],i=[wt(void 0,void 0,[Tt.selected(void 0===r.chapter_opt),0],[st("(select chapter)"),0]),Or((function(e){return wt(void 0,void 0,[Tt.selected(S(r.chapter_opt,e)),0],[st(e.name),0])}),r.available_chapters)],ae("","select",void 0!==n?n:"",void 0!==t?t:"",a,i)),[wi(void 0,"Add Rule / Fact",1),[u?wi(void 0,"Query",b(1,[0])):Ct,0]]]]),[yt(void 0,void 0,0,0),[ft(void 0,"editable_rules",0,[vt(void 0,void 0,0,[st(u?"Click the rule text of any rule to edit/update that rule. Clicking X removes the rule from the database WITHOUT a prompt.":"Click <Add Rule/Fact> to start adding rules to the database."),0]),[ft(void 0,void 0,0,Or(Ei,u)),0]]),0]]]);else switch(0|c.tag){case 0:e=ft(void 0,"adding_rule",0,[Ci(c[0],"New Rule","Add Rule",vi.addRule,0,"New rule..."),[yt(void 0,void 0,0,0),[o(0),0]]]);break;case 1:var s=c[0];e=ft(void 0,"editing_rule",0,[Ci(c[1],"Editing Rule","Update Rule",(function(r){return vi.editRuleEntry(l(La.RuleDatabase.update_rule_entry,s,r))}),0,"Edit rule..."),[yt(void 0,void 0,0,0),[o([s,0]),0]]]);break;case 2:e=o(0);break;case 3:var v=c[0].solution_stream;e=o(v?v[0].rules_applied:0)}return ki("Rules and Facts",[e,0])}function Li(r){return ft(void 0,"instructions",0,Or((function(r){return vt(void 0,void 0,0,[st(r),0])}),r))}function Ii(r){var e=function(r,e){return ki(r,[e,0])},n=r.chapter_opt,t=void 0!==n?n.rule_instructions:oi,a=r.interaction_mode;if("number"==typeof a)return e("Instructions",Li(t));switch(0|a.tag){case 2:return e("Query",function(r,e){var n=void 0!==e?ii(e):0;return ft(void 0,"editing_query",0,[Ci(r,"Query","Execute Query",vi.executeQuery,0,"New query..."),[n?ft(void 0,void 0,0,[mt(void 0,void 0,0,[st("Example Queries. Click a query below to populate the query entry box with that query."),0]),[ft(void 0,void 0,0,Or((function(r){var e=r[0];return ft(void 0,void 0,[_t("example-query"),[qt(vi.updateText(f(La.Query.to_string,e))),0]],[Fi(e,r[1][0]),0])}),n)),0]]):Ct,0]])}(a[0],r.chapter_opt));case 3:return e("Query",function(r){var e,n=r.displayed_solutions,t=r.solution_stream,a=r.initiating_query,i=function(r){return xi("Query",[Fi(a,""),0])},u=function(r){var e=l(La.Frame.to_strings,a,r.frame);return ft(void 0,void 0,[_t("solution-frame"),0],e?[dt(void 0,void 0,0,[st("Satisfied With Variable Substitution(s)"),0]),[gt(void 0,void 0,0,Or((function(r){return bt(void 0,void 0,0,[st(r),0])}),e)),0]]:[dt(void 0,void 0,0,[st("Satisfied Without Variable Sustitution"),0]),[gt(void 0,void 0,0,0),0]])};if(n){var o=Sr(n);e=xi(f(en([b(11,["Prior Solutions (",b(4,[0,0,0,b(12,[41,0])])]),"Prior Solutions (%d)"]),o),[mt(void 0,void 0,0,[st("OBSERVE: Some solutions may appear more than once because there can be multiple paths to reach the same solution. LitLog does not remove duplicate solutions from the display in order to illustrate the paths / search process."),0]),Or(u,n)])}else e=Ct;return ft(void 0,"executing_query",0,[t?ft(void 0,"solutions_remaining",0,[yi([wi(void 0,"Next Solution",3),[wi(void 0,"New Query",b(1,[a])),[wi(void 0,"Cancel",0),0]]]),[i(),[xi("Current Solution",[mt(void 0,void 0,0,[st("OBSERVE: All rules and facts applied in the discovery of the current solution are highlighted in the Rules and Facts panel with a count of the number of times the Rule/Fact was applied in the discovery of the solution."),0]),[u(t[0]),0]]),0]]]):ft(void 0,"end_of_stream",0,[yi([wi(void 0,"New Query",b(1,[a])),[wi(void 0,"Manage Rules",0),[wi(void 0,"Next Chapter",2),0]]]),[i(),[xi("All Solutions Found",[mt(void 0,void 0,0,[st("All of the solutions to the query have been found. Click New Query to keep experimenting in this chapter or <Next Chapter> to move on."),0]),0]),[n?Ct:ft(void 0,void 0,[_t("no-solution"),0],[st("No Solution"),0]),0]]]]),[e,0]])}(a[0]));default:return e("Instructions",Li(t))}}var Pi=zr(" ",["\n        html {\n            height: 100%\n        }\n\n        select {\n            font-size: 16px;\n            color: #444;\n            margin-left: 4px;\n            margin-right: 16px;\n        }\n\n        body {\n            height: 100%;\n            background-color: #eee;\n            display: flex;\n            flex-direction: column;\n            font-family: sans-serif;\n            padding: 0;\n            margin: 0;\n        }\n\n        p {\n            font-size: 14px;\n        }\n\n        h3 {\n            margin-bottom: 3px;\n        }\n    ",[_i,[Si,["\n\n    ",[Ni,[Ti,["",[" \n\n    div."+String("example-query")+" {\n        border-radius: 3px;\n        padding: 5px;\n        margin-bottom: 6px;\n        background-color: #444;\n    }\n\n    div."+String("no-solution")+" {\n        margin: 4px;\n        padding: 6px;\n        border-radius: 3px;\n        border-color: #aaa;\n        border-width: 1px;\n        border-style: solid;\n        background-color: #fcc;\n    }\n\n    div."+String("solution-frame")+" {\n        margin: 4px;\n        padding: 4px;\n        border-radius: 3px;\n        border-color: #aaa;\n        border-width: 1px;\n        border-style: solid;\n        background-color: #cfc;\n    }\n\n    div."+String("solution-frame")+" > h3 {\n        font-size: 16px;\n        font-weight: bold;\n        margin: 4px;\n    }\n    \n    ",0]]]]]]]]);var Di=function(r,e){var n={init:function(r){return l(e.init,r,mi(document.location))},update:e.update,view:e.view,subscriptions:function(n){return b(0,[[bi(r),[f(e.subscriptions,n),0]]])},shutdown:e.shutdown};return function(r,e){return pi(n,r,e)}}((function(r){return vi.viewRules}),{init:function(r,e){return[li.init(void 0),0]},update:function(r,n){var t,a=function(r,e){var n=ni.rule_database_result_from_rule_strings(e.rules);return n.tag?(console.error(n[0]),r):n[0]},i=r.interaction_mode,u=r.rule_database;if("number"==typeof n)switch(n){case 0:t={rule_database:r.rule_database,available_chapters:r.available_chapters,chapter_opt:r.chapter_opt,interaction_mode:0};break;case 1:t={rule_database:r.rule_database,available_chapters:r.available_chapters,chapter_opt:r.chapter_opt,interaction_mode:b(0,[{text:"",compilation_result:b(1,[0])}])};break;case 2:var o=r.chapter_opt,c=void 0!==o?function(r){return Dt.next_or_this_item(r,ui)}(o):function(r){if(r)return r[0];throw[e,"hd"]}(ui);t={rule_database:a(u,c),available_chapters:r.available_chapters,chapter_opt:c,interaction_mode:0};break;case 3:t="number"==typeof i||3!==i.tag?r:{rule_database:r.rule_database,available_chapters:r.available_chapters,chapter_opt:r.chapter_opt,interaction_mode:b(3,[fi(i[0])])}}else switch(0|n.tag){case 0:var s=n[0],v=f(La.RuleDatabase.rule_from_entry,s);t={rule_database:r.rule_database,available_chapters:r.available_chapters,chapter_opt:r.chapter_opt,interaction_mode:b(1,[s,ci(La.Rule.to_string,v)])};break;case 1:t={rule_database:r.rule_database,available_chapters:r.available_chapters,chapter_opt:r.chapter_opt,interaction_mode:b(2,[ci(La.Query.to_string,n[0])])};break;case 2:var d=n[0];t={rule_database:void 0!==d?a(u,d):La.RuleDatabase.empty,available_chapters:r.available_chapters,chapter_opt:d,interaction_mode:0};break;case 3:var h=n[0],p=Ua.rule_database_snapshot(u);if("number"==typeof i)t=r;else switch(0|i.tag){case 0:t={rule_database:r.rule_database,available_chapters:r.available_chapters,chapter_opt:r.chapter_opt,interaction_mode:b(0,[si(h,ni.rule_parser,(function(r){return Ua.issues_in_new_rule(p,r)}))])};break;case 1:var m=i[0];t={rule_database:r.rule_database,available_chapters:r.available_chapters,chapter_opt:r.chapter_opt,interaction_mode:b(1,[m,si(h,ni.rule_parser,(function(r){return Ua.issues_in_existing_rule(p,l(La.RuleDatabase.update_rule_entry,m,r))}))])};break;case 2:t={rule_database:r.rule_database,available_chapters:r.available_chapters,chapter_opt:r.chapter_opt,interaction_mode:b(2,[si(h,ni.query_parser,(function(r){return Ua.issues_in_query(p,r)}))])};break;case 3:t=r}break;case 4:t={rule_database:l(La.RuleDatabase.add_rule,u,n[0]),available_chapters:r.available_chapters,chapter_opt:r.chapter_opt,interaction_mode:b(0,[{text:"",compilation_result:b(1,[0])}])};break;case 5:t={rule_database:l(La.RuleDatabase.update_rule,u,n[0]),available_chapters:r.available_chapters,chapter_opt:r.chapter_opt,interaction_mode:0};break;case 6:t={rule_database:l(La.RuleDatabase.remove_rule,u,n[0]),available_chapters:r.available_chapters,chapter_opt:r.chapter_opt,interaction_mode:r.interaction_mode};break;case 7:var g=n[0],w=ai.query(u,g);t={rule_database:r.rule_database,available_chapters:r.available_chapters,chapter_opt:r.chapter_opt,interaction_mode:b(3,[{initiating_query:g,solution_stream:w,displayed_solutions:0}])}}return[t,0]},view:function(r){return e=[Mi(r),[Ii(r),0]],ft(void 0,void 0,[_t("panels"),0],e);var e},subscriptions:function(r){return 0},shutdown:function(r){return 0}});return r.main=function(r,e){var n=document.createElement("style");return document.head.appendChild(n),n.innerHTML=Pi,l(Di,r,void 0)},r}({});
