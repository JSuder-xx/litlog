var starter=function(e){"use strict";var w=["Failure",-2],q=["Invalid_argument",-3],k=["Division_by_zero",-5],E=["Not_found",-6],c=["Match_failure",-7],F=["Assert_failure",-10];function u(e,t,r){for(var n=new Array(r),i=0,a=t;i<r;)n[i]=e[a],i=i+1|0,a=a+1|0;return n}function le(e,t){if(t<0||t>=e.length)throw[q,"index out of bounds"];return e[t]}function y(e,t){for(;;){var r=t,n=e,i=n.length,a=0===i?1:i,o=a-r.length|0;if(0==o)return n.apply(null,r);if(0<=o)return function(t,r){return function(e){return y(t,r.concat([e]))}}(n,r);t=u(r,a,0|-o),e=n.apply(null,u(r,0,a))}}function de(o,u){var e=o.length;if(1===e)return o(u);switch(e){case 1:return o(u);case 2:return function(e){return o(u,e)};case 3:return function(e,t){return o(u,e,t)};case 4:return function(e,t,r){return o(u,e,t,r)};case 5:return function(e,t,r,n){return o(u,e,t,r,n)};case 6:return function(e,t,r,n,i){return o(u,e,t,r,n,i)};case 7:return function(e,t,r,n,i,a){return o(u,e,t,r,n,i,a)};default:return y(o,[u])}}function M(a,o,u){var e=a.length;if(2===e)return a(o,u);switch(e){case 1:return y(a(o),[u]);case 2:return a(o,u);case 3:return function(e){return a(o,u,e)};case 4:return function(e,t){return a(o,u,e,t)};case 5:return function(e,t,r){return a(o,u,e,t,r)};case 6:return function(e,t,r,n){return a(o,u,e,t,r,n)};case 7:return function(e,t,r,n,i){return a(o,u,e,t,r,n,i)};default:return y(a,[o,u])}}function I(i,a,o,u){var e=i.length;if(3===e)return i(a,o,u);switch(e){case 1:return y(i(a),[o,u]);case 2:return y(i(a,o),[u]);case 3:return i(a,o,u);case 4:return function(e){return i(a,o,u,e)};case 5:return function(e,t){return i(a,o,u,e,t)};case 6:return function(e,t,r){return i(a,o,u,e,t,r)};case 7:return function(e,t,r,n){return i(a,o,u,e,t,r,n)};default:return y(i,[a,o,u])}}function ee(e,t){return t.tag=e,t}function v(e,t){return e===t?0:e<t?-1:1}w.tag=248,q.tag=248,k.tag=248,E.tag=248,c.tag=248,F.tag=248;var p=function(e,t){for(var r in e)t(r)};function a(e){var t=[e];return t.tag=246,t}function m(e,t){for(;;){var r=t,n=e;if(n===r)return!0;var i=typeof n;if("string"==i||"number"==i||"boolean"==i||"undefined"==i||null===n)return!1;var a=typeof r;if("function"==i||"function"==a)throw[q,"equal: functional value"];if("number"==a||"undefined"==a||null===r)return!1;var o=0|n.tag,u=0|r.tag;if(250!=o)if(250!=u){if(248==o)return n[1]===r[1];if(251==o)throw[q,"equal: abstract value"];if(o!=u)return!1;if(256==o)return n[1]===r[1];var s=0|n.length;if(s!=(0|r.length))return!1;if(!Array.isArray(n)){if(n instanceof Date&&r instanceof Date)return!(r<n||n<r);var c={contents:!0},f=function(t,r){return function(e){t.hasOwnProperty(e)||(r.contents=!1)}}(r,c),l=function(t,r,n){return function(e){t.hasOwnProperty(e)&&m(r[e],t[e])||(n.contents=!1)}}(n,r,c);return p(n,f),c.contents&&p(r,l),c.contents}for(var d=0;;){var h=d;if(h===s)return!0;if(!m(n[h],r[h]))return!1;d=h+1|0}}else t=r[0];else e=n[0]}}function te(e,t){return!m(e,t)}function g(e){if(e<0)throw[q,"String.create"];for(var t=new Array(e),r=0;r<e;++r)t[r]=0;return t}function b(e,t,r,n,i){if(!(i<=0))if(e!==r){var a=e.length-t|0;if(i<=a)for(var o=0;o<i;++o)r[n+o|0]=e[t+o|0];else{for(var u=0;u<a;++u)r[n+u|0]=e[t+u|0];for(var s=a;s<i;++s)r[n+s|0]=0}}else{if(t<n){for(var c=(e.length-n|0)-1|0,f=i-1|0,l=f<c?f:c;0<=l;--l)e[n+l|0]=e[t+l|0];return}if(t<=n)return;for(var d=(e.length-t|0)-1|0,h=i-1|0,v=h<d?h:d,p=0;p<=v;++p)e[n+p|0]=e[t+p|0]}}function f(e){var t=e.length,r="",n=t;if(t<=4096&&t===e.length)return String.fromCharCode.apply(null,e);for(var i=0;0<n;){var a=n<1024?n:1024,o=new Array(a);b(e,i,o,0,a),r+=String.fromCharCode.apply(null,o),n=n-a|0,i=i+a|0}return r}function s(e,t,r,n,i){if(!(i<=0)){var a=e.length-t|0;if(i<=a)for(var o=0;o<i;++o)r[n+o|0]=e.charCodeAt(t+o|0);else{for(var u=0;u<a;++u)r[n+u|0]=e.charCodeAt(t+u|0);for(var s=a;s<i;++s)r[n+s|0]=0}}}function l(e){for(var t=e.length,r=new Array(t),n=0;n<t;++n)r[n]=e.charCodeAt(n);return r}var d=Math.imul||function(e,t){return((e>>16)*(t|=0)<<16)+(65535&e)*t|0};function A(e,t){return[t,e>>>0]}var S=[-2147483648,0],t=[2147483647,4294967295],x=[0,1],O=[0,0],N=[-1,4294967295];function o(e){return 0!=(2147483648&e)}function h(e){return 0==(2147483648&e)}function L(e){var t=1+(-1^e[1])|0;return A(t,(-1^e[0])+(0==t?1:0)|0)}function _(e,t,r){var n=e[1],i=n+t|0,a=o(n)&&(o(t)||h(i))||o(t)&&h(i)?1:0;return A(i,e[0]+r+a|0)}function T(e,t){return _(e,t[1],t[0])}function P(e,t){return e[0]===t[0]&&e[1]===t[1]}function R(e,t,r){var n=1+(-1^t)>>>0;return _(e,n,(-1^r)+(0==n?1:0)|0)}function D(e,t){return R(e,t[1],t[0])}function C(e,t){for(;;){var r,n=t,i=e,a=0,o=0;if(0!==i[0])o=3;else{if(0===i[1])return O;o=3}if(3===o)if(0!==n[0])a=2;else{if(0===n[1])return O;a=2}if(2===a){var u=i[0],s=0;if(-2147483648!==u||0!==i[1]?s=3:r=n[1],3===s){var c=n[0],f=i[1],l=0;if(-2147483648!==c||0!==n[1]?l=4:r=f,4===l){var d=n[1];if(u<0){if(0<=c)return L(C(L(i),n));t=L(n),e=L(i);continue}if(c<0)return L(C(i,L(n)));var h=65535&u,v=f>>>16,p=65535&f,m=65535&c,g=d>>>16,b=65535&d,w=0,y=0,_=0,k=p*b,w=(y=(y=(_=(k>>>16)+v*b)>>>16)+((_=(65535&_)+p*g)>>>16)+h*b)>>>16;return w+=(y=(65535&y)+v*g)>>>16,w+=(y=(65535&y)+p*m)>>>16,A(65535&k|(65535&_)<<16,(y&=65535)|(w=(u>>>16)*b+h*g+v*m+p*(c>>>16)+w&65535)<<16)}}}return 0==(1&r)?O:S}}function W(e,t){var r=t[0],n=e[0];return r<n||!(n<r)&&e[1]>=t[1]}function Z(e,t){return!P(e,t)}function z(e,t){return!W(e,t)}function Q(e){return 4294967296*e[0]+e[1]}function H(e){return isNaN(e)||!isFinite(e)?O:e<=-0x8000000000000000?S:0x8000000000000000<=e+1?t:e<0?L(H(-e)):A(e%4294967296|0,e/4294967296|0)}function J(e){if(r=(t=e)[0],0==(n=r>>21)||-1==n&&(0!==t[1]||-2097152!==r))return String(Q(e));var t,r,n;if(e[0]<0)return P(e,S)?"-9223372036854775808":"-"+J(L(e));var i=H(Math.floor(Q(e)/10)),a=i[1],o=i[0],u=R(R(e,a<<3,a>>>29|o<<3),a<<1,a>>>31|o<<1),s=u[1],c=u[0];if(0===s&&0===c)return J(i)+"0";if(c<0){var f=1+(-1^s)>>>0,l=Math.ceil(f/10),d=10*l-f;return J(R(i,0|l,0))+String(0|d)}var h=s,v=Math.floor(h/10),p=h-10*v;return J(_(i,0|v,0))+String(0|p)}function $(e,t){for(;;){var r=t,n=e,i=0,a=0;if(0===r[0]&&0===r[1])throw k;if((a=3)===a){var o=n[0];if(-2147483648!==o)if(0!==o)i=2;else{if(0===n[1])return O;i=2}else if(0!==n[1])i=2;else{if(P(r,x)||P(r,N))return n;if(P(r,S))return x;var u=function(e,t){if(0===t)return e;var r=e[1];return 32<=t?A(0,r<<(t-32|0)):A(r<<t,r>>>(32-t|0)|e[0]<<t)}($(function(e,t){if(0===t)return e;var r=e[0];return t<32?A(r<<(32-t|0)|e[1]>>>t,r>>t):A(r>>(t-32|0),0<=r?0:-1)}(n,1),r),1),s=0;if(0!==u[0])s=4;else{if(0===u[1])return r[0]<0?x:L(x);s=4}if(4===s)return T(u,$(D(n,C(r,u)),r))}}if(2===i&&-2147483648===r[0]&&0===r[1])return O;var c=r[0];if(!(n[0]<0)){if(c<0)return L($(n,L(r)));for(var f=O,l=n;W(l,r);){for(var d=(y=1,(_=Math.floor(Q(l)/Q(r)))<y?y:_),h=Math.ceil(Math.log(d)/Math.LN2),v=h<=48?1:Math.pow(2,h-48),p=H(d),m=C(p,r);m[0]<0||(w=l,(b=m)[0]>w[0]||!(b[0]<w[0])&&b[1]>w[1]);)m=C(p=H(d-=v),r);0===(g=p)[0]&&0===g[1]&&(p=x),f=T(f,p),l=D(l,m)}return f}if(0<=c)return L($(L(n),r));t=L(r),e=L(n)}var g,b,w,y,_}function B(e,t){var r=$(e,t);return[r,D(e,C(r,t))]}function V(e){return 0|e[1]}function U(e){function t(e){return(e>>>0).toString(16)}var r=e[1],n=e[0];if(0===n&&0===r)return"0";if(0===r)return t(n)+"00000000";if(0===n)return t(r);var i=t(r),a=8-i.length|0;return a<=0?t(n)+i:t(n)+("0".repeat(a)+i)}function G(e){return[2147483647&e[0],e[1]]}function j(r){var e=r.length;if(31<e)throw[q,"format_int: format too long"];for(var t,n={justify:"+",signstyle:"-",filter:" ",alternate:!1,base:2,signedconv:!1,width:0,uppercase:!1,sign:1,prec:-1,conv:"f"},i=0;;){var a=i;if(e<=a)return n;var o=r.charCodeAt(a),u=0;if(69<=o)if(88<=o)if(121<=o)u=1;else switch(o-88|0){case 0:n.base=1,n.uppercase=!0,i=a+1|0;continue;case 13:case 14:case 15:u=5;break;case 12:case 17:u=4;break;case 23:i=a+1|(n.base=0);continue;case 29:n.base=2,i=a+1|0;continue;case 1:case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 16:case 18:case 19:case 20:case 21:case 22:case 24:case 25:case 26:case 27:case 28:case 30:case 31:u=1;break;case 32:i=a+(n.base=1)|0;continue}else{if(!(72<=o)){n.signedconv=!0,n.uppercase=!0,n.conv=String.fromCharCode(65<=(t=o)&&t<=90||192<=t&&t<=214||216<=t&&t<=222?t+32|0:t),i=a+1|0;continue}u=1}else switch(o){case 35:n.alternate=!0,i=a+1|0;continue;case 32:case 43:u=2;break;case 45:n.justify="-",i=a+1|0;continue;case 46:for(var s=a+1|(n.prec=0);function(t){return function(){var e=r.charCodeAt(t)-48|0;return 0<=e&&e<=9}}(s)();)n.prec=(d(n.prec,10)+r.charCodeAt(s)|0)-48|0,s=s+1|0;i=s;continue;case 33:case 34:case 36:case 37:case 38:case 39:case 40:case 41:case 42:case 44:case 47:u=1;break;case 48:n.filter="0",i=a+1|0;continue;case 49:case 50:case 51:case 52:case 53:case 54:case 55:case 56:case 57:u=3;break;default:u=1}switch(u){case 1:i=a+1|0;continue;case 2:n.signstyle=String.fromCharCode(o),i=a+1|0;continue;case 3:n.width=0;for(var c=a;function(t){return function(){var e=r.charCodeAt(t)-48|0;return 0<=e&&e<=9}}(c)();)n.width=(d(n.width,10)+r.charCodeAt(c)|0)-48|0,c=c+1|0;i=c;continue;case 4:n.signedconv=!0,n.base=2,i=a+1|0;continue;case 5:n.signedconv=!0,n.conv=String.fromCharCode(o),i=a+1|0;continue}}}function X(e,t){var r=e.justify,n=e.signstyle,i=e.filter,a=e.alternate,o=e.base,u=e.signedconv,s=e.width,c=e.uppercase,f=e.sign,l=t.length;u&&(f<0||"-"!==n)&&(l=l+1|0),a&&(0===o?l=l+1|0:1===o&&(l=l+2|0));var d="";if("+"===r&&" "===i)for(var h=l;h<s;++h)d+=i;if(u&&(f<0?d+="-":"-"!==n&&(d+=n)),a&&0===o&&(d+="0"),a&&1===o&&(d+="0x"),"+"===r&&"0"===i)for(var v=l;v<s;++v)d+=i;if(d=c?d+t.toUpperCase():d+t,"-"===r)for(var p=l;p<s;++p)d+=" ";return d}function Y(e,t){if("%d"===e)return String(t);var r,n=j(e),i=(t<0?n.signedconv?(n.sign=-1,-t):t>>>0:t).toString(function(e){switch(e){case 0:return 8;case 1:return 16;case 2:return 10}}(n.base));return 0<=n.prec&&(n.filter=" ",0<(r=n.prec-i.length|0)&&(i="0".repeat(r)+i)),X(n,i)}function r(e,t){if("%d"===e)return J(t);var r,n,i,a=j(e),o=a.signedconv&&z(t,O)?(a.sign=-1,L(t)):t;switch(a.base){case 0:r=function(e){var t="",r=A(8,0),n="01234567";if(z(e,O)){var i=B(G(e),r),a=T(A(0,268435456),i[0]);for(t=n[V(i[1])]+t;Z(a,O);)var o=B(a,r),a=o[0],t=n[V(o[1])]+t}else{var u=B(e,r),s=u[0];for(t=n[V(u[1])]+t;Z(s,O);){var c=B(s,r),s=c[0];t=n[V(c[1])]+t}}return t}(o);break;case 1:r=U(o);break;case 2:r=function(e){if(!z(e,O))return J(e);var t=A(10,0),r=B(G(e),t),n=B(T(A(8,0),r[1]),t);return J(T(T(A(-858993460,214748364),r[0]),n[0]))+"0123456789"[V(n[1])]}(o)}return i=0<=a.prec?(a.filter=" ",0<(n=a.prec-r.length|0)?"0".repeat(n)+r:r):r,X(a,i)}var K=function(e,t,r){if(!isFinite(e))return isNaN(e)?"nan":0<e?"infinity":"-infinity";var n=(0!=e||1/e!=-1/0)&&0<=e?0:1;n&&(e=-e);var i=0;if(0!=e)if(e<1)for(;e<1&&-1022<i;)e*=2,i--;else for(;2<=e;)e/=2,i++;var a,o=i<0?"":"+",u="";if(n)u="-";else switch(r){case 43:u="+";break;case 32:u=" "}0<=t&&t<13&&(a=Math.pow(2,4*t),e=Math.round(e*a)/a);var s,c,f=e.toString(16);return 0<=t&&((s=f.indexOf("."))<0?f+="."+"0".repeat(t):(c=s+1+t,f.length<c?f+="0".repeat(c-f.length):f=f.substr(0,c))),u+"0x"+f+"p"+o+i.toString(10)},n=Y,i=Y;function re(e,t){if(t>=e.length||t<0)throw[q,"index out of bounds"];return e.charCodeAt(t)}var ne={contents:0};function ie(e){var t=[e,(ne.contents=ne.contents+1,ne.contents)];return t.tag=248,t}var ae=[];function oe(e){if(void 0===e){var t=[ae,0];return t.tag=256,t}if(null===e||e[0]!==ae)return e;var r=e[1]+1|0,n=[ae,r];return n.tag=256,n}function ue(e){if(null===e||e[0]!==ae)return e;var t=e[1];return 0===t?void 0:[ae,t-1|0]}var se=ie("Caml_js_exceptions.Error");function ce(e){return function(e){if(void 0!==e){if(248===e.tag)return 1;var t=e[0];return void 0!==t&&248===t.tag}}(e)?e:[se,e]}function fe(e){if("number"==typeof e)return 0;switch(0|e.tag){case 0:return ee(0,[fe(e[0])]);case 1:return ee(1,[fe(e[0])]);case 2:return ee(2,[fe(e[0])]);case 3:return ee(3,[fe(e[0])]);case 4:return ee(4,[fe(e[0])]);case 5:return ee(5,[fe(e[0])]);case 6:return ee(6,[fe(e[0])]);case 7:return ee(7,[fe(e[0])]);case 8:return ee(8,[e[0],fe(e[1])]);case 9:var t=e[0];return ee(9,[t,t,fe(e[2])]);case 10:return ee(10,[fe(e[0])]);case 11:return ee(11,[fe(e[0])]);case 12:return ee(12,[fe(e[0])]);case 13:return ee(13,[fe(e[0])]);case 14:return ee(14,[fe(e[0])])}}function he(e,t){if("number"==typeof e)return t;switch(0|e.tag){case 0:return ee(0,[he(e[0],t)]);case 1:return ee(1,[he(e[0],t)]);case 2:return ee(2,[he(e[0],t)]);case 3:return ee(3,[he(e[0],t)]);case 4:return ee(4,[he(e[0],t)]);case 5:return ee(5,[he(e[0],t)]);case 6:return ee(6,[he(e[0],t)]);case 7:return ee(7,[he(e[0],t)]);case 8:return ee(8,[e[0],he(e[1],t)]);case 9:return ee(9,[e[0],e[1],he(e[2],t)]);case 10:return ee(10,[he(e[0],t)]);case 11:return ee(11,[he(e[0],t)]);case 12:return ee(12,[he(e[0],t)]);case 13:return ee(13,[he(e[0],t)]);case 14:return ee(14,[he(e[0],t)])}}ie("Pervasives.Exit");function ve(e){return 0<=e?e:0|-e}function pe(e){return e?"true":"false"}function me(e){for(var t=0,r=e;;){if(!r)return t;r=r[1],t=t+1|0}}function ge(e,t){for(;;){if(!e)return t;t=[e[0],t],e=e[1]}}function be(e){return ge(e,0)}function we(e){return e?function e(t,r){return t?[t[0],e(t[1],r)]:r}(e[0],we(e[1])):0}function ye(e,t){return t?[de(e,t[0]),ye(e,t[1])]:0}function _e(e,t){for(;;){var r=t;if(!r)return;de(e,r[0]),t=r[1]}}function ke(e,t,r){for(;;){var n=r;if(!n)return t;r=n[1],t=M(e,t,n[0])}}function Ae(e,t){if(e){if(t)return[[e[0],t[0]],Ae(e[1],t[1])];throw[q,"List.combine"]}if(!t)return 0;throw[q,"List.combine"]}var Se=we,xe=function(u){return function(e){for(var t=0,r=e;;){var n=r,i=t;if(!n)return ge(i,0);var a=n[1],o=n[0];de(u,o)?(r=a,t=[o,i]):r=a}}};function Oe(e){return 97<=e&&e<=122?e-32|0:e}function Ne(e,t){var r=g(e);return function(e,t,r,n){if(!(r<=0))for(var i=t,a=r+t|0;i<a;++i)e[i]=n}(r,0,e,t),r}var Le=[];function Te(e,t,r){if(t<0||r<0||t>(e.length-r|0))throw[q,"String.sub / Bytes.sub"];var n=g(r);return b(e,t,n,0,r),n}function Pe(e,t,r){return f(Te(e,t,r))}function Re(e,t,r,n,i){if(i<0||t<0||t>(e.length-i|0)||n<0||n>(r.length-i|0))throw[q,"Bytes.blit"];return b(e,t,r,n,i),0}function qe(e,t,r,n,i){if(i<0||t<0||t>(e.length-i|0)||n<0||n>(r.length-i|0))throw[q,"String.blit / Bytes.blit_string"];return s(e,t,r,n,i)}function Ee(e){var t=e-9|0;return 4<t||t<0?23==t:2!=t}function Fe(e){for(var t,r,n,i=0,a=0,o=e.length;a<o;++a)var u,s=e[a],i=i+(32<=s?58<(u=s-34|0)||u<0?93<=u?4:1:57<u||u<1?2:1:11<=s?13!==s?4:2:8<=s?2:4)|0;if(i===e.length)return r=(t=e).length,n=g(r),b(t,0,n,0,r),n;for(var c=g(i),f=i=0,l=e.length;f<l;++f){var d=e[f],h=0;if(35<=d)92!==d?127<=d?h=1:c[i]=d:h=2;else if(32<=d)34<=d?h=2:c[i]=d;else if(14<=d)h=1;else switch(d){case 8:c[i]=92,c[i=i+1|0]=98;break;case 9:c[i]=92,c[i=i+1|0]=116;break;case 10:c[i]=92,c[i=i+1|0]=110;break;case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:case 11:case 12:h=1;break;case 13:c[i]=92,c[i=i+1|0]=114}switch(h){case 1:c[i]=92,c[i=i+1|0]=48+(d/100|0)|0,c[i=i+1|0]=48+(d/10|0)%10|0,c[i=i+1|0]=48+d%10|0;break;case 2:c[i]=92,c[i=i+1|0]=d}i=i+1|0}return c}function Me(e){return function(e,t){var r=t.length;if(0===r)return t;for(var n=g(r),i=0;i<r;++i)n[i]=de(e,t[i]);return n}(Oe,e)}function Ie(e,t){return f(Ne(e,t))}function De(e,t,r){for(;;){if(!r)return e;var n=r[1],i=r[0];if(!n)return i.length+e|0;r=n,e=function(e,t){if(t<=e)return e;throw[q,"String.concat"]}((i.length+t|0)+e|0,e)}}function Ce(e,t){if(!t)return"";var r=e.length;return f(function(e,t,r,n,i){for(;;){var a=t;if(!i)return e;var o=i[1],u=i[0];if(!o)return s(u,0,e,a,u.length),e;s(u,0,e,a,u.length),s(r,0,e,a+u.length|0,n),i=o,t=(a+u.length|0)+n|0}}(g(De(0,r,t)),0,e,r,t))}function We(e){var t=e-9|0;return 4<t||t<0?23==t:2!=t}function Ze(e){return""===e||!We(e.charCodeAt(0))&&!We(e.charCodeAt(e.length-1|0))?e:f(function(e){for(var t=e.length,r=0;r<t&&Ee(e[r]);)r=r+1|0;for(var n=t-1|0;r<=n&&Ee(e[n]);)n=n-1|0;return r<=n?Te(e,r,1+(n-r|0)|0):Le}(l(e)))}var ze=v,Qe=qe;function He(e,t,r,n){var i,a,o=void 0!==t&&t,u=e.style;return void 0!==u.setProperty?u.setProperty(r,n,o?"important":null):(i=r,a=n,void(e.style[i]=a))}function Je(e,t,r){return e.insertBefore(t,r)}function $e(e,t,r,n){return""===t?e.setAttribute(r,n):e.setAttributeNS(t,r,n)}function Be(e,t){return""===e?document.createElement(t):document.createElementNS(e,t)}var Ve=ee(0,[""]);function Ue(e,t,r,n,i,a){return ee(2,[e,t,r,n,i,a])}function Ge(e,t){return ee(0,[e,t])}function je(e,t,r){return ee(3,[e,ee(0,[t,r]),{contents:void 0}])}function Xe(e){for(;;){var t=e;switch(0|t.tag){case 0:return"\x3c!-- "+t[0]+" --\x3e";case 1:return t[0];case 2:var r=t[1],n=t[0];return Ce("",["<",[n,[""===n?"":":",[r,[Ce("",ye(function(e){if("number"==typeof e)return"";switch(0|e.tag){case 0:return Ce("",[" ",[e[0],['="',[e[1],['"',0]]]]]);case 1:return Ce("",[" ",[e[1],['="',[e[2],['"',0]]]]]);case 2:return Ce("",[" data-",[e[0],['="',[e[1],['"',0]]]]]);case 3:return"";case 4:return Ce("",[' style="',[Ce(";",ye(function(e){return Ce("",[e[0],[":",[e[1],[";",0]]]])},e[0])),['"',0]]])}},t[4])),[">",[Ce("",ye(Xe,t[5])),["</",[r,[">",0]]]]]]]]]]);case 3:e=de(t[1],void 0);continue;case 4:e=t[1];continue}}}function Ye(e){if(!e.tag)return e[1];var t=e[0];return function(e){return oe(t)}}function Ke(e,t,r,n){var i,a,o,u,s,c={contents:Ye(n)},f=(i=e,a=c,function(e){var t=de(a.contents,e);if(void 0!==t)return de(i.contents.enqueue,ue(t))});return o=r,u=f,s=!1,t.addEventListener(o,u,s),{handler:f,cb:c}}function et(e,t,r){if(void 0!==r)return n=e,i=t,a=r.handler,o=!1,void n.removeEventListener(i,a,o);var n,i,a,o}function tt(e,t,r,n,i,a,o,u){var s,c,f=o.contents;if(void 0!==f)if(r!==n){o.contents=et(t,r,o.contents),u.contents=Ke(e,t,n,a)}else{if(u.contents=o.contents,s=i,(c=a).tag?s.tag&&m(c[0],s[0]):!s.tag&&c[0]===s[0])return;var l=Ye(a);f.cb.contents=l}else u.contents=Ke(e,t,n,a)}function rt(e,t,r,n,i){!function(r,e){var t,n,i;if("number"!=typeof e)switch(0|e.tag){case 0:return r[e[0]]=void 0;case 1:return t=r,n=e[0],i=e[1],""===n?t.removeAttribute(i):t.removeAttributeNS(n,i);case 2:throw console.log(["TODO:  Remove Data Unhandled",e[0],e[1]]),[w,"TODO:  Remove Data Unhandled"];case 3:var a=e[2];return a.contents=et(r,e[0],a.contents);case 4:ke(function(e,t){return He(r,void 0,t[0],null)},void 0,e[0])}}(t,n),function(e,r,t){if("number"!=typeof t)switch(0|t.tag){case 0:return r[t[0]]=t[1];case 1:return $e(r,t[0],t[1],t[2]);case 2:throw console.log(["TODO:  Add Data Unhandled",t[0],t[1]]),[w,"TODO:  Add Data Unhandled"];case 3:return t[2].contents=Ke(e,r,t[0],t[1]);case 4:ke(function(e,t){return He(r,void 0,t[0],t[1])},void 0,t[0])}}(e,t,i)}function nt(e,o,t,r,n){if("number"==typeof n)throw[w,"This should never be called as all entries through NoProp are gated."];switch(0|n.tag){case 0:return void(o[n[0]]=n[1]);case 1:return $e(o,n[0],n[1],n[2]);case 2:throw console.log(["TODO:  Mutate Data Unhandled",n[0],n[1]]),[w,"TODO:  Mutate Data Unhandled"];case 3:throw[w,"This will never be called because it is gated"];case 4:if("number"==typeof r)throw[w,"Passed a non-Style to a new Style as a Mutations while the old Style is not actually a style!"];if(4===r.tag)return function(e,t,r,n){for(;;){var i=n,a=r,o=t;if(a){if(i){n=i[1],r=a[1],t=I(e,o,a[0],i[0]);continue}throw[q,"List.fold_left2"]}if(i)throw[q,"List.fold_left2"];return o}}(function(e,t,r){var n=r[1],i=r[0],a=t[0];return a===i?t[1]===n?void 0:He(o,void 0,i,n):(He(o,void 0,a,null),He(o,void 0,i,n))},void 0,r[0],n[0]);throw[w,"Passed a non-Style to a new Style as a Mutations while the old Style is not actually a style!"]}}function it(e,t,r,n){return function(e,t,r,n){for(;;){var i=n,a=r;if(!a)return!i;var o=a[0];if(!i)return!1;if("number"==typeof o){if("number"==typeof i[0]){n=i[1],r=a[1],0;continue}}else switch(0|o.tag){case 0:var u=i[0];if("number"==typeof u||u.tag)break;o[0]===u[0]&&o[1]===u[1]||nt(0,t,0,o,u),n=i[1],r=a[1],0;continue;case 1:var s=i[0];if("number"==typeof s||1!==s.tag)break;o[0]===s[0]&&o[1]===s[1]&&o[2]===s[2]||nt(0,t,0,o,s),n=i[1],r=a[1],0;continue;case 2:var c=i[0];if("number"==typeof c||2!==c.tag)break;o[0]===c[0]&&o[1]===c[1]||nt(0,t,0,o,c),n=i[1],r=a[1],0;continue;case 3:var f=i[0];if("number"==typeof f||3!==f.tag)break;tt(e,t,o[0],f[0],o[1],f[1],o[2],f[2]),n=i[1],r=a[1],0;continue;case 4:var l=i[0];if("number"==typeof l||4!==l.tag)break;m(o[0],l[0])||nt(0,t,0,o,l),n=i[1],r=a[1],0;continue}rt(e,t,0,o,i[0]),n=i[1],r=a[1],0}}(e,t,r,n)}function at(e,t,r,n,i){if(2!==i.tag)throw[w,"Node replacement should never be passed anything but a node itself"];var a=i[4],o=le(r,n),u=Be(i[0],i[1]);if(it(e,u,ye(function(e){return 0},a),a))return st(e,u,u.childNodes,0,0,i[5]),Je(t,u,o),void t.removeChild(o);throw[c,["vdom.ml",319,30]]}function ot(e,t){for(;;){var r=t,n=e;switch(0|r.tag){case 0:var i=r[0];return document.createComment(i);case 1:var a=r[0];return document.createTextNode(a);case 2:var o=r[4],u=Be(r[0],r[1]);if(it(n,u,ye(function(e){return 0},o),o))return st(n,u,u.childNodes,0,0,r[5]),u;throw[c,["vdom.ml",333,30]];case 3:var s=de(r[1],void 0);t=r[2].contents=s;continue;case 4:t=r[1],e=de(r[0],n);continue}}}function ut(e,t,r,n,i,a){if(2!==i.tag)throw[w,"Non-node passed to patchVNodesOnElems_MutateNode"];if(2!==a.tag)throw[w,"Non-node passed to patchVNodesOnElems_MutateNode"];if(i[3]!==a[3]||i[1]!==a[1])return at(e,t,r,n,a),0;var o=le(r,n),u=o.childNodes;return it(e,o,i[4],a[4])||(console.log("VDom:  Failed swapping properties because the property list length changed, use `noProp` to swap properties instead, not by altering the list structure.  This is a massive inefficiency until this issue is resolved."),at(e,t,r,n,a)),st(e,o,u,0,i[5],a[5])}function st(e,t,r,n,i,a){for(;;){var o=a,u=i,s=n;if(u){var c=u[0];switch(0|c.tag){case 0:if(o){var f=o[0];if(!f.tag&&c[0]===f[0]){a=o[1],i=u[1],n=s+1|0;continue}}break;case 1:if(o){var l=o[0];if(1===l.tag){var d=l[0];c[0]!==d&&(le(r,s).nodeValue=d),a=o[1],i=u[1],n=s+1|0;continue}}break;case 2:if(o){var h=o[0];if(2===h.tag){var v=o[1],p=h[2],m=h[1],g=h[0],b=u[1],w=c[2],y=c[1],_=c[0];if(w===p&&""!==w){a=v,i=b,n=s+1|0;continue}if(""===w||""===p){ut(e,t,r,s,c,h),a=v,i=b,n=s+1|0;continue}var k=0,A=0;if(b){var S=b[0];if(2===S.tag){var x=b[1],O=S[2],N=S[1],L=S[0],T=0;if(v){var P=v[0];if(2===P.tag){if(L===g&&N===m&&O===p&&_===P[0]&&y===P[1]&&w===P[2]){var R=le(r,s),q=le(r,s+1|0);t.removeChild(q),Je(t,q,R),a=v[1],i=x,n=s+2|0;continue}T=4}else T=4}else T=4;if(4===T){if(L===g&&N===m&&O===p){var E=le(r,s);t.removeChild(E),a=v,i=x,n=s+1|0;continue}A=3}}else A=3}else A=3;if(3===A)if(v){var F=v[0];if(2===F.tag){if(_===F[0]&&y===F[1]&&w===F[2]){var M=le(r,s);Je(t,ot(e,h),M),a=v,n=s+1|0;continue}k=2}else k=2}else k=2;if(2===k){ut(e,t,r,s,c,h),a=v,i=b,n=s+1|0;continue}}}break;case 3:if(o){var I=o[0];if(3===I.tag){var D=o[1],C=I[2],W=I[1],Z=I[0],z=u[1],Q=c[2],H=c[0];if(H===Z){C.contents=Q.contents,a=D,i=z,n=s+1|0;continue}var J=0,$=0;if(z){var B=z[0];if(3===B.tag){var V=z[1],U=B[0],G=0;if(D){var j=D[0];if(3===j.tag){if(U===Z&&H===j[0]){var X=le(r,s),Y=le(r,s+1|0);t.removeChild(Y),Je(t,Y,X),a=D[1],i=V,n=s+2|0;continue}G=4}else G=4}else G=4;if(4===G){if(U===Z){var K=le(r,s);t.removeChild(K);var ee=B[2].contents;C.contents=ee,a=D,i=V,n=s+1|0;continue}$=3}}else $=3}else $=3;if(3===$)if(D){var te=D[0];if(3===te.tag){if(te[0]===H){var re=le(r,s),ne=de(W,void 0);Je(t,ot(e,C.contents=ne),re),a=D,n=s+1|0;continue}J=2}else J=2}else J=2;if(2===J){var ie=Q.contents,ae=de(W,void 0);a=[C.contents=ae,D],i=[ie,z];continue}}}break;case 4:i=[c[1],u[1]];continue}var oe=u[1];if(o){var ue=o[0];if(4===ue.tag){st(de(ue[0],e),t,r,s,[c,0],[ue[1],0]),a=o[1],i=oe,n=s+1|0;continue}var se=le(r,s);Je(t,ot(e,ue),se),t.removeChild(se),a=o[1],i=oe,n=s+1|0;continue}var ce=le(r,s);t.removeChild(ce),a=0,i=oe}else{if(!o)return;var fe=ot(e,o[0]);t.appendChild(fe),a=o[1],n=s+1|(i=0)}}}function ct(r,e){if("number"!=typeof e)switch(0|e.tag){case 1:return ke(function(e,t){return ct(r,t)},void 0,e[0]);case 0:case 2:return de(e[0],r)}}function ft(a,o,e,t){var u=function(e,t){for(;;){var r=t,n=e;if("number"==typeof r)return;switch(0|r.tag){case 0:var i=r[0];return i?_e(function(t){return function(e){return u(t,e)}}(n),i):void 0;case 1:return void(r[2].contents=de(r[1],n));case 2:var a=de(r[0],n);t=r[1],e=a;continue}}},s=function(e,t){for(;;){var r=t,n=e;if("number"==typeof r)return;switch(0|r.tag){case 0:var i=r[0];return i?_e(function(t){return function(e){return s(t,e)}}(n),i):void 0;case 1:var a=r[2],o=a.contents;return void 0!==o?de(o,a.contents=void 0):void 0;case 2:var u=de(r[0],n);t=r[1],e=u;continue}}};if("number"==typeof e){if("number"==typeof t)return t}else switch(0|e.tag){case 0:if("number"==typeof t||t.tag)break;return function(e,t){for(;;){var r=t;if(e){var n=e[1],i=e[0];if(r){ft(a,o,i,r[0]),t=r[1],e=n;continue}s(a,i),t=0,e=n}else{if(!r)return;u(o,r[0]),t=r[1],e=0}}}(e[0],t[0]),t;case 1:if("number"!=typeof t&&1===t.tag&&e[0]===t[0])return t[2].contents=e[2].contents,t;break;case 2:if("number"==typeof t||2!==t.tag)break;return ft(de(e[0],a),de(t[0],o),e[1],t[1]),t}return s(a,e),u(o,t),t}function lt(e,t){for(var r=e.length;(e.position+t|0)>r;)r<<=1;var n=g(r);Re(e.buffer,0,n,0,e.position),e.buffer=n,e.length=r}function dt(e,t){var r=t.length,n=e.position+r|0;n>e.length&&lt(e,r),qe(t,0,e.buffer,e.position,r),e.position=n}function ht(e,t){var r,n,i,a=e.bytes.length,o=e.ind+t|0;o<=a||(i=g((n=o)<(r=a<<1)?r:n),Re(e.bytes,0,i,0,a),e.bytes=i)}function vt(e,t){ht(e,1),e.bytes[e.ind]=t,e.ind=e.ind+1|0}function pt(e,t){var r=t.length;ht(e,r),Qe(t,0,e.bytes,e.ind,r),e.ind=e.ind+r|0}function mt(e){return Pe(e.bytes,0,e.ind)}function gt(e){if("number"==typeof e)return 0;switch(0|e.tag){case 0:return ee(0,[gt(e[0])]);case 1:return ee(1,[gt(e[0])]);case 2:return ee(2,[gt(e[0])]);case 3:return ee(3,[gt(e[0])]);case 4:return ee(4,[gt(e[0])]);case 5:return ee(5,[gt(e[0])]);case 6:return ee(6,[gt(e[0])]);case 7:return ee(7,[gt(e[0])]);case 8:return ee(8,[e[0],gt(e[1])]);case 9:return ee(9,[e[1],e[0],gt(e[2])]);case 10:return ee(10,[gt(e[0])]);case 11:return ee(11,[gt(e[0])]);case 12:return ee(12,[gt(e[0])]);case 13:return ee(13,[gt(e[0])]);case 14:return ee(14,[gt(e[0])])}}function bt(e){if("number"==typeof e)return[function(e){return 0},function(e){return 0},function(e){return 0},function(e){return 0}];switch(0|e.tag){case 0:var t=bt(e[0]),r=t[1],n=t[0];return[function(e){return de(n,0),0},function(e){return de(r,0),0},t[2],t[3]];case 1:var i=bt(e[0]),a=i[1],o=i[0];return[function(e){return de(o,0),0},function(e){return de(a,0),0},i[2],i[3]];case 2:var u=bt(e[0]),s=u[1],c=u[0];return[function(e){return de(c,0),0},function(e){return de(s,0),0},u[2],u[3]];case 3:var f=bt(e[0]),l=f[1],d=f[0];return[function(e){return de(d,0),0},function(e){return de(l,0),0},f[2],f[3]];case 4:var h=bt(e[0]),v=h[1],p=h[0];return[function(e){return de(p,0),0},function(e){return de(v,0),0},h[2],h[3]];case 5:var m=bt(e[0]),g=m[1],b=m[0];return[function(e){return de(b,0),0},function(e){return de(g,0),0},m[2],m[3]];case 6:var w=bt(e[0]),y=w[1],_=w[0];return[function(e){return de(_,0),0},function(e){return de(y,0),0},w[2],w[3]];case 7:var k=bt(e[0]),A=k[1],S=k[0];return[function(e){return de(S,0),0},function(e){return de(A,0),0},k[2],k[3]];case 8:var x=bt(e[1]),O=x[1],N=x[0];return[function(e){return de(N,0),0},function(e){return de(O,0),0},x[2],x[3]];case 9:var L=bt(e[2]),T=L[3],P=L[2],R=L[1],q=L[0],E=bt(wt(gt(e[0]),e[1])),F=E[3],M=E[2],I=E[1],D=E[0];return[function(e){return de(q,0),de(D,0),0},function(e){return de(I,0),de(R,0),0},function(e){return de(P,0),de(M,0),0},function(e){return de(F,0),de(T,0),0}];case 10:var C=bt(e[0]),W=C[1],Z=C[0];return[function(e){return de(Z,0),0},function(e){return de(W,0),0},C[2],C[3]];case 11:var z=bt(e[0]),Q=z[1],H=z[0];return[function(e){return de(H,0),0},function(e){return de(Q,0),0},z[2],z[3]];case 12:var J=bt(e[0]),$=J[1],B=J[0];return[function(e){return de(B,0),0},function(e){return de($,0),0},J[2],J[3]];case 13:var V=bt(e[0]),U=V[3],G=V[2],j=V[1],X=V[0];return[function(e){return de(X,0),0},function(e){return de(j,0),0},function(e){return de(G,0),0},function(e){return de(U,0),0}];case 14:var Y=bt(e[0]),K=Y[3],ee=Y[2],te=Y[1],re=Y[0];return[function(e){return de(re,0),0},function(e){return de(te,0),0},function(e){return de(ee,0),0},function(e){return de(K,0),0}]}}function wt(e,t){var r=0;if("number"==typeof e){if("number"==typeof t)return 0;switch(0|t.tag){case 8:r=6;break;case 9:r=7;break;case 10:r=1;break;case 11:r=2;break;case 12:r=3;break;case 13:r=4;break;case 14:r=5;break;default:throw[F,["camlinternalFormat.ml",846,23]]}}else switch(0|e.tag){case 0:if("number"==typeof t)r=8;else switch(0|t.tag){case 0:return ee(0,[wt(e[0],t[0])]);case 8:r=6;break;case 9:r=7;break;case 10:r=1;break;case 11:r=2;break;case 12:r=3;break;case 13:r=4;break;case 14:r=5}break;case 1:if("number"==typeof t)r=8;else switch(0|t.tag){case 1:return ee(1,[wt(e[0],t[0])]);case 8:r=6;break;case 9:r=7;break;case 10:r=1;break;case 11:r=2;break;case 12:r=3;break;case 13:r=4;break;case 14:r=5}break;case 2:if("number"==typeof t)r=8;else switch(0|t.tag){case 2:return ee(2,[wt(e[0],t[0])]);case 8:r=6;break;case 9:r=7;break;case 10:r=1;break;case 11:r=2;break;case 12:r=3;break;case 13:r=4;break;case 14:r=5}break;case 3:if("number"==typeof t)r=8;else switch(0|t.tag){case 3:return ee(3,[wt(e[0],t[0])]);case 8:r=6;break;case 9:r=7;break;case 10:r=1;break;case 11:r=2;break;case 12:r=3;break;case 13:r=4;break;case 14:r=5}break;case 4:if("number"==typeof t)r=8;else switch(0|t.tag){case 4:return ee(4,[wt(e[0],t[0])]);case 8:r=6;break;case 9:r=7;break;case 10:r=1;break;case 11:r=2;break;case 12:r=3;break;case 13:r=4;break;case 14:r=5}break;case 5:if("number"==typeof t)r=8;else switch(0|t.tag){case 5:return ee(5,[wt(e[0],t[0])]);case 8:r=6;break;case 9:r=7;break;case 10:r=1;break;case 11:r=2;break;case 12:r=3;break;case 13:r=4;break;case 14:r=5}break;case 6:if("number"==typeof t)r=8;else switch(0|t.tag){case 6:return ee(6,[wt(e[0],t[0])]);case 8:r=6;break;case 9:r=7;break;case 10:r=1;break;case 11:r=2;break;case 12:r=3;break;case 13:r=4;break;case 14:r=5}break;case 7:if("number"==typeof t)r=8;else switch(0|t.tag){case 7:return ee(7,[wt(e[0],t[0])]);case 8:r=6;break;case 9:r=7;break;case 10:r=1;break;case 11:r=2;break;case 12:r=3;break;case 13:r=4;break;case 14:r=5}break;case 8:if("number"==typeof t)throw[F,["camlinternalFormat.ml",832,26]];switch(0|t.tag){case 8:return ee(8,[wt(e[0],t[0]),wt(e[1],t[1])]);case 10:r=1;break;case 11:r=2;break;case 12:r=3;break;case 13:r=4;break;case 14:r=5;break;default:throw[F,["camlinternalFormat.ml",832,26]]}break;case 9:if("number"==typeof t)throw[F,["camlinternalFormat.ml",842,28]];switch(0|t.tag){case 8:r=6;break;case 9:var n=bt(wt(gt(e[1]),t[0]));return de(n[1],0),de(n[3],0),ee(9,[e[0],t[1],wt(e[2],t[2])]);case 10:r=1;break;case 11:r=2;break;case 12:r=3;break;case 13:r=4;break;case 14:r=5;break;default:throw[F,["camlinternalFormat.ml",842,28]]}break;case 10:if("number"==typeof t)throw[F,["camlinternalFormat.ml",810,21]];if(10===t.tag)return ee(10,[wt(e[0],t[0])]);throw[F,["camlinternalFormat.ml",810,21]];case 11:if("number"==typeof t)throw[F,["camlinternalFormat.ml",814,21]];switch(0|t.tag){case 10:r=1;break;case 11:return ee(11,[wt(e[0],t[0])]);default:throw[F,["camlinternalFormat.ml",814,21]]}break;case 12:if("number"==typeof t)throw[F,["camlinternalFormat.ml",818,19]];switch(0|t.tag){case 10:r=1;break;case 11:r=2;break;case 12:return ee(12,[wt(e[0],t[0])]);default:throw[F,["camlinternalFormat.ml",818,19]]}break;case 13:if("number"==typeof t)throw[F,["camlinternalFormat.ml",822,22]];switch(0|t.tag){case 10:r=1;break;case 11:r=2;break;case 12:r=3;break;case 13:return ee(13,[wt(e[0],t[0])]);default:throw[F,["camlinternalFormat.ml",822,22]]}break;case 14:if("number"==typeof t)throw[F,["camlinternalFormat.ml",827,30]];switch(0|t.tag){case 10:r=1;break;case 11:r=2;break;case 12:r=3;break;case 13:r=4;break;case 14:return ee(14,[wt(e[0],t[0])]);default:throw[F,["camlinternalFormat.ml",827,30]]}}switch(r){case 1:throw[F,["camlinternalFormat.ml",811,21]];case 2:throw[F,["camlinternalFormat.ml",815,21]];case 3:throw[F,["camlinternalFormat.ml",819,19]];case 4:throw[F,["camlinternalFormat.ml",823,22]];case 5:throw[F,["camlinternalFormat.ml",828,30]];case 6:throw[F,["camlinternalFormat.ml",833,26]];case 7:throw[F,["camlinternalFormat.ml",843,28]];case 8:throw[F,["camlinternalFormat.ml",847,23]]}}var yt=ie("CamlinternalFormat.Type_mismatch");function _t(e,t){if("number"==typeof e)return[0,t];if(!e.tag)return[ee(0,[e[0],e[1]]),t];if("number"==typeof t)throw yt;if(2===t.tag)return[ee(1,[e[0]]),t[0]];throw yt}function kt(e,t,r){var n=_t(e,r);if("number"!=typeof t)return[n[0],[t[0]],n[1]];if(0===t)return[n[0],0,n[1]];var i=n[1];if("number"==typeof i)throw yt;if(2===i.tag)return[n[0],1,i[0]];throw yt}function At(e,t){if("number"==typeof e)return[0,t];switch(0|e.tag){case 0:if("number"==typeof t)throw yt;if(t.tag)throw yt;var r=At(e[0],t[0]);return[ee(0,[r[0]]),r[1]];case 1:if("number"==typeof t)throw yt;if(t.tag)throw yt;var n=At(e[0],t[0]);return[ee(1,[n[0]]),n[1]];case 2:var i=_t(e[0],t),a=i[1];if("number"==typeof a)throw yt;if(1!==a.tag)throw yt;var o=At(e[1],a[0]);return[ee(2,[i[0],o[0]]),o[1]];case 3:var u=_t(e[0],t),s=u[1];if("number"==typeof s)throw yt;if(1!==s.tag)throw yt;var c=At(e[1],s[0]);return[ee(3,[u[0],c[0]]),c[1]];case 4:var f=kt(e[1],e[2],t),l=f[2];if("number"==typeof l)throw yt;if(2!==l.tag)throw yt;var d=At(e[3],l[0]);return[ee(4,[e[0],f[0],f[1],d[0]]),d[1]];case 5:var h=kt(e[1],e[2],t),v=h[2];if("number"==typeof v)throw yt;if(3!==v.tag)throw yt;var p=At(e[3],v[0]);return[ee(5,[e[0],h[0],h[1],p[0]]),p[1]];case 6:var m=kt(e[1],e[2],t),g=m[2];if("number"==typeof g)throw yt;if(4!==g.tag)throw yt;var b=At(e[3],g[0]);return[ee(6,[e[0],m[0],m[1],b[0]]),b[1]];case 7:var w=kt(e[1],e[2],t),y=w[2];if("number"==typeof y)throw yt;if(5!==y.tag)throw yt;var _=At(e[3],y[0]);return[ee(7,[e[0],w[0],w[1],_[0]]),_[1]];case 8:var k=kt(e[1],e[2],t),A=k[2];if("number"==typeof A)throw yt;if(6!==A.tag)throw yt;var S=At(e[3],A[0]);return[ee(8,[e[0],k[0],k[1],S[0]]),S[1]];case 9:var x=_t(e[0],t),O=x[1];if("number"==typeof O)throw yt;if(7!==O.tag)throw yt;var N=At(e[1],O[0]);return[ee(9,[x[0],N[0]]),N[1]];case 10:var L=At(e[0],t);return[ee(10,[L[0]]),L[1]];case 11:var T=At(e[1],t);return[ee(11,[e[0],T[0]]),T[1]];case 12:var P=At(e[1],t);return[ee(12,[e[0],P[0]]),P[1]];case 13:if("number"==typeof t)throw yt;if(8!==t.tag)throw yt;var R=t[0];if(te([e[1]],[R]))throw yt;var q=At(e[2],t[1]);return[ee(13,[e[0],R,q[0]]),q[1]];case 14:if("number"==typeof t)throw yt;if(9!==t.tag)throw yt;var E=t[0];if(te([fe(e[1])],[fe(E)]))throw yt;var F=At(e[2],fe(t[2]));return[ee(14,[e[0],E,F[0]]),F[1]];case 15:if("number"==typeof t)throw yt;if(10!==t.tag)throw yt;var M=At(e[0],t[0]);return[ee(15,[M[0]]),M[1]];case 16:if("number"==typeof t)throw yt;if(11!==t.tag)throw yt;var I=At(e[0],t[0]);return[ee(16,[I[0]]),I[1]];case 17:var D=At(e[1],t);return[ee(17,[e[0],D[0]]),D[1]];case 18:var C=e[0],W=e[1];if(C.tag){var Z=C[0],z=At(Z[0],t),Q=At(W,z[1]);return[ee(18,[ee(1,[[z[0],Z[1]]]),Q[0]]),Q[1]]}var H=C[0],J=At(H[0],t),$=At(W,J[1]);return[ee(18,[ee(0,[[J[0],H[1]]]),$[0]]),$[1]];case 19:if("number"==typeof t)throw yt;if(13!==t.tag)throw yt;var B=At(e[0],t[0]);return[ee(19,[B[0]]),B[1]];case 20:if("number"==typeof t)throw yt;if(1!==t.tag)throw yt;var V=At(e[2],t[0]);return[ee(20,[e[0],e[1],V[0]]),V[1]];case 21:if("number"==typeof t)throw yt;if(2!==t.tag)throw yt;var U=At(e[1],t[0]);return[ee(21,[e[0],U[0]]),U[1]];case 23:var G=e[0],j=e[1];if("number"==typeof G){if(2!==G)return St(G,j,t);if("number"==typeof t)throw yt;if(14!==t.tag)throw yt;var X=At(j,t[0]);return[ee(23,[2,X[0]]),X[1]]}switch(0|G.tag){case 8:return St(ee(8,[G[0],G[1]]),j,t);case 9:var Y=function e(t,r,n){if("number"==typeof t)return[0,At(r,n)];switch(0|t.tag){case 0:if("number"==typeof n)throw yt;if(n.tag)throw yt;var i=e(t[0],r,n[0]);return[ee(0,[i[0]]),i[1]];case 1:if("number"==typeof n)throw yt;if(1!==n.tag)throw yt;var a=e(t[0],r,n[0]);return[ee(1,[a[0]]),a[1]];case 2:if("number"==typeof n)throw yt;if(2!==n.tag)throw yt;var o=e(t[0],r,n[0]);return[ee(2,[o[0]]),o[1]];case 3:if("number"==typeof n)throw yt;if(3!==n.tag)throw yt;var u=e(t[0],r,n[0]);return[ee(3,[u[0]]),u[1]];case 4:if("number"==typeof n)throw yt;if(4!==n.tag)throw yt;var s=e(t[0],r,n[0]);return[ee(4,[s[0]]),s[1]];case 5:if("number"==typeof n)throw yt;if(5!==n.tag)throw yt;var c=e(t[0],r,n[0]);return[ee(5,[c[0]]),c[1]];case 6:if("number"==typeof n)throw yt;if(6!==n.tag)throw yt;var f=e(t[0],r,n[0]);return[ee(6,[f[0]]),f[1]];case 7:if("number"==typeof n)throw yt;if(7!==n.tag)throw yt;var l=e(t[0],r,n[0]);return[ee(7,[l[0]]),l[1]];case 8:if("number"==typeof n)throw yt;if(8!==n.tag)throw yt;var d=n[0];if(te([t[0]],[d]))throw yt;var h=e(t[1],r,n[1]);return[ee(8,[d,h[0]]),h[1]];case 9:if("number"==typeof n)throw yt;if(9!==n.tag)throw yt;var v=n[1],p=n[0];if(te([fe(t[0])],[fe(p)]))throw yt;if(te([fe(t[1])],[fe(v)]))throw yt;var m=bt(wt(gt(p),v));de(m[1],0),de(m[3],0);var g=e(fe(t[2]),r,n[2]);return[ee(9,[p,v,gt(g[0])]),g[1]];case 10:if("number"==typeof n)throw yt;if(10!==n.tag)throw yt;var b=e(t[0],r,n[0]);return[ee(10,[b[0]]),b[1]];case 11:if("number"==typeof n)throw yt;if(11!==n.tag)throw yt;var w=e(t[0],r,n[0]);return[ee(11,[w[0]]),w[1]];case 12:throw yt;case 13:if("number"==typeof n)throw yt;if(13!==n.tag)throw yt;var y=e(t[0],r,n[0]);return[ee(13,[y[0]]),y[1]];case 14:if("number"==typeof n)throw yt;if(14!==n.tag)throw yt;var _=e(t[0],r,n[0]);return[ee(14,[_[0]]),_[1]]}}(G[1],j,t),K=Y[1];return[ee(23,[ee(9,[G[0],Y[0]]),K[0]]),K[1]];default:return St(G,j,t)}case 22:case 24:throw yt}}function St(e,t,r){var n=At(t,r);return[ee(23,[e,n[0]]),n[1]]}function xt(e,t){return function(e,t){var r=At(e,t);if("number"==typeof r[1])return r[0];throw yt}(e,fe(gt(t)))}function Ot(e,t,r){var n=r.length,i=ve(t),a=t<0?0:e;if(i<=n)return r;var o=Ne(i,2===a?48:32);switch(a){case 0:Qe(r,0,o,0,n);break;case 1:Qe(r,0,o,i-n|0,n);break;case 2:0<n&&(43===re(r,0)||45===re(r,0)||32===re(r,0))?(o[0]=re(r,0),Qe(r,1,o,1+(i-n|0)|0,n-1|0)):1<n&&48===re(r,0)&&(120===re(r,1)||88===re(r,1))?(o[1]=re(r,1),Qe(r,2,o,2+(i-n|0)|0,n-2|0)):Qe(r,0,o,i-n|0,n)}return f(o)}function Nt(e,t){var r=ve(e),n=t.length,i=re(t,0),a=0;if(58<=i)if(71<=i){if(102<i||i<97)return t;a=2}else{if(i<65)return t;a=2}else if(32!==i){if(i<43)return t;switch(i-43|0){case 0:case 2:a=1;break;case 1:case 3:case 4:return t;case 5:if(n<(r+2|0)&&1<n&&(120===re(t,1)||88===re(t,1))){var o=Ne(r+2|0,48);return o[1]=re(t,1),Qe(t,2,o,4+(r-n|0)|0,n-2|0),f(o)}a=2;break;case 6:case 7:case 8:case 9:case 10:case 11:case 12:case 13:case 14:a=2}}else a=1;switch(a){case 1:if((r+1|0)<=n)return t;var u=Ne(r+1|0,48);return u[0]=i,Qe(t,1,u,2+(r-n|0)|0,n-1|0),f(u);case 2:if(r<=n)return t;var s=Ne(r,48);return Qe(t,0,s,r-n|0,n),f(s)}}function Lt(e){var i,t=(i=e,function(e){for(;;){var t=e;if(t>=i.length)return;var r=i.charCodeAt(t);if(r<32)return 1;var n=r-34|0;if(58<n||n<0){if(93<=n)return 1;e=t+1|0}else{if(57<n||n<1)return 1;e=t+1|0}}}(0)?f(Fe(l(i))):i),r=t.length,n=Ne(r+2|0,34);return s(t,0,n,1,r),f(n)}function Tt(e,t){if(15===e)return"%.12g";var r=ve(t),n=function(e){switch(e){case 0:case 1:case 2:return 102;case 3:case 4:case 5:return 101;case 6:case 7:case 8:return 69;case 9:case 10:case 11:return 103;case 12:case 13:case 14:return 71;case 15:return 70;case 16:case 17:case 18:return 104;case 19:case 20:case 21:return 72}}(e),i={ind:0,bytes:g(16)};return vt(i,37),function(e,t){switch(t){case 0:case 3:case 6:case 9:case 12:case 15:case 16:case 19:return;case 1:case 4:case 7:case 10:case 13:case 17:case 20:return vt(e,43);case 2:case 5:case 8:case 11:case 14:case 18:case 21:vt(e,32)}}(i,e),vt(i,46),pt(i,String(r)),vt(i,n),mt(i)}function Pt(e,t){return Y(function(e){switch(e){case 0:return"%d";case 1:return"%+d";case 2:return"% d";case 3:return"%i";case 4:return"%+i";case 5:return"% i";case 6:return"%x";case 7:return"%#x";case 8:return"%X";case 9:return"%#X";case 10:return"%o";case 11:return"%#o";case 12:return"%u"}}(e),t)}function Rt(e,t){return i(function(e){switch(e){case 0:return"%ld";case 1:return"%+ld";case 2:return"% ld";case 3:return"%li";case 4:return"%+li";case 5:return"% li";case 6:return"%lx";case 7:return"%#lx";case 8:return"%lX";case 9:return"%#lX";case 10:return"%lo";case 11:return"%#lo";case 12:return"%lu"}}(e),t)}function qt(e,t){return n(function(e){switch(e){case 0:return"%nd";case 1:return"%+nd";case 2:return"% nd";case 3:return"%ni";case 4:return"%+ni";case 5:return"% ni";case 6:return"%nx";case 7:return"%#nx";case 8:return"%nX";case 9:return"%#nX";case 10:return"%no";case 11:return"%#no";case 12:return"%nu"}}(e),t)}function Et(e,t){return r(function(e){switch(e){case 0:return"%Ld";case 1:return"%+Ld";case 2:return"% Ld";case 3:return"%Li";case 4:return"%+Li";case 5:return"% Li";case 6:return"%Lx";case 7:return"%#Lx";case 8:return"%LX";case 9:return"%#LX";case 10:return"%Lo";case 11:return"%#Lo";case 12:return"%Lu"}}(e),t)}function Ft(e,t,r){if(16<=e){var n;if(17<=e)switch(e-17|0){case 2:n=45;break;case 0:case 3:n=43;break;case 1:case 4:n=32}else n=45;var i=K(r,t,n);return 19<=e?f(Me(l(i))):i}var a=function(e,t){var r=j(e),n=r.prec<0?6:r.prec,i=t<0?(r.sign=-1,-t):t,a="";if(isNaN(i))a="nan",r.filter=" ";else if(isFinite(i)){switch(r.conv){case"e":var o=(a=i.toExponential(n)).length;"e"===a[o-3|0]&&(a=a.slice(0,o-1|0)+("0"+a.slice(o-1|0)));break;case"f":a=i.toFixed(n);break;case"g":var u=0!==n?n:1,s=(a=i.toExponential(u-1|0)).indexOf("e"),c=0|Number(a.slice(s+1|0));if(c<-4||1e21<=i||i.toFixed().length>u){for(var f=s-1|0;"0"===a[f];)f=f-1|0;"."===a[f]&&(f=f-1|0);var l=(a=a.slice(0,f+1|0)+a.slice(s)).length;"e"===a[l-3|0]&&(a=a.slice(0,l-1|0)+("0"+a.slice(l-1|0)))}else{var d=u;if(c<0)d=d-(1+c|0)|0,a=i.toFixed(d);else for(;(a=i.toFixed(d)).length>(u+1|0);)d=d-1|0;if(0!==d){for(var h=a.length-1|0;"0"===a[h];)h=h-1|0;"."===a[h]&&(h=h-1|0),a=a.slice(0,h+1|0)}}}}else a="inf",r.filter=" ";return X(r,a)}(Tt(e,t),r);if(15!==e)return a;var o,u=a.length,s=(o=r,isFinite(o)?22250738585072014e-324<=Math.abs(o)?0:0!==o?1:2:isNaN(o)?4:3);return 3!=s?4<=s?"nan":function(e){for(;;){var t=e;if(t===u)return!1;var r=re(a,t)-46|0;if(23<r||r<0){if(55==r)return!0;e=t+1|0}else{if(22<r||r<1)return!0;e=t+1|0}}}(0)?a:a+".":r<0?"neg_infinity":"infinity"}function Mt(e){var t=function(e){var t=0;if(40<=e){if(92===e)return"\\\\";t=127<=e?1:2}else if(32<=e){if(39<=e)return"\\'";t=2}else if(14<=e)t=1;else switch(e){case 8:return"\\b";case 9:return"\\t";case 10:return"\\n";case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:case 11:case 12:t=1;break;case 13:return"\\r"}switch(t){case 1:var r=[0,0,0,0];return r[0]=92,r[1]=48+(e/100|0)|0,r[2]=48+(e/10|0)%10|0,r[3]=48+e%10|0,f(r);case 2:var n=[0];return n[0]=e,f(n)}}(e),r=t.length,n=Ne(r+2|0,39);return s(t,0,n,1,r),f(n)}function It(e){var t={ind:0,bytes:g(16)};return function e(t,r){for(;;){var n=r;if("number"==typeof n)return;switch(0|n.tag){case 0:pt(t,"%c"),r=n[0];continue;case 1:pt(t,"%s"),r=n[0];continue;case 2:pt(t,"%i"),r=n[0];continue;case 3:pt(t,"%li"),r=n[0];continue;case 4:pt(t,"%ni"),r=n[0];continue;case 5:pt(t,"%Li"),r=n[0];continue;case 6:pt(t,"%f"),r=n[0];continue;case 7:pt(t,"%B"),r=n[0];continue;case 8:pt(t,"%{"),e(t,n[0]),pt(t,"%}"),r=n[1];continue;case 9:pt(t,"%("),e(t,n[0]),pt(t,"%)"),r=n[2];continue;case 10:pt(t,"%a"),r=n[0];continue;case 11:pt(t,"%t"),r=n[0];continue;case 12:pt(t,"%?"),r=n[0];continue;case 13:pt(t,"%r"),r=n[0];continue;case 14:pt(t,"%_r"),r=n[0];continue}}}(t,e),mt(t)}function Dt(e,c,t,r){for(;;){var n=r,i=t,a=e;if("number"==typeof n)return M(a,c,i);switch(0|n.tag){case 0:return function(r,n,i){return function(e){var t=ee(5,[n,e]);return Dt(r,c,t,i)}}(a,i,n[0]);case 1:return function(n,i,a){return function(e){var t=Mt(e),r=ee(4,[i,t]);return Dt(n,c,r,a)}}(a,i,n[0]);case 2:return Wt(a,c,i,n[1],n[0],function(e){return e});case 3:return Wt(a,c,i,n[1],n[0],Lt);case 4:return Zt(a,c,i,n[3],n[1],n[2],Pt,n[0]);case 5:return Zt(a,c,i,n[3],n[1],n[2],Rt,n[0]);case 6:return Zt(a,c,i,n[3],n[1],n[2],qt,n[0]);case 7:return Zt(a,c,i,n[3],n[1],n[2],Et,n[0]);case 8:var o=n[3],u=n[1],s=n[2],f=n[0];if("number"==typeof u)return"number"==typeof s?(0!==s?function(n,i,a,o){return function(e,t){var r=Ft(o,e,t);return Dt(n,c,ee(4,[i,r]),a)}}:function(r,n,i,a){return function(e){var t=Ft(a,-6,e);return Dt(r,c,ee(4,[n,t]),i)}})(a,i,o,f):function(r,n,i,a,o){return function(e){var t=Ft(a,o,e);return Dt(r,c,ee(4,[n,t]),i)}}(a,i,o,f,s[0]);if(u.tag){var l=u[0];return"number"==typeof s?(0!==s?function(i,a,o,u,s){return function(e,t,r){var n=Ot(s,e,Ft(u,t,r));return Dt(i,c,ee(4,[a,n]),o)}}:function(i,a,o,u,s){return function(e,t){var r=Ft(u,-6,t),n=Ot(s,e,r);return Dt(i,c,ee(4,[a,n]),o)}})(a,i,o,f,l):function(n,i,a,o,u,s){return function(e,t){var r=Ot(u,e,Ft(o,s,t));return Dt(n,c,ee(4,[i,r]),a)}}(a,i,o,f,l,s[0])}var d=u[1],h=u[0];return"number"==typeof s?(0!==s?function(n,i,a,o,u,s){return function(e,t){var r=Ot(u,s,Ft(o,e,t));return Dt(n,c,ee(4,[i,r]),a)}}:function(n,i,a,o,u,s){return function(e){var t=Ft(o,-6,e),r=Ot(u,s,t);return Dt(n,c,ee(4,[i,r]),a)}})(a,i,o,f,h,d):function(r,n,i,a,o,u,s){return function(e){var t=Ot(o,u,Ft(a,s,e));return Dt(r,c,ee(4,[n,t]),i)}}(a,i,o,f,h,d,s[0]);case 9:return Wt(a,c,i,n[1],n[0],pe);case 10:r=n[0],t=ee(7,[i]);continue;case 11:r=n[1],t=ee(2,[i,n[0]]);continue;case 12:r=n[1],t=ee(3,[i,n[0]]);continue;case 13:return function(t,r,n,i){return function(e){return Dt(t,c,ee(4,[r,i]),n)}}(a,i,n[2],It(n[1]));case 14:var v=n[2];return function(t,r,n,i){return function(e){return Dt(t,c,r,function e(t,r){if("number"==typeof t)return r;switch(0|t.tag){case 0:return ee(0,[e(t[0],r)]);case 1:return ee(1,[e(t[0],r)]);case 2:return ee(2,[t[0],e(t[1],r)]);case 3:return ee(3,[t[0],e(t[1],r)]);case 4:return ee(4,[t[0],t[1],t[2],e(t[3],r)]);case 5:return ee(5,[t[0],t[1],t[2],e(t[3],r)]);case 6:return ee(6,[t[0],t[1],t[2],e(t[3],r)]);case 7:return ee(7,[t[0],t[1],t[2],e(t[3],r)]);case 8:return ee(8,[t[0],t[1],t[2],e(t[3],r)]);case 9:return ee(9,[t[0],e(t[1],r)]);case 10:return ee(10,[e(t[0],r)]);case 11:return ee(11,[t[0],e(t[1],r)]);case 12:return ee(12,[t[0],e(t[1],r)]);case 13:return ee(13,[t[0],t[1],e(t[2],r)]);case 14:return ee(14,[t[0],t[1],e(t[2],r)]);case 15:return ee(15,[e(t[0],r)]);case 16:return ee(16,[e(t[0],r)]);case 17:return ee(17,[t[0],e(t[1],r)]);case 18:return ee(18,[t[0],e(t[1],r)]);case 19:return ee(19,[e(t[0],r)]);case 20:return ee(20,[t[0],t[1],e(t[2],r)]);case 21:return ee(21,[t[0],e(t[1],r)]);case 22:return ee(22,[e(t[0],r)]);case 23:return ee(23,[t[0],e(t[1],r)]);case 24:return ee(24,[t[0],t[1],e(t[2],r)])}}(xt(e[0],n),i))}}(a,i,n[1],v);case 15:return function(e,n,i){return function(t,r){return Dt(e,c,ee(6,[n,function(e){return M(t,e,r)}]),i)}}(a,i,n[0]);case 16:return function(t,r,n){return function(e){return Dt(t,c,ee(6,[r,e]),n)}}(a,i,n[0]);case 17:r=n[1],t=ee(0,[i,n[0]]);continue;case 18:var p=n[0];if(p.tag){var m=function(r,n,i){return function(e,t){return Dt(r,e,ee(1,[n,ee(1,[t])]),i)}}(a,i,n[1]);r=p[0][0],t=0,e=m;continue}var g=function(r,n,i){return function(e,t){return Dt(r,e,ee(1,[n,ee(0,[t])]),i)}}(a,i,n[1]);r=p[0][0],t=0,e=g;continue;case 19:throw[F,["camlinternalFormat.ml",1525,4]];case 20:return function(t,r,n){return function(e){return Dt(t,c,n,r)}}(a,n[2],ee(8,[i,"Printf: bad conversion %["]));case 21:return function(n,i,a){return function(e){var t=Y("%u",e),r=ee(4,[i,t]);return Dt(n,c,r,a)}}(a,i,n[1]);case 22:return function(r,n,i){return function(e){var t=ee(5,[n,e]);return Dt(r,c,t,i)}}(a,i,n[0]);case 23:return function(e,t,r,n,i){if("number"!=typeof n)return 9===n.tag?function r(n,i,a,e,o){if("number"==typeof e)return Ct(n,i,a,o);switch(0|e.tag){case 0:var t=e[0];return function(e){return r(n,i,a,t,o)};case 1:var u=e[0];return function(e){return r(n,i,a,u,o)};case 2:var s=e[0];return function(e){return r(n,i,a,s,o)};case 3:var c=e[0];return function(e){return r(n,i,a,c,o)};case 4:var f=e[0];return function(e){return r(n,i,a,f,o)};case 5:var l=e[0];return function(e){return r(n,i,a,l,o)};case 6:var d=e[0];return function(e){return r(n,i,a,d,o)};case 7:var h=e[0];return function(e){return r(n,i,a,h,o)};case 8:var v=e[1];return function(e){return r(n,i,a,v,o)};case 9:var p=e[2],m=wt(gt(e[0]),e[1]);return function(e){return r(n,i,a,he(m,p),o)};case 10:var g=e[0];return function(e,t){return r(n,i,a,g,o)};case 11:var b=e[0];return function(e){return r(n,i,a,b,o)};case 12:var w=e[0];return function(e){return r(n,i,a,w,o)};case 13:throw[F,["camlinternalFormat.ml",1616,31]];case 14:throw[F,["camlinternalFormat.ml",1617,31]]}}(e,t,r,n[1],i):Ct(e,t,r,i);if(2===n)throw[F,["camlinternalFormat.ml",1593,39]];return Ct(e,t,r,i)}(a,c,i,n[0],n[1]);case 24:return function t(r,n,i,a,e,o){if(!e)return Dt(r,n,ee(4,[i,o]),a);var u=e[0];return function(e){return t(r,n,i,a,u,de(o,e))}}(a,c,i,n[2],n[0],de(n[1],void 0))}}}function Ct(e,t,r,n){return Dt(e,t,ee(8,[r,"Printf: bad conversion %_"]),n)}function Wt(i,a,o,u,e,s){if("number"==typeof e)return function(e){var t=de(s,e),r=ee(4,[o,t]);return Dt(i,a,r,u)};if(e.tag){var c=e[0];return function(e,t){var r=Ot(c,e,de(s,t)),n=ee(4,[o,r]);return Dt(i,a,n,u)}}var n=e[1],f=e[0];return function(e){var t=Ot(f,n,de(s,e)),r=ee(4,[o,t]);return Dt(i,a,r,u)}}function Zt(i,a,o,u,e,t,s,c){if("number"==typeof e){if("number"==typeof t)return 0!==t?function(e,t){var r=Nt(e,M(s,c,t));return Dt(i,a,ee(4,[o,r]),u)}:function(e){var t=M(s,c,e);return Dt(i,a,ee(4,[o,t]),u)};var r=t[0];return function(e){var t=Nt(r,M(s,c,e));return Dt(i,a,ee(4,[o,t]),u)}}if(e.tag){var f=e[0];if("number"==typeof t)return 0!==t?function(e,t,r){var n=Ot(f,e,Nt(t,M(s,c,r)));return Dt(i,a,ee(4,[o,n]),u)}:function(e,t){var r=Ot(f,e,M(s,c,t));return Dt(i,a,ee(4,[o,r]),u)};var n=t[0];return function(e,t){var r=Ot(f,e,Nt(n,M(s,c,t)));return Dt(i,a,ee(4,[o,r]),u)}}var l=e[1],d=e[0];if("number"==typeof t)return 0!==t?function(e,t){var r=Ot(d,l,Nt(e,M(s,c,t)));return Dt(i,a,ee(4,[o,r]),u)}:function(e){var t=Ot(d,l,M(s,c,e));return Dt(i,a,ee(4,[o,t]),u)};var h=t[0];return function(e){var t=Ot(d,l,Nt(h,M(s,c,e)));return Dt(i,a,ee(4,[o,t]),u)}}function zt(e,t){for(;;){var r=t,n=0;if("number"==typeof r)return;switch(0|r.tag){case 0:var i=function(e){if("number"==typeof e)switch(e){case 0:return"@]";case 1:return"@}";case 2:return"@?";case 3:return"@\n";case 4:return"@.";case 5:return"@@";case 6:return"@%"}else switch(0|e.tag){case 0:case 1:return e[0];case 2:return"@"+f(Ne(1,e[0]))}}(r[1]);return zt(e,r[0]),dt(e,i),0;case 1:var a=r[1],o=r[0];if(a.tag){zt(e,o),dt(e,"@["),t=a[0];continue}zt(e,o),dt(e,"@{"),t=a[0];continue;case 2:case 4:n=1;break;case 3:case 5:n=2;break;case 6:return zt(e,r[0]),dt(e,de(r[1],void 0)),0;case 7:t=r[0];continue;case 8:throw zt(e,r[0]),[q,r[1]]}switch(n){case 1:return zt(e,r[0]),dt(e,r[1]),0;case 2:return zt(e,r[0]),u=e,s=r[1],c=void 0,(c=u.position)>=u.length&&lt(u,1),u.buffer[c]=s,u.position=c+1|0,0}}var u,s,c}function Qt(u,e){return Dt(function(e,t){var r,n,i,a,o={buffer:i=g(n=(r=64)<1?1:r),position:0,length:n,initial_buffer:i};return zt(o,t),de(u,Pe((a=o).buffer,0,a.position))},void 0,0,e[0])}function Ht(e){return Qt(function(e){return e},e)}function Jt(e){return I(Ht([ee(11,["At ",ee(2,[0,ee(11,["; Expecting ",ee(2,[0,ee(11,[" but actual ",ee(2,[0,0])])])])])]),"At %s; Expecting %s but actual %s"]),(t=e.location,M(Ht([ee(11,["Ln ",ee(4,[0,0,0,ee(11,[", Col ",ee(4,[0,0,0,0])])])]),"Ln %d, Col %d"]),t.line,t.column)),e.expecting,e.actual);var t}function $t(e){return e.result}function Bt(e,t,r){var n=de(e,r);if(n.tag)return ee(1,[n[0]]);var i=n[0];return M(t,i.result,{location:i.location,input_chars:i.remaining_chars})}function Vt(e,t,r,n){var i=de(e,n);if(i.tag)return ee(0,[{result:r,location:n.location,remaining_chars:n.input_chars}]);var a=i[0];return M(t,a.result,{location:a.location,input_chars:a.remaining_chars})}function Ut(e,t){return ee(0,[{result:e,location:t.location,remaining_chars:t.input_chars}])}function Gt(e,t,r){var n=de(t,r);if(!n.tag)return n;var i=n[0];return ee(1,i?[[{expecting:de(e,Ce(" OR ",ye(function(e){return e.expecting},i))),actual:i[0].actual,location:r.location},0]]:[[{expecting:de(e,""),actual:"No input",location:r.location},0]])}function jt(e,t,r){var n=de(t,r);if(!n.tag)return n;var i=n[0];return ee(1,i?[[{expecting:e,actual:i[0].actual,location:r.location},i[1]]]:[[{expecting:e,actual:"",location:r.location},0]])}function Xt(r,t){return function(e){return Bt(t,function(e){var t=de(r,e);return function(e){return Ut(t,e)}},e)}}function Yt(e,t,r){var n=de(e,r);if(!n.tag)return n;var i=de(t,r);return i.tag?ee(1,[Se([n[0],[i[0],0]])]):i}function Kt(e){if(!e)return function(e){return ee(1,[0])};var t=e[0],r=Kt(e[1]);return function(e){return Yt(t,r,e)}}function er(n){function t(e){return Bt(n,function(r){var t=er(n);return function(e){return Bt(t,function(e){var t=[r,e];return function(e){return Ut(t,e)}},e)}},e)}return function(e){return Yt(t,function(e){return Ut(0,e)},e)}}function tr(e,t){return i=t,a=r=e,n=(o=function(t){var r=be(t);return function(e){return Vt(i,function(e){return function(e){return Bt(a,function(e){return o([e,t])},e)}},r,e)}})(0),function(e){return Bt(r,function(r){return function(e){return Bt(n,function(e){var t=[r,e];return function(e){return Ut(t,e)}},e)}},e)};var r,n,i,a,o}function rr(e,t,r){var n=r.input_chars;if(!n)return ee(1,[[{expecting:t,actual:"Ran out of characters",location:r.location},0]]);var i,a,o,u=n[0];return de(e,u)?ee(0,[{result:u,location:(i=r.location,a=u,o=i.line,10!==a&&13!==a?{column:i.column+1|0,line:o}:{column:1,line:o+1|0}),remaining_chars:n[1]}]):ee(1,[[{expecting:t,actual:de(Ht([ee(12,[39,ee(0,[ee(12,[39,0])])]),"'%c'"]),u),location:r.location},0]])}function nr(t){var r=de(Ht([ee(0,[0]),"%c"]),t);return function(e){return rr(function(e){return t===e},r,e)}}function ir(t,r){var n=M(Ht([ee(11,["A character between ",ee(0,[ee(11,[" and ",ee(0,[0])])])]),"A character between %c and %c"]),t,r);return function(e){return rr(function(e){return t<=e&&e<=r},n,e)}}var ar,or,ur=(ar=[32,[9,[13,[10,0]]]],or=de(Ht([ee(11,["One of: ",ee(2,[0,0])]),"One of: %s"]),Ce(", ",ye(function(e){return Ie(1,e)},ar))),function(e){return rr(function(e){return function(e,t){for(;;){var r=t;if(!r)return!1;if(m(r[0],e))return!0;t=r[1]}}(e,ar)},or,e)}),sr=(nr(10),nr(9),ir(65,90)),cr=ir(97,122),fr=ir(48,57),lr=Ht([ee(2,[0,0]),"%s"]);function dr(e){return Gt(lr,function(e){return Yt(cr,sr,e)},e)}Kt([ir(97,102),[ir(65,70),[fr,0]]]);var hr=function t(r){function n(e){return Bt(r,function(e){return t(r)},e)}return function(e){return Yt(n,function(e){return Ut(void 0,e)},e)}}(ur);ir(48,55);function vr(n){var i=n.length,a=function(e){if(i<=e)return function(e){return Ut(n,e)};var t=a(e+1|0),r=nr(re(n,e));return function(e){return Bt(r,function(e){return t},e)}};if(i<=0)return function(e){throw[w,e]}("token must be a non-empty string");function t(e){return Bt(hr,function(e){return r},e)}var r=a(0);return function(e){return jt(n,t,e)}}function pr(e,t){return de(e,{location:{column:1,line:1},input_chars:(i=Ze(t),a=i.length,be(function(e,t){for(;;){var r=t,n=e;if(r===a)return n;t=r+1|0,e=[re(i,r),n]}}(0,0)))});var i,a}function mr(e,t){var r=pr(e,t);if(r.tag)return ee(1,[r[0]]);var n=r[0],i=n.remaining_chars,a=n.location;return i?ee(1,[[{expecting:"End of input",actual:de(Ht([ee(11,["Characters remaining: ",ee(2,[0,0])]),"Characters remaining: %s"]),Ce("",ye(function(e){return Ie(1,e)},i))),location:a},0]]):ee(0,[{result:n.result,location:a,remaining_chars:i}])}var gr=Bt,br=Yt,wr=function(t,r){return function(e){return Bt(t,function(e){return r},e)}},yr=function(t,r){return function(e){return Bt(t,function(t){return function(e){return Bt(r,function(e){return function(e){return Ut(t,e)}},e)}},e)}};function _r(h){function v(e){return e?e[4]:0}function p(e,t,r,n){var i=v(e),a=v(n);return[e,t,r,n,a<=i?i+1|0:a+1|0]}function n(e,t){return[0,e,t,0,1]}function m(e,t,r,n){var i=e?e[4]:0,a=n?n[4]:0;if((a+2|0)<i){if(e){var o=e[3],u=e[2],s=e[1],c=e[0];if(v(c)>=v(o))return p(c,s,u,p(o,t,r,n));if(o)return p(p(c,s,u,o[0]),o[1],o[2],p(o[3],t,r,n));throw[q,"Map.bal"]}throw[q,"Map.bal"]}if(a<=(i+2|0))return[e,t,r,n,a<=i?i+1|0:a+1|0];if(n){var f=n[3],l=n[2],d=n[1],h=n[0];if(v(f)>=v(h))return p(p(e,t,r,h),d,l,f);if(h)return p(p(e,t,r,h[0]),h[1],h[2],p(h[3],d,l,f));throw[q,"Map.bal"]}throw[q,"Map.bal"]}function i(e){for(;;){if(!e)throw E;var t=e[0];if(!t)return[e[1],e[2]];e=t}}function e(e){for(;;){if(!e)return;var t=e[0];if(!t)return[e[1],e[2]];e=t}}function g(e,t){if(!e)return t;if(!t)return e;var r=i(t);return m(e,r[0],r[1],a(t))}function l(e,t){if(!e)return t;if(!t)return e;var r=i(t);return x(e,r[0],r[1],a(t))}function b(e,t,r,n){return void 0!==r?x(e,t,ue(r),n):l(e,n)}function c(e,t){for(;;){if(!e)return t;t=[e[1],e[2],e[3],t],e=e[0]}}var f=function(e,t,r){if(!r)return[0,e,t,0,1];var n=r[3],i=r[2],a=r[1],o=r[0],u=M(h.compare,e,a);if(0===u)return i===t?r:[o,e,t,n,r[4]];if(u<0){var s=f(e,t,o);return o===s?r:m(s,a,i,n)}var c=f(e,t,n);return n===c?r:m(o,a,i,c)},a=function(e){if(e){var t=e[0];return t?m(a(t),e[1],e[2],e[3]):e[3]}throw[q,"Map.remove_min_elt"]},d=function(e,t){if(!t)return 0;var r=t[3],n=t[2],i=t[1],a=t[0],o=M(h.compare,e,i);if(0===o)return g(a,r);if(o<0){var u=d(e,a);return a===u?t:m(u,i,n,r)}var s=d(e,r);return r===s?t:m(a,i,n,s)},w=function(e,t,r){if(r){var n=r[3],i=r[2],a=r[1],o=r[0],u=M(h.compare,e,a);if(0===u){var s=de(t,oe(i));if(void 0===s)return g(o,n);var c=ue(s);return i===c?r:[o,e,c,n,r[4]]}if(u<0){var f=w(e,t,o);return o===f?r:m(f,a,i,n)}var l=w(e,t,n);return n===l?r:m(o,a,i,l)}var d=de(t,void 0);return void 0!==d?[0,e,ue(d),0,1]:0},o=function(e,t){for(;;){var r=t;if(!r)return;o(e,r[0]),M(e,r[1],r[2]),t=r[3]}},u=function(e,t){if(!t)return 0;var r=u(e,t[0]),n=de(e,t[2]),i=u(e,t[3]);return[r,t[1],n,i,t[4]]},s=function(e,t){if(!t)return 0;var r=t[1];return[s(e,t[0]),r,M(e,r,t[2]),s(e,t[3]),t[4]]},y=function(e,t,r){for(;;){var n=t;if(!n)return r;r=I(e,n[1],n[2],y(e,n[0],r)),t=n[3]}},_=function(e,t){for(;;){var r=t;if(!r)return!0;if(!M(e,r[1],r[2]))return!1;if(!_(e,r[0]))return!1;t=r[3]}},k=function(e,t){for(;;){var r=t;if(!r)return!1;if(M(e,r[1],r[2]))return!0;if(k(e,r[0]))return!0;t=r[3]}},A=function(e,t,r){return r?m(A(e,t,r[0]),r[1],r[2],r[3]):n(e,t)},S=function(e,t,r){return r?m(r[0],r[1],r[2],S(e,t,r[3])):n(e,t)},x=function(e,t,r,n){if(!e)return A(t,r,n);if(!n)return S(t,r,e);var i=n[4],a=e[4];return(i+2|0)<a?m(e[0],e[1],e[2],x(e[3],t,r,n)):(a+2|0)<i?m(x(e,t,r,n[0]),n[1],n[2],n[3]):p(e,t,r,n)},O=function(e,t){if(!t)return[0,void 0,0];var r=t[3],n=t[2],i=t[1],a=t[0],o=M(h.compare,e,i);if(0===o)return[a,oe(n),r];if(o<0){var u=O(e,a);return[u[0],u[1],x(u[2],i,n,r)]}var s=O(e,r);return[x(a,i,n,s[0]),s[1],s[2]]},N=function(e,t,r){if(t){var n=t[1];if(t[4]>=v(r)){var i=O(n,r);return b(N(e,t[0],i[0]),n,I(e,n,oe(t[2]),i[1]),N(e,t[3],i[2]))}}else if(!r)return 0;if(r){var a=r[1],o=O(a,t);return b(N(e,o[0],r[0]),a,I(e,a,o[1],oe(r[2])),N(e,o[2],r[3]))}throw[F,["map.ml",393,10]]},L=function(e,t,r){if(!t)return r;if(!r)return t;var n=r[2],i=r[1],a=t[2],o=t[1];if(t[4]>=r[4]){var u=O(o,r),s=u[1],c=L(e,t[0],u[0]),f=L(e,t[3],u[2]);return void 0!==s?b(c,o,I(e,o,a,ue(s)),f):x(c,o,a,f)}var l=O(i,t),d=l[1],h=L(e,l[0],r[0]),v=L(e,l[2],r[3]);return void 0!==d?b(h,i,I(e,i,ue(d),n),v):x(h,i,n,v)},T=function(e,t){if(!t)return 0;var r=t[3],n=t[2],i=t[1],a=t[0],o=T(e,a),u=M(e,i,n),s=T(e,r);return u?a===o&&r===s?t:x(o,i,n,s):l(o,s)},P=function(e,t){if(!t)return[0,0];var r=t[2],n=t[1],i=P(e,t[0]),a=i[1],o=i[0],u=M(e,n,r),s=P(e,t[3]),c=s[1],f=s[0];return u?[x(o,n,r,f),l(a,c)]:[l(o,f),x(a,n,r,c)]},t=function(e){return e?(t(e[0])+1|0)+t(e[3])|0:0},R=function(e,t){for(;;){var r=t;if(!r)return e;t=r[0],e=[[r[1],r[2]],R(e,r[3])]}};return{empty:0,is_empty:function(e){return!e},mem:function(e,t){for(;;){var r=t;if(!r)return!1;var n=M(h.compare,e,r[1]);if(0===n)return!0;t=n<0?r[0]:r[3]}},add:f,update:w,singleton:n,remove:d,merge:N,union:L,compare:function(e,t,r){for(var n=c(t,0),i=c(r,0);;){var a=i,o=n;if(!o)return a?-1:0;if(!a)return 1;var u=M(h.compare,o[0],a[0]);if(0!==u)return u;var s=M(e,o[1],a[1]);if(0!==s)return s;i=c(a[2],a[3]),n=c(o[2],o[3])}},equal:function(e,t,r){for(var n=c(t,0),i=c(r,0);;){var a=i,o=n;if(!o)return!a;if(!a)return!1;if(0!==M(h.compare,o[0],a[0]))return!1;if(!M(e,o[1],a[1]))return!1;i=c(a[2],a[3]),n=c(o[2],o[3])}},iter:o,fold:y,for_all:_,exists:k,filter:T,partition:P,cardinal:t,bindings:function(e){return R(0,e)},min_binding:i,min_binding_opt:e,max_binding:function(e){for(;;){if(!e)throw E;var t=e[3];if(!t)return[e[1],e[2]];e=t}},max_binding_opt:function(e){for(;;){if(!e)return;var t=e[3];if(!t)return[e[1],e[2]];e=t}},choose:i,choose_opt:e,split:O,find:function(e,t){for(;;){var r=t;if(!r)throw E;var n=M(h.compare,e,r[1]);if(0===n)return r[2];t=n<0?r[0]:r[3]}},find_opt:function(e,t){for(;;){var r=t;if(!r)return;var n=M(h.compare,e,r[1]);if(0===n)return oe(r[2]);t=n<0?r[0]:r[3]}},find_first:function(e,t){for(;;){var r=t;if(!r)throw E;var n=r[1];if(de(e,n))for(var i=n,a=r[2],o=r[0];;){var u=o;if(!u)return[i,a];var s=u[1];de(e,s)?(o=u[0],a=u[2],i=s):o=u[3]}t=r[3]}},find_first_opt:function(e,t){for(;;){var r=t;if(!r)return;var n=r[1];if(de(e,n))for(var i=n,a=r[2],o=r[0];;){var u=o;if(!u)return[i,a];var s=u[1];de(e,s)?(o=u[0],a=u[2],i=s):o=u[3]}t=r[3]}},find_last:function(e,t){for(;;){var r=t;if(!r)throw E;var n=r[1];if(de(e,n))for(var i=n,a=r[2],o=r[3];;){var u=o;if(!u)return[i,a];var s=u[1];de(e,s)?(o=u[3],a=u[2],i=s):o=u[0]}t=r[0]}},find_last_opt:function(e,t){for(;;){var r=t;if(!r)return;var n=r[1];if(de(e,n))for(var i=n,a=r[2],o=r[3];;){var u=o;if(!u)return[i,a];var s=u[1];de(e,s)?(o=u[3],a=u[2],i=s):o=u[0]}t=r[0]}},map:u,mapi:s}}function kr(e,t){var r=t.length;if(0===r)return[];for(var n=function(e,t){for(var r=new Array(e),n=0;n<e;++n)r[n]=t;return r}(r,de(e,t[0])),i=1;i<r;++i)n[i]=de(e,t[i]);return n}function Ar(e,t,r){for(var n=r,i=t.length-1|0;0<=i;--i)n=M(e,t[i],n);return n}ie("Array.Bottom");function Sr(e,t){if(t in e)return oe(e[t])}var xr=function(e){var t=typeof e;return"string"==t?ee(0,[e]):"number"==t?ee(1,[e]):"boolean"==t?!0===e?1:0:null===e?2:Array.isArray(e)?ee(3,[e]):ee(2,[e])};function Or(e,t){return t.tag?t:e}function Nr(e,t){return t.tag?oe(t[0]):function(e){if(e.tag)return oe(e[0])}(e)}function Lr(e){return e?e[4]:0}function Tr(e,t,r,n){var i=Lr(e),a=Lr(n);return[e,t,r,n,a<=i?i+1|0:a+1|0]}function Pr(e,t){return[0,e,t,0,1]}function Rr(e,t,r,n){var i=e?e[4]:0,a=n?n[4]:0;if((a+2|0)<i){if(e){var o=e[3],u=e[2],s=e[1],c=e[0];if(Lr(c)>=Lr(o))return Tr(c,s,u,Tr(o,t,r,n));if(o)return Tr(Tr(c,s,u,o[0]),o[1],o[2],Tr(o[3],t,r,n));throw[q,"Map.bal"]}throw[q,"Map.bal"]}if(a<=(i+2|0))return[e,t,r,n,a<=i?i+1|0:a+1|0];if(n){var f=n[3],l=n[2],d=n[1],h=n[0];if(Lr(f)>=Lr(h))return Tr(Tr(e,t,r,h),d,l,f);if(h)return Tr(Tr(e,t,r,h[0]),h[1],h[2],Tr(h[3],d,l,f));throw[q,"Map.bal"]}throw[q,"Map.bal"]}function qr(e,t,r){if(!r)return[0,e,t,0,1];var n=r[3],i=r[2],a=r[1],o=r[0],u=v(e,a);if(0===u)return i===t?r:[o,e,t,n,r[4]];if(u<0){var s=qr(e,t,o);return o===s?r:Rr(s,a,i,n)}var c=qr(e,t,n);return n===c?r:Rr(o,a,i,c)}function Er(e){for(;;){if(!e)throw E;var t=e[0];if(!t)return[e[1],e[2]];e=t}}function Fr(e){for(;;){if(!e)return;var t=e[0];if(!t)return[e[1],e[2]];e=t}}function Mr(e){if(e){var t=e[0];return t?Rr(Mr(t),e[1],e[2],e[3]):e[3]}throw[q,"Map.remove_min_elt"]}function Ir(e,t){if(!e)return t;if(!t)return e;var r=Er(t);return Rr(e,r[0],r[1],Mr(t))}function Dr(e,t,r,n){if(!e)return function e(t,r,n){return n?Rr(e(t,r,n[0]),n[1],n[2],n[3]):Pr(t,r)}(t,r,n);if(!n)return function e(t,r,n){return n?Rr(n[0],n[1],n[2],e(t,r,n[3])):Pr(t,r)}(t,r,e);var i=n[4],a=e[4];return(i+2|0)<a?Rr(e[0],e[1],e[2],Dr(e[3],t,r,n)):(a+2|0)<i?Rr(Dr(e,t,r,n[0]),n[1],n[2],n[3]):Tr(e,t,r,n)}function Cr(e,t){if(!e)return t;if(!t)return e;var r=Er(t);return Dr(e,r[0],r[1],Mr(t))}function Wr(e,t,r,n){return void 0!==r?Dr(e,t,ue(r),n):Cr(e,n)}function Zr(e,t){if(!t)return[0,void 0,0];var r=t[3],n=t[2],i=t[1],a=t[0],o=v(e,i);if(0===o)return[a,oe(n),r];if(o<0){var u=Zr(e,a);return[u[0],u[1],Dr(u[2],i,n,r)]}var s=Zr(e,r);return[Dr(a,i,n,s[0]),s[1],s[2]]}function zr(e,t){for(;;){if(!e)return t;t=[e[1],e[2],e[3],t],e=e[0]}}var Qr={empty:0,is_empty:function(e){return!e},mem:function(e,t){for(;;){if(!t)return!1;var r=v(e,t[1]);if(0===r)return!0;t=r<0?t[0]:t[3]}},add:qr,update:function e(t,r,n){if(n){var i=n[3],a=n[2],o=n[1],u=n[0],s=v(t,o);if(0===s){var c=de(r,oe(a));if(void 0===c)return Ir(u,i);var f=ue(c);return a===f?n:[u,t,f,i,n[4]]}if(s<0){var l=e(t,r,u);return u===l?n:Rr(l,o,a,i)}var d=e(t,r,i);return i===d?n:Rr(u,o,a,d)}var h=de(r,void 0);return void 0!==h?[0,t,ue(h),0,1]:0},singleton:Pr,remove:function e(t,r){if(!r)return 0;var n=r[3],i=r[2],a=r[1],o=r[0],u=v(t,a);if(0===u)return Ir(o,n);if(u<0){var s=e(t,o);return o===s?r:Rr(s,a,i,n)}var c=e(t,n);return n===c?r:Rr(o,a,i,c)},merge:function e(t,r,n){if(r){var i=r[1];if(r[4]>=Lr(n)){var a=Zr(i,n);return Wr(e(t,r[0],a[0]),i,I(t,i,oe(r[2]),a[1]),e(t,r[3],a[2]))}}else if(!n)return 0;if(n){var o=n[1],u=Zr(o,r);return Wr(e(t,u[0],n[0]),o,I(t,o,u[1],oe(n[2])),e(t,u[2],n[3]))}throw[F,["map.ml",393,10]]},union:function e(t,r,n){if(!r)return n;if(!n)return r;var i=n[2],a=n[1],o=r[2],u=r[1];if(r[4]>=n[4]){var s=Zr(u,n),c=s[1],f=e(t,r[0],s[0]),l=e(t,r[3],s[2]);return void 0!==c?Wr(f,u,I(t,u,o,ue(c)),l):Dr(f,u,o,l)}var d=Zr(a,r),h=d[1],v=e(t,d[0],n[0]),p=e(t,d[2],n[3]);return void 0!==h?Wr(v,a,I(t,a,ue(h),i),p):Dr(v,a,i,p)},compare:function(e,t,r){for(var n=zr(t,0),i=zr(r,0);;){var a=i,o=n;if(!o)return a?-1:0;if(!a)return 1;var u=v(o[0],a[0]);if(0!==u)return u;var s=M(e,o[1],a[1]);if(0!==s)return s;i=zr(a[2],a[3]),n=zr(o[2],o[3])}},equal:function(e,t,r){for(var n=zr(t,0),i=zr(r,0);;){var a=i,o=n;if(!o)return!a;if(!a)return!1;if(0!==v(o[0],a[0]))return!1;if(!M(e,o[1],a[1]))return!1;i=zr(a[2],a[3]),n=zr(o[2],o[3])}},iter:function e(t,r){for(;;){var n=r;if(!n)return;e(t,n[0]),M(t,n[1],n[2]),r=n[3]}},fold:function e(t,r,n){for(;;){var i=r;if(!i)return n;n=I(t,i[1],i[2],e(t,i[0],n)),r=i[3]}},for_all:function e(t,r){for(;;){var n=r;if(!n)return!0;if(!M(t,n[1],n[2]))return!1;if(!e(t,n[0]))return!1;r=n[3]}},exists:function e(t,r){for(;;){var n=r;if(!n)return!1;if(M(t,n[1],n[2]))return!0;if(e(t,n[0]))return!0;r=n[3]}},filter:function e(t,r){if(!r)return 0;var n=r[3],i=r[2],a=r[1],o=r[0],u=e(t,o),s=M(t,a,i),c=e(t,n);return s?o===u&&n===c?r:Dr(u,a,i,c):Cr(u,c)},partition:function e(t,r){if(!r)return[0,0];var n=r[2],i=r[1],a=e(t,r[0]),o=a[1],u=a[0],s=M(t,i,n),c=e(t,r[3]),f=c[1],l=c[0];return s?[Dr(u,i,n,l),Cr(o,f)]:[Cr(u,l),Dr(o,i,n,f)]},cardinal:function e(t){return t?(e(t[0])+1|0)+e(t[3])|0:0},bindings:function(e){return function e(t,r){for(;;){var n=r;if(!n)return t;r=n[0],t=[[n[1],n[2]],e(t,n[3])]}}(0,e)},min_binding:Er,min_binding_opt:Fr,max_binding:function(e){for(;;){if(!e)throw E;var t=e[3];if(!t)return[e[1],e[2]];e=t}},max_binding_opt:function(e){for(;;){if(!e)return;var t=e[3];if(!t)return[e[1],e[2]];e=t}},choose:Er,choose_opt:Fr,split:Zr,find:function(e,t){for(;;){if(!t)throw E;var r=v(e,t[1]);if(0===r)return t[2];t=r<0?t[0]:t[3]}},find_opt:function(e,t){for(;;){var r=t;if(!r)return;var n=v(e,r[1]);if(0===n)return oe(r[2]);t=n<0?r[0]:r[3]}},find_first:function(e,t){for(;;){var r=t;if(!r)throw E;var n=r[1];if(de(e,n))for(var i=n,a=r[2],o=r[0];;){var u=o;if(!u)return[i,a];var s=u[1];de(e,s)?(o=u[0],a=u[2],i=s):o=u[3]}t=r[3]}},find_first_opt:function(e,t){for(;;){var r=t;if(!r)return;var n=r[1];if(de(e,n))for(var i=n,a=r[2],o=r[0];;){var u=o;if(!u)return[i,a];var s=u[1];de(e,s)?(o=u[0],a=u[2],i=s):o=u[3]}t=r[3]}},find_last:function(e,t){for(;;){var r=t;if(!r)throw E;var n=r[1];if(de(e,n))for(var i=n,a=r[2],o=r[3];;){var u=o;if(!u)return[i,a];var s=u[1];de(e,s)?(o=u[3],a=u[2],i=s):o=u[0]}t=r[0]}},find_last_opt:function(e,t){for(;;){var r=t;if(!r)return;var n=r[1];if(de(e,n))for(var i=n,a=r[2],o=r[3];;){var u=o;if(!u)return[i,a];var s=u[1];de(e,s)?(o=u[3],a=u[2],i=s):o=u[0]}t=r[0]}},map:function e(t,r){if(!r)return 0;var n=e(t,r[0]),i=de(t,r[2]),a=e(t,r[3]);return[n,r[1],i,a,r[4]]},mapi:function e(t,r){if(!r)return 0;var n=r[1];return[e(t,r[0]),n,M(t,n,r[2]),e(t,r[3]),r[4]]}},Hr=ie("Tea_json.Decoder.ParseFail");function Jr(r){return[function(e){var t=xr(e);return"number"==typeof t&&2<=t?ee(0,[r]):ee(1,["Non-null value"])}]}function $r(i,e){var a=e[0];return[function(e){var t=xr(e);if("number"==typeof t)return ee(1,["Non-fieldable value"]);if(2!==t.tag)return ee(1,["Non-fieldable value"]);var r=Sr(t[0],i);if(void 0===r)return ee(1,["Field Value is undefined: "+i]);var n=de(a,ue(r));return n.tag?ee(1,["field `"+i+("` -> "+n[0])]):n}]}function Br(t){return[function(e){var a=function(e,t){for(;;){var r=t;if(!r)return ee(1,["No one-of's matched"]);var n=r[1];try{var i=de(r[0][0],e);return i.tag?a(e,n):i}catch(e){t=n;continue}}};return a(e,t)}]}function Vr(r,e){var n=e[0];return[function(e){var t=de(n,e);return t.tag?ee(1,["map "+t[0]]):ee(0,[de(r,t[0])])}]}function Ur(n,e){var i=e[0];return[function(e){var t=de(i,e);if(t.tag)return t;var r=de(n,t[0]);return de(r[0],e)}]}function Gr(e,t){try{return de(e[0],t)}catch(e){var r=ce(e);return r[0]===Hr?ee(1,[r[1]]):ee(1,["Unknown JSON parsing error"])}}var jr={ObjectDict:Qr,ParseFail:Hr,string:[function(e){var t=xr(e);return"number"==typeof t||t.tag?ee(1,["Non-string value"]):ee(0,[t[0]])}],$$int:[function(e){var t=xr(e);if("number"==typeof t)return ee(1,["Non-int value"]);if(1!==t.tag)return ee(1,["Non-int value"]);var r=t[0];return-2147483648<r&&r<2147483647?ee(0,[0|r]):ee(1,["number out of int range"])}],$$float:[function(e){var t=xr(e);return"number"==typeof t||1!==t.tag?ee(1,["Non-float-value"]):ee(0,[t[0]])}],bool:[function(e){var t=xr(e);if("number"!=typeof t)return ee(1,["Non-boolean value"]);switch(t){case 0:return ee(0,[!1]);case 1:return ee(0,[!0]);case 2:return ee(1,["Non-boolean value"])}}],$$null:Jr,list:function(e){var n=e[0];return[function(e){var t=xr(e);if("number"==typeof t)return ee(1,["Non-list value"]);if(3!==t.tag)return ee(1,["Non-list value"]);try{return ee(0,[ye(function(e){var t=de(n,e);if(!t.tag)return t[0];throw[Hr,t[0]]},function(e){for(var t=e.length-1|0,r=0;;){if(t<0)return r;r=[e[t],r],t=t-1|0}}(t[0]))])}catch(e){var r=ce(e);if(r[0]===Hr)return ee(1,["list -> "+r[1]]);throw r}}]},array:function(e){var n=e[0];return[function(e){var t=xr(e);if("number"==typeof t)return ee(1,["Non-array value"]);if(3!==t.tag)return ee(1,["Non-array value"]);try{return ee(0,[kr(function(e){var t=de(n,e);if(!t.tag)return t[0];throw[Hr,t[0]]},t[0])])}catch(e){var r=ce(e);if(r[0]===Hr)return ee(1,["array -> "+r[1]]);throw r}}]},keyValuePairs:function(e){var a=e[0];return[function(e){var t=xr(e);if("number"==typeof t)return ee(1,["Non-keyValuePair value"]);if(2!==t.tag)return ee(1,["Non-keyValuePair value"]);var i=t[0],r=Object.keys(i);try{return ee(0,[Ar(function(e,t){var r=Sr(i,e);if(void 0===r)throw[Hr,"Key is undefined: "+e];var n=de(a,ue(r));if(!n.tag)return[[e,n[0]],t];throw[Hr,n[0]]},r,0)])}catch(e){var n=ce(e);if(n[0]===Hr)return ee(1,["Invalid keyValuePair parsing: "+n[1]]);throw n}}]},dict:function(e){var a=e[0];return[function(e){var t=xr(e);if("number"==typeof t)return ee(1,["Non-dict value"]);if(2!==t.tag)return ee(1,["Non-dict value"]);var i=t[0],r=Object.keys(i);try{return ee(0,[Ar(function(e,t){var r=Sr(i,e);if(void 0===r)throw[Hr,"Key is undefined: "+e];var n=de(a,ue(r));if(!n.tag)return qr(e,n[0],t);throw[Hr,n[0]]},r,0)])}catch(e){var n=ce(e);if(n[0]===Hr)return ee(1,["Invalid dict parsing: "+n[1]]);throw n}}]},field:$r,at:function(e,t){return function e(t,r,n){return r?M(t,r[0],e(t,r[1],n)):n}($r,e,t)},index:function(n,e){var i=e[0];return[function(e){var t=xr(e);if("number"==typeof t)return ee(1,["Non-array value"]);if(3!==t.tag)return ee(1,["Non-array value"]);var r=t[0];return n<0||n>r.length?ee(1,["Array index out of range: "+String(n)]):de(i,le(r,n))}]},maybe:function(e){var r=e[0];return[function(e){var t=de(r,e);return t.tag?ee(0,[void 0]):ee(0,[oe(t[0])])}]},oneOf:Br,map:Vr,map2:function(i,e,t){var a=t[0],o=e[0];return[function(e){var t=de(o,e),r=de(a,e);if(!t.tag&&!r.tag)return ee(0,[M(i,t[0],r[0])]);var n=Nr(t,r);if(void 0!==n)return ee(1,["map2 -> "+n]);throw[w,"Impossible case"]}]},map3:function(a,e,t,r){var o=r[0],u=t[0],s=e[0];return[function(e){var t=de(s,e),r=de(u,e),n=de(o,e);if(!t.tag&&!r.tag&&!n.tag)return ee(0,[I(a,t[0],r[0],n[0])]);var i=Or(n,Or(r,t));if(i.tag)return ee(1,["map3 -> "+i[0]]);throw[w,"Impossible case"]}]},map4:function(o,e,t,r,n){var u=n[0],s=r[0],c=t[0],f=e[0];return[function(e){var t=de(f,e),r=de(c,e),n=de(s,e),i=de(u,e);if(!(t.tag||r.tag||n.tag||i.tag))return ee(0,[function(n,i,a,o,u){var e=n.length;if(4===e)return n(i,a,o,u);switch(e){case 1:return y(n(i),[a,o,u]);case 2:return y(n(i,a),[o,u]);case 3:return y(n(i,a,o),[u]);case 4:return n(i,a,o,u);case 5:return function(e){return n(i,a,o,u,e)};case 6:return function(e,t){return n(i,a,o,u,e,t)};case 7:return function(e,t,r){return n(i,a,o,u,e,t,r)};default:return y(n,[i,a,o,u])}}(o,t[0],r[0],n[0],i[0])]);var a=Or(i,Or(n,Or(r,t)));if(a.tag)return ee(1,["map4 -> "+a[0]]);throw[w,"Impossible case"]}]},map5:function(u,e,t,r,n,i){var s=i[0],c=n[0],f=r[0],l=t[0],d=e[0];return[function(e){var t=de(d,e),r=de(l,e),n=de(f,e),i=de(c,e),a=de(s,e);if(!(t.tag||r.tag||n.tag||i.tag||a.tag))return ee(0,[function(r,n,i,a,o,u){var e=r.length;if(5===e)return r(n,i,a,o,u);switch(e){case 1:return y(r(n),[i,a,o,u]);case 2:return y(r(n,i),[a,o,u]);case 3:return y(r(n,i,a),[o,u]);case 4:return y(r(n,i,a,o),[u]);case 5:return r(n,i,a,o,u);case 6:return function(e){return r(n,i,a,o,u,e)};case 7:return function(e,t){return r(n,i,a,o,u,e,t)};default:return y(r,[n,i,a,o,u])}}(u,t[0],r[0],n[0],i[0],a[0])]);var o=Or(a,Or(i,Or(n,Or(r,t))));if(o.tag)return ee(1,["map5 -> "+o[0]]);throw[w,"Impossible case"]}]},map6:function(s,e,t,r,n,i,a){var c=a[0],f=i[0],l=n[0],d=r[0],h=t[0],v=e[0];return[function(e){var t=de(v,e),r=de(h,e),n=de(d,e),i=de(l,e),a=de(f,e),o=de(c,e);if(!(t.tag||r.tag||n.tag||i.tag||a.tag||o.tag))return ee(0,[function(t,r,n,i,a,o,u){var e=t.length;if(6===e)return t(r,n,i,a,o,u);switch(e){case 1:return y(t(r),[n,i,a,o,u]);case 2:return y(t(r,n),[i,a,o,u]);case 3:return y(t(r,n,i),[a,o,u]);case 4:return y(t(r,n,i,a),[o,u]);case 5:return y(t(r,n,i,a,o),[u]);case 6:return t(r,n,i,a,o,u);case 7:return function(e){return t(r,n,i,a,o,u,e)};default:return y(t,[r,n,i,a,o,u])}}(s,t[0],r[0],n[0],i[0],a[0],o[0])]);var u=Or(o,Or(a,Or(i,Or(n,Or(r,t)))));if(u.tag)return ee(1,["map6 -> "+u[0]]);throw[w,"Impossible case"]}]},map7:function(c,e,t,r,n,i,a,o){var f=o[0],l=a[0],d=i[0],h=n[0],v=r[0],p=t[0],m=e[0];return[function(e){var t=de(m,e),r=de(p,e),n=de(v,e),i=de(h,e),a=de(d,e),o=de(l,e),u=de(f,e);if(!(t.tag||r.tag||n.tag||i.tag||a.tag||o.tag||u.tag))return ee(0,[function(e,t,r,n,i,a,o,u){var s=e.length;if(7===s)return e(t,r,n,i,a,o,u);switch(s){case 1:return y(e(t),[r,n,i,a,o,u]);case 2:return y(e(t,r),[n,i,a,o,u]);case 3:return y(e(t,r,n),[i,a,o,u]);case 4:return y(e(t,r,n,i),[a,o,u]);case 5:return y(e(t,r,n,i,a),[o,u]);case 6:return y(e(t,r,n,i,a,o),[u]);case 7:return e(t,r,n,i,a,o,u);default:return y(e,[t,r,n,i,a,o,u])}}(c,t[0],r[0],n[0],i[0],a[0],o[0],u[0])]);var s=Or(u,Or(o,Or(a,Or(i,Or(n,Or(r,t))))));if(s.tag)return ee(1,["map7 -> "+s[0]]);throw[w,"Impossible case"]}]},map8:function(f,e,t,r,n,i,a,o,u){var l=u[0],d=o[0],h=a[0],v=i[0],p=n[0],m=r[0],g=t[0],b=e[0];return[function(e){var t=de(b,e),r=de(g,e),n=de(m,e),i=de(p,e),a=de(v,e),o=de(h,e),u=de(d,e),s=de(l,e);if(!(t.tag||r.tag||n.tag||i.tag||a.tag||o.tag||u.tag||s.tag))return ee(0,[function(e,t,r,n,i,a,o,u,s){var c=e.length;if(8===c)return e(t,r,n,i,a,o,u,s);switch(c){case 1:return y(e(t),[r,n,i,a,o,u,s]);case 2:return y(e(t,r),[n,i,a,o,u,s]);case 3:return y(e(t,r,n),[i,a,o,u,s]);case 4:return y(e(t,r,n,i),[a,o,u,s]);case 5:return y(e(t,r,n,i,a),[o,u,s]);case 6:return y(e(t,r,n,i,a,o),[u,s]);case 7:return y(e(t,r,n,i,a,o,u),[s]);default:return y(e,[t,r,n,i,a,o,u,s])}}(f,t[0],r[0],n[0],i[0],a[0],o[0],u[0],s[0])]);var c=Or(s,Or(u,Or(o,Or(a,Or(i,Or(n,Or(r,t)))))));if(c.tag)return ee(1,["map8 -> "+c[0]]);throw[w,"Impossible case"]}]},succeed:function(t){return[function(e){return ee(0,[t])}]},fail:function(t){return[function(e){return ee(1,[t])}]},value:[function(e){return ee(0,[e])}],andThen:Ur,lazy_:function(e){return Ur(e,[function(e){return ee(0,[void 0])}])},nullable:function(e){return Br([Jr(void 0),[Vr(oe,e),0]])},decodeValue:Gr,decodeEvent:function(e,t){try{return de(e[0],t)}catch(e){var r=ce(e);return r[0]===Hr?ee(1,[r[1]]):ee(1,["Unknown JSON parsing error"])}},decodeString:function(e,t){try{return Gr(e,JSON.parse(t))}catch(e){return ee(1,["Invalid JSON string"])}}};function Xr(e){return ee(1,[e])}function Yr(e,t,r,n){return Ue("","div",void 0!==e?e:"",void 0!==t?t:"",r,n)}function Kr(e,t,r,n){return Ue("","span",void 0!==e?e:"",void 0!==t?t:"",r,n)}function en(e,t,r,n){return Ue("","p",void 0!==e?e:"",void 0!==t?t:"",r,n)}function tn(e,t,r,n){return Ue("","a",void 0!==e?e:"",void 0!==t?t:"",r,n)}function rn(e,t,r,n){return Ue("","h3",void 0!==e?e:"",void 0!==t?t:"",r,n)}function nn(e,t,r,n){return Ue("","button",void 0!==e?e:"",void 0!==t?t:"",r,n)}function an(e,t,r,n){return Ue("","textarea",void 0!==e?e:"",void 0!==t?t:"",r,n)}function on(e,t,r,n){return Ue("","label",void 0!==e?e:"",void 0!==t?t:"",r,n)}function un(e,t,r,n){return Ue("","ul",void 0!==e?e:"",void 0!==t?t:"",r,n)}function sn(e,t,r,n){return Ue("","li",void 0!==e?e:"",void 0!==t?t:"",r,n)}function cn(e,t,r,n){return Ue("","option",void 0!==e?e:"",void 0!==t?t:"",r,n)}function fn(e,t,r,n){return Ue("","hr",void 0!==e?e:"",void 0!==t?t:"",r,n)}function ln(e){return ee(0,["className",e])}function dn(e){return ee(0,["className",Ce(" ",ye(function(e){return e[0]},xe(function(e){return e[1]})(e)))])}var hn=function(e,t){return ee(4,[[[e,t],0]])};function vn(e){return ee(0,["placeholder",e])}function pn(e){return ee(0,["value",e])}var mn=je;function gn(e,t){var r,n;return n=function(e){return oe(de(t,e))},je("input",void 0!==(r=void 0!==e?e:"")?r:"",function(e){var t=e.target;if(void 0!==t){var r=t.value;return void 0!==r?de(n,r):void 0}})}function bn(e,t){var r,n;return n=function(e){return oe(de(t,e))},je("change",void 0!==(r=void 0!==e?e:"")?r:"",function(e){var t=e.target;if(void 0!==t){var r=t.value;return void 0!==r?de(n,r):void 0}})}function wn(e){return ee(3,["click",ee(1,[e]),{contents:void 0}])}var yn={stopPropagation:!1,preventDefault:!1},_n=(jr.at(["target",["value",0]],jr.string),jr.at(["target",["checked",0]],jr.bool),jr.field("keyCode",jr.$$int));var kn={max:function(e){return ee(1,["","max",e])},min:function(e){return ee(1,["","min",e])},step:function(e){return ee(1,["","step",e])},disabled:function(e){return e?ee(1,["","disabled","true"]):0},selected:function(e){return e?ee(1,["","selected","true"]):0},acceptCharset:function(e){return ee(1,["","accept-charset",e])},rel:function(e){return ee(1,["","rel",e])}},An=Ve,Sn=0,xn=246,On=250,Nn=ie("CamlinternalLazy.Undefined");function Ln(e){throw Nn}function Tn(e){var t=0|e.tag;return t===On?e[0]:t!==xn?e:function(e){var t,r=e[0];e[0]=Ln;try{var n=de(r,void 0);return e[0]=n,t=On,e.tag=t,n}catch(t){throw e[0]=function(e){throw t},t}}(e)}function Pn(e,t){return Se(ye(t,e))}var Rn={take:function(e,t){var r=function(e,t,r){for(;;){var n=t;if(0===r)return[e,n];if(!n)return[e,0];r=r-1|0,t=n[1],e=[n[0],e]}}(0,t,e);return[be(r[0]),r[1]]},apply:function(e,t){return de(t,e)},bind:Pn,concat_map:function(e,t){return Se(ye(e,t))},$great$great$eq:Pn,next_or_this_item:function(e,t){for(var r=t;;){if(!r)return e;var n=r[1];if(m(e,r[0]))return n?n[0]:e;r=n}},count:function(e,t){for(var r=0,n=t;;){var i=r;if(!n)return i;var a=n[1];de(e,n[0])?(n=a,r=i+1|0):n=a}},list_from_option:function(e){return void 0!==e?[ue(e),0]:0},first_inconsistent_opt:function(e,t){if(e)for(var r=de(t,e[0]),n=e[1];;){var i=n,a=r;if(!i)return;var o=de(t,i[0]);if(!m(o,a))return[a,o];n=i[1],r=o}}};function qn(e,t,r){return mn(e,t,function(e){return yn.stopPropagation&&e.stopPropagation(),yn.preventDefault&&e.preventDefault(),(t=jr.decodeEvent(r,e)).tag?void 0:oe(t[0]);var t})}var En={keydown:function(e,t,r){var n=jr.field("ctrlKey",jr.bool),i=jr.map2(function(e,t){return{ctrlKey:t,keyCode:e}},_n,n);return qn("keydown",e,jr.andThen(function(e){return de(r,e)?jr.succeed(t):jr.fail("Incorrect keys")},i))}},Fn={on_keyed:qn,Keydown:En};function Mn(e,t){return t.tag?t:ee(0,[de(e,t[0])])}function In(e){return e.tag?e:e[0]}function Dn(e,t){return In(Mn(t,e))}var Cn={map:Mn,map_error:function(e,t){return t.tag?ee(1,[de(e,t[0])]):t},flatten:In,flat_map:function(e,t){return In(Mn(e,t))},bind:Dn,$great$great$eq:Dn};function Wn(e){return[e,0]}function Zn(t,e){if(!e)return 0;var r=e[1];return[de(t,e[0]),a(function(e){return Zn(t,Tn(r))})]}function zn(e,t){if(!e)return Tn(t);var r=e[1];return[e[0],a(function(e){return zn(Tn(t),r)})]}function Qn(e){if(!e)return 0;var t=e[1];return zn(e[0],a(function(e){return Qn(Tn(t))}))}function Hn(e,t){return Qn(Zn(t,e))}var Jn={$$return:Wn,unit:Wn,push:function(e,t){return[e,t]},zip:function t(e,r){if(!e)return 0;if(!r)return 0;var n=r[1],i=e[1];return[[e[0],r[0]],a(function(e){return t(Tn(i),Tn(n))})]},numbers_from:function t(r){return[r,a(function(e){return t(r+1|0)})]},map:Zn,filter:function r(n,e){for(;;){if(!e)return 0;var t=e[1],i=e[0];if(de(n,i))return[i,a(function(t){return function(e){return r(n,Tn(t))}}(t))];e=Tn(t)}},interleave_delayed:zn,append_delayed:function t(e,r){if(!e)return Tn(r);var n=e[1];return[e[0],a(function(e){return t(Tn(n),r)})]},flatten:Qn,bind:Hn,$great$great$eq:Hn,from_list:function t(e){if(!e)return 0;var r=e[1];return[e[0],a(function(e){return t(r)})]},from_option:function(e){return void 0!==e?[ue(e),0]:0}};function $n(e,t){return[M(Ht([ee(2,[0,ee(11,["__Renamed",ee(4,[0,0,0,0])])]),"%s__Renamed%d"]),e[0],t)]}function Bn(e){return de(Ht([ee(12,[63,ee(2,[0,0])]),"?%s"]),e[0])}var Vn={compare:function(e,t){return v(e[0],t[0])},make:function(e){return[e]},make_numbered:$n,to_string:Bn};function Un(e,t){return v(e[0],t[0])}function Gn(e,t){return e[0]===t[0]}var jn={make:function(e){return[e]},compare:Un,equals:Gn,to_string:function(e){return e[0]}};function Xn(e){if(!e.tag)return Bn(e[0]);var t=e[0],r=t.related_terms,n=t.relation_name[0];return r?M(Ht([ee(2,[0,ee(12,[40,ee(2,[0,ee(12,[41,0])])])]),"%s(%s)"]),n,Ce(", ",ye(Xn,r))):n}function Yn(e){if(!e.tag)return 0;var t=e[0],r=t.related_terms;return[[t.relation_name,me(r)],Rn.concat_map(Yn,r)]}var Kn={make_relation:function(e,t){return ee(1,[{relation_name:[e],related_terms:t}])},make_variable:function(e){return ee(0,[[e]])},to_string:Xn,relation_arities:Yn,count_sub_terms:function e(t){return t.tag?1+ke(function(e,t){return e+t|0},0,ye(e,t[0].related_terms))|0:1}};function ei(e){switch(0|e.tag){case 0:return Xn(e[0]);case 1:return M(Ht([ee(12,[60,ee(2,[0,ee(11,[" = ",ee(2,[0,ee(12,[62,0])])])])]),"<%s = %s>"]),Xn(e[0]),Xn(e[1]));case 2:return M(Ht([ee(12,[60,ee(2,[0,ee(11,[" /= ",ee(2,[0,ee(12,[62,0])])])])]),"<%s /= %s>"]),Xn(e[0]),Xn(e[1]))}}function ti(e){switch(0|e.tag){case 0:return Yn(e[0])}return Se([Yn(e[0]),[Yn(e[1]),0]])}var ri={to_string:ei,relation_arities:ti};function ni(e){return Ce("\n\tand ",ye(ei,e))}var ii={empty:0,to_string:ni},ai=_r(Vn),oi=ai.empty;function ui(e,t){return I(ai.add,e[0],e[1],t)}function si(e,t){var r=M(ai.find_opt,e,t);if(void 0!==r){if(r.tag)return r;var n=si(r[0],t);return void 0!==n?n:r}}function ci(e,r){function n(e){var t=si(e,r);return void 0!==t?i(t):ee(0,[["?"]])}var i=function(e){if(!e.tag)return n(e[0]);var t=e[0];return ee(1,[{relation_name:t.relation_name,related_terms:ye(i,t.related_terms)}])},a=function(e,t){if(t.tag)return ke(a,e,t[0].related_terms);var r=t[0];return ui([r,n(r)],e)};return de(ai.bindings,ke(function(e,t){switch(0|t.tag){case 0:return a(e,t[0])}return a(a(e,t[0]),t[1])},oi,e))}function fi(e,i,a){var o=function(e){for(;;){var t=e;if(t.tag)return function(e,t){for(;;){var r=t;if(!r)return!1;if(de(e,r[0]))return!0;t=r[1]}}(o,t[0].related_terms);var r=t[0];if(m(r,i))return!0;var n=si(r,a);if(void 0===n)return!1;e=n}};return o(e)}var li={FrameMap:ai,empty:oi,extend:ui,to_all_bindings:function(e){return ye(function(e){return M(Ht([ee(2,[0,ee(11,[" := ",ee(2,[0,0])])]),"%s := %s"]),Bn(e[0]),Xn(e[1]))},de(ai.bindings,e))},lookup:si,instantiate:function(n){var i=function(e){if(!e.tag){var t=si(e[0],n);return void 0!==t?i(t):ee(0,[["?"]])}var r=e[0];return ee(1,[{relation_name:r.relation_name,related_terms:ye(i,r.related_terms)}])};return i},variable_bindings_in_query:ci,to_strings:function(e,t){var r=ci(e,t);return r?ye(function(e){return M(Ht([ee(2,[0,ee(11,[" := ",ee(2,[0,0])])]),"%s := %s"]),Bn(e[0]),Xn(e[1]))},r):0},term_depends_on_variable:fi};function di(e){return Se([we(ye(ti,e.antecedents)),[Yn(e.consequent),0]])}var hi={contents:1};function vi(e){if(!e.tag)return ee(0,[$n(e[0],hi.contents)]);var t=e[0],r=ye(vi,t.related_terms);return ee(1,[{relation_name:t.relation_name,related_terms:r}])}function pi(e){switch(0|e.tag){case 0:return ee(0,[vi(e[0])]);case 1:return ee(1,[vi(e[0]),vi(e[1])]);case 2:return ee(2,[vi(e[0]),vi(e[1])])}}function mi(e){return hi.contents=hi.contents+1|0,{antecedents:ye(pi,e.antecedents),consequent:vi(e.consequent)}}var gi={to_string:function(e){var t,r,n=e.antecedents,i=Xn(e.consequent);return r=n?(t=ni(n),M(Ht([ee(2,[0,ee(11,["\n\twhen ",ee(2,[0,0])])]),"%s\n\twhen %s"]),i,t)):i,de(Ht([ee(2,[0,ee(12,[46,0])]),"%s."]),r)},relation_arities:di,rename_rule_variables:mi},bi=_r({compare:ze});function wi(e){return e.rule}function yi(e,t){return e.id===t.id}var _i={all_rules:0,indexed_by_consequent_relation:bi.empty};function ki(e,t){var r,n;return n=t.tag?void 0!==(r=M(bi.find_opt,t[0].relation_name[0],e.indexed_by_consequent_relation))?r:0:e.all_rules,Jn.from_list(be(n))}function Ai(e){return be(e.all_rules)}var Si={contents:1};function xi(e,t){var r={id:(Si.contents=Si.contents+1|0,Si.contents),rule:t},n=t.consequent;return n.tag?{all_rules:[r,e.all_rules],indexed_by_consequent_relation:I(bi.update,n[0].relation_name[0],function(e){return void 0!==e?[r,e]:[r,0]},e.indexed_by_consequent_relation)}:{all_rules:[r,e.all_rules],indexed_by_consequent_relation:e.indexed_by_consequent_relation}}var Oi,Ni={VariableName:Vn,RelationName:jn,Term:Kn,ComplexTerm:ri,Query:ii,Frame:li,Rule:gi,RuleDatabase:{empty:_i,rule_from_entry:wi,identifier_of_rule_entry:function(e){return de(Ht([ee(4,[0,0,0,0]),"%d"]),e.id)},update_rule_entry:function(e,t){return{id:e.id,rule:t}},is_same:yi,remove_rule:function(e,t){var r=t.id,n=xe(function(e){return e.id!==r}),i=de(n,e.all_rules),a=t.rule.consequent;return a.tag?{all_rules:i,indexed_by_consequent_relation:I(bi.update,a[0].relation_name[0],function(e){return void 0!==e?de(n,e):0},e.indexed_by_consequent_relation)}:{all_rules:i,indexed_by_consequent_relation:e.indexed_by_consequent_relation}},add_rule:xi,update_rule:function(e,t){function r(e){return ye(function(e){return e.id===t.id?t:e},e)}var n=r(e.all_rules),i=t.rule.consequent;return i.tag?{all_rules:n,indexed_by_consequent_relation:I(bi.update,i[0].relation_name[0],function(e){return void 0!==e?r(e):[t,0]},e.indexed_by_consequent_relation)}:{all_rules:n,indexed_by_consequent_relation:e.indexed_by_consequent_relation}},fetch_for_query:ki,all_rules:Ai}},Li={$$Map:Oi=_r({compare:Un}),make:function(r,e){return ke(function(e,t){return I(Oi.update,de(r,t),function(e){return void 0!==e?[t,e]:[t,0]},e)},Oi.empty,e)},keys:function(e){return ye(function(e){return e[0]},de(Oi.bindings,e))},find_opt:function(e,t){return M(Oi.find_opt,e,t)}};function Ti(i,e){return ke(function(e,t){var r=de(i,t);if(void 0===r)return e;var n=Rn.first_inconsistent_opt(r,function(e){return e[1]});return void 0!==n?[I(Ht([ee(11,["Relation '",ee(2,[0,ee(11,["' has inconsistent number of terms applied of ",ee(4,[0,0,0,ee(11,[" and ",ee(4,[0,0,0,0])])])])])]),"Relation '%s' has inconsistent number of terms applied of %d and %d"]),t[0],n[0],n[1]),e]:e},0,e)}function Pi(e){return M(Li.make,function(e){return e[0]},Rn.concat_map(di,e))}function Ri(e){return de(Li.keys,M(Li.make,function(e){return e[0]},di(e)))}function qi(e,t){var r=Pi([t,ye(wi,e)]);return Ti(function(e){return M(Li.find_opt,e,r)},Ri(t))}var Ei={rule_database_snapshot:Ai,issues_in_existing_rule:function(e,t){var r=Pi(ye(wi,[t,xe(function(e){return!yi(e,t)})(e)]));return Ti(function(e){return M(Li.find_opt,e,r)},Ri(wi(t)))},issues_in_new_rule:qi,issues_in_query:function(e,t){var r=Rn.concat_map(ti,t),n=M(Li.make,function(e){return e[0]},Se([r,[Rn.concat_map(di,ye(wi,e)),0]]));return Ti(function(e){return M(Li.find_opt,e,n)},de(Li.keys,M(Li.make,function(e){return e[0]},r)))}};function Fi(e){function t(e){return br(dr,n,e)}function r(e){return Gt(i,t,e)}var n=nr(95),i=de(Ht([ee(2,[0,ee(11,[" requires ",ee(2,[0,0])])]),"%s requires %s"]),e);return function(e){return gr(r,function(t){return Xt(function(e){return Ce("",ye(function(e){return Ie(1,e)},[t,e]))},er(Kt([dr,[fr,[nr(95),[nr(45),0]]]])))},e)}}var Mi=wr(nr(63),Xt(function(e){return ee(0,[[e]])},Fi("Variable")));function Ii(e){return jt("Variable starting with ?",Mi,e)}var Di=wr(vr("= "),function(e){return Ut(!0,e)}),Ci=wr(vr("/= "),function(e){return Ut(!1,e)});function Wi(e){return br(Di,Ci,e)}function Zi(e){return tr(e,wr(wr(hr,vr("and")),hr))}function zi(e){return gr(yr(Fi("Relation"),hr),function(e){var t=[e],r=ee(1,[{relation_name:t,related_terms:0}]),n=yr(nr(40),hr);return function(e){return Vt(n,function(e){return Xt(function(e){return ee(1,[{relation_name:t,related_terms:e}])},yr(yr(Ji,hr),nr(41)))},r,e)}},e)}function Qi(e){return gr(wr(nr(60),Hi),function(n){return function(e){return gr(Wi,function(r){var t=yr(Hi,nr(62));return function(e){return gr(t,function(e){var t=ee(r?1:2,[n,e]);return function(e){return Ut(t,e)}},e)}},e)}},e)}function Hi(e){return br(Ii,zi,e)}function Ji(e){return tr(yr(Hi,hr),wr(nr(44),hr))(e)}function $i(e){return br(Xt(function(e){return ee(0,[e])},Hi),Qi,e)}function Bi(e){return Zi($i)(e)}function Vi(e){return yr(function(e){return gr(Hi,function(t){function r(e){return Ut(n,e)}var n={antecedents:0,consequent:t},i=Xt(function(e){return{antecedents:e,consequent:t}},wr(wr(wr(hr,vr("when")),hr),Bi));return function(e){return br(i,r,e)}},e)},nr(46))(e)}var Ui={rule_parser:Vi,query_parser:function(e){return Zi($i)(e)},rule_database_result_from_rule_strings:function(e){return ke(function(e,t){return Cn.flat_map(function(n){return Cn.flat_map(function(e){var t=e.result,r=qi(Ai(n),t);return 0<me(r)?ee(1,[r]):ee(0,[xi(n,t)])},Cn.map_error(function(e){return ye(Jt,e)},mr(Vi,t)))},e)},ee(0,[_i]),e)}};function Gi(e){var t=function(e,t){for(var r=0,n=0,i=t;;){var a=i,o=n,u=r;if(!a)return[ge(u,0),ge(o,0)];var s=a[1],c=a[0];de(e,c)?(i=s,r=[c,u]):(i=s,n=[c,o])}}(function(e){switch(0|e.tag){case 0:case 1:return!1;case 2:return!0}},e);return Se([t[1],[t[0],0]])}function ji(s,e){var c=function(u,e,t){for(;;){var r=t,n=e;if(200<u)return Jn.$$return({frame:oi,rules_applied:0,failed_at_depth:u});var i=function(o){return function(e){switch(0|e.tag){case 0:var i=e[0];return Jn.$great$great$eq(o,function(n){return Jn.$great$great$eq(ki(s,i),function(e){var t=mi(wi(e)),r=f(i,t.consequent,n);return void 0!==r?c(u+1|0,t.antecedents,Jn.$$return({frame:r.frame,rules_applied:[e,r.rules_applied],failed_at_depth:r.failed_at_depth})):0})});case 1:var t=e[1],r=e[0];return Jn.$great$great$eq(o,function(e){return Jn.from_option(f(r,t,e))});case 2:var n=e[1],a=e[0];return Jn.$great$great$eq(o,function(e){return void 0!==f(a,n,e)?0:Jn.$$return(e)})}}}(r);if(!n)return r;t=i(n[0]),e=n[1]}},f=function(e,t,r){function n(e,t,r){var n=si(e,r.frame);if(void 0!==n)return f(n,t,r);if(t.tag)return fi(t,e,r.frame)?void 0:{frame:ui([e,t],r.frame),rules_applied:r.rules_applied,failed_at_depth:r.failed_at_depth};var i=si(t[0],r.frame);return void 0!==i?f(ee(0,[e]),i,r):{frame:ui([e,t],r.frame),rules_applied:r.rules_applied,failed_at_depth:r.failed_at_depth}}if(m(e,t))return r;if(!e.tag)return n(e[0],t,r);var i=e[0];if(!t.tag)return n(t[0],e,r);var a=t[0];return Gn(i.relation_name,a.relation_name)?ke(function(e,t){if(void 0!==e)return f(t[0],t[1],e)},r,Ae(i.related_terms,a.related_terms)):void 0},t=Gi(e);return function(e){return c(1,t,e)}}var Xi={query:function(e,t){return ji(e,t)(Jn.$$return({frame:oi,rules_applied:0,failed_at_depth:void 0}))}};function Yi(e){var t=function e(t){if(!t)return ee(0,[0]);var r=t[1],n=t[0];if(!r)return n.tag?n:ee(0,[[n[0],0]]);if(n.tag)return n;var i=e(r);return i.tag?i:ee(0,[[n[0],i[0]]])}(ye(function(e){return mr(Ui.query_parser,e)},ye(function(e){return e[0]},e.queries)));return t.tag?(console.error(t[0]),0):Ae(ye($t,t[0]),ye(function(e){return e[1]},e.queries))}var Ki=[{name:"Simple Facts",rule_instructions:["FACTs are unconditionally true statements. As soon as a fact is entered into the database it is known to be true. \n        A Fact can relate other terms together or it can stand on its own. In this chapter we show just simple facts that stand on their own.",["A Fact is represented as an identifier written in any case. Spaces cannot be used inside Fact names but underscores can be.",["Click the <Query> button to explore the queries that can be written against this simple database.",0]]],rules:["OrangesAreSpherical.",["oranges_are_spherical.",["SoccerBallsAreSpherical.",["soccerBalls_ARE_spherical.",0]]]],queries:[["SoccerBallsAreSpherical",["This query just asks whether the fact is found in the database."]],[["FootballsAreSpherical",["Try this query. Observe that no solution was found because the fact is not in the database."]],0]]},[{name:"Facts as Predicates",rule_instructions:["Facts can also express the truth of a _relationship_ between things. A Fact that expresses a relationship with a single term can be viewed as a declaration of \n            inclusion in a Set (a Predicate). For example, the facts from the previous chapter about spherical items can be more usefully represented as predicates.",["The syntax of a relationship is the relation name followed by a comma delimitted list of related things in parenthesis:",["FACTNAME(RELATED_THING_1, RELATED_THING_2, ...RELATED_THING_N)",0]]],rules:["Spherical(Oranges).",["Spherical(SoccerBalls).",["Spherical(BasketBalls).",["Spherical(Sun).",0]]]],queries:[["Spherical(Oranges)",["This query just asks if this specific fact is in the database. It is."]],[["Spherical(FootBalls)",["Observe that this query fails to find a solution."]],0]]},[{name:"Querying with Variables",rule_instructions:["The queries in the prior chapters were pretty lame because they could only ask if very _specific_ facts were present in the database exactly as stated.",["To introduce a little abstraction we need variables which act as wildcards or placeholders for any value. Variables are written in LitLog with a ? prefix.",['When a query includes a variable, the solution to the query will display the variable "binding" which satisfies the query.',0]]],rules:["Spherical(Oranges).",["Spherical(SoccerBalls).",["Spherical(BasketBalls).",["Spherical(Sun).",0]]]],queries:[["Spherical(?sphericalThing)",["When you execute this query you will observe multiple things: 1) the solution now includes the value of the binding and \n            2) there are now MULTIPLE solutions which can be requested by clicking Next Solution. Logic programming environments\n            require user to explicitly ask for the Next Solution because logic programming supports INFINITE solution spaces!!!"]],0]},[{name:"Relationships",rule_instructions:["In the last chapter we saw a relationship with a single term but Facts can express relationships between many terms. This ability to\n        express complex relationships allows us to encode surprisingly complex information. For now we will start by demonstrating a simple mother-child relationship.",0],rules:["MotherOf(Sally, Bob).",["MotherOf(Sally, Janice).",["MotherOf(Sally, Debrah).",["MotherOf(Janice, Malcom).",0]]]],queries:[["MotherOf(Sally, Debrah)",["This query without any variables simply asks if the fact can be found in the database; not very interesting."]],[["MotherOf(Sally, ?childOfSally)",["This query will find all children of Sally in the database by fixing Sally in the Mother position and asking what variable bindings in the Child position would enable a match with a known fact in the database.."]],[["MotherOf(?motherOfBob, Bob)",["Here we fix the Child and instead ask for variable bindings in the Mother position. This query will find the mother (or mothers) of Bob. NOTE: We have now seen that variables can be put in any place. That is a powerful concept we will explore later."]],[["MotherOf(?mother, ?child)",["In fact, we can use variables for both locations to get all mother-child solutions in the database."]],0]]]]},[{name:"Unification in Queries",rule_instructions:["In the last chapter two chapters we saw how variables can be used to both look for matches and also return information about what the variable values might allow a query term to match a known fact.",["This chapter demonstrates using a single variable in multiple locations to indicate that one item must match in multiple places. It seems obvious but it is deceptively powerful. ",0]],rules:["MotherOf(Sally, Bob).",["MotherOf(Sally, Janice).",["MotherOf(Sally, Debrah).",["MotherOf(Janice, Malcom).",0]]]],queries:[["MotherOf(?mother, ?siblingOne) and MotherOf(?mother, ?siblingTwo)",["Match on all mother/child pairs where the SAME mother is common to both. This happens because we are using the same ?mother variable in each MotherOf sub-query. When running this query you will observe that a person is their own sibling."]],[["MotherOf(?motherOne, ?siblingOne) and MotherOf(?motherTwo, ?siblingTwo) and <?motherOne = ?motherTwo>",["In the prior query we get the work done of ensuring the common mother by simply using the same variable name. This query shows the long-hand version by introducing the <left = right> syntax which expresses that left 'unifies' with right. Where possible we want to use the first form shown i.e. explicitly stating that two terms unify should only be done where necessary."]],[["MotherOf(?mother, ?siblingOne) and MotherOf(?mother, ?siblingTwo) and <?siblingOne /= ?siblingTwo>",["In addition to expressing that two terms must unify we can also express that two terms must NOT unify. For example, to filter out cases where siblingOne and siblingTwo are the same person we use the /= operator which stands for 'does not unify'."]],[["MotherOf(?motherOne, ?notSiblingOne) and MotherOf(?motherTwo, ?notSiblingTwo) and <?motherOne /= ?motherTwo> and <?notSiblingOne /= ?notSiblingTwo>",["This query finds all people who are NOT siblings of one another."]],0]]]]},[{name:"Unification: Database",rule_instructions:["Facts, Relations, Variables, and Unification clearly provide enough descriptive and querying power to support common database use cases.",["The facts below describe employees in a fictitious software company. The Job relation associates an employee with a job role. \n        The Salary relation associates an employee with their level of pay (unrelated to performance as is often the case). Finally there are two sets of which employees may or may not be members: Smart and GetsThingsDone.",["By using unification we will be able to do work similar to a JOIN in a SQL database (in fact, the commonality should start to become obvious as you work through the example queries).",0]]],rules:["Job(Cindy, QAEngineer).",["Smart(Cindy).",["GetsThingsDone(Cindy).",["Salary(Cindy, Moderate).",["Job(Swathi, QAEngineer).",["Smart(Swathi).",["GetsThingsDone(Swathi).",["Salary(Swathi, High).",["Job(William, QAEngineer).",["GetsThingsDone(William).",["Salary(William, Low).",["Job(Janet, QAEngineer).",["Smart(Janet).",["Salary(Janet, Low).",["Job(Alice, SoftwareEngineer).",["Smart(Alice).",["GetsThingsDone(Alice).",["Salary(Alice, Low).",["Job(Beatrice, Marketing).",["Smart(Beatrice).",["GetsThingsDone(Beatrice).",["Salary(Beatrice, High).",0]]]]]]]]]]]]]]]]]]]]]],queries:[["Job(?person, QAEngineer)",["Simply find all the persons who are quality engineers."]],[["Job(?person, QAEngineer) and Smart(?person) and GetsThingsDone(?person)",["Now find all the quality engineers who are both smart and get things done."]],[["Job(?person, QAEngineer) and Salary(?person, High)",["Find all the highly paid QA Engineers."]],[["Job(?person, QAEngineer) and Salary(?person, ?salary)",["This is where things get fun!!! Here we ask for all persons who are QA Engineers and then use the SAME ?person variable in the Salary sub-query in order to join to the Salary relation and get the salary level for said person. Take a moment to reflect on the implications."]],[["Smart(?person) and GetsThingsDone(?person) and Job(?person, ?jobRole)",["Here is another way of looking at a join: We first find the smart people who are also industrious and then finally use the Job relation to query that person's role."]],[["Job(?person, QAEngineer) and Smart(?person) and GetsThingsDone(?person) and Salary(?person, ?salary) and <?salary /= High>",["As a final example, find all the smart, industrious quality engineers who do not get paid a high salary."]],0]]]]]]},[{name:"Using Relations like Functions",rule_instructions:["Relations are more general than functions but they can be used to achieve Function-like behavior.",["This chapter demonstrates a Mirror relation which relates two Pair relations. The definition of Mirror declares that the first Pair is the reverse of the second Pair.",["This declaration of structure can then be used in a Query to provide a value on one side of the relation and get a value out of the other side by using a variable. The amazing thing about relations is that it does not matter which side you put the value in.",0]]],rules:["Mirror(Pair(?first, ?second), Pair(?second, ?first)).",0],queries:[["Mirror(Pair(Hello, Goodbye), ?mirrorPair)",["We provide a Pair in the first position and get out a swapped Pair in the second position."]],[["Mirror(?mirrorPair, Pair(Open, Close))",["Here we provide a Pair in the second position and get the swapped Pair in the first position."]],[["Mirror(Pair(Hello, Goodbye), Pair(?x, ?y))",["In this example we place variables inside the swapped Pair in order to extract the information individually."]],[["Mirror(Pair(Job(Beatrice, Marketing), Job(Alice, SoftwareEngineer)), Pair(?x, ?y))",["This query demonstrates that the values that are matched inside the pair can themselves be relations."]],[["Mirror(Widget(A), ?mirrorPair)",["This query FAILS because the first position passed to Mirror does not match the expected structure of Pair."]],0]]]]]},[{name:"Implication (Rules)",rule_instructions:["So far we have gotten a lot of work done with Facts, both simple facts and relations, and Variables.",["While Facts are uncondtionally true, a RULE specifies a _conclusion_ whose truth is dependent upon one or more conditions.",["Rules are written: Consequent when AntecedentCondition",["but can be _thought_ from the other direction as: Given AntecedentCondition then Consequent",["For example, someone is a parent of someone else if we can prove that they are the mother or father. Parenthood follows from motherhood and fatherhood (Parenthood <-- Fatherhood). \n        Stated the other direction, Fatherhood implies Parenthood (Fatherhood --\x3e Parenthood).",["Rules also serve a function (pun intended) similar to functions in other languages in that they are a named abstraction or generalization with a body where the body may hold implementation details.",["The body of a rule is the list of all the sub-queries which must be satisfied in order for the rule to hold true.",0]]]]]]],rules:["ParentOf(?parent, ?child) when MotherOf(?parent, ?child).",["ParentOf(?parent, ?child) when FatherOf(?parent, ?child).",["MotherOf(Sally, Janice).",["MotherOf(Sally, Debrah).",["MotherOf(Janice, Malcom).",["FatherOf(Roberto, Janice).",0]]]]]],queries:[["ParentOf(Sally, Janice)",["Here we will simply ask the database if it can prove that Sally is the parent of Janice. NOTE: The database does not explicitly declare Sally is the parent of Janice. The logic system deduced the fact from the rules given."]],[["ParentOf(?parent, Janice)",["We can also use variables in the query to find all parents of Janice."]],[["ParentOf(Sally, ?child)",["Or find all the children of Sally."]],0]]]},[{name:"Unification in Rules",rule_instructions:['A few chapters earlier we QUERIED for siblings by using the same variable to represent the mother of two individuals. All of the interesting "work" was done in the query itself.',["In this chapter we are going to use Rules as an abstraction mechanism (like functions in other languages) to put the work inside the rule. Further, we are going to base our sibling\n        definition off of the more general ParentOf relation rather than the specific subset relation MotherOf.",0]],rules:["ParentOf(?parent, ?child) when MotherOf(?parent, ?child).",["Siblings(?firstSibling, ?secondSibling) when ParentOf(?parent, ?firstSibling) and ParentOf(?parent, ?secondSibling) and <?firstSibling /= ?secondSibling>.",["MotherOf(Sally, Janice).",["MotherOf(Sally, Debrah).",["MotherOf(Sally, Malcom).",0]]]]],queries:[["Siblings(Janice, Debrah)",["A yes/no style query that just asks the system to deduce whether Janice and Debrah are siblings."]],[["Siblings(?sibling, Debrah)",["Here we ask about the siblings of Debrah. OBSERVE: Debrah is her own sibling! Weird. We will explain and fix this behavior in the next Chapter."]],0]]},[{name:"Recursion in Rules (Genealogy Example)",rule_instructions:["A rule can depend upon itself recursively! This chapter demonstrates a recursive declaration for proving that someone  is an ancestor of another.",["As is always the case with recursion, BEWARE to always have a terminating base case. Observe that the recursive specification of AncestorOf has a ParentOf \n        sub-query which is not a reference to AncestorOf. When that ParentOf sub-query in the body of the AncestorOf rule fails the rule fails and recursion terminates.",["You will also observe that we define the AncestorOf relation TWICE!!! Relations can be declared multiple times where each succeeding declaration adds another pattern that can\n        match for the relation. In other words, when a relation is defined a second time the second does not override or replace the first but rather adds a new way the relation can match.",["IMPORTANT: Rules are matched in the order they are entered in the database. The ordering of rules is part of the program specification and changing rule order changes program behavior.",["Observe that the simplest case of Ancestor is immediate Parentage. If someone is your parent they are your ancestor full-stop. This is a base case.",["In the second, recursive, definition of AncestorOf the ParentOf sub-query comes first as a simple base case which, only if it succeeds, then leads the logic engine to recursively search AncestorOf.",["The order of sub-queries in a rule body control the flow and meaning of the rule. Order matters!!!",0]]]]]]],rules:["ParentOf(?Mother, ?Child) when MotherOf(?Mother, ?Child).",["AncestorOf(?Ancestor, ?Descendant) when ParentOf(?Ancestor, ?Descendant).",["AncestorOf(?Ancestor, ?Descendant) when ParentOf(?ParentOfDescendant, ?Descendant) and AncestorOf(?Ancestor, ?ParentOfDescendant).",["MotherOf(Erica, Sally).",["MotherOf(Sally, Jane).",["MotherOf(Jane, Maria).",["MotherOf(Maria, Roberta).",0]]]]]]],queries:[["AncestorOf(Erica, Sally)",["Here Erica is just Sally's mother so we don't even need to use recursion"]],[["AncestorOf(Erica, Jane)",["Note that there is ONE application of the recursive rule."]],[["AncestorOf(Erica, Roberta)",["Observe that there are THREE applications of the recursive rule."]],[["AncestorOf(?ancestor, Roberta)",["Demonstrating a variable to ask for ALL ancestors of Roberta."]],[["AncestorOf(Erica, ?descendant)",["Demonstrating a variable to ask for ALL descendants of Erica."]],0]]]]]},[{name:"Pattern Matching & Recursion (Linked List: Append)",rule_instructions:["So far we have covered use cases that probably seem relatively natural to a database system. We are now going to\n          explore patterns that approximate general purpose programming but using an entirely declarative information based approach.",["We begin with appending two linked lists together. In this example, the Node relation defines a kind of linked-list node (in functional programming circles we would call this Cons).",["A node in a linked list has a value in the first position while the second position holds the next Node in the list.",["Here we represent a list with no elements as EmptyList. As such, since every Node must have a value and the next list, the last node in a list has EmptyList as the next list.",["A list of a zeros items is EmptyList.",["A list of a single item might be Node(FirstItem, EmptyList).",["A list of two items Node(FirstItem, Node(SecondItem, EmptyList))",["A list of three items Node(FirstItem, Node(SecondItem, Node(ThirdItem, EmptyList)))",["...and so on.",["This is a tedious way to write lists but it is still pretty amazing to consider it is possible to define list behavior with two facts. \n          Prolog actually has special syntax to simplify writing and reading lists but it is only sugar for exactly what we are doing here.",["Now we are going to look at how to implement Append which has a list in the first and second positions and defines that the list in the third position is the result of appending the\n          first two lists together.",["The first definition of Append is the  base case: Appending an empty list to any other list yields the same list. The base case definition is not even a Rule with a body. \n          All of the work is done in the declaration of the relation for the case where the first list is the EmptyList.",['The second definition for Append is a Rule which may take a little time to understand. Some of the "work" being done in the consequent of the Rule and some of the work is being done\n          in the rule body and the two are highly interrelated.',['In the first position we have Node(?LeftHeadValue, ?LeftRemainingList) which means that this version of Append will only match non-empty lists (Empty lists in the first position will be matched by the base case definition of Append).\n          As such, this pattern in the first position both ensures non-empty lists and also "unpacks" the structure of the non-empty list to give us the value of the head item in the left list in ?LeftHeadValue and \n          the remaining part of the list after head in ?LeftRemainingList. You can think of this as unpacking the fields of the Node structure into variables. In functional languages this unpacking is called destructuring.',["In the second position we match on any kind of list (empty or non-empty). Actually we match on anything at all because it is only a variable.",["The third position is where we define the result of appending a left and right list together. We use Node to build a new Linked List Node and we always include the head value from the left list. The rest of\n          the list is going to be the result of Appending what remains of the left list after removing head with the right list. The recursive work of getting that appended list is done in the body of the rule.",["The body of the rule is simple: It recursively calls Append using what was remaining in the left list and what was given in the right list. IMPORTANT: This is safe precisely because the very\n          definition of this version of Append involves unpacking the left list which means that we are, by definition, making the left list smaller. It is important to make the input smaller when\n          working with recursion to guarantee termination.",["INTERESTING: The Append operation can be queried from any direction just like every other query we have seen. In other languages the \n          append operation takes two INPUTs and yields an OUTPUT. In a logic programming language there are NO inputs or outputs in the specification of rules and facts. The author\n          of the query determines what is given and what must be solved (variables). Check out the example queries!",0]]]]]]]]]]]]]]]]]],rules:["Append(EmptyList, ?List, ?List).",["Append(Node(?LeftHeadValue, ?LeftRemainingList), ?RightList, Node(?LeftHeadValue, ?AppendOfLeftRemainingAndRightList)) when Append(?LeftRemainingList, ?RightList, ?AppendOfLeftRemainingAndRightList).",0]],queries:[["Append(Node(a, Node(b, Node(c, EmptyList))), Node(one, Node(two, Node(three, EmptyList))), ?Result)",["Appends a list of [a, b, c] and a list of [one, two, three]."]],[["Append(Node(a, Node(b, EmptyList)), ?right, Node(a, Node(b, Node(c, Node(d, EmptyList)))))",["AMAZING!!! We are asking what list would we have to add to [a, b] to get [a, b, c, d]."]],[["Append(?left, ?right, Node(a, Node(b, Node(c, Node(d, EmptyList)))))",["This is even crazier. We are now asking for all combinations of input that might produce the output."]],0]]]},[{name:"Recursion & Result Construction (Linked List: Zip)",rule_instructions:['This chapter demonstrates the implementation of a Zip function which takes two lists of equal length and combines them together to form a list of equal length of Pairs.\n          For each Pair, the first item of the pair comes from an item in the first list and the second item of the pair comes from the corresponding element in the second list." ',["For example, zipping a list of A, B, C and a list of One, Two, Three yields a list of Pair(A, One), Pair(B, Two), Pair(C, Three).",["The base case definition of zip is that the zip of two empty lists is an empty list.",["The next definition of zip only matches when the first and second lists are non-empty. The pattern Node(?leftItem, ?leftRemainingList) unpacks (destructures) the head item and remaining list \n          of the left list into variables which can be used in other terms.\n          The pattern Node(?rightItem, ?rightRemainingList) does the same thing for the right list.",["The third position of Zip, which defines the resulting zipped list, uses Node to build a new node and makes a Pair as the value of that node where the Pair is the left and right items. The \n          tail of that node is zippedRemainingList which is recursively built in the body of the rule by using what remains of the left and right lists.",["From these definitions we can see that Zip is only defined for the case where the first two lists (left and right) are empty or both are non-empty.",["We can also see that the recursion takes place by removing the head or top value from each and recursing on the remainder. That means that, by definition, both the first and second list get smaller at the same rate.",["Therefore, by definition, Zip is only defined for when the first two lists have equal lengths.",0]]]]]]]],rules:["Zip(EmptyList, EmptyList, EmptyList).",["Zip(Node(?leftItem, ?leftRemainingList), Node(?rightItem, ?rightRemainingList), Node(Pair(?leftItem, ?rightItem), ?zippedRemainingList)) when Zip(?leftRemainingList, ?rightRemainingList, ?zippedRemainingList).",0]],queries:[["Zip(Node(Small, Node(Medium, Node(Large, EmptyList))), Node(Circle, Node(Square, Node(Triangle, EmptyList))), ?shapesAndSizes)",["[Small, Medium, Large] and [Circle, Square, Triangle] succeeds because both lists are of the same size"]],[["Zip(Node(Small, Node(Medium, Node(Large, EmptyList))), Node(Circle, Node(Square, EmptyList)), ?shapesAndSizes)",["[Small, Medium, Large] and [Circle, Square] fails because the second list is small than the first"]],[["Zip(Node(Small, Node(Medium, Node(Large, EmptyList))), ?rightList, Node(Pair(Small, Penguin), Node(Pair(Medium, Dog), Node(Pair(Large, Elephant), EmptyList))))",["[Small, Medium, Large] and ?rightList yields [Pair(Small, Penguin), Pair(Medium, Dog), Pair(Large, Elephant)]. Once again, showing the power of logic programming to ask questions from different directions."]],[["Zip(Node(?leftOne, Node(Medium, Node(?leftThree, EmptyList))), Node(Penguin, Node(?rightTwo, Node(Elephant, EmptyList))), Node(Pair(Small, Penguin), Node(Pair(Medium, Dog), Node(Pair(Large, Elephant), EmptyList))))",["Here we are pulling out substructure by placing variables inside different relations."]],0]]]]},[{name:"Does Not Unify (Linked List: Remove)",rule_instructions:["This chapter illustrates how one might implement removal of all instances of a certain element from a list.",["The first definition of Remove is a base case relation: Removing an item from an empty list is always the empty list.",["The second definition of Remove is a rule that matches when the head of the list is the item to remove. \n          The body of the rule recursively removes from the remaining list and that result is the result of the definition. Note that the head of the list was intentionally discarded.",["The third definition of Remove is a rule that matches any time the list is non-empty. Here we ensure the currentItem is not a match for the item being removed. As such it must be retained and\n          so we use Node to tack current item onto the head of remainingListWithItemRemoved which was found through recursion.",0]]]],rules:["Remove(?itemToRemove, EmptyList, EmptyList).",["Remove(?itemToRemove, Node(?itemToRemove, ?remainingList), ?remainingListWithItemRemoved) when Remove(?itemToRemove, ?remainingList, ?remainingListWithItemRemoved).",["Remove(?itemToRemove, Node(?currentItem, ?remainingList), Node(?currentItem, ?remainingListWithItemRemoved)) when <?itemToRemove /= ?currentItem> and Remove(?itemToRemove, ?remainingList, ?remainingListWithItemRemoved).",0]]],queries:[["Remove(a, EmptyList, ?result)",[""]],[["Remove(a, Node(a, EmptyList), ?result)",[""]],[["Remove(a, Node(b, EmptyList), ?result)",[""]],[["Remove(b, Node(a, Node(b, Node(a, EmptyList))), ?result)",[""]],[["Remove(cherry, Node(apple, Node(banana, Node(cherry, Node(date, Node(elderberry, EmptyList))))), ?result)",[""]],[["Remove(x, Node(x, Node(o, Node(x, Node(o, Node(x, EmptyList))))), ?result)",[""]],[["Remove(?whatWouldIRemove, Node(x, Node(o, Node(x, Node(o, Node(x, EmptyList))))), Node(o, Node(o, EmptyList)))",[""]],0]]]]]]]},[{name:"Accumulators (Linked List: Reverse)",rule_instructions:["This chapter demonstrates TWO important techniques: 1. Auxillary (AKA Accessory or Helper) Facts & Rules. 2. Accumulators.",["Auxillary items are simply facts and rules which are used as an implementation detail and which you do not expect \n          consumers of your API to ever use directly. If we had a concept of scope we would make these relations private or not exported. The auxillary relations in this example are prefixed with an underscore \n          to denote that they are not part of the public API.",["This example has auxillary facts / rules because the implementations that get all of the work done use accumulators and we wish to abtract users of the API away from knowledge of that implementation detail.",["The public API we are building here is ReverseList which provides a list in the first position and defines that the list in the second position is the reverse of the first list.",["A base case is empty lists: an empty list is its own reverse. As usual the base case, though critically important, is easily stated.",["The second definition of the public API for ReverseList immediately delegates to the auxillary _ReverseListWithAccumulator and provides the starting value for the accumulator of an empty list.",["All of the real work is done by _ReverseListWithAccumulator which is a three place relation.",["The first place of the relation represents an _accumulated_ reversed list. This is the reversed list \n          built up from prior computations at the time the relation is matched.",["The second place of _ReverseListWithAccumulator is what _remains_ of the list we are reversing.",["The third place of _ReverseListWithAccumulator is the resulting reversed list which is expected to include\n          the accumulated results from the first position and the result of reversing the remaining items from the second position.",["The base case for _ReverseListWithAccumulator is when the remaining items to reverse (specified in the second position) is the empty list then the resulting reversed list is simply whatever we accumulated.",["When the list of items remaining to reverse is non-empty we match on the second definition of _ReverseListWithAccumulator. In the second position of the consequent of the rule, we unpack\n          the remaining list to get the current value and what remains of that list. In the body of the rule we recursively call _ReverseListWithAccumulator but observe that we add the current value to the accumulated list \n          in the first position and in the second position we recurse off what remains. Once again, this is safe because we are recursing based off the list which is given in the second position which, by definition, is \n          guaranteed to become smaller.",["As with a lot of recursive definitions it is very helpful to write down a concrete example of how this would execute because the operation of Reverse is entirely about execution order.",0]]]]]]]]]]]]],rules:["ReverseList(EmptyList, EmptyList).",["ReverseList(?List, ?ReversedList) when _ReverseListWithAccumulator(EmptyList, ?List, ?ReversedList).",["_ReverseListWithAccumulator(?accumulatedReversedList, EmptyList, ?accumulatedReversedList).",["_ReverseListWithAccumulator(?accumulatedReversedList, Node(?currentValue, ?remainingListToReverse), ?reversedList) when _ReverseListWithAccumulator(Node(?currentValue, ?accumulatedReversedList), ?remainingListToReverse, ?reversedList).",0]]]],queries:[["ReverseList(Node(a, Node(b, Node(c, EmptyList))), Node(c, Node(b, Node(a, EmptyList))))",["Using ReverseList as a query to determine if [a, b, c] is the reverse of [c, b, a]."]],[["ReverseList(Node(a, Node(b, Node(c, Node(d, EmptyList)))), ?reversed)",["Using ReverseList as a function to get the reverse of [a, b, c, d]."]],0]]},[{name:"Rules & Recursion #2 (Natural Number Summation)",rule_instructions:["Prolog natively understands how to work with numbers. LitLog does not. HOWEVER, there is enough expressive power in pattern matching, unification and recursive rules\n          to define numbers and numeric behaviors for cardinal numbers (counting numbers).",["The representation in the example is based off the Peano Axioms (internet search). Number are defined in terms of Zero, a base case, and PlusOne(?number) operation which, as the name implies adds one to its number argument.",["In this system, Zero is... well Zero. The number one is represented by simply adding one to Zero: PlusOne(Zero). Naturally, two can be found by adding one to that: PlusOne(PlusOne(Zero)). \n          Three is PlusOne(PlusOne(PlusOne(Zero))). This technique should feel __very__ similar to what we did in the Linked List example.",["In fact, the SumOf operation looks a lot like Appending two linked lists and so the Append operations are included here for comparison.",0]]]],rules:["SumOf(Zero, ?Number, ?Number).",["Append(EmptyList, ?List, ?List).",["SumOf(PlusOne(?leftMinusOne), ?Right, PlusOne(?sumOfLeftMinusOneAndRight)) when SumOf(?leftMinusOne, ?Right, ?sumOfLeftMinusOneAndRight).",["Append(Node(?HeadValue, ?Tail), ?RightLinkedList, Node(?HeadValue, ?Result)) when Append(?Tail, ?RightLinkedList, ?Result).",0]]]],queries:[["SumOf(Zero, Zero, ?sum)",["Query for the result of 0 + 0"]],[["SumOf(Zero, PlusOne(PlusOne(Zero)), ?sum)",["0 + 2"]],[["SumOf(PlusOne(Zero), PlusOne(PlusOne(Zero)), ?sum)",["1 + 2"]],[["SumOf(PlusOne(PlusOne(Zero)), PlusOne(PlusOne(Zero)), ?sum)",["2 + 2"]],[["SumOf(PlusOne(PlusOne(PlusOne(Zero))), PlusOne(PlusOne(Zero)), ?sum)",["3 + 2. Not only is this tedious to write but it is also difficult to decipher the output. We will clean that up in the next Chapter."]],0]]]]]},[{name:"Aliases (Pretty Summation)",rule_instructions:["The SumOf operation works by pattern matching on the structure of PlusOne. Therefore, the nesting structure, which is so difficult to read, is at the heart of what makes it work. We have to keep the nesting structure.",["However, we can alias the structured representation of numbers and define a pretty sum that relates terms at the level of the aliases.",["Observe that the code defines aliases for zero thru ten.",["It then defines SumOf identical to the definition from the prior chapter.",["PrettySum works by 1) solving for the structured representation of the left number, 2) solving for the structured representation of the right number, 3) solving for the structure representation of the sum, and 4) finally solves for the alias of the structured sum.",0]]]]],rules:["Alias(Zero, Zero).",["Alias(One, PlusOne(Zero)).",["Alias(Two, PlusOne(PlusOne(Zero))).",["Alias(Three, PlusOne(?twoStructure)) when Alias(Two, ?twoStructure).",["Alias(Four, PlusOne(?threeStructure)) when Alias(Three, ?threeStructure).",["Alias(Five, PlusOne(?fourStructure)) when Alias(Four, ?fourStructure).",["Alias(Six, PlusOne(?fiveStructure)) when Alias(Five, ?fiveStructure).",["Alias(Seven, PlusOne(?sixStructure)) when Alias(Six, ?sixStructure).",["Alias(Eight, PlusOne(?sevenStructure)) when Alias(Seven, ?sevenStructure).",["Alias(Nine, PlusOne(?eightStructure)) when Alias(Eight, ?eightStructure).",["Alias(Ten, PlusOne(?nineStructure)) when Alias(Nine, ?nineStructure).",["SumOf(Zero, ?Number, ?Number).",["SumOf(PlusOne(?InnerLeft), ?Right, PlusOne(?SumOfRightAndInnerLeft)) when SumOf(?InnerLeft, ?Right, ?SumOfRightAndInnerLeft).",["PrettySum(?leftAlias, ?rightAlias, ?prettySum) when Alias(?leftAlias, ?leftStructure) and Alias(?rightAlias, ?rightStructure) and SumOf(?leftStructure, ?rightStructure, ?sumStructure) and Alias(?prettySum, ?sumStructure).",0]]]]]]]]]]]]]],queries:[["PrettySum(Two, Three, ?prettySum)",["Execute this query and breath a sigh of relief. The answer is displayed as a very clear Five."]],[["PrettySum(Three, Five, ?prettySum)",[""]],[["PrettySum(Four, Five, ?prettySum)",[""]],[["PrettySum(?left, Three, Ten)",["Discover what can be added to Three to equal Ten."]],[["PrettySum(?left, ?right, Five)",["Find all the ways to add numbers to achieve Five"]],[["PrettySum(?half, ?half, ?num)",["Find all the pairs of numbers and their half."]],0]]]]]]},[{name:"Difference, Product, and Quotient",rule_instructions:["In the prior chapters we defined a Sum operation for the counting numbers and developed a method for providing readable aliases for those numbers.",["This chapter rounds out the proof that pattern matching and rules are sufficient to define rudimentary math operations of sum, difference, product, and quotient.",["First up is PrettyDifference which can be defined entirely in terms of PrettySum. That was easy.",["Product is a little trickier.",["We have two base cases for multiplication by zero which always yields zero i.e. n * 0 = 0 and 0 * n = 0.",["We also define two bases for multiplication where one of the terms is one which always yields the value of the other term i.e. n * 1 = n and 1 * n = n.",["Finally, we define the recursive work horse rule for _ProductOf which only matches when the right number is greater than zero. The body of the rule states that the product is: left + (left * (right - 1).\n          As is the case with recursion, we are defining product in terms of product but this is guaranteed to terminate because we defined base cases for 0 and 1 AND because the very definition of the rule \n          consistently makes the right number smaller by one.",["We define Quotient in terms of Product. ATTENTION: Defining Quotient this was causes a failure when there is any remainder!!! ",0]]]]]]]],rules:["_SumOf(Zero, ?Number, ?Number).",["_SumOf(PlusOne(?InnerLeft), ?Right, PlusOne(?SumOfRightAndInnerLeft)) when _SumOf(?InnerLeft, ?Right, ?SumOfRightAndInnerLeft).",["PrettySum(?leftAlias, ?rightAlias, ?prettySum) when Alias(?leftAlias, ?leftStructure) and Alias(?rightAlias, ?rightStructure) and _SumOf(?leftStructure, ?rightStructure, ?sumStructure) and Alias(?prettySum, ?sumStructure).",["PrettyDifference(?minuend, ?subtrahend, ?difference) when PrettySum(?subtrahend, ?difference, ?minuend).",["_ProductOf(Zero, ?anything, Zero).",["_ProductOf(?anything, Zero, Zero).",["_ProductOf(PlusOne(Zero), ?anything, ?anything).",["_ProductOf(?anything, PlusOne(Zero), ?anything).",["_ProductOf(?left, PlusOne(?rightMinusOne), ?product) when _ProductOf(?left, ?rightMinusOne, ?leftTimesRightMinusOne) and _SumOf(?left, ?leftTimesRightMinusOne, ?product).",["PrettyProduct(?leftAlias, ?rightAlias, ?prettyProduct) when Alias(?leftAlias, ?leftStructure) and Alias(?rightAlias, ?rightStructure) and _ProductOf(?leftStructure, ?rightStructure, ?productStructure) and Alias(?prettyProduct, ?productStructure).",["PrettyQuotient(?dividend, ?divisor, ?quotient) when PrettyProduct(?quotient, ?divisor, ?dividend).",["Alias(Zero, Zero).",["Alias(One, PlusOne(Zero)).",["Alias(Two, PlusOne(PlusOne(Zero))).",["Alias(Three, PlusOne(?prev)) when Alias(Two, ?prev).",["Alias(Four, PlusOne(?prev)) when Alias(Three, ?prev).",["Alias(Five, PlusOne(?prev)) when Alias(Four, ?prev).",["Alias(Six, PlusOne(?prev)) when Alias(Five, ?prev).",["Alias(Seven, PlusOne(?prev)) when Alias(Six, ?prev).",["Alias(Eight, PlusOne(?prev)) when Alias(Seven, ?prev).",["Alias(Nine, PlusOne(?prev)) when Alias(Eight, ?prev).",["Alias(Ten, PlusOne(?prev)) when Alias(Nine, ?prev).",["Alias(Eleven, PlusOne(?prev)) when Alias(Ten, ?prev).",["Alias(Twelve, PlusOne(?prev)) when Alias(Eleven, ?prev).",["Alias(Thirteen, PlusOne(?prev)) when Alias(Twelve, ?prev).",["Alias(Fourteen, PlusOne(?prev)) when Alias(Thirteen, ?prev).",["Alias(Fifteen, PlusOne(?prev)) when Alias(Fourteen, ?prev).",0]]]]]]]]]]]]]]]]]]]]]]]]]]],queries:[["PrettyDifference(Eight, Three, ?num)",["8 - 3 = ?num"]],[["PrettyDifference(Eight, ?what, Four)",["8 - ?what = 4"]],[["PrettyDifference(?left, ?right, Four)",["?left - ?right = 4"]],[["PrettyProduct(Two, Five, ?result)",["2 * 5 = ?"]],[["PrettyProduct(Five, Two, ?result)",["5 * 2 = ?"]],[["PrettyProduct(Three, ?right, Nine)",["3 * n = 9"]],[["PrettyQuotient(Six, Three, ?result)",["6 / 3 = ?"]],[["PrettyQuotient(Twelve, Three, ?result)",["12 / 2 = ?"]],[["PrettyQuotient(Fourteen, Seven, ?result)",["14 / 7 = ?"]],0]]]]]]]]]},[{name:"Lists and Numbers (Linked List: IndexOf)",rule_instructions:[" This chapter demonstrates a definition that finds the item of an item in a linked list. Previous chapters covered both linked lists and the counting numbers so it felt appropriate. ",0],rules:["IndexOf(?item, ?list, ?index) when _IndexOf(?item, ?list, Zero, ?index).",["_IndexOf(?itemToFind, EmptyList, ?currentIndex, NotFound).",["_IndexOf(?itemToFind, Node(?itemToFind, ?remainingItems), ?currentIndex, ?currentIndex).",["_IndexOf(?itemToFind, Node(?topItem, ?remainingItems), ?currentIndex, ?resultIndex) \n                when <?topItem /= ?itemToFind> \n                and _IndexOf(?itemToFind, ?remainingItems, PlusOne(?currentIndex), ?resultIndex).\n            ",0]]]],queries:[["IndexOf(Apples, Node(Apples, EmptyList), ?index)",["Index of first item in a one item list"]],[["IndexOf(Apples, EmptyList, ?index)",["Index of item in an empty list"]],[["IndexOf(Dates, Node(Apples, Node(Bananas, EmptyList)), ?index)",["Index of item not a member of two item list"]],[["IndexOf(Cherries, Node(Apples, Node(Bananas, Node(Cherries, Node(Dates, EmptyList)))), ?index)",["Index of third item in a four item list"]],0]]]]},[{name:"Algorithmic Problem Solving (Tower of Hanoi)",rule_instructions:[" This chapter demonstrates another poster-child problem: the Tower of Hanoi puzzle. \n          In the puzzle there are three rods: left, middle, and right. At the start of the puzzle there are a number of\n          discs on the leftmost rod stacked from largest at the bottom to smallest on the top. The goal is to get all of the discs from the left rod to the right rod. ",[" The constraints are: ",[" 1. Only one disk can be moved at a time. ",[" 2. Only the top disc of any rod may be removed (moved) and it must be placed on the top of another stack (or an empty rod). ",[" 3. A disk can only be placed on top of a larger disk. A disk cannot be placed on top of a smaller disk. ",[" There are four parts to the code. ",[" 1. The two Move rules effectively do all of the real work of solving the puzzle!!! The rest of the code is for aesthetics. \n          This is because Move works on Peano numbers which are hard to read and it builds the solution using an accumulator which builds the solution reversed. \n          ",[" 2. Define some human readable aliases for the Peano numbers. ",[" 3. Include the definition of reversing a linked list. ",[" 4. Finally the top level TowerOfHanoiWithDiscs rule accepts a readable alias for the number of discs to start with on the\n          leftmost rod (the larger the number the more difficult the puzzle) and returns the solution in the correct order. ",0]]]]]]]]]],rules:["Move(Zero, ?X, ?Y, ?dontCare, ?PriorMoves, Node(MoveTopDiskFrom(?X, ?Y), ?PriorMoves)).",["Move(PlusOne(?M), ?X, ?Y, ?Z, ?PriorMoves, ?FinalMoves) \n                when Move(?M, ?X, ?Z, ?Y, ?PriorMoves, ?MovesAfterFirst) \n                and Move(Zero, ?X, ?Y, ?_, ?MovesAfterFirst, ?MovesAfterZero) \n                and Move(?M, ?Z, ?Y, ?X, ?MovesAfterZero, ?FinalMoves).\n          ",["Alias(Zero, Zero).",["Alias(One, PlusOne(Zero)).",["Alias(Two, PlusOne(PlusOne(Zero))).",["Alias(Three, PlusOne(?twoStructure)) when Alias(Two, ?twoStructure).",["Alias(Four, PlusOne(?threeStructure)) when Alias(Three, ?threeStructure).",["Alias(Five, PlusOne(?fourStructure)) when Alias(Four, ?fourStructure).",["Alias(Six, PlusOne(?fiveStructure)) when Alias(Five, ?fiveStructure).",["Alias(Seven, PlusOne(?sixStructure)) when Alias(Six, ?sixStructure).",["Alias(Eight, PlusOne(?sevenStructure)) when Alias(Seven, ?sevenStructure).",["Alias(Nine, PlusOne(?eightStructure)) when Alias(Eight, ?eightStructure).",["ReverseList(EmptyList, EmptyList).",["ReverseListWithAccumulator(?accumulator, EmptyList, ?accumulator).",["ReverseListWithAccumulator(?accumulator, Node(?head, ?tail), ?reversed) when ReverseListWithAccumulator(Node(?head, ?accumulator), ?tail, ?reversed).",["ReverseList(?List, ?ReversedList) when ReverseListWithAccumulator(EmptyList, ?List, ?ReversedList).",["TowerOfHanoiWithDiscs(?numberOfDiscs, ?resultingMoves)\n                when Alias(?numberOfDiscs, PlusOne(?zeroBasedStructure))\n                and Move(?zeroBasedStructure, Left, Right, Center, EmptyList, ?resultingMovesReversed)\n                and ReverseList(?resultingMovesReversed, ?resultingMoves).\n          ",0]]]]]]]]]]]]]]]]],queries:[["TowerOfHanoiWithDiscs(One, ?solution)",[""]],[["TowerOfHanoiWithDiscs(Two, ?solution)",[""]],[["TowerOfHanoiWithDiscs(Three, ?solution)",[""]],[["TowerOfHanoiWithDiscs(Four, ?solution)",[""]],[["TowerOfHanoiWithDiscs(Five, ?solution)",[""]],0]]]]]},[{name:"Finite State Automata",rule_instructions:0,rules:["_Recognize(?Node, EmptyList) when FinalState(?Node).",["_Recognize(?OriginalNode, ?InputList) when TransitionFromToWithInput(?OriginalNode, ?NextNode, ?Label) and _Traverse(?Label, ?InputList, ?NewInputList) and _Recognize(?NextNode, ?NewInputList).",["_Traverse(?Label, Node(?Label, ?Remaining), ?Remaining).",["Recognize(?InputList) when InitialState(?StartingState) and _Recognize(?StartingState, ?InputList).",["InitialState(AcceptingApplesOrDone).",["FinalState(Finished).",["TransitionFromToWithInput(AcceptingApplesOrDone, Finished, Done).",["TransitionFromToWithInput(AcceptingApplesOrDone, AcceptingApplesOrDone, Apples).",["TransitionFromToWithInput(AcceptingApplesOrDone, AcceptingOranges, Apples).",["TransitionFromToWithInput(AcceptingOranges, AcceptingApplesOrDone, Oranges).",0]]]]]]]]]],queries:[["Recognize(Node(Apples, Node(Oranges, Node(Done, EmptyList))))",[""]],[["Recognize(Node(Apples, Node(Oranges, Node(Apples, Node(Oranges, Node(Done, EmptyList))))))",[""]],[["Recognize(Node(Apples, Node(Oranges, Node(Apples, Node(Oranges, Node(Apples, Node(Oranges, Node(Done, EmptyList))))))))",[""]],[["Recognize(Node(Apples, Done))",[""]],[["Recognize(?Inputs)",[""]],0]]]]]},0]]]]]]]]]]]]]]]]]]]];var ea=["LitLog, short for Literate Logic programming, is a subset of Prolog with a simpler syntax and an on-line editor. \n    The goal of LitLog is to offer a path to quickly learning the basics of declarative logic programming in three lunch breaks or less.",["When Logic Programming fits the problem space, it beats other programming paradigms by orders of magnitude so it is a helpful tool to\n    have in your mental toolbox (even if an applicable problem may only arise once in a decade). It is also just neat and that alone is worth a few lunch periods.",["The act of declarative logic programming is building a knowledge database that can be queried. It is the query powers that are surprising and interesting.",["Rules & Facts are the two forms of knowledge representation. Get started by choosing the first chapter.",0]]]];function ta(e,t){return{text:de(e,t),compilation_result:ee(0,[t])}}function ra(e,t,r){var n,i,a=mr(t,e);return{text:e,compilation_result:a.tag?ee(1,[["Parse Error",0]]):(i=de(r,n=a[0].result))?ee(1,[i]):ee(0,[n])}}function na(e){var t=e.solution_stream;return t?{initiating_query:e.initiating_query,solution_stream:Tn(t[1]),displayed_solutions:[t[0],e.displayed_solutions]}:e}var ia={CompiledTextEditing:{empty:function(e){return{text:"",compilation_result:ee(1,[0])}},edit:ta,make:ra},ExecutingQueryInfo:{next_solution:na},init:function(e){return{rule_database:Ni.RuleDatabase.empty,available_chapters:Ki,chapter_opt:void 0,interaction_mode:0}}};var aa={viewRules:0,initiateAddRule:1,initiateEditRule:function(e){return ee(0,[e])},initiateEditQuery:function(e){return ee(1,[e])},chooseChapter:function(e){return ee(2,[e])},nextChapter:2,updateText:function(e){return ee(3,[e])},addRule:function(e){return ee(4,[e])},editRuleEntry:function(e){return ee(5,[e])},deleteRule:function(e){return ee(6,[e])},executeQuery:function(e){return ee(7,[e])},nextFrame:3};function oa(){"remove"in Element.prototype||(Element.prototype.remove=function(){this.parentNode&&this.parentNode.removeChild(this)}),function(){for(var a=0,e=["ms","moz","webkit","o"],t=0;t<e.length&&!window.requestAnimationFrame;++t)window.requestAnimationFrame=window[e[t]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[e[t]+"CancelAnimationFrame"]||window[e[t]+"CancelRequestAnimationFrame"];window.requestAnimationFrame||(window.requestAnimationFrame=function(e,t){var r=(new Date).getTime(),n=Math.max(0,16-(r-a)),i=window.setTimeout(function(){e(r+n)},n);return a=r+n,i}),window.cancelAnimationFrame||(window.cancelAnimationFrame=function(e){clearTimeout(e)})}()}function ua(o,l,n,d,h,e){if(void 0===e)return function(i){function a(e){var t=de(n,e);r.contents=ft(i,i,r.contents,t)}var r={contents:0};return{startup:function(e){ct(i,h),a(d)},render_string:function(e){return Xe(de(l,e))},handleMsg:function(e,t){var r=M(o,e,t),n=r[0];return ct(i,r[1]),a(n),n},shutdown:function(e){ct(i,e),r.contents=ft(i,i,r.contents,0)}}};var v=ue(e);return function(u){function i(e){var t,r,n,i,a,o;void 0!==f.contents&&(t=[de(l,c.contents),0],n=u,i=v,a=s.contents,o=t,st(n,i,i.childNodes,0,a,o),r=o,s.contents=r,f.contents=void 0)}function t(e){for(;0<v.childNodes.length;){var t=v.firstChild;null!==t&&v.removeChild(t)}}function a(e){var t=de(n,e);r.contents=ft(u,u,r.contents,t)}var s={contents:0},c={contents:d},f={contents:void 0},r={contents:0};return{startup:function(e){t(),ct(u,h),a(c.contents),f.contents=-1,i()},render_string:function(e){return Xe(de(l,e))},handleMsg:function(e,t){var r=M(o,e,t),n=r[0];return c.contents=n,ct(u,r[1]),void 0===f.contents&&(f.contents=-1,i()),a(n),n},shutdown:function(e){f.contents=void 0,ct(u,e),r.contents=ft(u,u,r.contents,0),s.contents=0,t()}}}}function sa(e,t,r){oa();var n,i,a,o,u,s,c,f,l,d=de(e.init,r),h=d[0],v=null==t?void 0:oe(t),p=ua(e.update,e.view,e.subscriptions,h,d[1],v);return n=h,i=p,a=e.shutdown,o={contents:n},s=de(i,u={contents:{enqueue:function(e){console.log("INVALID enqueue CALL!")}}}),c={contents:void 0},l={enqueue:f=function(e){var t=c.contents;if(void 0===t){c.contents=0;var r=M(s.handleMsg,o.contents,e);o.contents=r;var n=c.contents;if(void 0!==n)return n?(c.contents=void 0,_e(f,be(n))):void(c.contents=void 0);throw[w,"INVALID message queue state, should never be None during message processing!"]}c.contents=[e,t]}},u.contents=l,de(s.startup,void 0),{pushMsg:f,shutdown:function(e){u.contents={enqueue:function(e){console.log("INVALID message enqueued when shut down")}};var t=de(a,o.contents);de(s.shutdown,t)},getHtmlString:function(e){return de(s.render_string,o.contents)}}}function ca(e){return{href:e.href,protocol:e.protocol,host:e.host,hostname:e.hostname,port:e.port,pathname:e.pathname,search:e.search,hash:e.hash,username:e.username,password:e.password,origin:e.origin}}var fa={contents:void 0};function la(a){var t;return t=function(t){fa.contents=function(e){return de(t.enqueue,de(a,e))};function i(e){var t;void 0!==(t=fa.contents)&&de(t,ca(document.location))}var e,r,n;return r=i,n=!(e="popstate"),window.addEventListener(e,r,n),function(e){return r=i,n=!(t="popstate"),window.removeEventListener(t,r,n);var t,r,n}},ee(1,["navigation",function(e){return de(t,e.contents)},{contents:void 0}])}var da="button-bar",ha="delete";function va(e,t,r){var n=void 0===e||e;return nn(void 0,void 0,[wn(r),[kn.disabled(!n),0]],[Xr(t),0])}function pa(e){return Yr(void 0,void 0,[ln(da),0],e)}var ma="#48a9dc",ga="\n\n        ."+String(da)+(" {\n            padding-top: 5px; \n            padding-bottom: 5px;\n        }\n\n        button {\n            background-color: white;\n            color: #555;\n            cursor: pointer;\n            box-shadow: 0 0 0 1px "+String(ma)+(";\n            border: none;\n            border-radius: 4px;\n            padding: 6px;\n            margin-right: 8px;\n            font-size: 14px;\n        }\n\n        button."+String(ha)+(" {\n            background-color: #f00;\n            box-shadow: 0 0 2px 2px rgba(127,0,0,.5);\n            font-weight: bold;\n            color: #fff;\n            padding-left: 8px;\n            padding-right: 8px;\n            border-radius: 4px;\n            display: inline-block;\n        }\n\n        button:active {\n            background-color: "+String(ma)+(";\n            color: white;\n        }\n\n        button:disabled {\n            background-color: #ddd;\n            color: #90adbd;\n        }\n\n        a, a:active, a:visited {\n            display: inline-block;\n            color: "+String(ma)+("\n        }\n\n        a, a:active, a:visited {\n            display: inline-block;\n            color: "+String(ma))))))+"\n        }\n    ",ba="menu",wa="body",ya="\n        ."+String(ba)+(" {\n            overflow: hidden;\n            background-color: #333;\n            position: fixed;\n            height: 36px;\n            width: 100%;\n        }\n\n        ."+String(wa)+(" {\n            margin-top: 37px;\n            height: calc(100% - 37px);\n            height: -webkit-calc(100% - 37px);\n        }\n\n        ."+String(ba)+(" a {\n            float: left;\n            color: white;\n            text-align: center;\n            padding: 10px 16px;\n            text-decoration: none;\n            font-size: 14px;\n        }\n\n        ."+String(ba))))+" a:hover {\n            background-color: #ddd;\n            color: black;\n        }\n        \n        ";function _a(e,t){return Yr(void 0,void 0,[hn("height","100%"),0],[Yr(void 0,void 0,[ln(ba),0],ye(function(e){return tn(void 0,void 0,[ee(1,["","href",e[0]]),[ee(0,["target","_blank"]),0]],[Xr(e[1]),0])},e)),[Yr(void 0,void 0,[ln(wa),0],[t,0]),0]])}var ka="panels",Aa="panel",Sa="panel-header",xa="panel-body";function Oa(e,t){return Yr(void 0,void 0,[ln(Aa),0],[Yr(void 0,void 0,[ln(Sa),0],[Xr(e),0]),[Yr(void 0,void 0,[ln(xa),0],t),0]])}var Na="\n        div."+String(ka)+(" {\n            height: 100%;\n        }\n\n        div."+String(Sa)+(" {\n            background-color: #248;\n            color: white;\n            font-weight: bold;\n            padding: 4px;\n            height: 18px;\n        }   \n\n        div."+String(Aa)+(" {\n            background-color: white;\n            margin-top: 5px;\n        }     \n        \n\n        @media screen and (max-width: 1023px) {\n            div."+String(Aa)+(" {\n                float: left;\n                width: 99%;\n                margin-top: 10px;\n                border: solid 1px #aaa;\n            }\n        }\n\n        @media screen and (min-width: 1024px) {\n            div."+String(Aa)+(" {\n                float: left;\n                margin-left: 5px;\n                margin-right: 5px;\n                width: calc(50% - 15px);\n                width: -webkit-calc(50% - 15px);\n                height: 98%;\n                border: solid 1px #aaa;\n            }\n        }\n\n        div."+String(xa))))))+" {\n            padding: 6px;\n            height: calc(100% - 40px);\n            height: -webkit-calc(100% - 40px);            \n            overflow-y: auto;            \n        }\n    ",La="section";function Ta(e,t){return Yr(void 0,void 0,[ln(La),0],[rn(void 0,void 0,0,[Xr(e),0]),[fn(void 0,void 0,0,0),[Yr(void 0,void 0,0,t),0]]])}var Pa="variable",Ra="fact",qa="relation",Ea="punctuation",Fa="query-comment",Ma="rule-application-count",Ia="rule-application-count-visible",Da="related-terms-list",Ca="relation",Wa="multi-line-relation",Za="rule-item",za="rule-used",Qa="rule-display",Ha="\n        ."+String(Pa)+(" {\n            color: #ff0; \n            display: inline-block;\n        }\n\n        ."+String(Ca)+(" {\n            display: inline-block;\n            vertical-align: top;\n        }\n\n        ."+String(Wa)+(" {\n            border: solid 1px #346;\n            padding: 2px;\n            margin-bottom: 4px;\n            margin-top: 2px;\n            border-radius: 5px;\n        }\n\n        ."+String(Ra)+(" {\n            color: #0f0;\n            display: inline-block;\n        }\n        \n        ."+String(Fa)+(" {\n            color: #ccc;\n            padding: 4px;\n            margin-bottom: 8px;\n        }\n\n        ."+String(qa)+(" {\n            color: #6af;\n            font-weight: bold;\n            display: inline-block;\n        }\n\n        ."+String(Ea)+(" {\n            color: white;\n            font-weight: bold;\n            vertical-align: top;\n        }\n\n        ."+String(Ea)+(":last-child {\n            vertical-align: bottom;\n        }\n\n        ."+String(Qa)+(" {\n            background-color: black;\n            font-family: Consolas, monospace;\n            padding: 4px;\n        }\n\n        ."+String(Za)+(" {\n            color: black;\n            background-color: black;\n\n            display: flex;\n            align-items: center;            \n\n            border-radius: 6px;\n            padding: 6px;\n            box-shadow: 0 0.5em 1em -0.125em rgba(10,10,10,.1), 0 0 0 1px rgba(10,10,10,.02);\n\n            margin-bottom: 12px;\n            font-size: 14px;\n        }\n\n        ."+String(Za)+("."+String(za)+(" {\n            box-shadow: 0 0 2px 4px #f44;\n        }\n\n        ."+String(Ma)+(" {\n            display: inline-block;\n            visibility: hidden;\n            padding-left: 6px;\n            padding-right: 6px;\n            padding-top: 2px;\n            padding-bottom: 2px;\n            border-radius: 9px;\n            border: solid 1px #884;\n            color: black;\n            background-color: #ff8;\n            font-weight: bold;\n            font-size: 16px;\n        }\n\n        ."+String(Ma)+("."+String(Ia)+(" {\n            visibility: visible;\n        }\n\n        ."+String(Qa)+(" ul."+String(Da)))))))))))))))))+" {\n            padding-left: 20px;\n        }\n\n        ul {\n            list-style: none;\n            margin-block-start: 0;\n            margin-block-end: 0;\n        }\n    ";function Ja(e){return Kr(void 0,void 0,[ln(Ea),0],[Xr(e),0])}function $a(e){if(!e.tag)return Kr(void 0,void 0,[ln(Pa),0],[Xr(de(Ht([ee(12,[63,ee(2,[0,0])]),"?%s"]),e[0][0])),0]);var t=e[0],r=t.related_terms,n=t.relation_name[0];if(!r)return Kr(void 0,void 0,[ln(Ra),0],[Xr(n),0]);var i=r[1],a=r[0];return i?(4<=ke(function(e,t){return e+t|0},0,ye(Ni.Term.count_sub_terms,r))?function(e,t,r){return Kr(void 0,void 0,[dn([[Ca,!0],[[Wa,!0],0]]),0],[Kr(void 0,void 0,[ln(qa),0],[Xr(e),0]),[Ja("("),[un(void 0,void 0,[ln(Da),0],[sn(void 0,void 0,0,[$a(t),0]),ye(function(e){return sn(void 0,void 0,0,[Ja(", "),[$a(e),0]])},r)]),[Ja(")"),0]]]])}:function(e,t,r){return Kr(void 0,void 0,[ln(Ca),0],[Kr(void 0,void 0,[ln(qa),0],[Xr(e),0]),[Ja("("),[Kr(void 0,void 0,0,[$a(t),0]),[Kr(void 0,void 0,0,ye(function(e){return Kr(void 0,void 0,0,[Ja(", "),[$a(e),0]])},r)),[Ja(")"),0]]]]])})(n,a,i):Kr(void 0,void 0,[ln(Ca),0],[Kr(void 0,void 0,[ln(qa),0],[Xr(n),0]),[Ja("("),[$a(a),[Ja(")"),0]]]])}function Ba(e){switch(0|e.tag){case 0:return $a(e[0]);case 1:return Kr(void 0,void 0,0,[Ja("<"),[$a(e[0]),[Ja("="),[$a(e[1]),[Ja(">"),0]]]]]);case 2:return Kr(void 0,void 0,0,[Ja("<"),[$a(e[0]),[Ja("/="),[$a(e[1]),[Ja(">"),0]]]]])}}function Va(e){function t(e,t){return sn(void 0,void 0,0,[Ja(e),[Ba(t),0]])}var r,n,i,a=e.antecedents;return i=a?(r=a[0],un(void 0,void 0,0,(n=be(a[1]))?Se([[t("when ",r),0],[ye(function(e){return t("and ",e)},be(n[1])),[[sn(void 0,void 0,0,[Ja("and "),[Ba(n[0]),[Ja("."),0]]]),0],0]]]):[sn(void 0,void 0,0,[Ja(" when "),[Ba(r),[Ja("."),0]]]),0])):Ja("."),Yr(void 0,void 0,[ln(Qa),0],[$a(e.consequent),[i,0]])}function Ua(e,t){return Yr(void 0,void 0,[ln(Qa),0],[0!==t.length?Yr(void 0,void 0,[ln(Fa),0],[Xr(t),0]):An,[un(void 0,void 0,0,e?[sn(void 0,void 0,0,[Ba(e[0]),0]),ye(function(e){return sn(void 0,void 0,0,[Ja("and "),[Ba(e),0]])},e[1])]:0),0]])}function Ga(e){var t=de(Ni.RuleDatabase.rule_from_entry,e);return Yr(void 0,void 0,[dn([[Za,!0],[[za,!1],0]]),0],[nn(void 0,void 0,[wn(aa.deleteRule(e)),[ln(ha),0]],[Xr("X"),0]),[tn(void 0,void 0,[wn(aa.initiateEditRule(e)),0],[Va(t),0]),0]])}var ja="language-editing",Xa="errors-container",Ya="editing-container",Ka="\n        input {\n            margin-left: 6px;\n        }          \n        \n        ."+String(ja)+(" {\n            width: 96%;\n            min-height: 92px;\n            font-family: Consolas, monospace;\n            background-color: black;\n            white-space: nowrap;\n            color: white;\n        }\n\n        ."+String(Ya)+(" {\n            margin-bottom: 16px;\n        }\n\n        ."+String(Xa)+(" ul {\n            padding-left: 20px;\n            list-style: square;\n        }\n\n        ."+String(Xa)+(" {\n            margin-bottom: 16px;\n        }\n\n        ."+String(Xa)))))+" li {\n            color: #800;\n            font-size: 14px;\n        }\n    ";function eo(e,t,r,n,i,a){var o,u=e.compilation_result;if(u.tag)return Yr(void 0,void 0,[ln(Ya),0],[on(void 0,void 0,0,[Xr(t),0]),[an(void 0,void 0,[gn(void 0,aa.updateText),[ln(ja),[vn(a),[Ge("spellcheck","false"),[pn(e.text),[Sn,0]]]]]],0),[An,[pa([(o=u[0])?Yr(void 0,void 0,[ln(Xa),0],[un(void 0,void 0,0,ye(function(e){return sn(void 0,void 0,0,[Xr(e),0])},o)),0]):An,[va(void 0,"Cancel",i),0]]),0]]]]);var s=de(n,u[0]);return Yr(void 0,void 0,[ln(Ya),0],[on(void 0,void 0,0,[Xr(t),0]),[an(void 0,void 0,[gn(void 0,aa.updateText),[ln(ja),[Ge("spellcheck","false"),[vn(a),[pn(e.text),[I(Fn.Keydown.keydown,e.text,s,function(e){return 13===e.keyCode&&e.ctrlKey}),0]]]]]],0),[Yr(void 0,void 0,0,[Xr(de(Ht([ee(11,["(ctrl+enter to ",ee(2,[0,ee(12,[41,0])])]),"(ctrl+enter to %s)"]),r)),0]),[pa([va(void 0,r,s),[va(void 0,"Cancel",i),0]]),0]]]])}function to(r){function e(i){return Yr(void 0,void 0,0,ye(function(e){return t=i,r=e,n=Rn.count(function(e){return M(Ni.RuleDatabase.is_same,e,r)},t),Yr(void 0,void 0,[dn([[Za,!0],[[za,0<n],0]]),0],[Kr(void 0,void 0,[dn([[Ma,!0],[[Ia,0<n],0]]),0],[Xr(de(Ht([ee(4,[0,0,0,0]),"%d"]),n)),0]),[Va(de(Ni.RuleDatabase.rule_from_entry,r)),0]]);var t,r,n},o))}var t,n,i,a,o=de(Ni.RuleDatabase.all_rules,r.rule_database),u=r.interaction_mode;if("number"==typeof u)c=Yr(void 0,"viewing_rules",0,[pa([on(void 0,void 0,0,[Xr("Chapter:"),0]),[(i=[bn(n=t=void 0,function(t){return aa.chooseChapter(function(e,t){for(;;){var r=t;if(!r)return;var n=r[0];if(de(e,n))return oe(n);t=r[1]}}(function(e){return e.name===t},r.available_chapters))}),0],a=[cn(void 0,void 0,[kn.selected(void 0===r.chapter_opt),0],[Xr("(select chapter)"),0]),ye(function(e){return cn(void 0,void 0,[kn.selected(m(r.chapter_opt,e)),0],[Xr(e.name),0])},r.available_chapters)],Ue("","select",void 0!==t?t:"",void 0!==n?n:"",i,a)),[va(void 0,"Add Rule / Fact",1),[o?va(void 0,"Query",ee(1,[0])):An,0]]]]),[fn(void 0,void 0,0,0),[Yr(void 0,"editable_rules",0,[en(void 0,void 0,0,[Xr(o?"Click the rule text of any rule to edit/update that rule. Clicking X removes the rule from the database WITHOUT a prompt.":"Click <Add Rule/Fact> to start adding rules to the database."),0]),[Yr(void 0,void 0,0,ye(Ga,o)),0]]),0]]]);else switch(0|u.tag){case 0:c=Yr(void 0,"adding_rule",0,[eo(u[0],"New Rule","Add Rule",aa.addRule,0,"New rule..."),[fn(void 0,void 0,0,0),[e(0),0]]]);break;case 1:var s=u[0],c=Yr(void 0,"editing_rule",0,[eo(u[1],"Editing Rule","Update Rule",function(e){return aa.editRuleEntry(M(Ni.RuleDatabase.update_rule_entry,s,e))},0,"Edit rule..."),[fn(void 0,void 0,0,0),[e([s,0]),0]]]);break;case 2:c=e(0);break;case 3:var f=u[0].solution_stream;c=e(f?f[0].rules_applied:0)}return Oa("Rules and Facts",[c,0])}var ro="solution-frame",no="no-solution",io="example-query";function ao(e){function t(e){return Ta("Query",[Ua(s,""),0])}function r(e){function t(e,t){return Yr(void 0,void 0,[ln(ro),0],[rn(void 0,void 0,0,[Xr(e),0]),[un(void 0,void 0,0,ye(function(e){return sn(void 0,void 0,0,[Xr(e),0])},t)),0]])}var r=e.failed_at_depth;if(void 0!==r)return Yr(void 0,void 0,[ln(no),0],[Xr(de(Ht([ee(11,["Gave up search at depth of ",ee(4,[0,0,0,ee(11,[". You could be missing a terminating base case in a recursive definition OR you may have simply asked a question whose solution requires more searching than is allowed by LitLog.",0])])]),"Gave up search at depth of %d. You could be missing a terminating base case in a recursive definition OR you may have simply asked a question whose solution requires more searching than is allowed by LitLog."]),r)),0]);var n=M(Ni.Frame.to_strings,s,e.frame);return n?t("Satisfied With Variable Substitution(s)",n):t("Satisfied Without Variable Sustitution",0)}var n,i,a,o=e.displayed_solutions,u=e.solution_stream,s=e.initiating_query;return i=u?(n=Ta("Current Solution",[on(void 0,void 0,0,[Xr("OBSERVE: All rules and facts applied in the discovery of the current solution are highlighted in the Rules and Facts panel with a count of the number of times the Rule/Fact was applied in the discovery of the solution."),0]),[r(u[0]),0]]),Tn(u[1])?Yr(void 0,"solutions_remaining",0,[pa([va(void 0,"Next Solution",3),[va(void 0,"New Query",ee(1,[s])),[va(void 0,"Cancel Querying",0),[va(void 0,"Cancel Querying and Go to Next Chapter",2),0]]]]),[t(),[n,0]]]):Yr(void 0,"end_of_stream_with_current",0,[pa([va(void 0,"New Query",ee(1,[s])),[va(void 0,"Manage Rules",0),[va(void 0,"Go to Next Chapter",2),0]]]),[t(),[n,[Ta("All Solutions Found",[on(void 0,void 0,0,[Xr("All of the solutions to the query have been found. Click New Query to keep experimenting in this chapter or <Next Chapter> to move on."),0]),0]),0]]]])):Yr(void 0,"end_of_stream",0,[pa([va(void 0,"New Query",ee(1,[s])),[va(void 0,"Manage Rules",0),[va(void 0,"Go to Next Chapter",2),0]]]),[t(),[o?An:Yr(void 0,void 0,[ln(no),0],[Xr("No Solution"),0]),[Ta("All Solutions Found",[on(void 0,void 0,0,[Xr("All of the solutions to the query have been found. Click New Query to keep experimenting in this chapter or <Next Chapter> to move on."),0]),0]),0]]]]),Yr(void 0,"executing_query",0,[i,[o?(a=me(o),Ta(de(Ht([ee(11,["Prior Solutions (",ee(4,[0,0,0,ee(12,[41,0])])]),"Prior Solutions (%d)"]),a),[on(void 0,void 0,0,[Xr("OBSERVE: Some solutions may appear more than once because there can be multiple paths to reach the same solution. LitLog does not remove duplicate solutions from the display in order to illustrate the paths / search process."),0]),ye(r,o)])):An,0]])}function oo(e){return Yr(void 0,"instructions",0,ye(function(e){return en(void 0,void 0,0,[Xr(e),0])},e))}function uo(e){function t(e,t){return Oa(e,[t,0])}var r,n,i,a=e.chapter_opt,o=void 0!==a?a.rule_instructions:ea,u=e.interaction_mode;if("number"==typeof u)return t("Instructions",oo(o));switch(0|u.tag){case 2:return t("Query",(r=u[0],n=e.chapter_opt,i=void 0!==n?Yi(n):0,Yr(void 0,"editing_query",0,[eo(r,"Query","Execute Query",aa.executeQuery,0,"New query..."),[i?Yr(void 0,void 0,0,[on(void 0,void 0,0,[Xr("Example Queries. Click a query below to populate the query entry box with that query."),0]),[Yr(void 0,void 0,0,ye(function(e){var t=e[0];return Yr(void 0,void 0,[ln(io),[wn(aa.updateText(de(Ni.Query.to_string,t))),0]],[Ua(t,e[1][0]),0])},i)),0]]):An,0]])));case 3:return t("Query",ao(u[0]));default:return t("Instructions",oo(o))}}var so=Ce(" ",["\n        html {\n            height: 100%\n        }\n\n        select {\n            font-size: 16px;\n            color: #444;\n            margin-left: 4px;\n            margin-right: 16px;\n            margin-bottom: 6px;\n        }\n\n        body {\n            height: 100%;\n            background-color: #eee;\n            display: flex;\n            flex-direction: column;\n            font-family: sans-serif;\n            padding: 0;\n            margin: 0;\n        }\n\n        p {\n            font-size: 14px;\n        }\n\n        h3 {\n            margin-bottom: 3px;\n        }\n    ",[ga,[ya,[Na,["\n\n    ",[Ha,[Ka,["",[" \n\n    div."+String(io)+(" {\n        border-radius: 3px;\n        padding: 5px;\n        margin-bottom: 6px;\n        background-color: #444;\n    }\n\n    div."+String(no)+(" {\n        margin: 4px;\n        padding: 6px;\n        border-radius: 3px;\n        border-color: #aaa;\n        border-width: 1px;\n        border-style: solid;\n        background-color: #fcc;\n    }\n\n    div."+String(ro)+(" {\n        margin: 4px;\n        padding: 4px;\n        border-radius: 3px;\n        border-color: #aaa;\n        border-width: 1px;\n        border-style: solid;\n        background-color: #cfc;\n    }\n\n    div."+String(ro))))+" > h3 {\n        font-size: 16px;\n        font-weight: bold;\n        margin: 4px;\n    }\n    \n    ",0]]]]]]]]]);var co,fo,lo,ho=(co=function(e){return aa.viewRules},lo={init:function(e){return M(fo.init,e,ca(document.location))},update:(fo={init:function(e,t){return[ia.init(void 0),0]},update:function(e,t){function r(e,t){var r=Ui.rule_database_result_from_rule_strings(t.rules);return r.tag?(console.error(r[0]),e):r[0]}var n,i=e.interaction_mode,a=e.rule_database;if("number"==typeof t)switch(t){case 0:s={rule_database:e.rule_database,available_chapters:e.available_chapters,chapter_opt:e.chapter_opt,interaction_mode:0};break;case 1:s={rule_database:e.rule_database,available_chapters:e.available_chapters,chapter_opt:e.chapter_opt,interaction_mode:ee(0,[{text:"",compilation_result:ee(1,[0])}])};break;case 2:var o=e.chapter_opt,u=void 0!==o?(n=o,Rn.next_or_this_item(n,Ki)):function(e){if(e)return e[0];throw[w,"hd"]}(Ki),s={rule_database:r(a,u),available_chapters:e.available_chapters,chapter_opt:u,interaction_mode:0};break;case 3:s="number"==typeof i||3!==i.tag?e:{rule_database:e.rule_database,available_chapters:e.available_chapters,chapter_opt:e.chapter_opt,interaction_mode:ee(3,[na(i[0])])}}else switch(0|t.tag){case 0:var c=t[0],f=de(Ni.RuleDatabase.rule_from_entry,c);s={rule_database:e.rule_database,available_chapters:e.available_chapters,chapter_opt:e.chapter_opt,interaction_mode:ee(1,[c,ta(Ni.Rule.to_string,f)])};break;case 1:s={rule_database:e.rule_database,available_chapters:e.available_chapters,chapter_opt:e.chapter_opt,interaction_mode:ee(2,[ta(Ni.Query.to_string,t[0])])};break;case 2:var l=t[0];s={rule_database:void 0!==l?r(a,l):Ni.RuleDatabase.empty,available_chapters:e.available_chapters,chapter_opt:l,interaction_mode:0};break;case 3:var d=t[0],h=Ei.rule_database_snapshot(a);if("number"==typeof i)s=e;else switch(0|i.tag){case 0:s={rule_database:e.rule_database,available_chapters:e.available_chapters,chapter_opt:e.chapter_opt,interaction_mode:ee(0,[ra(d,Ui.rule_parser,function(e){return Ei.issues_in_new_rule(h,e)})])};break;case 1:var v=i[0];s={rule_database:e.rule_database,available_chapters:e.available_chapters,chapter_opt:e.chapter_opt,interaction_mode:ee(1,[v,ra(d,Ui.rule_parser,function(e){return Ei.issues_in_existing_rule(h,M(Ni.RuleDatabase.update_rule_entry,v,e))})])};break;case 2:s={rule_database:e.rule_database,available_chapters:e.available_chapters,chapter_opt:e.chapter_opt,interaction_mode:ee(2,[ra(d,Ui.query_parser,function(e){return Ei.issues_in_query(h,e)})])};break;case 3:s=e}break;case 4:s={rule_database:M(Ni.RuleDatabase.add_rule,a,t[0]),available_chapters:e.available_chapters,chapter_opt:e.chapter_opt,interaction_mode:ee(0,[{text:"",compilation_result:ee(1,[0])}])};break;case 5:s={rule_database:M(Ni.RuleDatabase.update_rule,a,t[0]),available_chapters:e.available_chapters,chapter_opt:e.chapter_opt,interaction_mode:0};break;case 6:s={rule_database:M(Ni.RuleDatabase.remove_rule,a,t[0]),available_chapters:e.available_chapters,chapter_opt:e.chapter_opt,interaction_mode:e.interaction_mode};break;case 7:var p=t[0],m=Xi.query(a,p);s={rule_database:e.rule_database,available_chapters:e.available_chapters,chapter_opt:e.chapter_opt,interaction_mode:ee(3,[{initiating_query:p,solution_stream:m,displayed_solutions:0}])}}return[s,0]},view:function(e){return _a([["https://jsuder-xx.github.io","My Home Page"],[["https://github.com/JSuder-xx/litlog","On GitHub"],0]],(t=[to(e),[uo(e),0]],Yr(void 0,void 0,[ln(ka),0],t)));var t},subscriptions:function(e){return 0},shutdown:function(e){return 0}}).update,view:fo.view,subscriptions:function(e){return ee(0,[[la(co),[de(fo.subscriptions,e),0]]])},shutdown:fo.shutdown},function(e,t){return sa(lo,e,t)});return e.main=function(e,t){var r=document.createElement("style");return document.head.appendChild(r),r.innerHTML=so,M(ho,e,void 0)},e}({});
