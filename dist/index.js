var starter=function(e){"use strict";var w=["Failure",-2],E=["Invalid_argument",-3],S=["Division_by_zero",-5],L=["Not_found",-6],s=["Match_failure",-7],M=["Assert_failure",-10];function o(e,r,n){for(var t=new Array(n),a=0,i=r;a<n;)t[a]=e[i],a=a+1|0,i=i+1|0;return t}function le(e,r){if(r<0||r>=e.length)throw[E,"index out of bounds"];return e[r]}function y(e,r){for(;;){var n=r,t=e,a=t.length,i=0===a?1:a,u=i-n.length|0;if(0==u)return t.apply(null,n);if(0<=u)return function(r,n){return function(e){return y(r,n.concat([e]))}}(t,n);r=o(n,i,0|-u),e=t.apply(null,o(n,0,i))}}function ve(u,o){var e=u.length;if(1===e)return u(o);switch(e){case 1:return u(o);case 2:return function(e){return u(o,e)};case 3:return function(e,r){return u(o,e,r)};case 4:return function(e,r,n){return u(o,e,r,n)};case 5:return function(e,r,n,t){return u(o,e,r,n,t)};case 6:return function(e,r,n,t,a){return u(o,e,r,n,t,a)};case 7:return function(e,r,n,t,a,i){return u(o,e,r,n,t,a,i)};default:return y(u,[o])}}function C(i,u,o){var e=i.length;if(2===e)return i(u,o);switch(e){case 1:return y(i(u),[o]);case 2:return i(u,o);case 3:return function(e){return i(u,o,e)};case 4:return function(e,r){return i(u,o,e,r)};case 5:return function(e,r,n){return i(u,o,e,r,n)};case 6:return function(e,r,n,t){return i(u,o,e,r,n,t)};case 7:return function(e,r,n,t,a){return i(u,o,e,r,n,t,a)};default:return y(i,[u,o])}}function D(a,i,u,o){var e=a.length;if(3===e)return a(i,u,o);switch(e){case 1:return y(a(i),[u,o]);case 2:return y(a(i,u),[o]);case 3:return a(i,u,o);case 4:return function(e){return a(i,u,o,e)};case 5:return function(e,r){return a(i,u,o,e,r)};case 6:return function(e,r,n){return a(i,u,o,e,r,n)};case 7:return function(e,r,n,t){return a(i,u,o,e,r,n,t)};default:return y(a,[i,u,o])}}function ee(e,r){return r.tag=e,r}function a(e,r){return e<r?-1:e===r?0:1}function h(e,r){return e===r?0:e<r?-1:1}w.tag=248,E.tag=248,S.tag=248,L.tag=248,s.tag=248,M.tag=248;var p=function(e,r){for(var n in e)r(n)};function i(e){var r=[e];return r.tag=246,r}function m(e,r){for(;;){var n=r,t=e;if(t===n)return!0;var a=typeof t;if("string"==a||"number"==a||"boolean"==a||"undefined"==a||null===t)return!1;var i=typeof n;if("function"==a||"function"==i)throw[E,"equal: functional value"];if("number"==i||"undefined"==i||null===n)return!1;var u=0|t.tag,o=0|n.tag;if(250!=u)if(250!=o){if(248==u)return t[1]===n[1];if(251==u)throw[E,"equal: abstract value"];if(u!=o)return!1;if(256==u)return t[1]===n[1];var c=0|t.length;if(c!=(0|n.length))return!1;if(!Array.isArray(t)){if(t instanceof Date&&n instanceof Date)return!(n<t||t<n);var s={contents:!0},f=function(r,n){return function(e){r.hasOwnProperty(e)||(n.contents=!1)}}(n,s),l=function(r,n,t){return function(e){r.hasOwnProperty(e)&&m(n[e],r[e])||(t.contents=!1)}}(t,n,s);return p(t,f),s.contents&&p(n,l),s.contents}for(var v=0;;){var d=v;if(d===c)return!0;if(!m(t[d],n[d]))return!1;v=d+1|0}}else r=n[0];else e=t[0]}}function re(e,r){return!m(e,r)}function g(e){if(e<0)throw[E,"String.create"];for(var r=new Array(e),n=0;n<e;++n)r[n]=0;return r}function b(e,r,n,t,a){if(!(a<=0))if(e!==n){var i=e.length-r|0;if(a<=i)for(var u=0;u<a;++u)n[t+u|0]=e[r+u|0];else{for(var o=0;o<i;++o)n[t+o|0]=e[r+o|0];for(var c=i;c<a;++c)n[t+c|0]=0}}else{if(r<t){for(var s=(e.length-t|0)-1|0,f=a-1|0,l=f<s?f:s;0<=l;--l)e[t+l|0]=e[r+l|0];return}if(r<=t)return;for(var v=(e.length-r|0)-1|0,d=a-1|0,h=d<v?d:v,p=0;p<=h;++p)e[t+p|0]=e[r+p|0]}}function f(e){var r=e.length,n="",t=r;if(r<=4096&&r===e.length)return String.fromCharCode.apply(null,e);for(var a=0;0<t;){var i=t<1024?t:1024,u=new Array(i);b(e,a,u,0,i),n+=String.fromCharCode.apply(null,u),t=t-i|0,a=a+i|0}return n}function c(e,r,n,t,a){if(!(a<=0)){var i=e.length-r|0;if(a<=i)for(var u=0;u<a;++u)n[t+u|0]=e.charCodeAt(r+u|0);else{for(var o=0;o<i;++o)n[t+o|0]=e.charCodeAt(r+o|0);for(var c=i;c<a;++c)n[t+c|0]=0}}}function l(e){for(var r=e.length,n=new Array(r),t=0;t<r;++t)n[t]=e.charCodeAt(t);return n}var v=Math.imul||function(e,r){return((e>>16)*(r|=0)<<16)+(65535&e)*r|0};function k(e,r){return[r,e>>>0]}var x=[-2147483648,0],r=[2147483647,4294967295],A=[0,1],N=[0,0],O=[-1,4294967295];function u(e){return 0!=(2147483648&e)}function d(e){return 0==(2147483648&e)}function q(e){var r=1+(-1^e[1])|0;return k(r,(-1^e[0])+(0==r?1:0)|0)}function _(e,r,n){var t=e[1],a=t+r|0,i=u(t)&&(u(r)||d(a))||u(r)&&d(a)?1:0;return k(a,e[0]+n+i|0)}function R(e,r){return _(e,r[1],r[0])}function T(e,r){return e[0]===r[0]&&e[1]===r[1]}function F(e,r,n){var t=1+(-1^r)>>>0;return _(e,t,(-1^n)+(0==t?1:0)|0)}function P(e,r){return F(e,r[1],r[0])}function I(e,r){for(;;){var n,t=r,a=e,i=0,u=0;if(0!==a[0])u=3;else{if(0===a[1])return N;u=3}if(3===u)if(0!==t[0])i=2;else{if(0===t[1])return N;i=2}if(2===i){var o=a[0],c=0;if(-2147483648!==o||0!==a[1]?c=3:n=t[1],3===c){var s=t[0],f=a[1],l=0;if(-2147483648!==s||0!==t[1]?l=4:n=f,4===l){var v=t[1];if(o<0){if(0<=s)return q(I(q(a),t));r=q(t),e=q(a);continue}if(s<0)return q(I(a,q(t)));var d=65535&o,h=f>>>16,p=65535&f,m=65535&s,g=v>>>16,b=65535&v,w=0,y=0,_=0,S=p*b,w=(y=(y=(_=(S>>>16)+h*b)>>>16)+((_=(65535&_)+p*g)>>>16)+d*b)>>>16;return w+=(y=(65535&y)+h*g)>>>16,w+=(y=(65535&y)+p*m)>>>16,k(65535&S|(65535&_)<<16,(y&=65535)|(w=(o>>>16)*b+d*g+h*m+p*(s>>>16)+w&65535)<<16)}}}return 0==(1&n)?N:x}}function W(e,r){var n=r[0],t=e[0];return n<t||!(t<n)&&e[1]>=r[1]}function $(e,r){return!T(e,r)}function J(e,r){return!W(e,r)}function Z(e){return 4294967296*e[0]+e[1]}function B(e){return isNaN(e)||!isFinite(e)?N:e<=-0x8000000000000000?x:0x8000000000000000<=e+1?r:e<0?q(B(-e)):k(e%4294967296|0,e/4294967296|0)}function H(e){if(n=(r=e)[0],0==(t=n>>21)||-1==t&&(0!==r[1]||-2097152!==n))return String(Z(e));var r,n,t;if(e[0]<0)return T(e,x)?"-9223372036854775808":"-"+H(q(e));var a=B(Math.floor(Z(e)/10)),i=a[1],u=a[0],o=F(F(e,i<<3,i>>>29|u<<3),i<<1,i>>>31|u<<1),c=o[1],s=o[0];if(0===c&&0===s)return H(a)+"0";if(s<0){var f=1+(-1^c)>>>0,l=Math.ceil(f/10),v=10*l-f;return H(F(a,0|l,0))+String(0|v)}var d=c,h=Math.floor(d/10),p=d-10*h;return H(_(a,0|h,0))+String(0|p)}function Q(e,r){for(;;){var n=r,t=e,a=0,i=0;if(0===n[0]&&0===n[1])throw S;if((i=3)===i){var u=t[0];if(-2147483648!==u)if(0!==u)a=2;else{if(0===t[1])return N;a=2}else if(0!==t[1])a=2;else{if(T(n,A)||T(n,O))return t;if(T(n,x))return A;var o=function(e,r){if(0===r)return e;var n=e[1];return 32<=r?k(0,n<<(r-32|0)):k(n<<r,n>>>(32-r|0)|e[0]<<r)}(Q(function(e,r){if(0===r)return e;var n=e[0];return r<32?k(n<<(32-r|0)|e[1]>>>r,n>>r):k(n>>(r-32|0),0<=n?0:-1)}(t,1),n),1),c=0;if(0!==o[0])c=4;else{if(0===o[1])return n[0]<0?A:q(A);c=4}if(4===c)return R(o,Q(P(t,I(n,o)),n))}}if(2===a&&-2147483648===n[0]&&0===n[1])return N;var s=n[0];if(!(t[0]<0)){if(s<0)return q(Q(t,q(n)));for(var f=N,l=t;W(l,n);){for(var v=(y=1,(_=Math.floor(Z(l)/Z(n)))<y?y:_),d=Math.ceil(Math.log(v)/Math.LN2),h=d<=48?1:Math.pow(2,d-48),p=B(v),m=I(p,n);m[0]<0||(w=l,(b=m)[0]>w[0]||!(b[0]<w[0])&&b[1]>w[1]);)m=I(p=B(v-=h),n);0===(g=p)[0]&&0===g[1]&&(p=A),f=R(f,p),l=P(l,m)}return f}if(0<=s)return q(Q(q(t),n));r=q(n),e=q(t)}var g,b,w,y,_}function V(e,r){var n=Q(e,r);return[n,P(e,I(n,r))]}function U(e){return 0|e[1]}function j(e){function r(e){return(e>>>0).toString(16)}var n=e[1],t=e[0];if(0===t&&0===n)return"0";if(0===n)return r(t)+"00000000";if(0===t)return r(n);var a=r(n),i=8-a.length|0;return i<=0?r(t)+a:r(t)+("0".repeat(i)+a)}function z(e){return[2147483647&e[0],e[1]]}function X(n){var e=n.length;if(31<e)throw[E,"format_int: format too long"];for(var r,t={justify:"+",signstyle:"-",filter:" ",alternate:!1,base:2,signedconv:!1,width:0,uppercase:!1,sign:1,prec:-1,conv:"f"},a=0;;){var i=a;if(e<=i)return t;var u=n.charCodeAt(i),o=0;if(69<=u)if(88<=u)if(121<=u)o=1;else switch(u-88|0){case 0:t.base=1,t.uppercase=!0,a=i+1|0;continue;case 13:case 14:case 15:o=5;break;case 12:case 17:o=4;break;case 23:a=i+1|(t.base=0);continue;case 29:t.base=2,a=i+1|0;continue;case 1:case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 16:case 18:case 19:case 20:case 21:case 22:case 24:case 25:case 26:case 27:case 28:case 30:case 31:o=1;break;case 32:a=i+(t.base=1)|0;continue}else{if(!(72<=u)){t.signedconv=!0,t.uppercase=!0,t.conv=String.fromCharCode(65<=(r=u)&&r<=90||192<=r&&r<=214||216<=r&&r<=222?r+32|0:r),a=i+1|0;continue}o=1}else switch(u){case 35:t.alternate=!0,a=i+1|0;continue;case 32:case 43:o=2;break;case 45:t.justify="-",a=i+1|0;continue;case 46:for(var c=i+1|(t.prec=0);function(r){return function(){var e=n.charCodeAt(r)-48|0;return 0<=e&&e<=9}}(c)();)t.prec=(v(t.prec,10)+n.charCodeAt(c)|0)-48|0,c=c+1|0;a=c;continue;case 33:case 34:case 36:case 37:case 38:case 39:case 40:case 41:case 42:case 44:case 47:o=1;break;case 48:t.filter="0",a=i+1|0;continue;case 49:case 50:case 51:case 52:case 53:case 54:case 55:case 56:case 57:o=3;break;default:o=1}switch(o){case 1:a=i+1|0;continue;case 2:t.signstyle=String.fromCharCode(u),a=i+1|0;continue;case 3:t.width=0;for(var s=i;function(r){return function(){var e=n.charCodeAt(r)-48|0;return 0<=e&&e<=9}}(s)();)t.width=(v(t.width,10)+n.charCodeAt(s)|0)-48|0,s=s+1|0;a=s;continue;case 4:t.signedconv=!0,t.base=2,a=i+1|0;continue;case 5:t.signedconv=!0,t.conv=String.fromCharCode(u),a=i+1|0;continue}}}function G(e,r){var n=e.justify,t=e.signstyle,a=e.filter,i=e.alternate,u=e.base,o=e.signedconv,c=e.width,s=e.uppercase,f=e.sign,l=r.length;o&&(f<0||"-"!==t)&&(l=l+1|0),i&&(0===u?l=l+1|0:1===u&&(l=l+2|0));var v="";if("+"===n&&" "===a)for(var d=l;d<c;++d)v+=a;if(o&&(f<0?v+="-":"-"!==t&&(v+=t)),i&&0===u&&(v+="0"),i&&1===u&&(v+="0x"),"+"===n&&"0"===a)for(var h=l;h<c;++h)v+=a;if(v=s?v+r.toUpperCase():v+r,"-"===n)for(var p=l;p<c;++p)v+=" ";return v}function K(e,r){if("%d"===e)return String(r);var n,t=X(e),a=(r<0?t.signedconv?(t.sign=-1,-r):r>>>0:r).toString(function(e){switch(e){case 0:return 8;case 1:return 16;case 2:return 10}}(t.base));return 0<=t.prec&&(t.filter=" ",0<(n=t.prec-a.length|0)&&(a="0".repeat(n)+a)),G(t,a)}function n(e,r){if("%d"===e)return H(r);var n,t,a,i=X(e),u=i.signedconv&&J(r,N)?(i.sign=-1,q(r)):r;switch(i.base){case 0:n=function(e){var r="",n=k(8,0),t="01234567";if(J(e,N)){var a=V(z(e),n),i=R(k(0,268435456),a[0]);for(r=t[U(a[1])]+r;$(i,N);)var u=V(i,n),i=u[0],r=t[U(u[1])]+r}else{var o=V(e,n),c=o[0];for(r=t[U(o[1])]+r;$(c,N);){var s=V(c,n),c=s[0];r=t[U(s[1])]+r}}return r}(u);break;case 1:n=j(u);break;case 2:n=function(e){if(!J(e,N))return H(e);var r=k(10,0),n=V(z(e),r),t=V(R(k(8,0),n[1]),r);return H(R(R(k(-858993460,214748364),n[0]),t[0]))+"0123456789"[U(t[1])]}(u)}return a=0<=i.prec?(i.filter=" ",0<(t=i.prec-n.length|0)?"0".repeat(t)+n:n):n,G(i,a)}var Y=function(e,r,n){if(!isFinite(e))return isNaN(e)?"nan":0<e?"infinity":"-infinity";var t=(0!=e||1/e!=-1/0)&&0<=e?0:1;t&&(e=-e);var a=0;if(0!=e)if(e<1)for(;e<1&&-1022<a;)e*=2,a--;else for(;2<=e;)e/=2,a++;var i,u=a<0?"":"+",o="";if(t)o="-";else switch(n){case 43:o="+";break;case 32:o=" "}0<=r&&r<13&&(i=Math.pow(2,4*r),e=Math.round(e*i)/i);var c,s,f=e.toString(16);return 0<=r&&((c=f.indexOf("."))<0?f+="."+"0".repeat(r):(s=c+1+r,f.length<s?f+="0".repeat(s-f.length):f=f.substr(0,s))),o+"0x"+f+"p"+u+a.toString(10)},t=K,ne=K;function te(e,r){if(r>=e.length||r<0)throw[E,"index out of bounds"];return e.charCodeAt(r)}var ae={contents:0};function ie(e){var r=[e,(ae.contents=ae.contents+1,ae.contents)];return r.tag=248,r}var ue=[];function oe(e){if(void 0===e){var r=[ue,0];return r.tag=256,r}if(null===e||e[0]!==ue)return e;var n=e[1]+1|0,t=[ue,n];return t.tag=256,t}function ce(e){if(null===e||e[0]!==ue)return e;var r=e[1];return 0===r?void 0:[ue,r-1|0]}var se=ie("Caml_js_exceptions.Error");function fe(e){return function(e){if(void 0!==e){if(248===e.tag)return 1;var r=e[0];return void 0!==r&&248===r.tag}}(e)?e:[se,e]}function de(e){if("number"==typeof e)return 0;switch(0|e.tag){case 0:return ee(0,[de(e[0])]);case 1:return ee(1,[de(e[0])]);case 2:return ee(2,[de(e[0])]);case 3:return ee(3,[de(e[0])]);case 4:return ee(4,[de(e[0])]);case 5:return ee(5,[de(e[0])]);case 6:return ee(6,[de(e[0])]);case 7:return ee(7,[de(e[0])]);case 8:return ee(8,[e[0],de(e[1])]);case 9:var r=e[0];return ee(9,[r,r,de(e[2])]);case 10:return ee(10,[de(e[0])]);case 11:return ee(11,[de(e[0])]);case 12:return ee(12,[de(e[0])]);case 13:return ee(13,[de(e[0])]);case 14:return ee(14,[de(e[0])])}}function he(e,r){if("number"==typeof e)return r;switch(0|e.tag){case 0:return ee(0,[he(e[0],r)]);case 1:return ee(1,[he(e[0],r)]);case 2:return ee(2,[he(e[0],r)]);case 3:return ee(3,[he(e[0],r)]);case 4:return ee(4,[he(e[0],r)]);case 5:return ee(5,[he(e[0],r)]);case 6:return ee(6,[he(e[0],r)]);case 7:return ee(7,[he(e[0],r)]);case 8:return ee(8,[e[0],he(e[1],r)]);case 9:return ee(9,[e[0],e[1],he(e[2],r)]);case 10:return ee(10,[he(e[0],r)]);case 11:return ee(11,[he(e[0],r)]);case 12:return ee(12,[he(e[0],r)]);case 13:return ee(13,[he(e[0],r)]);case 14:return ee(14,[he(e[0],r)])}}ie("Pervasives.Exit");function pe(e){return 0<=e?e:0|-e}function me(e){return e?"true":"false"}function ge(e){for(var r=0,n=e;;){if(!n)return r;n=n[1],r=r+1|0}}function be(e,r){for(;;){if(!e)return r;r=[e[0],r],e=e[1]}}function we(e){return be(e,0)}function ye(e){return e?function e(r,n){return r?[r[0],e(r[1],n)]:n}(e[0],ye(e[1])):0}function _e(e,r){return r?[ve(e,r[0]),_e(e,r[1])]:0}function Se(e,r){for(;;){var n=r;if(!n)return;ve(e,n[0]),r=n[1]}}function ke(e,r,n){for(;;){var t=n;if(!t)return r;n=t[1],r=C(e,r,t[0])}}function xe(e,r){if(e){if(r)return[[e[0],r[0]],xe(e[1],r[1])];throw[E,"List.combine"]}if(!r)return 0;throw[E,"List.combine"]}function Ae(e,r){for(;;){if(0===e)return r;if(!r)throw[M,["list.ml",262,11]];r=r[1],e=e-1|0}}var Ne=ye,Oe=function(o){return function(e){for(var r=0,n=e;;){var t=n,a=r;if(!t)return be(a,0);var i=t[1],u=t[0];ve(o,u)?(n=i,r=[u,a]):n=i}}},qe=function(_,e){function S(e,r){if(2!==e){if(3===e&&r){var n=r[1];if(n){var t=n[1];if(t){var a=t[0],i=n[0],u=r[0];return C(_,u,i)<=0?C(_,i,a)<=0?[u,[i,[a,0]]]:C(_,u,a)<=0?[u,[a,[i,0]]]:[a,[u,[i,0]]]:C(_,u,a)<=0?[i,[u,[a,0]]]:C(_,i,a)<=0?[i,[a,[u,0]]]:[a,[i,[u,0]]]}}}}else if(r){var o=r[1];if(o){var c=o[0],s=r[0];return C(_,s,c)<=0?[s,[c,0]]:[c,[s,0]]}}for(var f=e>>1,l=e-f|0,v=Ae(f,r),d=k(f,r),h=k(l,v),p=0;;){var m=p,g=h,b=d;if(!b)return be(g,m);if(!g)return be(b,m);var w=g[0],y=b[0];0<C(_,y,w)?(p=[y,m],d=b[1]):(p=[w,m],h=g[1])}}var k=function(e,r){if(2!==e){if(3===e&&r){var n=r[1];if(n){var t=n[1];if(t){var a=t[0],i=n[0],u=r[0];return 0<C(_,u,i)?0<C(_,i,a)?[u,[i,[a,0]]]:0<C(_,u,a)?[u,[a,[i,0]]]:[a,[u,[i,0]]]:0<C(_,u,a)?[i,[u,[a,0]]]:0<C(_,i,a)?[i,[a,[u,0]]]:[a,[i,[u,0]]]}}}}else if(r){var o=r[1];if(o){var c=o[0],s=r[0];return 0<C(_,s,c)?[s,[c,0]]:[c,[s,0]]}}for(var f=e>>1,l=e-f|0,v=Ae(f,r),d=S(f,r),h=S(l,v),p=0;;){var m=p,g=h,b=d;if(!b)return be(g,m);if(!g)return be(b,m);var w=g[0],y=b[0];C(_,y,w)<=0?(p=[y,m],d=b[1]):(p=[w,m],h=g[1])}},r=ge(e);return r<2?e:S(r,e)};function Re(e){return 97<=e&&e<=122?e-32|0:e}function Te(e,r){var n=g(e);return function(e,r,n,t){if(!(n<=0))for(var a=r,i=n+r|0;a<i;++a)e[a]=t}(n,0,e,r),n}var Fe=[];function Ee(e,r,n){if(r<0||n<0||r>(e.length-n|0))throw[E,"String.sub / Bytes.sub"];var t=g(n);return b(e,r,t,0,n),t}function Le(e,r,n){return f(Ee(e,r,n))}function Me(e,r,n,t,a){if(a<0||r<0||r>(e.length-a|0)||t<0||t>(n.length-a|0))throw[E,"Bytes.blit"];return b(e,r,n,t,a),0}function Ce(e,r,n,t,a){if(a<0||r<0||r>(e.length-a|0)||t<0||t>(n.length-a|0))throw[E,"String.blit / Bytes.blit_string"];return c(e,r,n,t,a)}function De(e){var r=e-9|0;return 4<r||r<0?23==r:2!=r}function Pe(e){for(var r,n,t,a=0,i=0,u=e.length;i<u;++i)var o,c=e[i],a=a+(32<=c?58<(o=c-34|0)||o<0?93<=o?4:1:57<o||o<1?2:1:11<=c?13!==c?4:2:8<=c?2:4)|0;if(a===e.length)return n=(r=e).length,t=g(n),b(r,0,t,0,n),t;for(var s=g(a),f=a=0,l=e.length;f<l;++f){var v=e[f],d=0;if(35<=v)92!==v?127<=v?d=1:s[a]=v:d=2;else if(32<=v)34<=v?d=2:s[a]=v;else if(14<=v)d=1;else switch(v){case 8:s[a]=92,s[a=a+1|0]=98;break;case 9:s[a]=92,s[a=a+1|0]=116;break;case 10:s[a]=92,s[a=a+1|0]=110;break;case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:case 11:case 12:d=1;break;case 13:s[a]=92,s[a=a+1|0]=114}switch(d){case 1:s[a]=92,s[a=a+1|0]=48+(v/100|0)|0,s[a=a+1|0]=48+(v/10|0)%10|0,s[a=a+1|0]=48+v%10|0;break;case 2:s[a]=92,s[a=a+1|0]=v}a=a+1|0}return s}function Ie(e){return function(e,r){var n=r.length;if(0===n)return r;for(var t=g(n),a=0;a<n;++a)t[a]=ve(e,r[a]);return t}(Re,e)}function We(e,r){return f(Te(e,r))}function $e(e,r,n){for(;;){if(!n)return e;var t=n[1],a=n[0];if(!t)return a.length+e|0;n=t,e=function(e,r){if(r<=e)return e;throw[E,"String.concat"]}((a.length+r|0)+e|0,e)}}function Je(e,r){if(!r)return"";var n=e.length;return f(function(e,r,n,t,a){for(;;){var i=r;if(!a)return e;var u=a[1],o=a[0];if(!u)return c(o,0,e,i,o.length),e;c(o,0,e,i,o.length),c(n,0,e,i+o.length|0,t),a=u,r=(i+o.length|0)+t|0}}(g($e(0,n,r)),0,e,n,r))}function Ze(e){var r=e-9|0;return 4<r||r<0?23==r:2!=r}function Be(e){return""===e||!Ze(e.charCodeAt(0))&&!Ze(e.charCodeAt(e.length-1|0))?e:f(function(e){for(var r=e.length,n=0;n<r&&De(e[n]);)n=n+1|0;for(var t=r-1|0;n<=t&&De(e[t]);)t=t-1|0;return n<=t?Ee(e,n,1+(t-n|0)|0):Fe}(l(e)))}var He=h,Qe=Ce;function Ve(e,r,n,t){var a,i,u=void 0!==r&&r,o=e.style;return void 0!==o.setProperty?o.setProperty(n,t,u?"important":null):(a=n,i=t,void(e.style[a]=i))}function Ue(e,r,n){return e.insertBefore(r,n)}function je(e,r,n,t){return""===r?e.setAttribute(n,t):e.setAttributeNS(r,n,t)}function ze(e,r){return""===e?document.createElement(r):document.createElementNS(e,r)}var Xe=ee(0,[""]);function Ge(e,r,n,t,a,i){return ee(2,[e,r,n,t,a,i])}function Ke(e,r,n){return ee(3,[e,ee(0,[r,n]),{contents:void 0}])}function Ye(e){for(;;){var r=e;switch(0|r.tag){case 0:return"\x3c!-- "+r[0]+" --\x3e";case 1:return r[0];case 2:var n=r[1],t=r[0];return Je("",["<",[t,[""===t?"":":",[n,[Je("",_e(function(e){if("number"==typeof e)return"";switch(0|e.tag){case 0:return Je("",[" ",[e[0],['="',[e[1],['"',0]]]]]);case 1:return Je("",[" ",[e[1],['="',[e[2],['"',0]]]]]);case 2:return Je("",[" data-",[e[0],['="',[e[1],['"',0]]]]]);case 3:return"";case 4:return Je("",[' style="',[Je(";",_e(function(e){return Je("",[e[0],[":",[e[1],[";",0]]]])},e[0])),['"',0]]])}},r[4])),[">",[Je("",_e(Ye,r[5])),["</",[n,[">",0]]]]]]]]]]);case 3:e=ve(r[1],void 0);continue;case 4:e=r[1];continue}}}function er(e){if(!e.tag)return e[1];var r=e[0];return function(e){return oe(r)}}function rr(e,r,n,t){var a,i,u,o,c,s={contents:er(t)},f=(a=e,i=s,function(e){var r=ve(i.contents,e);if(void 0!==r)return ve(a.contents.enqueue,ce(r))});return u=n,o=f,c=!1,r.addEventListener(u,o,c),{handler:f,cb:s}}function nr(e,r,n){if(void 0!==n)return t=e,a=r,i=n.handler,u=!1,void t.removeEventListener(a,i,u);var t,a,i,u}function tr(e,r,n,t,a,i,u,o){var c,s,f=u.contents;if(void 0!==f)if(n!==t){u.contents=nr(r,n,u.contents),o.contents=rr(e,r,t,i)}else{if(o.contents=u.contents,c=a,(s=i).tag?c.tag&&m(s[0],c[0]):!c.tag&&s[0]===c[0])return;var l=er(i);f.cb.contents=l}else o.contents=rr(e,r,t,i)}function ar(e,r,n,t,a){!function(n,e){var r,t,a;if("number"!=typeof e)switch(0|e.tag){case 0:return n[e[0]]=void 0;case 1:return r=n,t=e[0],a=e[1],""===t?r.removeAttribute(a):r.removeAttributeNS(t,a);case 2:throw console.log(["TODO:  Remove Data Unhandled",e[0],e[1]]),[w,"TODO:  Remove Data Unhandled"];case 3:var i=e[2];return i.contents=nr(n,e[0],i.contents);case 4:ke(function(e,r){return Ve(n,void 0,r[0],null)},void 0,e[0])}}(r,t),function(e,n,r){if("number"!=typeof r)switch(0|r.tag){case 0:return n[r[0]]=r[1];case 1:return je(n,r[0],r[1],r[2]);case 2:throw console.log(["TODO:  Add Data Unhandled",r[0],r[1]]),[w,"TODO:  Add Data Unhandled"];case 3:return r[2].contents=rr(e,n,r[0],r[1]);case 4:ke(function(e,r){return Ve(n,void 0,r[0],r[1])},void 0,r[0])}}(e,r,a)}function ir(e,u,r,n,t){if("number"==typeof t)throw[w,"This should never be called as all entries through NoProp are gated."];switch(0|t.tag){case 0:return void(u[t[0]]=t[1]);case 1:return je(u,t[0],t[1],t[2]);case 2:throw console.log(["TODO:  Mutate Data Unhandled",t[0],t[1]]),[w,"TODO:  Mutate Data Unhandled"];case 3:throw[w,"This will never be called because it is gated"];case 4:if("number"==typeof n)throw[w,"Passed a non-Style to a new Style as a Mutations while the old Style is not actually a style!"];if(4===n.tag)return function(e,r,n,t){for(;;){var a=t,i=n,u=r;if(i){if(a){t=a[1],n=i[1],r=D(e,u,i[0],a[0]);continue}throw[E,"List.fold_left2"]}if(a)throw[E,"List.fold_left2"];return u}}(function(e,r,n){var t=n[1],a=n[0],i=r[0];return i===a?r[1]===t?void 0:Ve(u,void 0,a,t):(Ve(u,void 0,i,null),Ve(u,void 0,a,t))},void 0,n[0],t[0]);throw[w,"Passed a non-Style to a new Style as a Mutations while the old Style is not actually a style!"]}}function ur(e,r,n,t){return function(e,r,n,t){for(;;){var a=t,i=n;if(!i)return!a;var u=i[0];if(!a)return!1;if("number"==typeof u){if("number"==typeof a[0]){t=a[1],n=i[1],0;continue}}else switch(0|u.tag){case 0:var o=a[0];if("number"==typeof o||o.tag)break;u[0]===o[0]&&u[1]===o[1]||ir(0,r,0,u,o),t=a[1],n=i[1],0;continue;case 1:var c=a[0];if("number"==typeof c||1!==c.tag)break;u[0]===c[0]&&u[1]===c[1]&&u[2]===c[2]||ir(0,r,0,u,c),t=a[1],n=i[1],0;continue;case 2:var s=a[0];if("number"==typeof s||2!==s.tag)break;u[0]===s[0]&&u[1]===s[1]||ir(0,r,0,u,s),t=a[1],n=i[1],0;continue;case 3:var f=a[0];if("number"==typeof f||3!==f.tag)break;tr(e,r,u[0],f[0],u[1],f[1],u[2],f[2]),t=a[1],n=i[1],0;continue;case 4:var l=a[0];if("number"==typeof l||4!==l.tag)break;m(u[0],l[0])||ir(0,r,0,u,l),t=a[1],n=i[1],0;continue}ar(e,r,0,u,a[0]),t=a[1],n=i[1],0}}(e,r,n,t)}function or(e,r,n,t,a){if(2!==a.tag)throw[w,"Node replacement should never be passed anything but a node itself"];var i=a[4],u=le(n,t),o=ze(a[0],a[1]);if(ur(e,o,_e(function(e){return 0},i),i))return fr(e,o,o.childNodes,0,0,a[5]),Ue(r,o,u),void r.removeChild(u);throw[s,["vdom.ml",319,30]]}function cr(e,r){for(;;){var n=r,t=e;switch(0|n.tag){case 0:var a=n[0];return document.createComment(a);case 1:var i=n[0];return document.createTextNode(i);case 2:var u=n[4],o=ze(n[0],n[1]);if(ur(t,o,_e(function(e){return 0},u),u))return fr(t,o,o.childNodes,0,0,n[5]),o;throw[s,["vdom.ml",333,30]];case 3:var c=ve(n[1],void 0);r=n[2].contents=c;continue;case 4:r=n[1],e=ve(n[0],t);continue}}}function sr(e,r,n,t,a,i){if(2!==a.tag)throw[w,"Non-node passed to patchVNodesOnElems_MutateNode"];if(2!==i.tag)throw[w,"Non-node passed to patchVNodesOnElems_MutateNode"];if(a[3]!==i[3]||a[1]!==i[1])return or(e,r,n,t,i),0;var u=le(n,t),o=u.childNodes;return ur(e,u,a[4],i[4])||(console.log("VDom:  Failed swapping properties because the property list length changed, use `noProp` to swap properties instead, not by altering the list structure.  This is a massive inefficiency until this issue is resolved."),or(e,r,n,t,i)),fr(e,u,o,0,a[5],i[5])}function fr(e,r,n,t,a,i){for(;;){var u=i,o=a,c=t;if(o){var s=o[0];switch(0|s.tag){case 0:if(u){var f=u[0];if(!f.tag&&s[0]===f[0]){i=u[1],a=o[1],t=c+1|0;continue}}break;case 1:if(u){var l=u[0];if(1===l.tag){var v=l[0];s[0]!==v&&(le(n,c).nodeValue=v),i=u[1],a=o[1],t=c+1|0;continue}}break;case 2:if(u){var d=u[0];if(2===d.tag){var h=u[1],p=d[2],m=d[1],g=d[0],b=o[1],w=s[2],y=s[1],_=s[0];if(w===p&&""!==w){i=h,a=b,t=c+1|0;continue}if(""===w||""===p){sr(e,r,n,c,s,d),i=h,a=b,t=c+1|0;continue}var S=0,k=0;if(b){var x=b[0];if(2===x.tag){var A=b[1],N=x[2],O=x[1],q=x[0],R=0;if(h){var T=h[0];if(2===T.tag){if(q===g&&O===m&&N===p&&_===T[0]&&y===T[1]&&w===T[2]){var F=le(n,c),E=le(n,c+1|0);r.removeChild(E),Ue(r,E,F),i=h[1],a=A,t=c+2|0;continue}R=4}else R=4}else R=4;if(4===R){if(q===g&&O===m&&N===p){var L=le(n,c);r.removeChild(L),i=h,a=A,t=c+1|0;continue}k=3}}else k=3}else k=3;if(3===k)if(h){var M=h[0];if(2===M.tag){if(_===M[0]&&y===M[1]&&w===M[2]){var C=le(n,c);Ue(r,cr(e,d),C),i=h,t=c+1|0;continue}S=2}else S=2}else S=2;if(2===S){sr(e,r,n,c,s,d),i=h,a=b,t=c+1|0;continue}}}break;case 3:if(u){var D=u[0];if(3===D.tag){var P=u[1],I=D[2],W=D[1],$=D[0],J=o[1],Z=s[2],B=s[0];if(B===$){I.contents=Z.contents,i=P,a=J,t=c+1|0;continue}var H=0,Q=0;if(J){var V=J[0];if(3===V.tag){var U=J[1],j=V[0],z=0;if(P){var X=P[0];if(3===X.tag){if(j===$&&B===X[0]){var G=le(n,c),K=le(n,c+1|0);r.removeChild(K),Ue(r,K,G),i=P[1],a=U,t=c+2|0;continue}z=4}else z=4}else z=4;if(4===z){if(j===$){var Y=le(n,c);r.removeChild(Y);var ee=V[2].contents;I.contents=ee,i=P,a=U,t=c+1|0;continue}Q=3}}else Q=3}else Q=3;if(3===Q)if(P){var re=P[0];if(3===re.tag){if(re[0]===B){var ne=le(n,c),te=ve(W,void 0);Ue(r,cr(e,I.contents=te),ne),i=P,t=c+1|0;continue}H=2}else H=2}else H=2;if(2===H){var ae=Z.contents,ie=ve(W,void 0);i=[I.contents=ie,P],a=[ae,J];continue}}}break;case 4:a=[s[1],o[1]];continue}var ue=o[1];if(u){var oe=u[0];if(4===oe.tag){fr(ve(oe[0],e),r,n,c,[s,0],[oe[1],0]),i=u[1],a=ue,t=c+1|0;continue}var ce=le(n,c);Ue(r,cr(e,oe),ce),r.removeChild(ce),i=u[1],a=ue,t=c+1|0;continue}var se=le(n,c);r.removeChild(se),i=0,a=ue}else{if(!u)return;var fe=cr(e,u[0]);r.appendChild(fe),i=u[1],t=c+1|(a=0)}}}function lr(n,e){if("number"!=typeof e)switch(0|e.tag){case 1:return ke(function(e,r){return lr(n,r)},void 0,e[0]);case 0:case 2:return ve(e[0],n)}}function vr(i,u,e,r){var o=function(e,r){for(;;){var n=r,t=e;if("number"==typeof n)return;switch(0|n.tag){case 0:var a=n[0];return a?Se(function(r){return function(e){return o(r,e)}}(t),a):void 0;case 1:return void(n[2].contents=ve(n[1],t));case 2:var i=ve(n[0],t);r=n[1],e=i;continue}}},c=function(e,r){for(;;){var n=r,t=e;if("number"==typeof n)return;switch(0|n.tag){case 0:var a=n[0];return a?Se(function(r){return function(e){return c(r,e)}}(t),a):void 0;case 1:var i=n[2],u=i.contents;return void 0!==u?ve(u,i.contents=void 0):void 0;case 2:var o=ve(n[0],t);r=n[1],e=o;continue}}};if("number"==typeof e){if("number"==typeof r)return r}else switch(0|e.tag){case 0:if("number"==typeof r||r.tag)break;return function(e,r){for(;;){var n=r;if(e){var t=e[1],a=e[0];if(n){vr(i,u,a,n[0]),r=n[1],e=t;continue}c(i,a),r=0,e=t}else{if(!n)return;o(u,n[0]),r=n[1],e=0}}}(e[0],r[0]),r;case 1:if("number"!=typeof r&&1===r.tag&&e[0]===r[0])return r[2].contents=e[2].contents,r;break;case 2:if("number"==typeof r||2!==r.tag)break;return vr(ve(e[0],i),ve(r[0],u),e[1],r[1]),r}return c(i,e),o(u,r),r}function dr(e,r){for(var n=e.length;(e.position+r|0)>n;)n<<=1;var t=g(n);Me(e.buffer,0,t,0,e.position),e.buffer=t,e.length=n}function hr(e,r){var n=r.length,t=e.position+n|0;t>e.length&&dr(e,n),Ce(r,0,e.buffer,e.position,n),e.position=t}function pr(e,r){var n,t,a,i=e.bytes.length,u=e.ind+r|0;u<=i||(a=g((t=u)<(n=i<<1)?n:t),Me(e.bytes,0,a,0,i),e.bytes=a)}function mr(e,r){pr(e,1),e.bytes[e.ind]=r,e.ind=e.ind+1|0}function gr(e,r){var n=r.length;pr(e,n),Qe(r,0,e.bytes,e.ind,n),e.ind=e.ind+n|0}function br(e){return Le(e.bytes,0,e.ind)}function wr(e){if("number"==typeof e)return 0;switch(0|e.tag){case 0:return ee(0,[wr(e[0])]);case 1:return ee(1,[wr(e[0])]);case 2:return ee(2,[wr(e[0])]);case 3:return ee(3,[wr(e[0])]);case 4:return ee(4,[wr(e[0])]);case 5:return ee(5,[wr(e[0])]);case 6:return ee(6,[wr(e[0])]);case 7:return ee(7,[wr(e[0])]);case 8:return ee(8,[e[0],wr(e[1])]);case 9:return ee(9,[e[1],e[0],wr(e[2])]);case 10:return ee(10,[wr(e[0])]);case 11:return ee(11,[wr(e[0])]);case 12:return ee(12,[wr(e[0])]);case 13:return ee(13,[wr(e[0])]);case 14:return ee(14,[wr(e[0])])}}function yr(e){if("number"==typeof e)return[function(e){return 0},function(e){return 0},function(e){return 0},function(e){return 0}];switch(0|e.tag){case 0:var r=yr(e[0]),n=r[1],t=r[0];return[function(e){return ve(t,0),0},function(e){return ve(n,0),0},r[2],r[3]];case 1:var a=yr(e[0]),i=a[1],u=a[0];return[function(e){return ve(u,0),0},function(e){return ve(i,0),0},a[2],a[3]];case 2:var o=yr(e[0]),c=o[1],s=o[0];return[function(e){return ve(s,0),0},function(e){return ve(c,0),0},o[2],o[3]];case 3:var f=yr(e[0]),l=f[1],v=f[0];return[function(e){return ve(v,0),0},function(e){return ve(l,0),0},f[2],f[3]];case 4:var d=yr(e[0]),h=d[1],p=d[0];return[function(e){return ve(p,0),0},function(e){return ve(h,0),0},d[2],d[3]];case 5:var m=yr(e[0]),g=m[1],b=m[0];return[function(e){return ve(b,0),0},function(e){return ve(g,0),0},m[2],m[3]];case 6:var w=yr(e[0]),y=w[1],_=w[0];return[function(e){return ve(_,0),0},function(e){return ve(y,0),0},w[2],w[3]];case 7:var S=yr(e[0]),k=S[1],x=S[0];return[function(e){return ve(x,0),0},function(e){return ve(k,0),0},S[2],S[3]];case 8:var A=yr(e[1]),N=A[1],O=A[0];return[function(e){return ve(O,0),0},function(e){return ve(N,0),0},A[2],A[3]];case 9:var q=yr(e[2]),R=q[3],T=q[2],F=q[1],E=q[0],L=yr(_r(wr(e[0]),e[1])),M=L[3],C=L[2],D=L[1],P=L[0];return[function(e){return ve(E,0),ve(P,0),0},function(e){return ve(D,0),ve(F,0),0},function(e){return ve(T,0),ve(C,0),0},function(e){return ve(M,0),ve(R,0),0}];case 10:var I=yr(e[0]),W=I[1],$=I[0];return[function(e){return ve($,0),0},function(e){return ve(W,0),0},I[2],I[3]];case 11:var J=yr(e[0]),Z=J[1],B=J[0];return[function(e){return ve(B,0),0},function(e){return ve(Z,0),0},J[2],J[3]];case 12:var H=yr(e[0]),Q=H[1],V=H[0];return[function(e){return ve(V,0),0},function(e){return ve(Q,0),0},H[2],H[3]];case 13:var U=yr(e[0]),j=U[3],z=U[2],X=U[1],G=U[0];return[function(e){return ve(G,0),0},function(e){return ve(X,0),0},function(e){return ve(z,0),0},function(e){return ve(j,0),0}];case 14:var K=yr(e[0]),Y=K[3],ee=K[2],re=K[1],ne=K[0];return[function(e){return ve(ne,0),0},function(e){return ve(re,0),0},function(e){return ve(ee,0),0},function(e){return ve(Y,0),0}]}}function _r(e,r){var n=0;if("number"==typeof e){if("number"==typeof r)return 0;switch(0|r.tag){case 8:n=6;break;case 9:n=7;break;case 10:n=1;break;case 11:n=2;break;case 12:n=3;break;case 13:n=4;break;case 14:n=5;break;default:throw[M,["camlinternalFormat.ml",846,23]]}}else switch(0|e.tag){case 0:if("number"==typeof r)n=8;else switch(0|r.tag){case 0:return ee(0,[_r(e[0],r[0])]);case 8:n=6;break;case 9:n=7;break;case 10:n=1;break;case 11:n=2;break;case 12:n=3;break;case 13:n=4;break;case 14:n=5}break;case 1:if("number"==typeof r)n=8;else switch(0|r.tag){case 1:return ee(1,[_r(e[0],r[0])]);case 8:n=6;break;case 9:n=7;break;case 10:n=1;break;case 11:n=2;break;case 12:n=3;break;case 13:n=4;break;case 14:n=5}break;case 2:if("number"==typeof r)n=8;else switch(0|r.tag){case 2:return ee(2,[_r(e[0],r[0])]);case 8:n=6;break;case 9:n=7;break;case 10:n=1;break;case 11:n=2;break;case 12:n=3;break;case 13:n=4;break;case 14:n=5}break;case 3:if("number"==typeof r)n=8;else switch(0|r.tag){case 3:return ee(3,[_r(e[0],r[0])]);case 8:n=6;break;case 9:n=7;break;case 10:n=1;break;case 11:n=2;break;case 12:n=3;break;case 13:n=4;break;case 14:n=5}break;case 4:if("number"==typeof r)n=8;else switch(0|r.tag){case 4:return ee(4,[_r(e[0],r[0])]);case 8:n=6;break;case 9:n=7;break;case 10:n=1;break;case 11:n=2;break;case 12:n=3;break;case 13:n=4;break;case 14:n=5}break;case 5:if("number"==typeof r)n=8;else switch(0|r.tag){case 5:return ee(5,[_r(e[0],r[0])]);case 8:n=6;break;case 9:n=7;break;case 10:n=1;break;case 11:n=2;break;case 12:n=3;break;case 13:n=4;break;case 14:n=5}break;case 6:if("number"==typeof r)n=8;else switch(0|r.tag){case 6:return ee(6,[_r(e[0],r[0])]);case 8:n=6;break;case 9:n=7;break;case 10:n=1;break;case 11:n=2;break;case 12:n=3;break;case 13:n=4;break;case 14:n=5}break;case 7:if("number"==typeof r)n=8;else switch(0|r.tag){case 7:return ee(7,[_r(e[0],r[0])]);case 8:n=6;break;case 9:n=7;break;case 10:n=1;break;case 11:n=2;break;case 12:n=3;break;case 13:n=4;break;case 14:n=5}break;case 8:if("number"==typeof r)throw[M,["camlinternalFormat.ml",832,26]];switch(0|r.tag){case 8:return ee(8,[_r(e[0],r[0]),_r(e[1],r[1])]);case 10:n=1;break;case 11:n=2;break;case 12:n=3;break;case 13:n=4;break;case 14:n=5;break;default:throw[M,["camlinternalFormat.ml",832,26]]}break;case 9:if("number"==typeof r)throw[M,["camlinternalFormat.ml",842,28]];switch(0|r.tag){case 8:n=6;break;case 9:var t=yr(_r(wr(e[1]),r[0]));return ve(t[1],0),ve(t[3],0),ee(9,[e[0],r[1],_r(e[2],r[2])]);case 10:n=1;break;case 11:n=2;break;case 12:n=3;break;case 13:n=4;break;case 14:n=5;break;default:throw[M,["camlinternalFormat.ml",842,28]]}break;case 10:if("number"==typeof r)throw[M,["camlinternalFormat.ml",810,21]];if(10===r.tag)return ee(10,[_r(e[0],r[0])]);throw[M,["camlinternalFormat.ml",810,21]];case 11:if("number"==typeof r)throw[M,["camlinternalFormat.ml",814,21]];switch(0|r.tag){case 10:n=1;break;case 11:return ee(11,[_r(e[0],r[0])]);default:throw[M,["camlinternalFormat.ml",814,21]]}break;case 12:if("number"==typeof r)throw[M,["camlinternalFormat.ml",818,19]];switch(0|r.tag){case 10:n=1;break;case 11:n=2;break;case 12:return ee(12,[_r(e[0],r[0])]);default:throw[M,["camlinternalFormat.ml",818,19]]}break;case 13:if("number"==typeof r)throw[M,["camlinternalFormat.ml",822,22]];switch(0|r.tag){case 10:n=1;break;case 11:n=2;break;case 12:n=3;break;case 13:return ee(13,[_r(e[0],r[0])]);default:throw[M,["camlinternalFormat.ml",822,22]]}break;case 14:if("number"==typeof r)throw[M,["camlinternalFormat.ml",827,30]];switch(0|r.tag){case 10:n=1;break;case 11:n=2;break;case 12:n=3;break;case 13:n=4;break;case 14:return ee(14,[_r(e[0],r[0])]);default:throw[M,["camlinternalFormat.ml",827,30]]}}switch(n){case 1:throw[M,["camlinternalFormat.ml",811,21]];case 2:throw[M,["camlinternalFormat.ml",815,21]];case 3:throw[M,["camlinternalFormat.ml",819,19]];case 4:throw[M,["camlinternalFormat.ml",823,22]];case 5:throw[M,["camlinternalFormat.ml",828,30]];case 6:throw[M,["camlinternalFormat.ml",833,26]];case 7:throw[M,["camlinternalFormat.ml",843,28]];case 8:throw[M,["camlinternalFormat.ml",847,23]]}}var Sr=ie("CamlinternalFormat.Type_mismatch");function kr(e,r){if("number"==typeof e)return[0,r];if(!e.tag)return[ee(0,[e[0],e[1]]),r];if("number"==typeof r)throw Sr;if(2===r.tag)return[ee(1,[e[0]]),r[0]];throw Sr}function xr(e,r,n){var t=kr(e,n);if("number"!=typeof r)return[t[0],[r[0]],t[1]];if(0===r)return[t[0],0,t[1]];var a=t[1];if("number"==typeof a)throw Sr;if(2===a.tag)return[t[0],1,a[0]];throw Sr}function Ar(e,r){if("number"==typeof e)return[0,r];switch(0|e.tag){case 0:if("number"==typeof r)throw Sr;if(r.tag)throw Sr;var n=Ar(e[0],r[0]);return[ee(0,[n[0]]),n[1]];case 1:if("number"==typeof r)throw Sr;if(r.tag)throw Sr;var t=Ar(e[0],r[0]);return[ee(1,[t[0]]),t[1]];case 2:var a=kr(e[0],r),i=a[1];if("number"==typeof i)throw Sr;if(1!==i.tag)throw Sr;var u=Ar(e[1],i[0]);return[ee(2,[a[0],u[0]]),u[1]];case 3:var o=kr(e[0],r),c=o[1];if("number"==typeof c)throw Sr;if(1!==c.tag)throw Sr;var s=Ar(e[1],c[0]);return[ee(3,[o[0],s[0]]),s[1]];case 4:var f=xr(e[1],e[2],r),l=f[2];if("number"==typeof l)throw Sr;if(2!==l.tag)throw Sr;var v=Ar(e[3],l[0]);return[ee(4,[e[0],f[0],f[1],v[0]]),v[1]];case 5:var d=xr(e[1],e[2],r),h=d[2];if("number"==typeof h)throw Sr;if(3!==h.tag)throw Sr;var p=Ar(e[3],h[0]);return[ee(5,[e[0],d[0],d[1],p[0]]),p[1]];case 6:var m=xr(e[1],e[2],r),g=m[2];if("number"==typeof g)throw Sr;if(4!==g.tag)throw Sr;var b=Ar(e[3],g[0]);return[ee(6,[e[0],m[0],m[1],b[0]]),b[1]];case 7:var w=xr(e[1],e[2],r),y=w[2];if("number"==typeof y)throw Sr;if(5!==y.tag)throw Sr;var _=Ar(e[3],y[0]);return[ee(7,[e[0],w[0],w[1],_[0]]),_[1]];case 8:var S=xr(e[1],e[2],r),k=S[2];if("number"==typeof k)throw Sr;if(6!==k.tag)throw Sr;var x=Ar(e[3],k[0]);return[ee(8,[e[0],S[0],S[1],x[0]]),x[1]];case 9:var A=kr(e[0],r),N=A[1];if("number"==typeof N)throw Sr;if(7!==N.tag)throw Sr;var O=Ar(e[1],N[0]);return[ee(9,[A[0],O[0]]),O[1]];case 10:var q=Ar(e[0],r);return[ee(10,[q[0]]),q[1]];case 11:var R=Ar(e[1],r);return[ee(11,[e[0],R[0]]),R[1]];case 12:var T=Ar(e[1],r);return[ee(12,[e[0],T[0]]),T[1]];case 13:if("number"==typeof r)throw Sr;if(8!==r.tag)throw Sr;var F=r[0];if(re([e[1]],[F]))throw Sr;var E=Ar(e[2],r[1]);return[ee(13,[e[0],F,E[0]]),E[1]];case 14:if("number"==typeof r)throw Sr;if(9!==r.tag)throw Sr;var L=r[0];if(re([de(e[1])],[de(L)]))throw Sr;var M=Ar(e[2],de(r[2]));return[ee(14,[e[0],L,M[0]]),M[1]];case 15:if("number"==typeof r)throw Sr;if(10!==r.tag)throw Sr;var C=Ar(e[0],r[0]);return[ee(15,[C[0]]),C[1]];case 16:if("number"==typeof r)throw Sr;if(11!==r.tag)throw Sr;var D=Ar(e[0],r[0]);return[ee(16,[D[0]]),D[1]];case 17:var P=Ar(e[1],r);return[ee(17,[e[0],P[0]]),P[1]];case 18:var I=e[0],W=e[1];if(I.tag){var $=I[0],J=Ar($[0],r),Z=Ar(W,J[1]);return[ee(18,[ee(1,[[J[0],$[1]]]),Z[0]]),Z[1]]}var B=I[0],H=Ar(B[0],r),Q=Ar(W,H[1]);return[ee(18,[ee(0,[[H[0],B[1]]]),Q[0]]),Q[1]];case 19:if("number"==typeof r)throw Sr;if(13!==r.tag)throw Sr;var V=Ar(e[0],r[0]);return[ee(19,[V[0]]),V[1]];case 20:if("number"==typeof r)throw Sr;if(1!==r.tag)throw Sr;var U=Ar(e[2],r[0]);return[ee(20,[e[0],e[1],U[0]]),U[1]];case 21:if("number"==typeof r)throw Sr;if(2!==r.tag)throw Sr;var j=Ar(e[1],r[0]);return[ee(21,[e[0],j[0]]),j[1]];case 23:var z=e[0],X=e[1];if("number"==typeof z){if(2!==z)return Nr(z,X,r);if("number"==typeof r)throw Sr;if(14!==r.tag)throw Sr;var G=Ar(X,r[0]);return[ee(23,[2,G[0]]),G[1]]}switch(0|z.tag){case 8:return Nr(ee(8,[z[0],z[1]]),X,r);case 9:var K=function e(r,n,t){if("number"==typeof r)return[0,Ar(n,t)];switch(0|r.tag){case 0:if("number"==typeof t)throw Sr;if(t.tag)throw Sr;var a=e(r[0],n,t[0]);return[ee(0,[a[0]]),a[1]];case 1:if("number"==typeof t)throw Sr;if(1!==t.tag)throw Sr;var i=e(r[0],n,t[0]);return[ee(1,[i[0]]),i[1]];case 2:if("number"==typeof t)throw Sr;if(2!==t.tag)throw Sr;var u=e(r[0],n,t[0]);return[ee(2,[u[0]]),u[1]];case 3:if("number"==typeof t)throw Sr;if(3!==t.tag)throw Sr;var o=e(r[0],n,t[0]);return[ee(3,[o[0]]),o[1]];case 4:if("number"==typeof t)throw Sr;if(4!==t.tag)throw Sr;var c=e(r[0],n,t[0]);return[ee(4,[c[0]]),c[1]];case 5:if("number"==typeof t)throw Sr;if(5!==t.tag)throw Sr;var s=e(r[0],n,t[0]);return[ee(5,[s[0]]),s[1]];case 6:if("number"==typeof t)throw Sr;if(6!==t.tag)throw Sr;var f=e(r[0],n,t[0]);return[ee(6,[f[0]]),f[1]];case 7:if("number"==typeof t)throw Sr;if(7!==t.tag)throw Sr;var l=e(r[0],n,t[0]);return[ee(7,[l[0]]),l[1]];case 8:if("number"==typeof t)throw Sr;if(8!==t.tag)throw Sr;var v=t[0];if(re([r[0]],[v]))throw Sr;var d=e(r[1],n,t[1]);return[ee(8,[v,d[0]]),d[1]];case 9:if("number"==typeof t)throw Sr;if(9!==t.tag)throw Sr;var h=t[1],p=t[0];if(re([de(r[0])],[de(p)]))throw Sr;if(re([de(r[1])],[de(h)]))throw Sr;var m=yr(_r(wr(p),h));ve(m[1],0),ve(m[3],0);var g=e(de(r[2]),n,t[2]);return[ee(9,[p,h,wr(g[0])]),g[1]];case 10:if("number"==typeof t)throw Sr;if(10!==t.tag)throw Sr;var b=e(r[0],n,t[0]);return[ee(10,[b[0]]),b[1]];case 11:if("number"==typeof t)throw Sr;if(11!==t.tag)throw Sr;var w=e(r[0],n,t[0]);return[ee(11,[w[0]]),w[1]];case 12:throw Sr;case 13:if("number"==typeof t)throw Sr;if(13!==t.tag)throw Sr;var y=e(r[0],n,t[0]);return[ee(13,[y[0]]),y[1]];case 14:if("number"==typeof t)throw Sr;if(14!==t.tag)throw Sr;var _=e(r[0],n,t[0]);return[ee(14,[_[0]]),_[1]]}}(z[1],X,r),Y=K[1];return[ee(23,[ee(9,[z[0],K[0]]),Y[0]]),Y[1]];default:return Nr(z,X,r)}case 22:case 24:throw Sr}}function Nr(e,r,n){var t=Ar(r,n);return[ee(23,[e,t[0]]),t[1]]}function Or(e,r){return function(e,r){var n=Ar(e,r);if("number"==typeof n[1])return n[0];throw Sr}(e,de(wr(r)))}function qr(e,r,n){var t=n.length,a=pe(r),i=r<0?0:e;if(a<=t)return n;var u=Te(a,2===i?48:32);switch(i){case 0:Qe(n,0,u,0,t);break;case 1:Qe(n,0,u,a-t|0,t);break;case 2:0<t&&(43===te(n,0)||45===te(n,0)||32===te(n,0))?(u[0]=te(n,0),Qe(n,1,u,1+(a-t|0)|0,t-1|0)):1<t&&48===te(n,0)&&(120===te(n,1)||88===te(n,1))?(u[1]=te(n,1),Qe(n,2,u,2+(a-t|0)|0,t-2|0)):Qe(n,0,u,a-t|0,t)}return f(u)}function Rr(e,r){var n=pe(e),t=r.length,a=te(r,0),i=0;if(58<=a)if(71<=a){if(102<a||a<97)return r;i=2}else{if(a<65)return r;i=2}else if(32!==a){if(a<43)return r;switch(a-43|0){case 0:case 2:i=1;break;case 1:case 3:case 4:return r;case 5:if(t<(n+2|0)&&1<t&&(120===te(r,1)||88===te(r,1))){var u=Te(n+2|0,48);return u[1]=te(r,1),Qe(r,2,u,4+(n-t|0)|0,t-2|0),f(u)}i=2;break;case 6:case 7:case 8:case 9:case 10:case 11:case 12:case 13:case 14:i=2}}else i=1;switch(i){case 1:if((n+1|0)<=t)return r;var o=Te(n+1|0,48);return o[0]=a,Qe(r,1,o,2+(n-t|0)|0,t-1|0),f(o);case 2:if(n<=t)return r;var c=Te(n,48);return Qe(r,0,c,n-t|0,t),f(c)}}function Tr(e){var a,r=(a=e,function(e){for(;;){var r=e;if(r>=a.length)return;var n=a.charCodeAt(r);if(n<32)return 1;var t=n-34|0;if(58<t||t<0){if(93<=t)return 1;e=r+1|0}else{if(57<t||t<1)return 1;e=r+1|0}}}(0)?f(Pe(l(a))):a),n=r.length,t=Te(n+2|0,34);return c(r,0,t,1,n),f(t)}function Fr(e,r){if(15===e)return"%.12g";var n=pe(r),t=function(e){switch(e){case 0:case 1:case 2:return 102;case 3:case 4:case 5:return 101;case 6:case 7:case 8:return 69;case 9:case 10:case 11:return 103;case 12:case 13:case 14:return 71;case 15:return 70;case 16:case 17:case 18:return 104;case 19:case 20:case 21:return 72}}(e),a={ind:0,bytes:g(16)};return mr(a,37),function(e,r){switch(r){case 0:case 3:case 6:case 9:case 12:case 15:case 16:case 19:return;case 1:case 4:case 7:case 10:case 13:case 17:case 20:return mr(e,43);case 2:case 5:case 8:case 11:case 14:case 18:case 21:mr(e,32)}}(a,e),mr(a,46),gr(a,String(n)),mr(a,t),br(a)}function Er(e,r){return K(function(e){switch(e){case 0:return"%d";case 1:return"%+d";case 2:return"% d";case 3:return"%i";case 4:return"%+i";case 5:return"% i";case 6:return"%x";case 7:return"%#x";case 8:return"%X";case 9:return"%#X";case 10:return"%o";case 11:return"%#o";case 12:return"%u"}}(e),r)}function Lr(e,r){return ne(function(e){switch(e){case 0:return"%ld";case 1:return"%+ld";case 2:return"% ld";case 3:return"%li";case 4:return"%+li";case 5:return"% li";case 6:return"%lx";case 7:return"%#lx";case 8:return"%lX";case 9:return"%#lX";case 10:return"%lo";case 11:return"%#lo";case 12:return"%lu"}}(e),r)}function Mr(e,r){return t(function(e){switch(e){case 0:return"%nd";case 1:return"%+nd";case 2:return"% nd";case 3:return"%ni";case 4:return"%+ni";case 5:return"% ni";case 6:return"%nx";case 7:return"%#nx";case 8:return"%nX";case 9:return"%#nX";case 10:return"%no";case 11:return"%#no";case 12:return"%nu"}}(e),r)}function Cr(e,r){return n(function(e){switch(e){case 0:return"%Ld";case 1:return"%+Ld";case 2:return"% Ld";case 3:return"%Li";case 4:return"%+Li";case 5:return"% Li";case 6:return"%Lx";case 7:return"%#Lx";case 8:return"%LX";case 9:return"%#LX";case 10:return"%Lo";case 11:return"%#Lo";case 12:return"%Lu"}}(e),r)}function Dr(e,r,n){if(16<=e){var t;if(17<=e)switch(e-17|0){case 2:t=45;break;case 0:case 3:t=43;break;case 1:case 4:t=32}else t=45;var a=Y(n,r,t);return 19<=e?f(Ie(l(a))):a}var i=function(e,r){var n=X(e),t=n.prec<0?6:n.prec,a=r<0?(n.sign=-1,-r):r,i="";if(isNaN(a))i="nan",n.filter=" ";else if(isFinite(a)){switch(n.conv){case"e":var u=(i=a.toExponential(t)).length;"e"===i[u-3|0]&&(i=i.slice(0,u-1|0)+("0"+i.slice(u-1|0)));break;case"f":i=a.toFixed(t);break;case"g":var o=0!==t?t:1,c=(i=a.toExponential(o-1|0)).indexOf("e"),s=0|Number(i.slice(c+1|0));if(s<-4||1e21<=a||a.toFixed().length>o){for(var f=c-1|0;"0"===i[f];)f=f-1|0;"."===i[f]&&(f=f-1|0);var l=(i=i.slice(0,f+1|0)+i.slice(c)).length;"e"===i[l-3|0]&&(i=i.slice(0,l-1|0)+("0"+i.slice(l-1|0)))}else{var v=o;if(s<0)v=v-(1+s|0)|0,i=a.toFixed(v);else for(;(i=a.toFixed(v)).length>(o+1|0);)v=v-1|0;if(0!==v){for(var d=i.length-1|0;"0"===i[d];)d=d-1|0;"."===i[d]&&(d=d-1|0),i=i.slice(0,d+1|0)}}}}else i="inf",n.filter=" ";return G(n,i)}(Fr(e,r),n);if(15!==e)return i;var u,o=i.length,c=(u=n,isFinite(u)?22250738585072014e-324<=Math.abs(u)?0:0!==u?1:2:isNaN(u)?4:3);return 3!=c?4<=c?"nan":function(e){for(;;){var r=e;if(r===o)return!1;var n=te(i,r)-46|0;if(23<n||n<0){if(55==n)return!0;e=r+1|0}else{if(22<n||n<1)return!0;e=r+1|0}}}(0)?i:i+".":n<0?"neg_infinity":"infinity"}function Pr(e){var r=function(e){var r=0;if(40<=e){if(92===e)return"\\\\";r=127<=e?1:2}else if(32<=e){if(39<=e)return"\\'";r=2}else if(14<=e)r=1;else switch(e){case 8:return"\\b";case 9:return"\\t";case 10:return"\\n";case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:case 11:case 12:r=1;break;case 13:return"\\r"}switch(r){case 1:var n=[0,0,0,0];return n[0]=92,n[1]=48+(e/100|0)|0,n[2]=48+(e/10|0)%10|0,n[3]=48+e%10|0,f(n);case 2:var t=[0];return t[0]=e,f(t)}}(e),n=r.length,t=Te(n+2|0,39);return c(r,0,t,1,n),f(t)}function Ir(e){var r={ind:0,bytes:g(16)};return function e(r,n){for(;;){var t=n;if("number"==typeof t)return;switch(0|t.tag){case 0:gr(r,"%c"),n=t[0];continue;case 1:gr(r,"%s"),n=t[0];continue;case 2:gr(r,"%i"),n=t[0];continue;case 3:gr(r,"%li"),n=t[0];continue;case 4:gr(r,"%ni"),n=t[0];continue;case 5:gr(r,"%Li"),n=t[0];continue;case 6:gr(r,"%f"),n=t[0];continue;case 7:gr(r,"%B"),n=t[0];continue;case 8:gr(r,"%{"),e(r,t[0]),gr(r,"%}"),n=t[1];continue;case 9:gr(r,"%("),e(r,t[0]),gr(r,"%)"),n=t[2];continue;case 10:gr(r,"%a"),n=t[0];continue;case 11:gr(r,"%t"),n=t[0];continue;case 12:gr(r,"%?"),n=t[0];continue;case 13:gr(r,"%r"),n=t[0];continue;case 14:gr(r,"%_r"),n=t[0];continue}}}(r,e),br(r)}function Wr(e,s,r,n){for(;;){var t=n,a=r,i=e;if("number"==typeof t)return C(i,s,a);switch(0|t.tag){case 0:return function(n,t,a){return function(e){var r=ee(5,[t,e]);return Wr(n,s,r,a)}}(i,a,t[0]);case 1:return function(t,a,i){return function(e){var r=Pr(e),n=ee(4,[a,r]);return Wr(t,s,n,i)}}(i,a,t[0]);case 2:return Jr(i,s,a,t[1],t[0],function(e){return e});case 3:return Jr(i,s,a,t[1],t[0],Tr);case 4:return Zr(i,s,a,t[3],t[1],t[2],Er,t[0]);case 5:return Zr(i,s,a,t[3],t[1],t[2],Lr,t[0]);case 6:return Zr(i,s,a,t[3],t[1],t[2],Mr,t[0]);case 7:return Zr(i,s,a,t[3],t[1],t[2],Cr,t[0]);case 8:var u=t[3],o=t[1],c=t[2],f=t[0];if("number"==typeof o)return"number"==typeof c?(0!==c?function(t,a,i,u){return function(e,r){var n=Dr(u,e,r);return Wr(t,s,ee(4,[a,n]),i)}}:function(n,t,a,i){return function(e){var r=Dr(i,-6,e);return Wr(n,s,ee(4,[t,r]),a)}})(i,a,u,f):function(n,t,a,i,u){return function(e){var r=Dr(i,u,e);return Wr(n,s,ee(4,[t,r]),a)}}(i,a,u,f,c[0]);if(o.tag){var l=o[0];return"number"==typeof c?(0!==c?function(a,i,u,o,c){return function(e,r,n){var t=qr(c,e,Dr(o,r,n));return Wr(a,s,ee(4,[i,t]),u)}}:function(a,i,u,o,c){return function(e,r){var n=Dr(o,-6,r),t=qr(c,e,n);return Wr(a,s,ee(4,[i,t]),u)}})(i,a,u,f,l):function(t,a,i,u,o,c){return function(e,r){var n=qr(o,e,Dr(u,c,r));return Wr(t,s,ee(4,[a,n]),i)}}(i,a,u,f,l,c[0])}var v=o[1],d=o[0];return"number"==typeof c?(0!==c?function(t,a,i,u,o,c){return function(e,r){var n=qr(o,c,Dr(u,e,r));return Wr(t,s,ee(4,[a,n]),i)}}:function(t,a,i,u,o,c){return function(e){var r=Dr(u,-6,e),n=qr(o,c,r);return Wr(t,s,ee(4,[a,n]),i)}})(i,a,u,f,d,v):function(n,t,a,i,u,o,c){return function(e){var r=qr(u,o,Dr(i,c,e));return Wr(n,s,ee(4,[t,r]),a)}}(i,a,u,f,d,v,c[0]);case 9:return Jr(i,s,a,t[1],t[0],me);case 10:n=t[0],r=ee(7,[a]);continue;case 11:n=t[1],r=ee(2,[a,t[0]]);continue;case 12:n=t[1],r=ee(3,[a,t[0]]);continue;case 13:return function(r,n,t,a){return function(e){return Wr(r,s,ee(4,[n,a]),t)}}(i,a,t[2],Ir(t[1]));case 14:var h=t[2];return function(r,n,t,a){return function(e){return Wr(r,s,n,function e(r,n){if("number"==typeof r)return n;switch(0|r.tag){case 0:return ee(0,[e(r[0],n)]);case 1:return ee(1,[e(r[0],n)]);case 2:return ee(2,[r[0],e(r[1],n)]);case 3:return ee(3,[r[0],e(r[1],n)]);case 4:return ee(4,[r[0],r[1],r[2],e(r[3],n)]);case 5:return ee(5,[r[0],r[1],r[2],e(r[3],n)]);case 6:return ee(6,[r[0],r[1],r[2],e(r[3],n)]);case 7:return ee(7,[r[0],r[1],r[2],e(r[3],n)]);case 8:return ee(8,[r[0],r[1],r[2],e(r[3],n)]);case 9:return ee(9,[r[0],e(r[1],n)]);case 10:return ee(10,[e(r[0],n)]);case 11:return ee(11,[r[0],e(r[1],n)]);case 12:return ee(12,[r[0],e(r[1],n)]);case 13:return ee(13,[r[0],r[1],e(r[2],n)]);case 14:return ee(14,[r[0],r[1],e(r[2],n)]);case 15:return ee(15,[e(r[0],n)]);case 16:return ee(16,[e(r[0],n)]);case 17:return ee(17,[r[0],e(r[1],n)]);case 18:return ee(18,[r[0],e(r[1],n)]);case 19:return ee(19,[e(r[0],n)]);case 20:return ee(20,[r[0],r[1],e(r[2],n)]);case 21:return ee(21,[r[0],e(r[1],n)]);case 22:return ee(22,[e(r[0],n)]);case 23:return ee(23,[r[0],e(r[1],n)]);case 24:return ee(24,[r[0],r[1],e(r[2],n)])}}(Or(e[0],t),a))}}(i,a,t[1],h);case 15:return function(e,t,a){return function(r,n){return Wr(e,s,ee(6,[t,function(e){return C(r,e,n)}]),a)}}(i,a,t[0]);case 16:return function(r,n,t){return function(e){return Wr(r,s,ee(6,[n,e]),t)}}(i,a,t[0]);case 17:n=t[1],r=ee(0,[a,t[0]]);continue;case 18:var p=t[0];if(p.tag){var m=function(n,t,a){return function(e,r){return Wr(n,e,ee(1,[t,ee(1,[r])]),a)}}(i,a,t[1]);n=p[0][0],r=0,e=m;continue}var g=function(n,t,a){return function(e,r){return Wr(n,e,ee(1,[t,ee(0,[r])]),a)}}(i,a,t[1]);n=p[0][0],r=0,e=g;continue;case 19:throw[M,["camlinternalFormat.ml",1525,4]];case 20:return function(r,n,t){return function(e){return Wr(r,s,t,n)}}(i,t[2],ee(8,[a,"Printf: bad conversion %["]));case 21:return function(t,a,i){return function(e){var r=K("%u",e),n=ee(4,[a,r]);return Wr(t,s,n,i)}}(i,a,t[1]);case 22:return function(n,t,a){return function(e){var r=ee(5,[t,e]);return Wr(n,s,r,a)}}(i,a,t[0]);case 23:return function(e,r,n,t,a){if("number"!=typeof t)return 9===t.tag?function n(t,a,i,e,u){if("number"==typeof e)return $r(t,a,i,u);switch(0|e.tag){case 0:var r=e[0];return function(e){return n(t,a,i,r,u)};case 1:var o=e[0];return function(e){return n(t,a,i,o,u)};case 2:var c=e[0];return function(e){return n(t,a,i,c,u)};case 3:var s=e[0];return function(e){return n(t,a,i,s,u)};case 4:var f=e[0];return function(e){return n(t,a,i,f,u)};case 5:var l=e[0];return function(e){return n(t,a,i,l,u)};case 6:var v=e[0];return function(e){return n(t,a,i,v,u)};case 7:var d=e[0];return function(e){return n(t,a,i,d,u)};case 8:var h=e[1];return function(e){return n(t,a,i,h,u)};case 9:var p=e[2],m=_r(wr(e[0]),e[1]);return function(e){return n(t,a,i,he(m,p),u)};case 10:var g=e[0];return function(e,r){return n(t,a,i,g,u)};case 11:var b=e[0];return function(e){return n(t,a,i,b,u)};case 12:var w=e[0];return function(e){return n(t,a,i,w,u)};case 13:throw[M,["camlinternalFormat.ml",1616,31]];case 14:throw[M,["camlinternalFormat.ml",1617,31]]}}(e,r,n,t[1],a):$r(e,r,n,a);if(2===t)throw[M,["camlinternalFormat.ml",1593,39]];return $r(e,r,n,a)}(i,s,a,t[0],t[1]);case 24:return function r(n,t,a,i,e,u){if(!e)return Wr(n,t,ee(4,[a,u]),i);var o=e[0];return function(e){return r(n,t,a,i,o,ve(u,e))}}(i,s,a,t[2],t[0],ve(t[1],void 0))}}}function $r(e,r,n,t){return Wr(e,r,ee(8,[n,"Printf: bad conversion %_"]),t)}function Jr(a,i,u,o,e,c){if("number"==typeof e)return function(e){var r=ve(c,e),n=ee(4,[u,r]);return Wr(a,i,n,o)};if(e.tag){var s=e[0];return function(e,r){var n=qr(s,e,ve(c,r)),t=ee(4,[u,n]);return Wr(a,i,t,o)}}var t=e[1],f=e[0];return function(e){var r=qr(f,t,ve(c,e)),n=ee(4,[u,r]);return Wr(a,i,n,o)}}function Zr(a,i,u,o,e,r,c,s){if("number"==typeof e){if("number"==typeof r)return 0!==r?function(e,r){var n=Rr(e,C(c,s,r));return Wr(a,i,ee(4,[u,n]),o)}:function(e){var r=C(c,s,e);return Wr(a,i,ee(4,[u,r]),o)};var n=r[0];return function(e){var r=Rr(n,C(c,s,e));return Wr(a,i,ee(4,[u,r]),o)}}if(e.tag){var f=e[0];if("number"==typeof r)return 0!==r?function(e,r,n){var t=qr(f,e,Rr(r,C(c,s,n)));return Wr(a,i,ee(4,[u,t]),o)}:function(e,r){var n=qr(f,e,C(c,s,r));return Wr(a,i,ee(4,[u,n]),o)};var t=r[0];return function(e,r){var n=qr(f,e,Rr(t,C(c,s,r)));return Wr(a,i,ee(4,[u,n]),o)}}var l=e[1],v=e[0];if("number"==typeof r)return 0!==r?function(e,r){var n=qr(v,l,Rr(e,C(c,s,r)));return Wr(a,i,ee(4,[u,n]),o)}:function(e){var r=qr(v,l,C(c,s,e));return Wr(a,i,ee(4,[u,r]),o)};var d=r[0];return function(e){var r=qr(v,l,Rr(d,C(c,s,e)));return Wr(a,i,ee(4,[u,r]),o)}}function Br(e,r){for(;;){var n=r,t=0;if("number"==typeof n)return;switch(0|n.tag){case 0:var a=function(e){if("number"==typeof e)switch(e){case 0:return"@]";case 1:return"@}";case 2:return"@?";case 3:return"@\n";case 4:return"@.";case 5:return"@@";case 6:return"@%"}else switch(0|e.tag){case 0:case 1:return e[0];case 2:return"@"+f(Te(1,e[0]))}}(n[1]);return Br(e,n[0]),hr(e,a),0;case 1:var i=n[1],u=n[0];if(i.tag){Br(e,u),hr(e,"@["),r=i[0];continue}Br(e,u),hr(e,"@{"),r=i[0];continue;case 2:case 4:t=1;break;case 3:case 5:t=2;break;case 6:return Br(e,n[0]),hr(e,ve(n[1],void 0)),0;case 7:r=n[0];continue;case 8:throw Br(e,n[0]),[E,n[1]]}switch(t){case 1:return Br(e,n[0]),hr(e,n[1]),0;case 2:return Br(e,n[0]),o=e,c=n[1],s=void 0,(s=o.position)>=o.length&&dr(o,1),o.buffer[s]=c,o.position=s+1|0,0}}var o,c,s}function Hr(o,e){return Wr(function(e,r){var n,t,a,i,u={buffer:a=g(t=(n=64)<1?1:n),position:0,length:t,initial_buffer:a};return Br(u,r),ve(o,Le((i=u).buffer,0,i.position))},void 0,0,e[0])}function Qr(e){return Hr(function(e){return e},e)}function Vr(e,r){return n=e.location,t=r.location,n.line===t.line?a(t.column,n.column):a(t.line,n.line);var n,t}function Ur(e){return D(Qr([ee(11,["At ",ee(2,[0,ee(11,["; Expecting ",ee(2,[0,ee(11,[" but actual ",ee(2,[0,0])])])])])]),"At %s; Expecting %s but actual %s"]),(r=e.location,C(Qr([ee(11,["Ln ",ee(4,[0,0,0,ee(11,[", Col ",ee(4,[0,0,0,0])])])]),"Ln %d, Col %d"]),r.line,r.column)),e.expecting,e.actual);var r}function jr(e){return e.result}function zr(e,r,n){var t=ve(e,n);if(t.tag)return ee(1,[t[0]]);var a=t[0];return C(r,a.result,{location:a.location,input_chars:a.remaining_chars})}function Xr(e,r,n,t){var a=ve(e,t);if(a.tag)return ee(0,[{result:n,location:t.location,remaining_chars:t.input_chars}]);var i=a[0];return C(r,i.result,{location:i.location,input_chars:i.remaining_chars})}function Gr(e,r){return ee(0,[{result:e,location:r.location,remaining_chars:r.input_chars}])}function Kr(e,r,n){var t=ve(r,n);if(!t.tag)return t;var a=t[0];return ee(1,a?[[{expecting:ve(e,Je(" OR ",_e(function(e){return e.expecting},a))),actual:a[0].actual,location:n.location},0]]:[[{expecting:ve(e,""),actual:"No input",location:n.location},0]])}function Yr(e,r,n){var t=ve(r,n);if(!t.tag)return t;var a=t[0];return ee(1,a?[[{expecting:e,actual:a[0].actual,location:n.location},a[1]]]:[[{expecting:e,actual:"",location:n.location},0]])}function en(n,r){return function(e){return zr(r,function(e){var r=ve(n,e);return function(e){return Gr(r,e)}},e)}}function rn(e,r,n){var t=ve(e,n);if(!t.tag)return t;var a=ve(r,n);return a.tag?ee(1,[Ne([t[0],[a[0],0]])]):a}function nn(e){if(!e)return function(e){return ee(1,[0])};var r=e[0],n=nn(e[1]);return function(e){return rn(r,n,e)}}function tn(t){function r(e){return zr(t,function(n){var r=tn(t);return function(e){return zr(r,function(e){var r=[n,e];return function(e){return Gr(r,e)}},e)}},e)}return function(e){return rn(r,function(e){return Gr(0,e)},e)}}function an(e,r){return a=r,i=n=e,t=(u=function(r){var n=we(r);return function(e){return Xr(a,function(e){return function(e){return zr(i,function(e){return u([e,r])},e)}},n,e)}})(0),function(e){return zr(n,function(n){return function(e){return zr(t,function(e){var r=[n,e];return function(e){return Gr(r,e)}},e)}},e)};var n,t,a,i,u}function un(e,r,n){var t=n.input_chars;if(!t)return ee(1,[[{expecting:r,actual:"Ran out of characters",location:n.location},0]]);var a,i,u,o=t[0];return ve(e,o)?ee(0,[{result:o,location:(a=n.location,i=o,u=a.line,10!==i&&13!==i?{column:a.column+1|0,line:u}:{column:1,line:u+1|0}),remaining_chars:t[1]}]):ee(1,[[{expecting:r,actual:ve(Qr([ee(12,[39,ee(0,[ee(12,[39,0])])]),"'%c'"]),o),location:n.location},0]])}function on(r){var n=ve(Qr([ee(0,[0]),"%c"]),r);return function(e){return un(function(e){return r===e},n,e)}}function cn(r,n){var t=C(Qr([ee(11,["A character between ",ee(0,[ee(11,[" and ",ee(0,[0])])])]),"A character between %c and %c"]),r,n);return function(e){return un(function(e){return r<=e&&e<=n},t,e)}}var sn,fn,ln=(sn=[32,[9,[13,[10,0]]]],fn=ve(Qr([ee(11,["One of: ",ee(2,[0,0])]),"One of: %s"]),Je(", ",_e(function(e){return We(1,e)},sn))),function(e){return un(function(e){return function(e,r){for(;;){var n=r;if(!n)return!1;if(m(n[0],e))return!0;r=n[1]}}(e,sn)},fn,e)}),vn=(on(10),on(9),cn(65,90)),dn=cn(97,122),hn=cn(48,57),pn=Qr([ee(2,[0,0]),"%s"]);function mn(e){return Kr(pn,function(e){return rn(dn,vn,e)},e)}nn([cn(97,102),[cn(65,70),[hn,0]]]);var gn=function r(n){function t(e){return zr(n,function(e){return r(n)},e)}return function(e){return rn(t,function(e){return Gr(void 0,e)},e)}}(ln);cn(48,55);function bn(t){var a=t.length,i=function(e){if(a<=e)return function(e){return Gr(t,e)};var r=i(e+1|0),n=on(te(t,e));return function(e){return zr(n,function(e){return r},e)}};if(a<=0)return function(e){throw[w,e]}("token must be a non-empty string");function r(e){return zr(gn,function(e){return n},e)}var n=i(0);return function(e){return Yr(t,r,e)}}function wn(e,r){return ve(e,{location:{column:1,line:1},input_chars:(a=Be(r),i=a.length,we(function(e,r){for(;;){var n=r,t=e;if(n===i)return t;r=n+1|0,e=[te(a,n),t]}}(0,0)))});var a,i}function yn(e,r){var n=wn(e,r);if(n.tag)return ee(1,[n[0]]);var t=n[0],a=t.remaining_chars,i=t.location;return a?ee(1,[[{expecting:"End of input",actual:ve(Qr([ee(11,["Characters remaining: ",ee(2,[0,0])]),"Characters remaining: %s"]),Je("",_e(function(e){return We(1,e)},a))),location:i},0]]):ee(0,[{result:t.result,location:i,remaining_chars:a}])}var _n=zr,Sn=rn,kn=function(r,n){return function(e){return zr(r,function(e){return n},e)}},xn=function(r,n){return function(e){return zr(r,function(r){return function(e){return zr(n,function(e){return function(e){return Gr(r,e)}},e)}},e)}};function An(d){function h(e){return e?e[4]:0}function p(e,r,n,t){var a=h(e),i=h(t);return[e,r,n,t,i<=a?a+1|0:i+1|0]}function t(e,r){return[0,e,r,0,1]}function m(e,r,n,t){var a=e?e[4]:0,i=t?t[4]:0;if((i+2|0)<a){if(e){var u=e[3],o=e[2],c=e[1],s=e[0];if(h(s)>=h(u))return p(s,c,o,p(u,r,n,t));if(u)return p(p(s,c,o,u[0]),u[1],u[2],p(u[3],r,n,t));throw[E,"Map.bal"]}throw[E,"Map.bal"]}if(i<=(a+2|0))return[e,r,n,t,i<=a?a+1|0:i+1|0];if(t){var f=t[3],l=t[2],v=t[1],d=t[0];if(h(f)>=h(d))return p(p(e,r,n,d),v,l,f);if(d)return p(p(e,r,n,d[0]),d[1],d[2],p(d[3],v,l,f));throw[E,"Map.bal"]}throw[E,"Map.bal"]}function a(e){for(;;){if(!e)throw L;var r=e[0];if(!r)return[e[1],e[2]];e=r}}function e(e){for(;;){if(!e)return;var r=e[0];if(!r)return[e[1],e[2]];e=r}}function g(e,r){if(!e)return r;if(!r)return e;var n=a(r);return m(e,n[0],n[1],i(r))}function l(e,r){if(!e)return r;if(!r)return e;var n=a(r);return A(e,n[0],n[1],i(r))}function b(e,r,n,t){return void 0!==n?A(e,r,ce(n),t):l(e,t)}function s(e,r){for(;;){if(!e)return r;r=[e[1],e[2],e[3],r],e=e[0]}}var f=function(e,r,n){if(!n)return[0,e,r,0,1];var t=n[3],a=n[2],i=n[1],u=n[0],o=C(d.compare,e,i);if(0===o)return a===r?n:[u,e,r,t,n[4]];if(o<0){var c=f(e,r,u);return u===c?n:m(c,i,a,t)}var s=f(e,r,t);return t===s?n:m(u,i,a,s)},i=function(e){if(e){var r=e[0];return r?m(i(r),e[1],e[2],e[3]):e[3]}throw[E,"Map.remove_min_elt"]},v=function(e,r){if(!r)return 0;var n=r[3],t=r[2],a=r[1],i=r[0],u=C(d.compare,e,a);if(0===u)return g(i,n);if(u<0){var o=v(e,i);return i===o?r:m(o,a,t,n)}var c=v(e,n);return n===c?r:m(i,a,t,c)},w=function(e,r,n){if(n){var t=n[3],a=n[2],i=n[1],u=n[0],o=C(d.compare,e,i);if(0===o){var c=ve(r,oe(a));if(void 0===c)return g(u,t);var s=ce(c);return a===s?n:[u,e,s,t,n[4]]}if(o<0){var f=w(e,r,u);return u===f?n:m(f,i,a,t)}var l=w(e,r,t);return t===l?n:m(u,i,a,l)}var v=ve(r,void 0);return void 0!==v?[0,e,ce(v),0,1]:0},u=function(e,r){for(;;){var n=r;if(!n)return;u(e,n[0]),C(e,n[1],n[2]),r=n[3]}},o=function(e,r){if(!r)return 0;var n=o(e,r[0]),t=ve(e,r[2]),a=o(e,r[3]);return[n,r[1],t,a,r[4]]},c=function(e,r){if(!r)return 0;var n=r[1];return[c(e,r[0]),n,C(e,n,r[2]),c(e,r[3]),r[4]]},y=function(e,r,n){for(;;){var t=r;if(!t)return n;n=D(e,t[1],t[2],y(e,t[0],n)),r=t[3]}},_=function(e,r){for(;;){var n=r;if(!n)return!0;if(!C(e,n[1],n[2]))return!1;if(!_(e,n[0]))return!1;r=n[3]}},S=function(e,r){for(;;){var n=r;if(!n)return!1;if(C(e,n[1],n[2]))return!0;if(S(e,n[0]))return!0;r=n[3]}},k=function(e,r,n){return n?m(k(e,r,n[0]),n[1],n[2],n[3]):t(e,r)},x=function(e,r,n){return n?m(n[0],n[1],n[2],x(e,r,n[3])):t(e,r)},A=function(e,r,n,t){if(!e)return k(r,n,t);if(!t)return x(r,n,e);var a=t[4],i=e[4];return(a+2|0)<i?m(e[0],e[1],e[2],A(e[3],r,n,t)):(i+2|0)<a?m(A(e,r,n,t[0]),t[1],t[2],t[3]):p(e,r,n,t)},N=function(e,r){if(!r)return[0,void 0,0];var n=r[3],t=r[2],a=r[1],i=r[0],u=C(d.compare,e,a);if(0===u)return[i,oe(t),n];if(u<0){var o=N(e,i);return[o[0],o[1],A(o[2],a,t,n)]}var c=N(e,n);return[A(i,a,t,c[0]),c[1],c[2]]},O=function(e,r,n){if(r){var t=r[1];if(r[4]>=h(n)){var a=N(t,n);return b(O(e,r[0],a[0]),t,D(e,t,oe(r[2]),a[1]),O(e,r[3],a[2]))}}else if(!n)return 0;if(n){var i=n[1],u=N(i,r);return b(O(e,u[0],n[0]),i,D(e,i,u[1],oe(n[2])),O(e,u[2],n[3]))}throw[M,["map.ml",393,10]]},q=function(e,r,n){if(!r)return n;if(!n)return r;var t=n[2],a=n[1],i=r[2],u=r[1];if(r[4]>=n[4]){var o=N(u,n),c=o[1],s=q(e,r[0],o[0]),f=q(e,r[3],o[2]);return void 0!==c?b(s,u,D(e,u,i,ce(c)),f):A(s,u,i,f)}var l=N(a,r),v=l[1],d=q(e,l[0],n[0]),h=q(e,l[2],n[3]);return void 0!==v?b(d,a,D(e,a,ce(v),t),h):A(d,a,t,h)},R=function(e,r){if(!r)return 0;var n=r[3],t=r[2],a=r[1],i=r[0],u=R(e,i),o=C(e,a,t),c=R(e,n);return o?i===u&&n===c?r:A(u,a,t,c):l(u,c)},T=function(e,r){if(!r)return[0,0];var n=r[2],t=r[1],a=T(e,r[0]),i=a[1],u=a[0],o=C(e,t,n),c=T(e,r[3]),s=c[1],f=c[0];return o?[A(u,t,n,f),l(i,s)]:[l(u,f),A(i,t,n,s)]},r=function(e){return e?(r(e[0])+1|0)+r(e[3])|0:0},F=function(e,r){for(;;){var n=r;if(!n)return e;r=n[0],e=[[n[1],n[2]],F(e,n[3])]}};return{empty:0,is_empty:function(e){return!e},mem:function(e,r){for(;;){var n=r;if(!n)return!1;var t=C(d.compare,e,n[1]);if(0===t)return!0;r=t<0?n[0]:n[3]}},add:f,update:w,singleton:t,remove:v,merge:O,union:q,compare:function(e,r,n){for(var t=s(r,0),a=s(n,0);;){var i=a,u=t;if(!u)return i?-1:0;if(!i)return 1;var o=C(d.compare,u[0],i[0]);if(0!==o)return o;var c=C(e,u[1],i[1]);if(0!==c)return c;a=s(i[2],i[3]),t=s(u[2],u[3])}},equal:function(e,r,n){for(var t=s(r,0),a=s(n,0);;){var i=a,u=t;if(!u)return!i;if(!i)return!1;if(0!==C(d.compare,u[0],i[0]))return!1;if(!C(e,u[1],i[1]))return!1;a=s(i[2],i[3]),t=s(u[2],u[3])}},iter:u,fold:y,for_all:_,exists:S,filter:R,partition:T,cardinal:r,bindings:function(e){return F(0,e)},min_binding:a,min_binding_opt:e,max_binding:function(e){for(;;){if(!e)throw L;var r=e[3];if(!r)return[e[1],e[2]];e=r}},max_binding_opt:function(e){for(;;){if(!e)return;var r=e[3];if(!r)return[e[1],e[2]];e=r}},choose:a,choose_opt:e,split:N,find:function(e,r){for(;;){var n=r;if(!n)throw L;var t=C(d.compare,e,n[1]);if(0===t)return n[2];r=t<0?n[0]:n[3]}},find_opt:function(e,r){for(;;){var n=r;if(!n)return;var t=C(d.compare,e,n[1]);if(0===t)return oe(n[2]);r=t<0?n[0]:n[3]}},find_first:function(e,r){for(;;){var n=r;if(!n)throw L;var t=n[1];if(ve(e,t))for(var a=t,i=n[2],u=n[0];;){var o=u;if(!o)return[a,i];var c=o[1];ve(e,c)?(u=o[0],i=o[2],a=c):u=o[3]}r=n[3]}},find_first_opt:function(e,r){for(;;){var n=r;if(!n)return;var t=n[1];if(ve(e,t))for(var a=t,i=n[2],u=n[0];;){var o=u;if(!o)return[a,i];var c=o[1];ve(e,c)?(u=o[0],i=o[2],a=c):u=o[3]}r=n[3]}},find_last:function(e,r){for(;;){var n=r;if(!n)throw L;var t=n[1];if(ve(e,t))for(var a=t,i=n[2],u=n[3];;){var o=u;if(!o)return[a,i];var c=o[1];ve(e,c)?(u=o[3],i=o[2],a=c):u=o[0]}r=n[0]}},find_last_opt:function(e,r){for(;;){var n=r;if(!n)return;var t=n[1];if(ve(e,t))for(var a=t,i=n[2],u=n[3];;){var o=u;if(!o)return[a,i];var c=o[1];ve(e,c)?(u=o[3],i=o[2],a=c):u=o[0]}r=n[0]}},map:o,mapi:c}}function Nn(e,r){var n=r.length;if(0===n)return[];for(var t=function(e,r){for(var n=new Array(e),t=0;t<e;++t)n[t]=r;return n}(n,ve(e,r[0])),a=1;a<n;++a)t[a]=ve(e,r[a]);return t}function On(e,r,n){for(var t=n,a=r.length-1|0;0<=a;--a)t=C(e,r[a],t);return t}ie("Array.Bottom");function qn(e,r){if(r in e)return oe(e[r])}var Rn=function(e){var r=typeof e;return"string"==r?ee(0,[e]):"number"==r?ee(1,[e]):"boolean"==r?!0===e?1:0:null===e?2:Array.isArray(e)?ee(3,[e]):ee(2,[e])};function Tn(e,r){return r.tag?r:e}function Fn(e,r){return r.tag?oe(r[0]):function(e){if(e.tag)return oe(e[0])}(e)}function En(e){return e?e[4]:0}function Ln(e,r,n,t){var a=En(e),i=En(t);return[e,r,n,t,i<=a?a+1|0:i+1|0]}function Mn(e,r){return[0,e,r,0,1]}function Cn(e,r,n,t){var a=e?e[4]:0,i=t?t[4]:0;if((i+2|0)<a){if(e){var u=e[3],o=e[2],c=e[1],s=e[0];if(En(s)>=En(u))return Ln(s,c,o,Ln(u,r,n,t));if(u)return Ln(Ln(s,c,o,u[0]),u[1],u[2],Ln(u[3],r,n,t));throw[E,"Map.bal"]}throw[E,"Map.bal"]}if(i<=(a+2|0))return[e,r,n,t,i<=a?a+1|0:i+1|0];if(t){var f=t[3],l=t[2],v=t[1],d=t[0];if(En(f)>=En(d))return Ln(Ln(e,r,n,d),v,l,f);if(d)return Ln(Ln(e,r,n,d[0]),d[1],d[2],Ln(d[3],v,l,f));throw[E,"Map.bal"]}throw[E,"Map.bal"]}function Dn(e,r,n){if(!n)return[0,e,r,0,1];var t=n[3],a=n[2],i=n[1],u=n[0],o=h(e,i);if(0===o)return a===r?n:[u,e,r,t,n[4]];if(o<0){var c=Dn(e,r,u);return u===c?n:Cn(c,i,a,t)}var s=Dn(e,r,t);return t===s?n:Cn(u,i,a,s)}function Pn(e){for(;;){if(!e)throw L;var r=e[0];if(!r)return[e[1],e[2]];e=r}}function In(e){for(;;){if(!e)return;var r=e[0];if(!r)return[e[1],e[2]];e=r}}function Wn(e){if(e){var r=e[0];return r?Cn(Wn(r),e[1],e[2],e[3]):e[3]}throw[E,"Map.remove_min_elt"]}function $n(e,r){if(!e)return r;if(!r)return e;var n=Pn(r);return Cn(e,n[0],n[1],Wn(r))}function Jn(e,r,n,t){if(!e)return function e(r,n,t){return t?Cn(e(r,n,t[0]),t[1],t[2],t[3]):Mn(r,n)}(r,n,t);if(!t)return function e(r,n,t){return t?Cn(t[0],t[1],t[2],e(r,n,t[3])):Mn(r,n)}(r,n,e);var a=t[4],i=e[4];return(a+2|0)<i?Cn(e[0],e[1],e[2],Jn(e[3],r,n,t)):(i+2|0)<a?Cn(Jn(e,r,n,t[0]),t[1],t[2],t[3]):Ln(e,r,n,t)}function Zn(e,r){if(!e)return r;if(!r)return e;var n=Pn(r);return Jn(e,n[0],n[1],Wn(r))}function Bn(e,r,n,t){return void 0!==n?Jn(e,r,ce(n),t):Zn(e,t)}function Hn(e,r){if(!r)return[0,void 0,0];var n=r[3],t=r[2],a=r[1],i=r[0],u=h(e,a);if(0===u)return[i,oe(t),n];if(u<0){var o=Hn(e,i);return[o[0],o[1],Jn(o[2],a,t,n)]}var c=Hn(e,n);return[Jn(i,a,t,c[0]),c[1],c[2]]}function Qn(e,r){for(;;){if(!e)return r;r=[e[1],e[2],e[3],r],e=e[0]}}var Vn={empty:0,is_empty:function(e){return!e},mem:function(e,r){for(;;){if(!r)return!1;var n=h(e,r[1]);if(0===n)return!0;r=n<0?r[0]:r[3]}},add:Dn,update:function e(r,n,t){if(t){var a=t[3],i=t[2],u=t[1],o=t[0],c=h(r,u);if(0===c){var s=ve(n,oe(i));if(void 0===s)return $n(o,a);var f=ce(s);return i===f?t:[o,r,f,a,t[4]]}if(c<0){var l=e(r,n,o);return o===l?t:Cn(l,u,i,a)}var v=e(r,n,a);return a===v?t:Cn(o,u,i,v)}var d=ve(n,void 0);return void 0!==d?[0,r,ce(d),0,1]:0},singleton:Mn,remove:function e(r,n){if(!n)return 0;var t=n[3],a=n[2],i=n[1],u=n[0],o=h(r,i);if(0===o)return $n(u,t);if(o<0){var c=e(r,u);return u===c?n:Cn(c,i,a,t)}var s=e(r,t);return t===s?n:Cn(u,i,a,s)},merge:function e(r,n,t){if(n){var a=n[1];if(n[4]>=En(t)){var i=Hn(a,t);return Bn(e(r,n[0],i[0]),a,D(r,a,oe(n[2]),i[1]),e(r,n[3],i[2]))}}else if(!t)return 0;if(t){var u=t[1],o=Hn(u,n);return Bn(e(r,o[0],t[0]),u,D(r,u,o[1],oe(t[2])),e(r,o[2],t[3]))}throw[M,["map.ml",393,10]]},union:function e(r,n,t){if(!n)return t;if(!t)return n;var a=t[2],i=t[1],u=n[2],o=n[1];if(n[4]>=t[4]){var c=Hn(o,t),s=c[1],f=e(r,n[0],c[0]),l=e(r,n[3],c[2]);return void 0!==s?Bn(f,o,D(r,o,u,ce(s)),l):Jn(f,o,u,l)}var v=Hn(i,n),d=v[1],h=e(r,v[0],t[0]),p=e(r,v[2],t[3]);return void 0!==d?Bn(h,i,D(r,i,ce(d),a),p):Jn(h,i,a,p)},compare:function(e,r,n){for(var t=Qn(r,0),a=Qn(n,0);;){var i=a,u=t;if(!u)return i?-1:0;if(!i)return 1;var o=h(u[0],i[0]);if(0!==o)return o;var c=C(e,u[1],i[1]);if(0!==c)return c;a=Qn(i[2],i[3]),t=Qn(u[2],u[3])}},equal:function(e,r,n){for(var t=Qn(r,0),a=Qn(n,0);;){var i=a,u=t;if(!u)return!i;if(!i)return!1;if(0!==h(u[0],i[0]))return!1;if(!C(e,u[1],i[1]))return!1;a=Qn(i[2],i[3]),t=Qn(u[2],u[3])}},iter:function e(r,n){for(;;){var t=n;if(!t)return;e(r,t[0]),C(r,t[1],t[2]),n=t[3]}},fold:function e(r,n,t){for(;;){var a=n;if(!a)return t;t=D(r,a[1],a[2],e(r,a[0],t)),n=a[3]}},for_all:function e(r,n){for(;;){var t=n;if(!t)return!0;if(!C(r,t[1],t[2]))return!1;if(!e(r,t[0]))return!1;n=t[3]}},exists:function e(r,n){for(;;){var t=n;if(!t)return!1;if(C(r,t[1],t[2]))return!0;if(e(r,t[0]))return!0;n=t[3]}},filter:function e(r,n){if(!n)return 0;var t=n[3],a=n[2],i=n[1],u=n[0],o=e(r,u),c=C(r,i,a),s=e(r,t);return c?u===o&&t===s?n:Jn(o,i,a,s):Zn(o,s)},partition:function e(r,n){if(!n)return[0,0];var t=n[2],a=n[1],i=e(r,n[0]),u=i[1],o=i[0],c=C(r,a,t),s=e(r,n[3]),f=s[1],l=s[0];return c?[Jn(o,a,t,l),Zn(u,f)]:[Zn(o,l),Jn(u,a,t,f)]},cardinal:function e(r){return r?(e(r[0])+1|0)+e(r[3])|0:0},bindings:function(e){return function e(r,n){for(;;){var t=n;if(!t)return r;n=t[0],r=[[t[1],t[2]],e(r,t[3])]}}(0,e)},min_binding:Pn,min_binding_opt:In,max_binding:function(e){for(;;){if(!e)throw L;var r=e[3];if(!r)return[e[1],e[2]];e=r}},max_binding_opt:function(e){for(;;){if(!e)return;var r=e[3];if(!r)return[e[1],e[2]];e=r}},choose:Pn,choose_opt:In,split:Hn,find:function(e,r){for(;;){if(!r)throw L;var n=h(e,r[1]);if(0===n)return r[2];r=n<0?r[0]:r[3]}},find_opt:function(e,r){for(;;){var n=r;if(!n)return;var t=h(e,n[1]);if(0===t)return oe(n[2]);r=t<0?n[0]:n[3]}},find_first:function(e,r){for(;;){var n=r;if(!n)throw L;var t=n[1];if(ve(e,t))for(var a=t,i=n[2],u=n[0];;){var o=u;if(!o)return[a,i];var c=o[1];ve(e,c)?(u=o[0],i=o[2],a=c):u=o[3]}r=n[3]}},find_first_opt:function(e,r){for(;;){var n=r;if(!n)return;var t=n[1];if(ve(e,t))for(var a=t,i=n[2],u=n[0];;){var o=u;if(!o)return[a,i];var c=o[1];ve(e,c)?(u=o[0],i=o[2],a=c):u=o[3]}r=n[3]}},find_last:function(e,r){for(;;){var n=r;if(!n)throw L;var t=n[1];if(ve(e,t))for(var a=t,i=n[2],u=n[3];;){var o=u;if(!o)return[a,i];var c=o[1];ve(e,c)?(u=o[3],i=o[2],a=c):u=o[0]}r=n[0]}},find_last_opt:function(e,r){for(;;){var n=r;if(!n)return;var t=n[1];if(ve(e,t))for(var a=t,i=n[2],u=n[3];;){var o=u;if(!o)return[a,i];var c=o[1];ve(e,c)?(u=o[3],i=o[2],a=c):u=o[0]}r=n[0]}},map:function e(r,n){if(!n)return 0;var t=e(r,n[0]),a=ve(r,n[2]),i=e(r,n[3]);return[t,n[1],a,i,n[4]]},mapi:function e(r,n){if(!n)return 0;var t=n[1];return[e(r,n[0]),t,C(r,t,n[2]),e(r,n[3]),n[4]]}},Un=ie("Tea_json.Decoder.ParseFail");function jn(n){return[function(e){var r=Rn(e);return"number"==typeof r&&2<=r?ee(0,[n]):ee(1,["Non-null value"])}]}function zn(a,e){var i=e[0];return[function(e){var r=Rn(e);if("number"==typeof r)return ee(1,["Non-fieldable value"]);if(2!==r.tag)return ee(1,["Non-fieldable value"]);var n=qn(r[0],a);if(void 0===n)return ee(1,["Field Value is undefined: "+a]);var t=ve(i,ce(n));return t.tag?ee(1,["field `"+a+("` -> "+t[0])]):t}]}function Xn(r){return[function(e){var i=function(e,r){for(;;){var n=r;if(!n)return ee(1,["No one-of's matched"]);var t=n[1];try{var a=ve(n[0][0],e);return a.tag?i(e,t):a}catch(e){r=t;continue}}};return i(e,r)}]}function Gn(n,e){var t=e[0];return[function(e){var r=ve(t,e);return r.tag?ee(1,["map "+r[0]]):ee(0,[ve(n,r[0])])}]}function Kn(t,e){var a=e[0];return[function(e){var r=ve(a,e);if(r.tag)return r;var n=ve(t,r[0]);return ve(n[0],e)}]}function Yn(e,r){try{return ve(e[0],r)}catch(e){var n=fe(e);return n[0]===Un?ee(1,[n[1]]):ee(1,["Unknown JSON parsing error"])}}var et={ObjectDict:Vn,ParseFail:Un,string:[function(e){var r=Rn(e);return"number"==typeof r||r.tag?ee(1,["Non-string value"]):ee(0,[r[0]])}],$$int:[function(e){var r=Rn(e);if("number"==typeof r)return ee(1,["Non-int value"]);if(1!==r.tag)return ee(1,["Non-int value"]);var n=r[0];return-2147483648<n&&n<2147483647?ee(0,[0|n]):ee(1,["number out of int range"])}],$$float:[function(e){var r=Rn(e);return"number"==typeof r||1!==r.tag?ee(1,["Non-float-value"]):ee(0,[r[0]])}],bool:[function(e){var r=Rn(e);if("number"!=typeof r)return ee(1,["Non-boolean value"]);switch(r){case 0:return ee(0,[!1]);case 1:return ee(0,[!0]);case 2:return ee(1,["Non-boolean value"])}}],$$null:jn,list:function(e){var t=e[0];return[function(e){var r=Rn(e);if("number"==typeof r)return ee(1,["Non-list value"]);if(3!==r.tag)return ee(1,["Non-list value"]);try{return ee(0,[_e(function(e){var r=ve(t,e);if(!r.tag)return r[0];throw[Un,r[0]]},function(e){for(var r=e.length-1|0,n=0;;){if(r<0)return n;n=[e[r],n],r=r-1|0}}(r[0]))])}catch(e){var n=fe(e);if(n[0]===Un)return ee(1,["list -> "+n[1]]);throw n}}]},array:function(e){var t=e[0];return[function(e){var r=Rn(e);if("number"==typeof r)return ee(1,["Non-array value"]);if(3!==r.tag)return ee(1,["Non-array value"]);try{return ee(0,[Nn(function(e){var r=ve(t,e);if(!r.tag)return r[0];throw[Un,r[0]]},r[0])])}catch(e){var n=fe(e);if(n[0]===Un)return ee(1,["array -> "+n[1]]);throw n}}]},keyValuePairs:function(e){var i=e[0];return[function(e){var r=Rn(e);if("number"==typeof r)return ee(1,["Non-keyValuePair value"]);if(2!==r.tag)return ee(1,["Non-keyValuePair value"]);var a=r[0],n=Object.keys(a);try{return ee(0,[On(function(e,r){var n=qn(a,e);if(void 0===n)throw[Un,"Key is undefined: "+e];var t=ve(i,ce(n));if(!t.tag)return[[e,t[0]],r];throw[Un,t[0]]},n,0)])}catch(e){var t=fe(e);if(t[0]===Un)return ee(1,["Invalid keyValuePair parsing: "+t[1]]);throw t}}]},dict:function(e){var i=e[0];return[function(e){var r=Rn(e);if("number"==typeof r)return ee(1,["Non-dict value"]);if(2!==r.tag)return ee(1,["Non-dict value"]);var a=r[0],n=Object.keys(a);try{return ee(0,[On(function(e,r){var n=qn(a,e);if(void 0===n)throw[Un,"Key is undefined: "+e];var t=ve(i,ce(n));if(!t.tag)return Dn(e,t[0],r);throw[Un,t[0]]},n,0)])}catch(e){var t=fe(e);if(t[0]===Un)return ee(1,["Invalid dict parsing: "+t[1]]);throw t}}]},field:zn,at:function(e,r){return function e(r,n,t){return n?C(r,n[0],e(r,n[1],t)):t}(zn,e,r)},index:function(t,e){var a=e[0];return[function(e){var r=Rn(e);if("number"==typeof r)return ee(1,["Non-array value"]);if(3!==r.tag)return ee(1,["Non-array value"]);var n=r[0];return t<0||t>n.length?ee(1,["Array index out of range: "+String(t)]):ve(a,le(n,t))}]},maybe:function(e){var n=e[0];return[function(e){var r=ve(n,e);return r.tag?ee(0,[void 0]):ee(0,[oe(r[0])])}]},oneOf:Xn,map:Gn,map2:function(a,e,r){var i=r[0],u=e[0];return[function(e){var r=ve(u,e),n=ve(i,e);if(!r.tag&&!n.tag)return ee(0,[C(a,r[0],n[0])]);var t=Fn(r,n);if(void 0!==t)return ee(1,["map2 -> "+t]);throw[w,"Impossible case"]}]},map3:function(i,e,r,n){var u=n[0],o=r[0],c=e[0];return[function(e){var r=ve(c,e),n=ve(o,e),t=ve(u,e);if(!r.tag&&!n.tag&&!t.tag)return ee(0,[D(i,r[0],n[0],t[0])]);var a=Tn(t,Tn(n,r));if(a.tag)return ee(1,["map3 -> "+a[0]]);throw[w,"Impossible case"]}]},map4:function(u,e,r,n,t){var o=t[0],c=n[0],s=r[0],f=e[0];return[function(e){var r=ve(f,e),n=ve(s,e),t=ve(c,e),a=ve(o,e);if(!(r.tag||n.tag||t.tag||a.tag))return ee(0,[function(t,a,i,u,o){var e=t.length;if(4===e)return t(a,i,u,o);switch(e){case 1:return y(t(a),[i,u,o]);case 2:return y(t(a,i),[u,o]);case 3:return y(t(a,i,u),[o]);case 4:return t(a,i,u,o);case 5:return function(e){return t(a,i,u,o,e)};case 6:return function(e,r){return t(a,i,u,o,e,r)};case 7:return function(e,r,n){return t(a,i,u,o,e,r,n)};default:return y(t,[a,i,u,o])}}(u,r[0],n[0],t[0],a[0])]);var i=Tn(a,Tn(t,Tn(n,r)));if(i.tag)return ee(1,["map4 -> "+i[0]]);throw[w,"Impossible case"]}]},map5:function(o,e,r,n,t,a){var c=a[0],s=t[0],f=n[0],l=r[0],v=e[0];return[function(e){var r=ve(v,e),n=ve(l,e),t=ve(f,e),a=ve(s,e),i=ve(c,e);if(!(r.tag||n.tag||t.tag||a.tag||i.tag))return ee(0,[function(n,t,a,i,u,o){var e=n.length;if(5===e)return n(t,a,i,u,o);switch(e){case 1:return y(n(t),[a,i,u,o]);case 2:return y(n(t,a),[i,u,o]);case 3:return y(n(t,a,i),[u,o]);case 4:return y(n(t,a,i,u),[o]);case 5:return n(t,a,i,u,o);case 6:return function(e){return n(t,a,i,u,o,e)};case 7:return function(e,r){return n(t,a,i,u,o,e,r)};default:return y(n,[t,a,i,u,o])}}(o,r[0],n[0],t[0],a[0],i[0])]);var u=Tn(i,Tn(a,Tn(t,Tn(n,r))));if(u.tag)return ee(1,["map5 -> "+u[0]]);throw[w,"Impossible case"]}]},map6:function(c,e,r,n,t,a,i){var s=i[0],f=a[0],l=t[0],v=n[0],d=r[0],h=e[0];return[function(e){var r=ve(h,e),n=ve(d,e),t=ve(v,e),a=ve(l,e),i=ve(f,e),u=ve(s,e);if(!(r.tag||n.tag||t.tag||a.tag||i.tag||u.tag))return ee(0,[function(r,n,t,a,i,u,o){var e=r.length;if(6===e)return r(n,t,a,i,u,o);switch(e){case 1:return y(r(n),[t,a,i,u,o]);case 2:return y(r(n,t),[a,i,u,o]);case 3:return y(r(n,t,a),[i,u,o]);case 4:return y(r(n,t,a,i),[u,o]);case 5:return y(r(n,t,a,i,u),[o]);case 6:return r(n,t,a,i,u,o);case 7:return function(e){return r(n,t,a,i,u,o,e)};default:return y(r,[n,t,a,i,u,o])}}(c,r[0],n[0],t[0],a[0],i[0],u[0])]);var o=Tn(u,Tn(i,Tn(a,Tn(t,Tn(n,r)))));if(o.tag)return ee(1,["map6 -> "+o[0]]);throw[w,"Impossible case"]}]},map7:function(s,e,r,n,t,a,i,u){var f=u[0],l=i[0],v=a[0],d=t[0],h=n[0],p=r[0],m=e[0];return[function(e){var r=ve(m,e),n=ve(p,e),t=ve(h,e),a=ve(d,e),i=ve(v,e),u=ve(l,e),o=ve(f,e);if(!(r.tag||n.tag||t.tag||a.tag||i.tag||u.tag||o.tag))return ee(0,[function(e,r,n,t,a,i,u,o){var c=e.length;if(7===c)return e(r,n,t,a,i,u,o);switch(c){case 1:return y(e(r),[n,t,a,i,u,o]);case 2:return y(e(r,n),[t,a,i,u,o]);case 3:return y(e(r,n,t),[a,i,u,o]);case 4:return y(e(r,n,t,a),[i,u,o]);case 5:return y(e(r,n,t,a,i),[u,o]);case 6:return y(e(r,n,t,a,i,u),[o]);case 7:return e(r,n,t,a,i,u,o);default:return y(e,[r,n,t,a,i,u,o])}}(s,r[0],n[0],t[0],a[0],i[0],u[0],o[0])]);var c=Tn(o,Tn(u,Tn(i,Tn(a,Tn(t,Tn(n,r))))));if(c.tag)return ee(1,["map7 -> "+c[0]]);throw[w,"Impossible case"]}]},map8:function(f,e,r,n,t,a,i,u,o){var l=o[0],v=u[0],d=i[0],h=a[0],p=t[0],m=n[0],g=r[0],b=e[0];return[function(e){var r=ve(b,e),n=ve(g,e),t=ve(m,e),a=ve(p,e),i=ve(h,e),u=ve(d,e),o=ve(v,e),c=ve(l,e);if(!(r.tag||n.tag||t.tag||a.tag||i.tag||u.tag||o.tag||c.tag))return ee(0,[function(e,r,n,t,a,i,u,o,c){var s=e.length;if(8===s)return e(r,n,t,a,i,u,o,c);switch(s){case 1:return y(e(r),[n,t,a,i,u,o,c]);case 2:return y(e(r,n),[t,a,i,u,o,c]);case 3:return y(e(r,n,t),[a,i,u,o,c]);case 4:return y(e(r,n,t,a),[i,u,o,c]);case 5:return y(e(r,n,t,a,i),[u,o,c]);case 6:return y(e(r,n,t,a,i,u),[o,c]);case 7:return y(e(r,n,t,a,i,u,o),[c]);default:return y(e,[r,n,t,a,i,u,o,c])}}(f,r[0],n[0],t[0],a[0],i[0],u[0],o[0],c[0])]);var s=Tn(c,Tn(o,Tn(u,Tn(i,Tn(a,Tn(t,Tn(n,r)))))));if(s.tag)return ee(1,["map8 -> "+s[0]]);throw[w,"Impossible case"]}]},succeed:function(r){return[function(e){return ee(0,[r])}]},fail:function(r){return[function(e){return ee(1,[r])}]},value:[function(e){return ee(0,[e])}],andThen:Kn,lazy_:function(e){return Kn(e,[function(e){return ee(0,[void 0])}])},nullable:function(e){return Xn([jn(void 0),[Gn(oe,e),0]])},decodeValue:Yn,decodeEvent:function(e,r){try{return ve(e[0],r)}catch(e){var n=fe(e);return n[0]===Un?ee(1,[n[1]]):ee(1,["Unknown JSON parsing error"])}},decodeString:function(e,r){try{return Yn(e,JSON.parse(r))}catch(e){return ee(1,["Invalid JSON string"])}}};function rt(e){return ee(1,[e])}function nt(e,r,n,t){return Ge("","div",void 0!==e?e:"",void 0!==r?r:"",n,t)}function tt(e,r,n,t){return Ge("","span",void 0!==e?e:"",void 0!==r?r:"",n,t)}function at(e,r,n,t){return Ge("","p",void 0!==e?e:"",void 0!==r?r:"",n,t)}function it(e,r,n,t){return Ge("","h3",void 0!==e?e:"",void 0!==r?r:"",n,t)}function ut(e,r,n,t){return Ge("","button",void 0!==e?e:"",void 0!==r?r:"",n,t)}function ot(e,r,n,t){return Ge("","textarea",void 0!==e?e:"",void 0!==r?r:"",n,t)}function ct(e,r,n,t){return Ge("","label",void 0!==e?e:"",void 0!==r?r:"",n,t)}function st(e,r,n,t){return Ge("","ul",void 0!==e?e:"",void 0!==r?r:"",n,t)}function ft(e,r,n,t){return Ge("","li",void 0!==e?e:"",void 0!==r?r:"",n,t)}function lt(e,r,n,t){return Ge("","option",void 0!==e?e:"",void 0!==r?r:"",n,t)}function vt(e,r,n,t){return Ge("","hr",void 0!==e?e:"",void 0!==r?r:"",n,t)}function dt(e){return ee(0,["className",e])}function ht(e){return ee(0,["className",Je(" ",_e(function(e){return e[0]},Oe(function(e){return e[1]})(e)))])}function pt(e){return ee(0,["placeholder",e])}function mt(e){return ee(0,["value",e])}var gt=Ke;function bt(e,r){var n,t;return t=function(e){return oe(ve(r,e))},Ke("input",void 0!==(n=void 0!==e?e:"")?n:"",function(e){var r=e.target;if(void 0!==r){var n=r.value;return void 0!==n?ve(t,n):void 0}})}function wt(e,r){var n,t;return t=function(e){return oe(ve(r,e))},Ke("change",void 0!==(n=void 0!==e?e:"")?n:"",function(e){var r=e.target;if(void 0!==r){var n=r.value;return void 0!==n?ve(t,n):void 0}})}function yt(e){return ee(3,["click",ee(1,[e]),{contents:void 0}])}var _t={stopPropagation:!1,preventDefault:!1},St=(et.at(["target",["value",0]],et.string),et.at(["target",["checked",0]],et.bool),et.field("keyCode",et.$$int));var kt={max:function(e){return ee(1,["","max",e])},min:function(e){return ee(1,["","min",e])},step:function(e){return ee(1,["","step",e])},disabled:function(e){return e?ee(1,["","disabled","true"]):0},selected:function(e){return e?ee(1,["","selected","true"]):0},acceptCharset:function(e){return ee(1,["","accept-charset",e])},rel:function(e){return ee(1,["","rel",e])}},xt=Xe,At=0,Nt=246,Ot=250,qt=ie("CamlinternalLazy.Undefined");function Rt(e){throw qt}function Tt(e){var r=0|e.tag;return r===Ot?e[0]:r!==Nt?e:function(e){var r,n=e[0];e[0]=Rt;try{var t=ve(n,void 0);return e[0]=t,r=Ot,e.tag=r,t}catch(r){throw e[0]=function(e){throw r},r}}(e)}function Ft(e,r){return Ne(_e(r,e))}var Et={take:function(e,r){var n=function(e,r,n){for(;;){var t=r;if(0===n)return[e,t];if(!t)return[e,0];n=n-1|0,r=t[1],e=[t[0],e]}}(0,r,e);return[we(n[0]),n[1]]},apply:function(e,r){return ve(r,e)},bind:Ft,concat_map:function(e,r){return Ne(_e(e,r))},$great$great$eq:Ft,next_or_this_item:function(e,r){for(var n=r;;){if(!n)return e;var t=n[1];if(m(e,n[0]))return t?t[0]:e;n=t}},count:function(e,r){for(var n=0,t=r;;){var a=n;if(!t)return a;var i=t[1];ve(e,t[0])?(t=i,n=a+1|0):t=i}},list_from_option:function(e){return void 0!==e?[ce(e),0]:0},first_inconsistent_opt:function(e,r){if(e)for(var n=ve(r,e[0]),t=e[1];;){var a=t,i=n;if(!a)return;var u=ve(r,a[0]);if(!m(u,i))return[i,u];t=a[1],n=u}}};function Lt(e,r,n){return gt(e,r,function(e){return _t.stopPropagation&&e.stopPropagation(),_t.preventDefault&&e.preventDefault(),(r=et.decodeEvent(n,e)).tag?void 0:oe(r[0]);var r})}var Mt={keydown:function(e,r,n){var t=et.field("ctrlKey",et.bool),a=et.map2(function(e,r){return{ctrlKey:r,keyCode:e}},St,t);return Lt("keydown",e,et.andThen(function(e){return ve(n,e)?et.succeed(r):et.fail("Incorrect keys")},a))}},Ct={on_keyed:Lt,Keydown:Mt};function Dt(e,r){return r.tag?r:ee(0,[ve(e,r[0])])}function Pt(e){return e.tag?e:e[0]}function It(e,r){return Pt(Dt(r,e))}var Wt={map:Dt,map_error:function(e,r){return r.tag?ee(1,[ve(e,r[0])]):r},flatten:Pt,flat_map:function(e,r){return Pt(Dt(e,r))},bind:It,$great$great$eq:It};function $t(e){return[e,0]}function Jt(r,e){if(!e)return 0;var n=e[1];return[ve(r,e[0]),i(function(e){return Jt(r,Tt(n))})]}function Zt(e,r){if(!e)return Tt(r);var n=e[1];return[e[0],i(function(e){return Zt(Tt(r),n)})]}function Bt(e){if(!e)return 0;var r=e[1];return Zt(e[0],i(function(e){return Bt(Tt(r))}))}function Ht(e,r){return Bt(Jt(r,e))}var Qt={$$return:$t,unit:$t,push:function(e,r){return[e,r]},map:Jt,filter:function n(t,e){for(;;){if(!e)return 0;var r=e[1],a=e[0];if(ve(t,a))return[a,i(function(r){return function(e){return n(t,Tt(r))}}(r))];e=Tt(r)}},interleave_delayed:Zt,append_delayed:function r(e,n){if(!e)return Tt(n);var t=e[1];return[e[0],i(function(e){return r(Tt(t),n)})]},flatten:Bt,bind:Ht,$great$great$eq:Ht,from_list:function r(e){if(!e)return 0;var n=e[1];return[e[0],i(function(e){return r(n)})]},from_option:function(e){return void 0!==e?[ce(e),0]:0}};function Vt(e,r){return[C(Qr([ee(2,[0,ee(4,[0,0,0,0])]),"%s%d"]),e[0],r)]}function Ut(e){return ve(Qr([ee(12,[63,ee(2,[0,0])]),"?%s"]),e[0])}var jt={compare:function(e,r){return h(e[0],r[0])},make:function(e){return[e]},make_numbered:Vt,to_string:Ut};function zt(e,r){return h(e[0],r[0])}function Xt(e,r){return e[0]===r[0]}var Gt={make:function(e){return[e]},compare:zt,equals:Xt,to_string:function(e){return e[0]}};function Kt(e){if(!e.tag)return Ut(e[0]);var r=e[0],n=r.related_terms,t=r.relation_name[0];return n?C(Qr([ee(2,[0,ee(12,[40,ee(2,[0,ee(12,[41,0])])])]),"%s(%s)"]),t,Je(", ",_e(Kt,n))):t}function Yt(e){if(!e.tag)return 0;var r=e[0],n=r.related_terms;return[[r.relation_name,ge(n)],Et.concat_map(Yt,n)]}var ea={make_relation:function(e,r){return ee(1,[{relation_name:[e],related_terms:r}])},make_variable:function(e){return ee(0,[[e]])},to_string:Kt,relation_arities:Yt};function ra(e){switch(0|e.tag){case 0:return Kt(e[0]);case 1:return C(Qr([ee(12,[60,ee(2,[0,ee(11,[" = ",ee(2,[0,ee(12,[62,0])])])])]),"<%s = %s>"]),Kt(e[0]),Kt(e[1]));case 2:return C(Qr([ee(12,[60,ee(2,[0,ee(11,[" /= ",ee(2,[0,ee(12,[62,0])])])])]),"<%s /= %s>"]),Kt(e[0]),Kt(e[1]))}}function na(e){switch(0|e.tag){case 0:return Yt(e[0])}return Ne([Yt(e[0]),[Yt(e[1]),0]])}var ta={to_string:ra,relation_arities:na};function aa(e){return Je(" and ",_e(ra,e))}var ia={empty:0,to_string:aa},ua=An(jt),oa=ua.empty;function ca(e,r){return D(ua.add,e[0],e[1],r)}function sa(e,r){var n=C(ua.find_opt,e,r);if(void 0!==n){if(n.tag)return n;var t=sa(n[0],r);return void 0!==t?t:n}}function fa(e,n){function t(e){var r=sa(e,n);return void 0!==r?i(r):ee(0,[["?"]])}var a=function(e,r){if(r.tag)return ke(a,e,r[0].related_terms);var n=r[0];return ca([n,t(n)],e)},i=function(e){if(!e.tag)return t(e[0]);var r=e[0];return ee(1,[{relation_name:r.relation_name,related_terms:_e(i,r.related_terms)}])};return ve(ua.bindings,ke(function(e,r){switch(0|r.tag){case 0:return a(e,r[0])}return a(a(e,r[0]),r[1])},oa,e))}function la(e,a,i){var u=function(e){for(;;){var r=e;if(r.tag)return function(e,r){for(;;){var n=r;if(!n)return!1;if(ve(e,n[0]))return!0;r=n[1]}}(u,r[0].related_terms);var n=r[0];if(m(n,a))return!0;var t=sa(n,i);if(void 0===t)return!1;e=t}};return u(e)}var va={FrameMap:ua,empty:oa,extend:ca,lookup:sa,instantiate:function(t){var a=function(e){if(!e.tag){var r=sa(e[0],t);return void 0!==r?a(r):ee(0,[["?"]])}var n=e[0];return ee(1,[{relation_name:n.relation_name,related_terms:_e(a,n.related_terms)}])};return a},variable_bindings_in_query:fa,to_strings:function(e,r){var n=fa(e,r);return n?_e(function(e){return C(Qr([ee(2,[0,ee(11,[" := ",ee(2,[0,0])])]),"%s := %s"]),Ut(e[0]),Kt(e[1]))},n):0},term_depends_on_variable:la};function da(e){var r,n,t=e.antecedents,a=Kt(e.consequent);return n=t?(r=aa(t),C(Qr([ee(2,[0,ee(11,[" when ",ee(2,[0,0])])]),"%s when %s"]),a,r)):a,ve(Qr([ee(2,[0,ee(12,[46,0])]),"%s."]),n)}function ha(e){return Ne([ye(_e(na,e.antecedents)),[Yt(e.consequent),0]])}var pa={contents:0};function ma(e){if(!e.tag)return ee(0,[Vt(e[0],pa.contents)]);var r=e[0],n=_e(ma,r.related_terms);return ee(1,[{relation_name:r.relation_name,related_terms:n}])}function ga(e){switch(0|e.tag){case 0:return ee(0,[ma(e[0])]);case 1:return ee(1,[ma(e[0]),ma(e[1])]);case 2:return ee(2,[ma(e[0]),ma(e[1])])}}function ba(e){return pa.contents=pa.contents+1|0,{antecedents:_e(ga,e.antecedents),consequent:ma(e.consequent)}}var wa={to_string:da,relation_arities:ha,rename_rule_variables:ba},ya=An({compare:He});function _a(e){return e.rule}function Sa(e,r){return e.id===r.id}var ka={all_rules:0,indexed_by_consequent_relation:ya.empty};function xa(e,r){var n,t;return t=r.tag?void 0!==(n=C(ya.find_opt,r[0].relation_name[0],e.indexed_by_consequent_relation))?n:0:e.all_rules,Qt.from_list(we(t))}function Aa(e){return we(e.all_rules)}var Na={contents:1};function Oa(e,r){var n={id:(Na.contents=Na.contents+1|0,Na.contents),rule:r},t=r.consequent;return t.tag?{all_rules:[n,e.all_rules],indexed_by_consequent_relation:D(ya.update,t[0].relation_name[0],function(e){return void 0!==e?[n,e]:[n,0]},e.indexed_by_consequent_relation)}:{all_rules:[n,e.all_rules],indexed_by_consequent_relation:e.indexed_by_consequent_relation}}var qa,Ra={VariableName:jt,RelationName:Gt,Term:ea,ComplexTerm:ta,Query:ia,Frame:va,Rule:wa,RuleDatabase:{empty:ka,rule_from_entry:_a,identifier_of_rule_entry:function(e){return ve(Qr([ee(4,[0,0,0,0]),"%d"]),e.id)},update_rule_entry:function(e,r){return console.log(ve(Qr([ee(11,["Update rule entry: ",ee(2,[0,0])]),"Update rule entry: %s"]),da(r))),{id:e.id,rule:r}},is_same:Sa,remove_rule:function(e,r){var n=r.id,t=Oe(function(e){return e.id!==n}),a=ve(t,e.all_rules),i=r.rule.consequent;return i.tag?{all_rules:a,indexed_by_consequent_relation:D(ya.update,i[0].relation_name[0],function(e){return void 0!==e?ve(t,e):0},e.indexed_by_consequent_relation)}:{all_rules:a,indexed_by_consequent_relation:e.indexed_by_consequent_relation}},add_rule:Oa,update_rule:function(e,r){function n(e){return _e(function(e){return e.id===r.id?r:e},e)}var t=n(e.all_rules);console.log(ve(Qr([ee(11,["Updating rule in database: ",ee(2,[0,0])]),"Updating rule in database: %s"]),da(r.rule)));var a=r.rule.consequent;return a.tag?{all_rules:t,indexed_by_consequent_relation:D(ya.update,a[0].relation_name[0],function(e){return void 0!==e?n(e):[r,0]},e.indexed_by_consequent_relation)}:{all_rules:t,indexed_by_consequent_relation:e.indexed_by_consequent_relation}},fetch_for_query:xa,all_rules:Aa}},Ta={$$Map:qa=An({compare:zt}),make:function(n,e){return ke(function(e,r){return D(qa.update,ve(n,r),function(e){return void 0!==e?[r,e]:[r,0]},e)},qa.empty,e)},keys:function(e){return _e(function(e){return e[0]},ve(qa.bindings,e))},find_opt:function(e,r){return C(qa.find_opt,e,r)}};function Fa(a,e){return ke(function(e,r){var n=ve(a,r);if(void 0===n)return e;var t=Et.first_inconsistent_opt(n,function(e){return e[1]});return void 0!==t?[D(Qr([ee(11,["Relation '",ee(2,[0,ee(11,["' has inconsistent number of terms applied of ",ee(4,[0,0,0,ee(11,[" and ",ee(4,[0,0,0,0])])])])])]),"Relation '%s' has inconsistent number of terms applied of %d and %d"]),r[0],t[0],t[1]),e]:e},0,e)}function Ea(e){return C(Ta.make,function(e){return e[0]},Et.concat_map(ha,e))}function La(e){return ve(Ta.keys,C(Ta.make,function(e){return e[0]},ha(e)))}function Ma(e,r){var n=Ea([r,_e(_a,e)]);return Fa(function(e){return C(Ta.find_opt,e,n)},La(r))}var Ca={rule_database_snapshot:Aa,issues_in_existing_rule:function(e,r){var n=Ea(_e(_a,[r,Oe(function(e){return!Sa(e,r)})(e)]));return Fa(function(e){return C(Ta.find_opt,e,n)},La(_a(r)))},issues_in_new_rule:Ma,issues_in_query:function(e,r){var n=Et.concat_map(na,r),t=C(Ta.make,function(e){return e[0]},Ne([n,[Et.concat_map(ha,_e(_a,e)),0]]));return Fa(function(e){return C(Ta.find_opt,e,t)},ve(Ta.keys,C(Ta.make,function(e){return e[0]},n)))}};function Da(e){function r(e){return Sn(mn,t,e)}function n(e){return Kr(a,r,e)}var t=on(95),a=ve(Qr([ee(2,[0,ee(11,[" requires ",ee(2,[0,0])])]),"%s requires %s"]),e);return function(e){return _n(n,function(r){return en(function(e){return Je("",_e(function(e){return We(1,e)},[r,e]))},tn(nn([mn,[hn,[on(95),[on(45),0]]]])))},e)}}var Pa=kn(on(63),en(function(e){return ee(0,[[e]])},Da("Variable")));function Ia(e){return Yr("Variable starting with ?",Pa,e)}var Wa=kn(bn("= "),function(e){return Gr(!0,e)}),$a=kn(bn("/= "),function(e){return Gr(!1,e)});function Ja(e){return Sn(Wa,$a,e)}function Za(e){return an(e,kn(kn(gn,bn("and")),gn))}function Ba(e){return Sn(Ia,Qa,e)}function Ha(e){return _n(kn(on(60),Ba),function(t){return function(e){return _n(Ja,function(n){var r=xn(Ba,on(62));return function(e){return _n(r,function(e){var r=ee(n?1:2,[t,e]);return function(e){return Gr(r,e)}},e)}},e)}},e)}function Qa(e){return _n(xn(Da("Relation"),gn),function(e){var r=[e],n=ee(1,[{relation_name:r,related_terms:0}]),t=xn(on(40),gn);return function(e){return Xr(t,function(e){return en(function(e){return ee(1,[{relation_name:r,related_terms:e}])},xn(xn(Va,gn),on(41)))},n,e)}},e)}function Va(e){return an(xn(Ba,gn),kn(on(44),gn))(e)}function Ua(e){return Sn(en(function(e){return ee(0,[e])},Ba),Ha,e)}function ja(e){return Za(Ua)(e)}function za(e){return xn(function(e){return _n(Ba,function(r){function n(e){return Gr(t,e)}var t={antecedents:0,consequent:r},a=en(function(e){return{antecedents:e,consequent:r}},kn(kn(kn(gn,bn("when")),gn),ja));return function(e){return Sn(a,n,e)}},e)},on(46))(e)}var Xa={rule_parser:za,query_parser:function(e){return Za(Ua)(e)},rule_database_result_from_rule_strings:function(e){return ke(function(e,r){return Wt.flat_map(function(t){return Wt.flat_map(function(e){var r=e.result,n=Ma(Aa(t),r);return 0<ge(n)?ee(1,[n]):ee(0,[Oa(t,r)])},Wt.map_error(function(e){return _e(Ur,e)},yn(za,r)))},e)},ee(0,[ka]),e)}};function Ga(e){var r=function(e,r){for(var n=0,t=0,a=r;;){var i=a,u=t,o=n;if(!i)return[be(o,0),be(u,0)];var c=i[1],s=i[0];ve(e,s)?(a=c,n=[s,o]):(a=c,t=[s,u])}}(function(e){switch(0|e.tag){case 0:case 1:return!1;case 2:return!0}},e);return Ne([r[1],[r[0],0]])}function Ka(o,e){function c(e,r){for(;;){var n=e;if(!n)return r;r=t(n[0],r),e=n[1]}}var t=function(e,r){switch(0|e.tag){case 0:var a=e[0];return Qt.$great$great$eq(r,function(t){return Qt.$great$great$eq(xa(o,a),function(e){var r=ba(_a(e)),n=s(a,r.consequent,t);return void 0!==n?c(r.antecedents,Qt.$$return({frame:n.frame,rules_applied:[e,n.rules_applied]})):0})});case 1:var n=e[1],t=e[0];return Qt.$great$great$eq(r,function(e){return Qt.from_option(s(t,n,e))});case 2:var i=e[1],u=e[0];return Qt.$great$great$eq(r,function(e){return void 0!==s(u,i,e)?0:Qt.$$return(e)})}},s=function(e,r,n){if(m(e,r))return n;if(!e.tag)return i(e[0],r,n);var t=e[0];if(!r.tag)return i(r[0],e,n);var a=r[0];return Xt(t.relation_name,a.relation_name)?ke(function(e,r){if(void 0!==e)return s(r[0],r[1],e)},n,xe(t.related_terms,a.related_terms)):void 0},i=function(e,r,n){var t=sa(e,n.frame);if(void 0!==t)return s(t,r,n);if(r.tag)return la(r,e,n.frame)?void 0:{frame:ca([e,r],n.frame),rules_applied:n.rules_applied};var a=sa(r[0],n.frame);return void 0!==a?s(ee(0,[e]),a,n):{frame:ca([e,r],n.frame),rules_applied:n.rules_applied}},r=Ga(e);return function(e){return c(r,e)}}var Ya={query:function(e,r){return Ka(e,r)(Qt.$$return({frame:oa,rules_applied:0}))}};function ei(e){var r=function e(r){if(!r)return ee(0,[0]);var n=r[1],t=r[0];if(!n)return t.tag?t:ee(0,[[t[0],0]]);if(t.tag)return t;var a=e(n);return a.tag?a:ee(0,[[t[0],a[0]]])}(_e(function(e){return yn(Xa.query_parser,e)},_e(function(e){return e[0]},e.queries)));return r.tag?(console.error(r[0]),0):xe(_e(jr,r[0]),_e(function(e){return e[1]},e.queries))}var ri=[{name:"Simple Facts",rule_instructions:["FACTs are unconditionally true statements. As soon as a fact is entered into the database it is known to be true. \n        A Fact can relate other terms together or it can stand on its own. In this chapter we show just simple facts that stand on their own.",["A Fact is represented as an identifier written in any case. Spaces cannot be used inside Fact names but underscores can be.",["Click the <Query> button to explore the queries that can be written against this simple database.",0]]],rules:["OrangesAreSpherical.",["oranges_are_spherical.",["SoccerBallsAreSpherical.",["soccerBalls_ARE_spherical.",0]]]],queries:[["SoccerBallsAreSpherical",["This query just asks whether the fact is found in the database. Execute this query to reveal that this fact is found in the database."]],[["FootballsAreSpherical",["Try this query. Observe that no solution was found because the fact is not in the database."]],0]]},[{name:"Facts as Predicates",rule_instructions:["Facts can also express the truth of a _relationship_ between things. A Fact that expresses a relationship with a single term can be viewed as a declaration of \n            inclusion in a Set (a Predicate). For example, the facts from the previous chapter about spherical items can be more usefully represented as predicates.",0],rules:["Spherical(Oranges).",["Spherical(SoccerBalls).",["Spherical(BasketBalls).",["Spherical(Sun).",0]]]],queries:[["Spherical(Oranges)",["This query just asks if this specific fact is in the database. It is."]],[["Spherical(FootBalls)",["Observe that this query fails to find a solution."]],0]]},[{name:"Querying with Variables",rule_instructions:["The queries in the prior chapters were pretty lame because they could only ask if very _specific_ facts were present in the database.",["To introduce a little abstraction we need variables which act as kind of wildcard placeholders for any value. Variables are written with a ? prefix.",["When a query includes a variable, the solution to the query will display the variable binding which satisfies the query.",0]]],rules:["Spherical(Oranges).",["Spherical(SoccerBalls).",["Spherical(BasketBalls).",["Spherical(Sun).",0]]]],queries:[["Spherical(?sphericalThing)",["When you execute this query you will observe multiple things: 1) the solution now includes the value of the binding and \n            2) there are now multiple solutions which can be requested with Next Solution. Logic programming environments\n            require user to explicitly ask for the Next Solution because logic programming supports INFINITE solution spaces!!!"]],0]},[{name:"Relationships",rule_instructions:["Facts can express relationships between multiple things. This child demonstrates declaration of mother-child relationships.",0],rules:["MotherOf(Sally, Bob).",["MotherOf(Sally, Janice).",["MotherOf(Sally, Debrah).",["MotherOf(Janice, Malcom).",0]]]],queries:[["MotherOf(Sally, ?childOfSally)",["This query will find all children of Sally in the database."]],[["MotherOf(?motherOfBob, Bob)",["This query will find the mother (or mothers) of Bob. NOTE: We have now seen that variables can be put in any place. That is a powerful concept we will explore later."]],[["MotherOf(?mother, ?child)",["In fact, we can use variables for both locations to get all mother-child solutions in the database."]],0]]]},[{name:"Implication (Rules)",rule_instructions:["While Facts are uncondtionally true, a RULE specifies a _conclusion_ whose truth is dependent upon one or more conditions. For example, someone is a parent of someone else if \n        we can prove that they are the mother or father. Parenthood follows from motherhood and fatherhood.",0],rules:["ParentOf(?parent, ?child) when MotherOf(?parent, ?child).",["ParentOf(?parent, ?child) when FatherOf(?parent, ?child).",["MotherOf(Sally, Janice).",["MotherOf(Sally, Debrah).",["MotherOf(Janice, Malcom).",["FatherOf(Roberto, Janice).",0]]]]]],queries:[["ParentOf(Sally, Janice)",["Here we will simply ask the database if it can prove that Sally is the parent of Janice. NOTE: The database does not explicitly declare Sally is the parent of Janice. The logic system deduced the fact from the rules given."]],[["ParentOf(?parent, Janice)",["We can also use variables in the query to find all parents of Janice."]],[["ParentOf(Sally, ?child)",["Or find all the children of Sally."]],0]]]},[{name:"Unification: Part 1",rule_instructions:["In this next example consider the definition of Siblings. Note that the variable ?parent is found in two sub-queries of ParentOf. \n        This means that the Siblings rule can only be proven true when a ParentOf can be proven for the first sibling and for the second and\n        that the parent must be able to be unified (in this case the same). This is an example of unification and it is one of most interesting powers \n        in logic programming because it can accomplish a lot work in a very subtle and succinct way.",0],rules:["ParentOf(?parent, ?child) when MotherOf(?parent, ?child).",["Siblings(?firstSibling, ?secondSibling) when ParentOf(?parent, ?firstSibling) and ParentOf(?parent, ?secondSibling).",["MotherOf(Sally, Janice).",["MotherOf(Sally, Debrah).",["MotherOf(Sally, Malcom).",0]]]]],queries:[["Siblings(Janice, Debrah)",["A yes/no style query that just asks the system to deduce whether Janice and Debrah are siblings."]],[["Siblings(?sibling, Debrah)",["Here we ask about the siblings of Debrah. OBSERVE: Debrah is her own sibling! Weird. We will explain and fix this behavior in the next Chapter."]],0]]},[{name:"Unification: Part 2",rule_instructions:["In the last chapter we saw that our definition of sibling was such that it would report that a person was their own sibling. This was because\n        we defined sibling as ANY other term in the database that has the same parent. We did not explicitly ask not to be informed when both terms were the same.",0],rules:["ParentOf(?parent, ?child) when MotherOf(?parent, ?child).",["Siblings(?firstSibling, ?secondSibling) when ParentOf(?parent, ?firstSibling) and ParentOf(?parent, ?secondSibling) and <?firstSibling /= ?secondSibling>.",["MotherOf(Sally, Janice).",["MotherOf(Sally, Debrah).",["MotherOf(Sally, Malcom).",0]]]]],queries:[["Siblings(?sibling, Debrah)",["Now we should only get other terms that have the same parent but which are not Debrah herself."]],0]},[{name:"Unification: Part 3",rule_instructions:[".",0],rules:["Job(Cindy, QualityEngineer).",["Smart(Cindy).",["GetsThingsDone(Cindy).",["Salary(Cindy, Moderate).",["Job(Swathi, QualityEngineer).",["Smart(Swathi).",["GetsThingsDone(Swathi).",["Salary(Swathi, High).",["Job(William, QualityEngineer).",["GetsThingsDone(William).",["Salary(William, Low).",["Job(Janet, QualityEngineer).",["Smart(Janet).",["Salary(Janet, Low).",["Job(Alice, SoftwareEngineer).",["Smart(Alice).",["GetsThingsDone(Alice).",["Salary(Alice, Low).",["Job(Beatrice, Marketing).",["Smart(Beatrice).",["GetsThingsDone(Beatrice).",["Salary(Beatrice, High).",0]]]]]]]]]]]]]]]]]]]]]],queries:[["Job(?person, QualityEngineer)",["Simply find all the persons who are quality engineers."]],[["Job(?person, QualityEngineer) and Smart(?person) and GetsThingsDone(?person)",["Now find all the quality engineers who are both smart and get things done."]],[["Job(?person, ?jobRole) and Smart(?person) and GetsThingsDone(?person)",["Just find the smart industrious people and report on their job role."]],[["Job(?person, QualityEngineer) and Smart(?person) and GetsThingsDone(?person) and Salary(?person, ?salary) and <?salary /= High>",["Now find all the smart, industrious quality engineers who do not get paid a high salary."]],0]]]]},[{name:"Recursion (Genealogy)",rule_instructions:["A rule can depend upon itself recursively! This chapter demonstrates a recursive declaration for proving that something is an ancestor of another.",["As is always the case with recursion, BEWARE to always have a terminating base case. Observe that the recursive specification of AncestorOf has a ParentOf \n        sub-query which is not a reference to AncestorOf. When the ParentOf sub-query in the body of the AncestorOf rule fails the recursion terminates.",0]],rules:["ParentOf(?Mother, ?Child) when MotherOf(?Mother, ?Child).",["AncestorOf(?Ancestor, ?Descendant) when ParentOf(?Ancestor, ?Descendant).",["AncestorOf(?Ancestor, ?Descendant) when ParentOf(?ParentOfDescendant, ?Descendant) and AncestorOf(?Ancestor, ?ParentOfDescendant).",["MotherOf(Erica, Sally).",["MotherOf(Sally, Jane).",["MotherOf(Jane, Maria).",["MotherOf(Maria, Roberta).",0]]]]]]],queries:[["AncestorOf(Erica, Sally)",["Here Erica is just Sally's mother so we don't even need to use recursion"]],[["AncestorOf(Erica, Jane)",["Note that there is ONE application of the recursive rule."]],[["AncestorOf(Erica, Roberta)",["Observe that there are THREE applications of the recursive rule."]],[["AncestorOf(?ancestor, Roberta)",["Demonstrating a variable to ask for ALL ancestors of Roberta."]],[["AncestorOf(Erica, ?descendant)",["Demonstrating a variable to ask for ALL descendants of Erica."]],0]]]]]},[{name:"Linked List: Append",rule_instructions:["So far we have covered use cases that probably seem relatively natural to a database system. We are now going to\n          explore patterns that approximate general purpose programming but using an entirely declarative information based approach.",["We begin with appending two linked lists together. In this example, the N relation defines a linked-list node (abbreviated to N for reasons that become quickly apparent.)",["A node in a linked list has a value and a pointer to the next item in the list. The last node in the list typically has a null pointer in most imperative programming languages.",["Here we represent the terminating value as Empty. So an empty list is just Empty.",["A list of a single item would be N(FirstItem, Empty).",["A list of two items N(FirstItem, N(SecondItem, Empty))",["...and so on. Obviously this is a tedious way to write lists but it is still pretty amazing to consider it is possible to define list behavior with two rules.",["The AMAZING property is that this append operation can be queried from any direction just like every other query we have seen. In other languages the \n          append operation takes two INPUTs and yields an OUTPUT. In a logic programming language there are NO inputs or outputs in the specification of rules and facts. The author\n          of the query determines what is given and what is requested.",0]]]]]]]],rules:["Append(Empty, ?List, ?List).",["Append(N(?Head, ?Tail), ?RightList, N(?Head, ?Result)) when Append(?Tail, ?RightList, ?Result).",0]],queries:[["Append(N(a, N(b, N(c, Empty))), N(one, N(two, N(three, Empty))), ?Result)",["Appends a list of [a, b, c] and a list of [one, two, three]."]],[["Append(N(a, N(b, Empty)), ?right, N(a, N(b, N(c, N(d, Empty)))))",["AMAZING!!! We are asking what list would we have to add to [a, b] to get [a, b, c, d]."]],[["Append(?left, ?right, N(a, N(b, N(c, N(d, Empty)))))",["This is even crazier. We are now asking for all combinations of input that might produce the output."]],0]]]},[{name:"Linked List: Reverse",rule_instructions:0,rules:["ReverseList(Empty, Empty).",["ReverseListWithAccumulator(?accumulator, Empty, ?accumulator).",["ReverseListWithAccumulator(?accumulator, N(?head, ?tail), ?reversed) when ReverseListWithAccumulator(N(?head, ?accumulator), ?tail, ?reversed).",["ReverseList(?List, ?ReversedList) when ReverseListWithAccumulator(Empty, ?List, ?ReversedList).",0]]]],queries:[["ReverseList(N(a, N(b, N(c, N(d, Empty)))), ?reversed)",[""]],[["ReverseList(?reversed, N(a, N(b, N(c, N(d, Empty)))))",[""]],0]]},[{name:"Linked List: Remove",rule_instructions:["This chapter illustrates how one might implement removal of all instances of an element from a list.",["The technique involves complex pattern matching, unification, recursion, and not-unifies.",["It is entirely OK if this seems hard. This example is included only to demonstrate the extent to which the declarative paradigm \n          can be stretched to implement ",0]]],rules:["Remove(?Item, Empty, Empty).",["Remove(?Item, N(?Item, ?Tail), ?RecursiveTail) when Remove(?Item, ?Tail, ?RecursiveTail).",["Remove(?Item, N(?Head, ?Tail), N(?Head, ?RecursiveTail)) when <?Item /= ?Head> and Remove(?Item, ?Tail, ?RecursiveTail).",0]]],queries:[["Remove(a, Empty, ?result)",[""]],[["Remove(a, N(a, Empty), ?result)",[""]],[["Remove(a, N(b, Empty), ?result)",[""]],[["Remove(b, N(a, N(b, N(a, Empty))), ?result)",[""]],[["Remove(cherry, N(apple, N(banana, N(cherry, N(date, N(elderberry, Empty))))), ?result)",[""]],[["Remove(x, N(x, N(o, N(x, N(o, N(x, Empty))))), ?result)",[""]],[["Remove(?whatWouldIRemove, N(x, N(o, N(x, N(o, N(x, Empty))))), N(o, N(o, Empty)))",[""]],0]]]]]]]},[{name:"Numbers: Summation",rule_instructions:["Real Prolog natively understands how to work with numbers. LitLog does not. HOWEVER, there is enough expressive power in pattern matching, unification and recursive rules\n          to define numbers and numeric behaviors for cardinal numbers (counting numbers).",["The representation in the example is based off the Peano Axioms (internet search). It is based on Zero and a Succ(?number) operation which simply means Successor or ?number + 1.",["In this system, Zero is... well Zero. The number one is represented by simply taking the successor of Zero so Succ(Zero). Naturally, two is the successor or one so Succ(Succ(Zero)). \n          This technique should feel very similar to what we did in the Linked List example.",["In fact, the SumOf operation looks a lot like Appending two linked lists and so the Append operations are included here for comparison.",0]]]],rules:["SumOf(Zero, ?Number, ?Number).",["SumOf(Succ(?InnerLeft), ?Right, Succ(?SumOfRightAndInnerLeft)) when SumOf(?InnerLeft, ?Right, ?SumOfRightAndInnerLeft).",["Append(Empty, ?List, ?List).",["Append(N(?Head, ?Tail), ?RightList, N(?Head, ?Result)) when Append(?Tail, ?RightList, ?Result).",0]]]],queries:[["SumOf(Zero, Zero, ?sum)",["Query for the result of 0 + 0"]],[["SumOf(Zero, Succ(Succ(Zero)), ?sum)",["0 + 2"]],[["SumOf(Succ(Zero), Succ(Succ(Zero)), ?sum)",["1 + 2"]],[["SumOf(Succ(Succ(Zero)), Succ(Succ(Zero)), ?sum)",["2 + 2"]],[["SumOf(Succ(Succ(Succ(Zero))), Succ(Succ(Zero)), ?sum)",["3 + 2. Not only is this tedious to write but it is also difficult to decipher the output. We will clean that up in the next Chapter."]],0]]]]]},[{name:"Numbers: Pretty Summation",rule_instructions:["The SumOf operation works by pattern matching on the structure of Succ. Therefore, the nesting structure, which is so difficult to read, as at the heart of what makes it works. We have to keep the nesting structure.",["However, we can alias the structured representation of numbers and define a pretty sum that relates terms at the level of the aliases.",["Observe that the code defines aliases for zero thru ten.",["It then defines SumOf identical to the definition from the prior chapter.",["PrettySum works by 1) solving for the structured representation of the left number, 2) solving for the structured representation of the right number, 3) solving for the structure representation of the sum, and 4) finally solves for the alias of the structured sum.",0]]]]],rules:["Alias(Zero, Zero).",["Alias(One, Succ(Zero)).",["Alias(Two, Succ(Succ(Zero))).",["Alias(Three, Succ(?twoStructure)) when Alias(Two, ?twoStructure).",["Alias(Four, Succ(?threeStructure)) when Alias(Three, ?threeStructure).",["Alias(Five, Succ(?fourStructure)) when Alias(Four, ?fourStructure).",["Alias(Six, Succ(?fiveStructure)) when Alias(Five, ?fiveStructure).",["Alias(Seven, Succ(?sixStructure)) when Alias(Six, ?sixStructure).",["Alias(Eight, Succ(?sevenStructure)) when Alias(Seven, ?sevenStructure).",["Alias(Nine, Succ(?eightStructure)) when Alias(Eight, ?eightStructure).",["Alias(Ten, Succ(?nineStructure)) when Alias(Nine, ?nineStructure).",["SumOf(Zero, ?Number, ?Number).",["SumOf(Succ(?InnerLeft), ?Right, Succ(?SumOfRightAndInnerLeft)) when SumOf(?InnerLeft, ?Right, ?SumOfRightAndInnerLeft).",["PrettySum(?leftAlias, ?rightAlias, ?prettySum) when Alias(?leftAlias, ?leftStructure) and Alias(?rightAlias, ?rightStructure) and SumOf(?leftStructure, ?rightStructure, ?sumStructure) and Alias(?prettySum, ?sumStructure).",0]]]]]]]]]]]]]],queries:[["PrettySum(Two, Three, ?prettySum)",["Execute this query and breath a sigh of relief. The answer is displayed as a very clear Five."]],[["PrettySum(Three, Five, ?prettySum)",[""]],[["PrettySum(Four, Five, ?prettySum)",[""]],[["PrettySum(?left, Three, Ten)",["Discover what can be added to Three to equal Ten."]],[["PrettySum(?left, ?right, Five)",["Find all the ways to add numbers to achieve Five"]],[["PrettySum(?half, ?half, ?num)",["Find all the pairs of numbers and their half."]],0]]]]]]},[{name:"Towers of Hanoi",rule_instructions:0,rules:["Alias(Zero, Zero).",["Alias(One, Succ(Zero)).",["Alias(Two, Succ(Succ(Zero))).",["Alias(Three, Succ(?twoStructure)) when Alias(Two, ?twoStructure).",["Alias(Four, Succ(?threeStructure)) when Alias(Three, ?threeStructure).",["Alias(Five, Succ(?fourStructure)) when Alias(Four, ?fourStructure).",["Alias(Six, Succ(?fiveStructure)) when Alias(Five, ?fiveStructure).",["Alias(Seven, Succ(?sixStructure)) when Alias(Six, ?sixStructure).",["Alias(Eight, Succ(?sevenStructure)) when Alias(Seven, ?sevenStructure).",["Alias(Nine, Succ(?eightStructure)) when Alias(Eight, ?eightStructure).",["ReverseList(Empty, Empty).",["ReverseListWithAccumulator(?accumulator, Empty, ?accumulator).",["ReverseListWithAccumulator(?accumulator, N(?head, ?tail), ?reversed) when ReverseListWithAccumulator(N(?head, ?accumulator), ?tail, ?reversed).",["ReverseList(?List, ?ReversedList) when ReverseListWithAccumulator(Empty, ?List, ?ReversedList).",["Move(Zero, ?X, ?Y, ?dontCare, ?PriorMoves, N(MoveTopDiskFrom(?X, ?Y), ?PriorMoves)).",["Move(Succ(?M), ?X, ?Y, ?Z, ?PriorMoves, ?FinalMoves) \n                when Move(?M, ?X, ?Z, ?Y, ?PriorMoves, ?MovesAfterFirst) \n                and Move(Zero, ?X, ?Y, ?_, ?MovesAfterFirst, ?MovesAfterZero) \n                and Move(?M, ?Z, ?Y, ?X, ?MovesAfterZero, ?FinalMoves).\n          ",["TowerOfHanoiWithDiscs(?numberOfDiscs, ?resultingMoves)\n                when Alias(?numberOfDiscs, Succ(?zeroBasedStructure))\n                and Move(?zeroBasedStructure, Left, Right, Center, Empty, ?resultingMovesReversed)\n                and ReverseList(?resultingMovesReversed, ?resultingMoves).\n          ",0]]]]]]]]]]]]]]]]],queries:[["TowerOfHanoiWithDiscs(One, ?solution)",[""]],[["TowerOfHanoiWithDiscs(Two, ?solution)",[""]],[["TowerOfHanoiWithDiscs(Three, ?solution)",[""]],[["TowerOfHanoiWithDiscs(Four, ?solution)",[""]],[["TowerOfHanoiWithDiscs(Five, ?solution)",[""]],0]]]]]},0]]]]]]]]]]]]]]];var ni=["LitLog, short for Literate Logic programming, is a subset of Prolog with a simpler syntax and an on-line editor. \n    The goal of LitLog is to offer a path to quickly learning the basics of declarative logic programming in three lunch breaks or less.",["When Logic Programming fits the problem space, it beats other programming paradigms by orders of magnitude so it is a helpful tool to\n    have in your mental toolbox (even if an applicable problem may only arise once in a decade). It is also just neat and that alone is worth a few lunch periods.",["The act of declarative logic programming is building a knowledge database that can be queried. It is the query powers that are surprising and interesting.",["Rules & Facts are the two forms of knowledge representation. Get started by choosing the first chapter.",0]]]];function ti(e,r){return{text:ve(e,r),compilation_result:ee(0,[r])}}function ai(e,r,n){var t,a,i,u,o,c=yn(r,e);return{text:e,compilation_result:c.tag?(t=qe(Vr,c[0]))?(a=t[0],i=Oe(function(e){return Vr(e,a)<=0})(t[1]),ee(1,[_e(Ur,[a,i])])):ee(1,[0]):(o=ve(n,u=c[0].result))?ee(1,[o]):ee(0,[u])}}function ii(e){var r=e.solution_stream;return r?{initiating_query:e.initiating_query,solution_stream:Tt(r[1]),displayed_solutions:[r[0],e.displayed_solutions]}:e}var ui={CompiledTextEditing:{empty:function(e){return{text:"",compilation_result:ee(1,[0])}},edit:ti,make:ai},ExecutingQueryInfo:{next_solution:ii},init:function(e){return{rule_database:Ra.RuleDatabase.empty,available_chapters:ri,chapter_opt:void 0,interaction_mode:0}}};var oi={viewRules:0,initiateAddRule:1,initiateEditRule:function(e){return ee(0,[e])},initiateEditQuery:function(e){return ee(1,[e])},chooseChapter:function(e){return ee(2,[e])},nextChapter:2,updateText:function(e){return ee(3,[e])},addRule:function(e){return ee(4,[e])},editRuleEntry:function(e){return ee(5,[e])},deleteRule:function(e){return ee(6,[e])},executeQuery:function(e){return ee(7,[e])},nextFrame:3};function ci(){"remove"in Element.prototype||(Element.prototype.remove=function(){this.parentNode&&this.parentNode.removeChild(this)}),function(){for(var i=0,e=["ms","moz","webkit","o"],r=0;r<e.length&&!window.requestAnimationFrame;++r)window.requestAnimationFrame=window[e[r]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[e[r]+"CancelAnimationFrame"]||window[e[r]+"CancelRequestAnimationFrame"];window.requestAnimationFrame||(window.requestAnimationFrame=function(e,r){var n=(new Date).getTime(),t=Math.max(0,16-(n-i)),a=window.setTimeout(function(){e(n+t)},t);return i=n+t,a}),window.cancelAnimationFrame||(window.cancelAnimationFrame=function(e){clearTimeout(e)})}()}function si(u,l,t,v,d,e){if(void 0===e)return function(a){function i(e){var r=ve(t,e);n.contents=vr(a,a,n.contents,r)}var n={contents:0};return{startup:function(e){lr(a,d),i(v)},render_string:function(e){return Ye(ve(l,e))},handleMsg:function(e,r){var n=C(u,e,r),t=n[0];return lr(a,n[1]),i(t),t},shutdown:function(e){lr(a,e),n.contents=vr(a,a,n.contents,0)}}};var h=ce(e);return function(o){function a(e){var r,n,t,a,i,u;void 0!==f.contents&&(r=[ve(l,s.contents),0],t=o,a=h,i=c.contents,u=r,fr(t,a,a.childNodes,0,i,u),n=u,c.contents=n,f.contents=void 0)}function r(e){for(;0<h.childNodes.length;){var r=h.firstChild;null!==r&&h.removeChild(r)}}function i(e){var r=ve(t,e);n.contents=vr(o,o,n.contents,r)}var c={contents:0},s={contents:v},f={contents:void 0},n={contents:0};return{startup:function(e){r(),lr(o,d),i(s.contents),f.contents=-1,a()},render_string:function(e){return Ye(ve(l,e))},handleMsg:function(e,r){var n=C(u,e,r),t=n[0];return s.contents=t,lr(o,n[1]),void 0===f.contents&&(f.contents=-1,a()),i(t),t},shutdown:function(e){f.contents=void 0,lr(o,e),n.contents=vr(o,o,n.contents,0),c.contents=0,r()}}}}function fi(e,r,n){ci();var t,a,i,u,o,c,s,f,l,v=ve(e.init,n),d=v[0],h=null==r?void 0:oe(r),p=si(e.update,e.view,e.subscriptions,d,v[1],h);return t=d,a=p,i=e.shutdown,u={contents:t},c=ve(a,o={contents:{enqueue:function(e){console.log("INVALID enqueue CALL!")}}}),s={contents:void 0},l={enqueue:f=function(e){var r=s.contents;if(void 0===r){s.contents=0;var n=C(c.handleMsg,u.contents,e);u.contents=n;var t=s.contents;if(void 0!==t)return t?(s.contents=void 0,Se(f,we(t))):void(s.contents=void 0);throw[w,"INVALID message queue state, should never be None during message processing!"]}s.contents=[e,r]}},o.contents=l,ve(c.startup,void 0),{pushMsg:f,shutdown:function(e){o.contents={enqueue:function(e){console.log("INVALID message enqueued when shut down")}};var r=ve(i,u.contents);ve(c.shutdown,r)},getHtmlString:function(e){return ve(c.render_string,u.contents)}}}function li(e){return{href:e.href,protocol:e.protocol,host:e.host,hostname:e.hostname,port:e.port,pathname:e.pathname,search:e.search,hash:e.hash,username:e.username,password:e.password,origin:e.origin}}var vi={contents:void 0};function di(i){var r;return r=function(r){vi.contents=function(e){return ve(r.enqueue,ve(i,e))};function a(e){var r;void 0!==(r=vi.contents)&&ve(r,li(document.location))}var e,n,t;return n=a,t=!(e="popstate"),window.addEventListener(e,n,t),function(e){return n=a,t=!(r="popstate"),window.removeEventListener(r,n,t);var r,n,t}},ee(1,["navigation",function(e){return ve(r,e.contents)},{contents:void 0}])}var hi="button-bar",pi="delete";function mi(e,r,n){var t=void 0===e||e;return ut(void 0,void 0,[yt(n),[kt.disabled(!t),0]],[rt(r),0])}function gi(e){return nt(void 0,void 0,[dt(hi),0],e)}var bi="#48a9dc",wi="\n\n        ."+String(hi)+(" {\n            padding-top: 5px; \n            padding-bottom: 5px;\n        }\n\n        button {\n            background-color: white;\n            color: #555;\n            box-shadow: 0 0 0 1px "+String(bi)+(";\n            border: none;\n            border-radius: 4px;\n            padding: 6px;\n            margin-right: 8px;\n            font-size: 14px;\n        }\n\n        button."+String(pi)+(" {\n            background-color: #f00;\n            box-shadow: 0 0 2px 2px rgba(127,0,0,.5);\n            font-weight: bold;\n            color: #fff;\n            padding-left: 8px;\n            padding-right: 8px;\n            border-radius: 4px;\n            display: inline-block;\n        }\n\n        button:active {\n            background-color: "+String(bi)+(";\n            color: white;\n        }\n\n        button:disabled {\n            background-color: #ddd;\n            color: #90adbd;\n        }\n\n        a, a:active, a:visited {\n            display: inline-block;\n            color: "+String(bi)+("\n        }\n\n        a, a:active, a:visited {\n            display: inline-block;\n            color: "+String(bi))))))+"\n        }\n    ",yi="panels",_i="panel",Si="panel-header",ki="panel-body";function xi(e,r){return nt(void 0,void 0,[dt(_i),0],[nt(void 0,void 0,[dt(Si),0],[rt(e),0]),[nt(void 0,void 0,[dt(ki),0],r),0]])}var Ai="\n        div."+String(yi)+(" {\n            height: 98%;\n        }\n\n        div."+String(Si)+(" {\n            background-color: #248;\n            color: white;\n            font-weight: bold;\n            padding: 4px;\n        }   \n\n        div."+String(_i)+(" {\n            overflow-y: auto;\n            background-color: white;\n            margin-top: 5px;\n        }     \n        \n\n        @media screen and (max-width: 1023px) {\n            div."+String(_i)+(" {\n                float: left;\n                width: 99%;\n                margin-top: 10px;\n                border: solid 1px #aaa;\n            }\n        }\n\n        @media screen and (min-width: 1024px) {\n            div."+String(_i)+(" {\n                float: left;\n                margin-left: 5px;\n                margin-right: 5px;\n                width: 48%;\n                height: 98%;\n                border: solid 1px #aaa;\n            }\n        }\n\n        div."+String(ki))))))+" {\n            padding: 6px;\n        }\n    ",Ni="section";function Oi(e,r){return nt(void 0,void 0,[dt(Ni),0],[it(void 0,void 0,0,[rt(e),0]),[vt(void 0,void 0,0,0),[nt(void 0,void 0,0,r),0]]])}var qi="variable",Ri="fact",Ti="relation",Fi="punctuation",Ei="query-comment",Li="rule-application-count",Mi="rule-application-count-visible",Ci="relation",Di="rule-item",Pi="rule-used",Ii="rule-display",Wi="\n        ."+String(qi)+(" {\n            color: #ff0; \n            display: inline-block;\n        }\n\n        ."+String(Ci)+(" {\n            display: inline-block;\n        }\n\n        ."+String(Ri)+(" {\n            color: #0f0;\n            display: inline-block;\n        }\n        \n        ."+String(Ei)+(" {\n            color: #ccc;\n            padding: 4px;\n            margin-bottom: 8px;\n        }\n\n        ."+String(Ti)+(" {\n            color: #6af;\n            font-weight: bold;\n            display: inline-block;\n        }\n\n        ."+String(Fi)+(" {\n            color: white;\n            font-weight: bold;\n        }\n\n        ."+String(Ii)+(" {\n            background-color: black;\n            font-family: Consolas, monospace;\n            padding: 4px;\n        }\n\n        ."+String(Di)+(" {\n            color: black;\n            background-color: black;\n\n            display: flex;\n            align-items: center;            \n\n            border-radius: 6px;\n            padding: 6px;\n            box-shadow: 0 0.5em 1em -0.125em rgba(10,10,10,.1), 0 0 0 1px rgba(10,10,10,.02);\n\n            margin-bottom: 12px;\n            font-size: 14px;\n        }\n\n        ."+String(Di)+("."+String(Pi)+(" {\n            box-shadow: 0 0 2px 4px #f44;\n        }\n\n        ."+String(Li)+(" {\n            display: inline-block;\n            visibility: hidden;\n            padding-left: 6px;\n            padding-right: 6px;\n            padding-top: 2px;\n            padding-bottom: 2px;\n            border-radius: 9px;\n            border: solid 1px #884;\n            color: black;\n            background-color: #ff8;\n            font-weight: bold;\n            font-size: 16px;\n        }\n\n        ."+String(Li)+("."+String(Mi)))))))))))))+" {\n            visibility: visible;\n        }\n\n        ul {\n            list-style: none;\n            margin-block-start: 0;\n            margin-block-end: 0;\n        }\n    ";function $i(e){return tt(void 0,void 0,[dt(Fi),0],[rt(e),0])}function Ji(e){if(!e.tag)return tt(void 0,void 0,[dt(qi),0],[rt(ve(Qr([ee(12,[63,ee(2,[0,0])]),"?%s"]),e[0][0])),0]);var r=e[0],n=r.related_terms,t=r.relation_name[0];return n?tt(void 0,void 0,[dt(Ci),0],[tt(void 0,void 0,[dt(Ti),0],[rt(t),0]),[$i("("),[Ji(n[0]),[tt(void 0,void 0,0,_e(function(e){return tt(void 0,void 0,0,[$i(", "),[Ji(e),0]])},n[1])),[$i(")"),0]]]]]):tt(void 0,void 0,[dt(Ri),0],[rt(t),0])}function Zi(e){switch(0|e.tag){case 0:return Ji(e[0]);case 1:return tt(void 0,void 0,0,[Ji(e[0]),[$i("="),[Ji(e[1]),0]]]);case 2:return tt(void 0,void 0,0,[Ji(e[0]),[$i("/="),[Ji(e[1]),0]]])}}function Bi(e){function r(e,r){return ft(void 0,void 0,0,[$i(e),[Zi(r),0]])}var n,t,a,i=e.antecedents;return a=i?(n=i[0],st(void 0,void 0,0,(t=we(i[1]))?Ne([[r("when ",n),0],[_e(function(e){return r("and ",e)},we(t[1])),[[ft(void 0,void 0,0,[$i("and "),[Zi(t[0]),[$i("."),0]]]),0],0]]]):[ft(void 0,void 0,0,[$i(" when "),[Zi(n),[$i("."),0]]]),0])):$i("."),nt(void 0,void 0,[dt(Ii),0],[Ji(e.consequent),[a,0]])}function Hi(e,r){return nt(void 0,void 0,[dt(Ii),0],[0!==r.length?nt(void 0,void 0,[dt(Ei),0],[rt(r),0]):xt,[st(void 0,void 0,0,_e(function(e){return ft(void 0,void 0,0,[Zi(e),0])},e)),0]])}function Qi(e){var r,n,t,a,i=ve(Ra.RuleDatabase.rule_from_entry,e);return nt(void 0,void 0,[ht([[Di,!0],[[Pi,!1],0]]),0],[ut(void 0,void 0,[yt(oi.deleteRule(e)),[dt(pi),0]],[rt("X"),0]),[(n=r=void 0,t=[yt(oi.initiateEditRule(e)),0],a=[Bi(i),0],Ge("","a",void 0!==r?r:"",void 0!==n?n:"",t,a)),0]])}var Vi="language-editing",Ui="errors-container",ji="editing-container",zi="\n        input {\n            margin-left: 6px;\n        }          \n        \n        ."+String(Vi)+(" {\n            width: 96%;\n            font-family: Consolas, monospace;\n            background-color: black;\n            color: white;\n        }\n\n        ."+String(Ui)+(" ul {\n            padding-left: 20px;\n            list-style: square;\n        }\n\n        ."+String(ji)+(" {\n            margin-bottom: 16px;\n        }\n\n        ."+String(Ui))))+" li {\n            color: #800;\n            font-size: 14px;\n        }\n    ";function Xi(e,r,n,t,a,i){var u,o=e.compilation_result;if(o.tag)return nt(void 0,void 0,[dt(ji),0],[ct(void 0,void 0,0,[rt(r),0]),[ot(void 0,void 0,[bt(void 0,oi.updateText),[dt(Vi),[pt(i),[mt(e.text),[At,0]]]]],0),[xt,[gi([(u=o[0])?nt(void 0,void 0,[dt(Ui),0],[st(void 0,void 0,0,_e(function(e){return ft(void 0,void 0,0,[rt(e),0])},u)),0]):xt,[mi(void 0,"Cancel",a),0]]),0]]]]);var c=ve(t,o[0]);return nt(void 0,void 0,[dt(ji),0],[ct(void 0,void 0,0,[rt(r),0]),[ot(void 0,void 0,[bt(void 0,oi.updateText),[dt(Vi),[pt(i),[mt(e.text),[D(Ct.Keydown.keydown,e.text,c,function(e){return 13===e.keyCode&&e.ctrlKey}),0]]]]],0),[nt(void 0,void 0,0,[rt(ve(Qr([ee(11,["(ctrl+enter to ",ee(2,[0,ee(12,[41,0])])]),"(ctrl+enter to %s)"]),n)),0]),[gi([mi(void 0,n,c),[mi(void 0,"Cancel",a),0]]),0]]]])}function Gi(n){function e(a){return nt(void 0,void 0,0,_e(function(e){return r=a,n=e,t=Et.count(function(e){return C(Ra.RuleDatabase.is_same,e,n)},r),nt(void 0,void 0,[ht([[Di,!0],[[Pi,0<t],0]]),0],[tt(void 0,void 0,[ht([[Li,!0],[[Mi,0<t],0]]),0],[rt(ve(Qr([ee(4,[0,0,0,0]),"%d"]),t)),0]),[Bi(ve(Ra.RuleDatabase.rule_from_entry,n)),0]]);var r,n,t},u))}var r,t,a,i,u=ve(Ra.RuleDatabase.all_rules,n.rule_database),o=n.interaction_mode;if("number"==typeof o)s=nt(void 0,"viewing_rules",0,[gi([ct(void 0,void 0,0,[rt("Chapter:"),0]),[(a=[wt(t=r=void 0,function(r){return oi.chooseChapter(function(e,r){for(;;){var n=r;if(!n)return;var t=n[0];if(ve(e,t))return oe(t);r=n[1]}}(function(e){return e.name===r},n.available_chapters))}),0],i=[lt(void 0,void 0,[kt.selected(void 0===n.chapter_opt),0],[rt("(select chapter)"),0]),_e(function(e){return lt(void 0,void 0,[kt.selected(m(n.chapter_opt,e)),0],[rt(e.name),0])},n.available_chapters)],Ge("","select",void 0!==r?r:"",void 0!==t?t:"",a,i)),[mi(void 0,"Add Rule / Fact",1),[u?mi(void 0,"Query",ee(1,[0])):xt,0]]]]),[vt(void 0,void 0,0,0),[nt(void 0,"editable_rules",0,[at(void 0,void 0,0,[rt(u?"Click the rule text of any rule to edit/update that rule. Clicking X removes the rule from the database WITHOUT a prompt.":"Click <Add Rule/Fact> to start adding rules to the database."),0]),[nt(void 0,void 0,0,_e(Qi,u)),0]]),0]]]);else switch(0|o.tag){case 0:s=nt(void 0,"adding_rule",0,[Xi(o[0],"New Rule","Add Rule",oi.addRule,0,"New rule..."),[vt(void 0,void 0,0,0),[e(0),0]]]);break;case 1:var c=o[0],s=nt(void 0,"editing_rule",0,[Xi(o[1],"Editing Rule","Update Rule",function(e){return oi.editRuleEntry(C(Ra.RuleDatabase.update_rule_entry,c,e))},0,"Edit rule..."),[vt(void 0,void 0,0,0),[e([c,0]),0]]]);break;case 2:s=e(0);break;case 3:var f=o[0].solution_stream;s=e(f?f[0].rules_applied:0)}return xi("Rules and Facts",[s,0])}var Ki="solution-frame",Yi="no-solution",eu="example-query";function ru(e){function r(e){return Oi("Query",[Hi(o,""),0])}function n(e){var r=C(Ra.Frame.to_strings,o,e.frame);return nt(void 0,void 0,[dt(Ki),0],r?[it(void 0,void 0,0,[rt("Satisfied With Variable Substitution(s)"),0]),[st(void 0,void 0,0,_e(function(e){return ft(void 0,void 0,0,[rt(e),0])},r)),0]]:[it(void 0,void 0,0,[rt("Satisfied Without Variable Sustitution"),0]),[st(void 0,void 0,0,0),0]])}var t,a,i=e.displayed_solutions,u=e.solution_stream,o=e.initiating_query;return a=i?(t=ge(i),Oi(ve(Qr([ee(11,["Prior Solutions (",ee(4,[0,0,0,ee(12,[41,0])])]),"Prior Solutions (%d)"]),t),[ct(void 0,void 0,0,[rt("OBSERVE: Some solutions may appear more than once because there can be multiple paths to reach the same solution. LitLog does not remove duplicate solutions from the display in order to illustrate the paths / search process."),0]),_e(n,i)])):xt,nt(void 0,"executing_query",0,[u?nt(void 0,"solutions_remaining",0,[gi([mi(void 0,"Next Solution",3),[mi(void 0,"New Query",ee(1,[o])),[mi(void 0,"Cancel",0),0]]]),[r(),[Oi("Current Solution",[ct(void 0,void 0,0,[rt("OBSERVE: All rules and facts applied in the discovery of the current solution are highlighted in the Rules and Facts panel with a count of the number of times the Rule/Fact was applied in the discovery of the solution."),0]),[n(u[0]),0]]),0]]]):nt(void 0,"end_of_stream",0,[gi([mi(void 0,"New Query",ee(1,[o])),[mi(void 0,"Manage Rules",0),[mi(void 0,"Next Chapter",2),0]]]),[r(),[Oi("All Solutions Found",[ct(void 0,void 0,0,[rt("All of the solutions to the query have been found. Click New Query to keep experimenting in this chapter or <Next Chapter> to move on."),0]),0]),[i?xt:nt(void 0,void 0,[dt(Yi),0],[rt("No Solution"),0]),0]]]]),[a,0]])}function nu(e){return nt(void 0,"instructions",0,_e(function(e){return at(void 0,void 0,0,[rt(e),0])},e))}function tu(e){function r(e,r){return xi(e,[r,0])}var n,t,a,i=e.chapter_opt,u=void 0!==i?i.rule_instructions:ni,o=e.interaction_mode;if("number"==typeof o)return r("Instructions",nu(u));switch(0|o.tag){case 2:return r("Query",(n=o[0],t=e.chapter_opt,a=void 0!==t?ei(t):0,nt(void 0,"editing_query",0,[Xi(n,"Query","Execute Query",oi.executeQuery,0,"New query..."),[a?nt(void 0,void 0,0,[ct(void 0,void 0,0,[rt("Example Queries. Click a query below to populate the query entry box with that query."),0]),[nt(void 0,void 0,0,_e(function(e){var r=e[0];return nt(void 0,void 0,[dt(eu),[yt(oi.updateText(ve(Ra.Query.to_string,r))),0]],[Hi(r,e[1][0]),0])},a)),0]]):xt,0]])));case 3:return r("Query",ru(o[0]));default:return r("Instructions",nu(u))}}var au=Je(" ",["\n        html {\n            height: 100%\n        }\n\n        select {\n            font-size: 16px;\n            color: #444;\n            margin-left: 4px;\n            margin-right: 16px;\n        }\n\n        body {\n            height: 100%;\n            background-color: #eee;\n            display: flex;\n            flex-direction: column;\n            font-family: sans-serif;\n            padding: 0;\n            margin: 0;\n        }\n\n        p {\n            font-size: 14px;\n        }\n\n        h3 {\n            margin-bottom: 3px;\n        }\n    ",[wi,[Ai,["\n\n    ",[Wi,[zi,["",[" \n\n    div."+String(eu)+(" {\n        border-radius: 3px;\n        padding: 5px;\n        margin-bottom: 6px;\n        background-color: #444;\n    }\n\n    div."+String(Yi)+(" {\n        margin: 4px;\n        padding: 6px;\n        border-radius: 3px;\n        border-color: #aaa;\n        border-width: 1px;\n        border-style: solid;\n        background-color: #fcc;\n    }\n\n    div."+String(Ki)+(" {\n        margin: 4px;\n        padding: 4px;\n        border-radius: 3px;\n        border-color: #aaa;\n        border-width: 1px;\n        border-style: solid;\n        background-color: #cfc;\n    }\n\n    div."+String(Ki))))+" > h3 {\n        font-size: 16px;\n        font-weight: bold;\n        margin: 4px;\n    }\n    \n    ",0]]]]]]]]);var iu,uu,ou,cu=(iu=function(e){return oi.viewRules},ou={init:function(e){return C(uu.init,e,li(document.location))},update:(uu={init:function(e,r){return[ui.init(void 0),0]},update:function(e,r){function n(e,r){var n=Xa.rule_database_result_from_rule_strings(r.rules);return n.tag?(console.error(n[0]),e):n[0]}var t,a=e.interaction_mode,i=e.rule_database;if("number"==typeof r)switch(r){case 0:c={rule_database:e.rule_database,available_chapters:e.available_chapters,chapter_opt:e.chapter_opt,interaction_mode:0};break;case 1:c={rule_database:e.rule_database,available_chapters:e.available_chapters,chapter_opt:e.chapter_opt,interaction_mode:ee(0,[{text:"",compilation_result:ee(1,[0])}])};break;case 2:var u=e.chapter_opt,o=void 0!==u?(t=u,Et.next_or_this_item(t,ri)):function(e){if(e)return e[0];throw[w,"hd"]}(ri),c={rule_database:n(i,o),available_chapters:e.available_chapters,chapter_opt:o,interaction_mode:0};break;case 3:c="number"==typeof a||3!==a.tag?e:{rule_database:e.rule_database,available_chapters:e.available_chapters,chapter_opt:e.chapter_opt,interaction_mode:ee(3,[ii(a[0])])}}else switch(0|r.tag){case 0:var s=r[0],f=ve(Ra.RuleDatabase.rule_from_entry,s);c={rule_database:e.rule_database,available_chapters:e.available_chapters,chapter_opt:e.chapter_opt,interaction_mode:ee(1,[s,ti(Ra.Rule.to_string,f)])};break;case 1:c={rule_database:e.rule_database,available_chapters:e.available_chapters,chapter_opt:e.chapter_opt,interaction_mode:ee(2,[ti(Ra.Query.to_string,r[0])])};break;case 2:var l=r[0];c={rule_database:void 0!==l?n(i,l):Ra.RuleDatabase.empty,available_chapters:e.available_chapters,chapter_opt:l,interaction_mode:0};break;case 3:var v=r[0],d=Ca.rule_database_snapshot(i);if("number"==typeof a)c=e;else switch(0|a.tag){case 0:c={rule_database:e.rule_database,available_chapters:e.available_chapters,chapter_opt:e.chapter_opt,interaction_mode:ee(0,[ai(v,Xa.rule_parser,function(e){return Ca.issues_in_new_rule(d,e)})])};break;case 1:var h=a[0];c={rule_database:e.rule_database,available_chapters:e.available_chapters,chapter_opt:e.chapter_opt,interaction_mode:ee(1,[h,ai(v,Xa.rule_parser,function(e){return Ca.issues_in_existing_rule(d,C(Ra.RuleDatabase.update_rule_entry,h,e))})])};break;case 2:c={rule_database:e.rule_database,available_chapters:e.available_chapters,chapter_opt:e.chapter_opt,interaction_mode:ee(2,[ai(v,Xa.query_parser,function(e){return Ca.issues_in_query(d,e)})])};break;case 3:c=e}break;case 4:c={rule_database:C(Ra.RuleDatabase.add_rule,i,r[0]),available_chapters:e.available_chapters,chapter_opt:e.chapter_opt,interaction_mode:ee(0,[{text:"",compilation_result:ee(1,[0])}])};break;case 5:c={rule_database:C(Ra.RuleDatabase.update_rule,i,r[0]),available_chapters:e.available_chapters,chapter_opt:e.chapter_opt,interaction_mode:0};break;case 6:c={rule_database:C(Ra.RuleDatabase.remove_rule,i,r[0]),available_chapters:e.available_chapters,chapter_opt:e.chapter_opt,interaction_mode:e.interaction_mode};break;case 7:var p=r[0],m=Ya.query(i,p);c={rule_database:e.rule_database,available_chapters:e.available_chapters,chapter_opt:e.chapter_opt,interaction_mode:ee(3,[{initiating_query:p,solution_stream:m,displayed_solutions:0}])}}return[c,0]},view:function(e){return r=[Gi(e),[tu(e),0]],nt(void 0,void 0,[dt(yi),0],r);var r},subscriptions:function(e){return 0},shutdown:function(e){return 0}}).update,view:uu.view,subscriptions:function(e){return ee(0,[[di(iu),[ve(uu.subscriptions,e),0]]])},shutdown:uu.shutdown},function(e,r){return fi(ou,e,r)});return e.main=function(e,r){var n=document.createElement("style");return document.head.appendChild(n),n.innerHTML=au,C(cu,e,void 0)},e}({});
